"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f";
exports.ids = ["vendor-chunks/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f"];
exports.modules = {

/***/ "(ssr)/./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/_chunks-es/PointerEvents.js":
/*!**************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/_chunks-es/PointerEvents.js ***!
  \**************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   InsertMenu: () => (/* binding */ InsertMenu),\n/* harmony export */   InsertMenuPopover: () => (/* binding */ InsertMenuPopover),\n/* harmony export */   PointerEvents: () => (/* binding */ PointerEvents),\n/* harmony export */   PopoverPortal: () => (/* binding */ PopoverPortal),\n/* harmony export */   TelemetryContext: () => (/* binding */ TelemetryContext),\n/* harmony export */   events: () => (/* binding */ events),\n/* harmony export */   getNodeIcon: () => (/* binding */ getNodeIcon),\n/* harmony export */   useTelemetry: () => (/* binding */ useTelemetry)\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/.pnpm/next@15.2.4_@babel+core@7.26.10_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react/jsx-runtime */ \"(ssr)/./node_modules/.pnpm/next@15.2.4_@babel+core@7.26.10_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.js\");\n/* harmony import */ var react_compiler_runtime__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-compiler-runtime */ \"(ssr)/./node_modules/.pnpm/react-compiler-runtime@19.0.0-beta-e993439-20250328_react@19.1.0/node_modules/react-compiler-runtime/dist/index.js\");\n/* harmony import */ var _sanity_insert_menu__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @sanity/insert-menu */ \"(ssr)/./node_modules/.pnpm/@sanity+insert-menu@1.1.8_@emotion+is-prop-valid@1.2.2_@sanity+types@3.83.0_@types+reac_00d06fb4262a0e1ae108b21052431060/node_modules/@sanity/insert-menu/dist/index.js\");\n/* harmony import */ var _sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sanity/ui/_visual-editing */ \"(ssr)/./node_modules/.pnpm/@sanity+ui@2.15.13_@emotion+is-prop-valid@1.2.2_react-dom@19.1.0_react@19.1.0__react-is_6a53d62aae3ab5ea8599da7dda1e9a92/node_modules/@sanity/ui/dist/_chunks-es/_visual-editing.mjs\");\n/* harmony import */ var styled_components__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! styled-components */ \"(ssr)/./node_modules/.pnpm/styled-components@6.1.17_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/styled-components/dist/styled-components.esm.js\");\n/* harmony import */ var _sanity_icons__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sanity/icons */ \"(ssr)/./node_modules/.pnpm/@sanity+icons@3.7.0_react@19.1.0/node_modules/@sanity/icons/dist/index.js\");\n\n\n\n\n\n\n\nfunction getNodeIcon(option) {\n  if (!option) return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.CubeIcon, {});\n  if (option.type === \"string\")\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.StringIcon, {});\n  if (option.type === \"number\")\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.NumberIcon, {});\n  const {\n    value: node\n  } = option;\n  if (\"icon\" in option && option.icon)\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { dangerouslySetInnerHTML: {\n      __html: option.icon\n    } });\n  const {\n    type\n  } = node;\n  if (type === \"string\")\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.StringIcon, {});\n  if (type === \"boolean\")\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.CheckmarkCircleIcon, {});\n  if (type === \"number\")\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.NumberIcon, {});\n  if (type === \"array\" || type === \"union\")\n    return (Array.isArray(node.of) ? node.of : [node.of]).some((n) => \"name\" in n && n.name === \"block\") ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.BlockContentIcon, {}) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.ThListIcon, {});\n  if (type === \"object\") {\n    if (option.name === \"image\")\n      return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.ImageIcon, {});\n    if (option.name === \"block\")\n      return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.StringIcon, {});\n  }\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.CubeIcon, {});\n}\nconst PortalContainer = styled_components__WEBPACK_IMPORTED_MODULE_4__.styled.div`\n  height: 100%;\n  inset: 0;\n  overflow-y: scroll;\n  overscroll-behavior: contain;\n  pointer-events: all;\n  position: fixed;\n  width: 100%;\n  -ms-overflow-style: none;\n  scrollbar-width: none;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  &:before {\n    content: '';\n    display: block;\n    height: calc(100% + 1px);\n    position: absolute;\n    top: 0;\n    width: 100%;\n    z-index: -1;\n  }\n`, PortalBackground = styled_components__WEBPACK_IMPORTED_MODULE_4__.styled.div`\n  background: transparent;\n  height: 100%;\n  inset: 0;\n  position: absolute;\n  width: 100%;\n`, PopoverPortal = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_2__.c)(6), {\n    children,\n    onDismiss,\n    setBoundaryElement\n  } = props, handleClick = _temp$1;\n  let t0;\n  $[0] !== onDismiss ? (t0 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(PortalBackground, { onClickCapture: onDismiss }), $[0] = onDismiss, $[1] = t0) : t0 = $[1];\n  let t1;\n  return $[2] !== children || $[3] !== setBoundaryElement || $[4] !== t0 ? (t1 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_5__.Portal, { children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(PortalContainer, { \"data-sanity-overlay-element\": !0, ref: setBoundaryElement, onClick: handleClick, children: [\n    t0,\n    children\n  ] }) }), $[2] = children, $[3] = setBoundaryElement, $[4] = t0, $[5] = t1) : t1 = $[5], t1;\n};\nfunction _temp$1(event) {\n  event.stopPropagation();\n}\nfunction defineEvent(options) {\n  return {\n    type: \"log\",\n    name: options.name,\n    version: options.version,\n    description: options.description,\n    maxSampleRate: options.maxSampleRate,\n    schema: void 0\n  };\n}\nconst events = {\n  \"Visual Editing Drag Sequence Completed\": defineEvent({\n    name: \"Visual Editing Drag Sequence Completed\",\n    description: \"An array is successfully reordered using drag and drop.\",\n    version: 1\n  }),\n  \"Visual Editing Drag Minimap Enabled\": defineEvent({\n    name: \"Visual Editing Drag Minimap Enabled\",\n    description: \"The zoomed-out minimap view is enabled during a drag sequence.\",\n    version: 1\n  }),\n  \"Visual Editing Context Menu Item Removed\": defineEvent({\n    name: \"Visual Editing Context Menu Item Removed\",\n    description: \"An item is removed using the Context Menu.\",\n    version: 1\n  }),\n  \"Visual Editing Context Menu Item Duplicated\": defineEvent({\n    name: \"Visual Editing Context Menu Item Duplicated\",\n    description: \"An item is duplicated using the Context Menu.\",\n    version: 1\n  }),\n  \"Visual Editing Context Menu Item Moved\": defineEvent({\n    name: \"Visual Editing Context Menu Item Moved\",\n    description: \"An item is moved using the Context Menu.\",\n    version: 1\n  }),\n  \"Visual Editing Context Menu Item Inserted\": defineEvent({\n    name: \"Visual Editing Context Menu Item Inserted\",\n    description: \"An item is inserted using the Context Menu.\",\n    version: 1\n  }),\n  \"Visual Editing Insert Menu Item Inserted\": defineEvent({\n    name: \"Visual Editing Insert Menu Item Inserted\",\n    description: \"An item is inserted using the Insert Menu.\",\n    version: 1\n  }),\n  \"Visual Editing Overlay Clicked\": defineEvent({\n    name: \"Visual Editing Overlay Clicked\",\n    description: \"An Overlay is clicked.\",\n    version: 1\n  })\n}, TelemetryContext = (0,react__WEBPACK_IMPORTED_MODULE_0__.createContext)(void 0);\nfunction useTelemetry() {\n  const context = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(TelemetryContext);\n  if (!context)\n    throw new Error(\"Telemetry context is missing\");\n  return context;\n}\nconst labels = {\n  \"insert-menu.filter.all-items\": \"All\",\n  \"insert-menu.search.no-results\": \"No results\",\n  \"insert-menu.search.placeholder\": \"Filter types\\u2026\",\n  \"insert-menu.toggle-grid-view.tooltip\": \"Toggle grid view\",\n  \"insert-menu.toggle-list-view.tooltip\": \"Toggle list view\"\n}, InsertMenu = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_2__.c)(11), {\n    node,\n    onSelect\n  } = props;\n  let t0;\n  $[0] !== node.options?.insertMenu ? (t0 = node.options?.insertMenu || {}, $[0] = node.options?.insertMenu, $[1] = t0) : t0 = $[1];\n  const insertMenuOptions = t0;\n  let t1;\n  $[2] !== insertMenuOptions.views ? (t1 = insertMenuOptions.views?.map(_temp), $[2] = insertMenuOptions.views, $[3] = t1) : t1 = $[3];\n  const views = t1;\n  let t2;\n  $[4] !== node.of ? (t2 = node.of.map(_temp2), $[4] = node.of, $[5] = t2) : t2 = $[5];\n  let t3;\n  return $[6] !== insertMenuOptions || $[7] !== onSelect || $[8] !== t2 || $[9] !== views ? (t3 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_insert_menu__WEBPACK_IMPORTED_MODULE_6__.InsertMenu, { ...insertMenuOptions, labels, schemaTypes: t2, onSelect, views }), $[6] = insertMenuOptions, $[7] = onSelect, $[8] = t2, $[9] = views, $[10] = t3) : t3 = $[10], t3;\n}, InsertMenuPopover = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_2__.c)(11), {\n    node,\n    onDismiss,\n    onSelect,\n    referenceElement\n  } = props;\n  let t0;\n  $[0] !== node || $[1] !== onSelect ? (t0 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(InsertMenu, { node, onSelect }), $[0] = node, $[1] = onSelect, $[2] = t0) : t0 = $[2];\n  const popoverContent = t0, width = (node.options?.insertMenu || {}).views?.some(_temp3) ? 0 : void 0;\n  let t1;\n  $[3] === Symbol.for(\"react.memo_cache_sentinel\") ? (t1 = [\"bottom\"], $[3] = t1) : t1 = $[3];\n  let t2;\n  $[4] !== popoverContent || $[5] !== referenceElement || $[6] !== width ? (t2 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_5__.Popover, { animate: !0, constrainSize: !0, content: popoverContent, fallbackPlacements: t1, open: !0, placement: \"top\", preventOverflow: !0, referenceElement, width }), $[4] = popoverContent, $[5] = referenceElement, $[6] = width, $[7] = t2) : t2 = $[7];\n  let t3;\n  return $[8] !== onDismiss || $[9] !== t2 ? (t3 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(PopoverPortal, { onDismiss, children: t2 }), $[8] = onDismiss, $[9] = t2, $[10] = t3) : t3 = $[10], t3;\n};\nfunction _temp(view) {\n  return view.name === \"grid\" ? {\n    ...view,\n    previewImageUrl: (name) => view.previewImageUrls?.[name]\n  } : view;\n}\nfunction _temp2(type) {\n  return {\n    ...type,\n    icon: getNodeIcon(type)\n  };\n}\nfunction _temp3(view) {\n  return view.name === \"grid\";\n}\nconst PointerEvents = (t0) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_2__.c)(10);\n  let children, rest, style;\n  $[0] !== t0 ? ({\n    children,\n    style,\n    ...rest\n  } = t0, $[0] = t0, $[1] = children, $[2] = rest, $[3] = style) : (children = $[1], rest = $[2], style = $[3]);\n  let t1;\n  $[4] !== style ? (t1 = {\n    ...style,\n    pointerEvents: \"all\"\n  }, $[4] = style, $[5] = t1) : t1 = $[5];\n  let t2;\n  return $[6] !== children || $[7] !== rest || $[8] !== t1 ? (t2 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { style: t1, \"data-sanity-overlay-element\": !0, ...rest, children }), $[6] = children, $[7] = rest, $[8] = t1, $[9] = t2) : t2 = $[9], t2;\n};\n\n//# sourceMappingURL=PointerEvents.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHNhbml0eSt2aXN1YWwtZWRpdGluZ0AyLjEzLjE1X0BlbW90aW9uK2lzLXByb3AtdmFsaWRAMS4yLjJfQHNhbml0eStjbGllbnRANi4yOC40X0BzYW5pXzhjMjAzM2ZlYWJkNWY1ODRhZjQ0NjliZmNlMTQxNTNmL25vZGVfbW9kdWxlcy9Ac2FuaXR5L3Zpc3VhbC1lZGl0aW5nL2Rpc3QvX2NodW5rcy1lcy9Qb2ludGVyRXZlbnRzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFrRDtBQUNKO0FBQ0g7QUFDc0I7QUFDSjtBQUNsQjtBQUNvRjtBQUMvSDtBQUNBLHNDQUFzQyxzREFBRyxDQUFDLG1EQUFRLElBQUk7QUFDdEQ7QUFDQSwyQkFBMkIsc0RBQUcsQ0FBQyxxREFBVSxJQUFJO0FBQzdDO0FBQ0EsMkJBQTJCLHNEQUFHLENBQUMscURBQVUsSUFBSTtBQUM3QztBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsMkJBQTJCLHNEQUFHLFVBQVU7QUFDeEM7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLDJCQUEyQixzREFBRyxDQUFDLHFEQUFVLElBQUk7QUFDN0M7QUFDQSwyQkFBMkIsc0RBQUcsQ0FBQyw4REFBbUIsSUFBSTtBQUN0RDtBQUNBLDJCQUEyQixzREFBRyxDQUFDLHFEQUFVLElBQUk7QUFDN0M7QUFDQSwySEFBMkgsc0RBQUcsQ0FBQywyREFBZ0IsSUFBSSxvQkFBb0Isc0RBQUcsQ0FBQyxxREFBVSxJQUFJO0FBQ3pMO0FBQ0E7QUFDQSw2QkFBNkIsc0RBQUcsQ0FBQyxvREFBUyxJQUFJO0FBQzlDO0FBQ0EsNkJBQTZCLHNEQUFHLENBQUMscURBQVUsSUFBSTtBQUMvQztBQUNBLHlCQUF5QixzREFBRyxDQUFDLG1EQUFRLElBQUk7QUFDekM7QUFDQSx3QkFBd0IscURBQU07QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHFEQUFNO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVkseURBQUM7QUFDYjtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSw2Q0FBNkMsc0RBQUcscUJBQXFCLDJCQUEyQjtBQUNoRztBQUNBLGlHQUFpRyxzREFBRyxDQUFDLDZEQUFNLElBQUksMEJBQTBCLHVEQUFJLG9CQUFvQjtBQUNqSztBQUNBO0FBQ0EsS0FBSyxHQUFHO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsQ0FBQyxxQkFBcUIsb0RBQWE7QUFDbkM7QUFDQSxrQkFBa0IsaURBQVU7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsWUFBWSx5REFBQztBQUNiO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSwwRUFBMEU7QUFDMUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrSEFBa0gsc0RBQUcsQ0FBQywyREFBWSxJQUFJLGdFQUFnRTtBQUN0TSxDQUFDO0FBQ0QsWUFBWSx5REFBQztBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsNkRBQTZELHNEQUFHLGVBQWUsZ0JBQWdCO0FBQy9GLG9FQUFvRTtBQUNwRTtBQUNBO0FBQ0E7QUFDQSxpR0FBaUcsc0RBQUcsQ0FBQyw4REFBTyxJQUFJLDJKQUEySjtBQUMzUTtBQUNBLG1FQUFtRSxzREFBRyxrQkFBa0IseUJBQXlCO0FBQ2pIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVkseURBQUM7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsbUZBQW1GLHNEQUFHLFVBQVUsaUVBQWlFO0FBQ2pLO0FBVUU7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL3BldHJva3ZhcnRzaWFueWkvY29kZS9nZW9tdW5kdXMtd2Vic2l0ZS9ub2RlX21vZHVsZXMvLnBucG0vQHNhbml0eSt2aXN1YWwtZWRpdGluZ0AyLjEzLjE1X0BlbW90aW9uK2lzLXByb3AtdmFsaWRAMS4yLjJfQHNhbml0eStjbGllbnRANi4yOC40X0BzYW5pXzhjMjAzM2ZlYWJkNWY1ODRhZjQ0NjliZmNlMTQxNTNmL25vZGVfbW9kdWxlcy9Ac2FuaXR5L3Zpc3VhbC1lZGl0aW5nL2Rpc3QvX2NodW5rcy1lcy9Qb2ludGVyRXZlbnRzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUNvbnRleHQsIHVzZUNvbnRleHQgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IGpzeCwganN4cyB9IGZyb20gXCJyZWFjdC9qc3gtcnVudGltZVwiO1xuaW1wb3J0IHsgYyB9IGZyb20gXCJyZWFjdC1jb21waWxlci1ydW50aW1lXCI7XG5pbXBvcnQgeyBJbnNlcnRNZW51IGFzIEluc2VydE1lbnUkMSB9IGZyb20gXCJAc2FuaXR5L2luc2VydC1tZW51XCI7XG5pbXBvcnQgeyBQb3J0YWwsIFBvcG92ZXIgfSBmcm9tIFwiQHNhbml0eS91aS9fdmlzdWFsLWVkaXRpbmdcIjtcbmltcG9ydCB7IHN0eWxlZCB9IGZyb20gXCJzdHlsZWQtY29tcG9uZW50c1wiO1xuaW1wb3J0IHsgQ3ViZUljb24sIFN0cmluZ0ljb24sIE51bWJlckljb24sIENoZWNrbWFya0NpcmNsZUljb24sIEJsb2NrQ29udGVudEljb24sIFRoTGlzdEljb24sIEltYWdlSWNvbiB9IGZyb20gXCJAc2FuaXR5L2ljb25zXCI7XG5mdW5jdGlvbiBnZXROb2RlSWNvbihvcHRpb24pIHtcbiAgaWYgKCFvcHRpb24pIHJldHVybiAvKiBAX19QVVJFX18gKi8ganN4KEN1YmVJY29uLCB7fSk7XG4gIGlmIChvcHRpb24udHlwZSA9PT0gXCJzdHJpbmdcIilcbiAgICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeChTdHJpbmdJY29uLCB7fSk7XG4gIGlmIChvcHRpb24udHlwZSA9PT0gXCJudW1iZXJcIilcbiAgICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeChOdW1iZXJJY29uLCB7fSk7XG4gIGNvbnN0IHtcbiAgICB2YWx1ZTogbm9kZVxuICB9ID0gb3B0aW9uO1xuICBpZiAoXCJpY29uXCIgaW4gb3B0aW9uICYmIG9wdGlvbi5pY29uKVxuICAgIHJldHVybiAvKiBAX19QVVJFX18gKi8ganN4KFwiZGl2XCIsIHsgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw6IHtcbiAgICAgIF9faHRtbDogb3B0aW9uLmljb25cbiAgICB9IH0pO1xuICBjb25zdCB7XG4gICAgdHlwZVxuICB9ID0gbm9kZTtcbiAgaWYgKHR5cGUgPT09IFwic3RyaW5nXCIpXG4gICAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3goU3RyaW5nSWNvbiwge30pO1xuICBpZiAodHlwZSA9PT0gXCJib29sZWFuXCIpXG4gICAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3goQ2hlY2ttYXJrQ2lyY2xlSWNvbiwge30pO1xuICBpZiAodHlwZSA9PT0gXCJudW1iZXJcIilcbiAgICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeChOdW1iZXJJY29uLCB7fSk7XG4gIGlmICh0eXBlID09PSBcImFycmF5XCIgfHwgdHlwZSA9PT0gXCJ1bmlvblwiKVxuICAgIHJldHVybiAoQXJyYXkuaXNBcnJheShub2RlLm9mKSA/IG5vZGUub2YgOiBbbm9kZS5vZl0pLnNvbWUoKG4pID0+IFwibmFtZVwiIGluIG4gJiYgbi5uYW1lID09PSBcImJsb2NrXCIpID8gLyogQF9fUFVSRV9fICovIGpzeChCbG9ja0NvbnRlbnRJY29uLCB7fSkgOiAvKiBAX19QVVJFX18gKi8ganN4KFRoTGlzdEljb24sIHt9KTtcbiAgaWYgKHR5cGUgPT09IFwib2JqZWN0XCIpIHtcbiAgICBpZiAob3B0aW9uLm5hbWUgPT09IFwiaW1hZ2VcIilcbiAgICAgIHJldHVybiAvKiBAX19QVVJFX18gKi8ganN4KEltYWdlSWNvbiwge30pO1xuICAgIGlmIChvcHRpb24ubmFtZSA9PT0gXCJibG9ja1wiKVxuICAgICAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3goU3RyaW5nSWNvbiwge30pO1xuICB9XG4gIHJldHVybiAvKiBAX19QVVJFX18gKi8ganN4KEN1YmVJY29uLCB7fSk7XG59XG5jb25zdCBQb3J0YWxDb250YWluZXIgPSBzdHlsZWQuZGl2YFxuICBoZWlnaHQ6IDEwMCU7XG4gIGluc2V0OiAwO1xuICBvdmVyZmxvdy15OiBzY3JvbGw7XG4gIG92ZXJzY3JvbGwtYmVoYXZpb3I6IGNvbnRhaW47XG4gIHBvaW50ZXItZXZlbnRzOiBhbGw7XG4gIHBvc2l0aW9uOiBmaXhlZDtcbiAgd2lkdGg6IDEwMCU7XG4gIC1tcy1vdmVyZmxvdy1zdHlsZTogbm9uZTtcbiAgc2Nyb2xsYmFyLXdpZHRoOiBub25lO1xuICBkaXNwbGF5OiBmbGV4O1xuICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgJjpiZWZvcmUge1xuICAgIGNvbnRlbnQ6ICcnO1xuICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgIGhlaWdodDogY2FsYygxMDAlICsgMXB4KTtcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgdG9wOiAwO1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIHotaW5kZXg6IC0xO1xuICB9XG5gLCBQb3J0YWxCYWNrZ3JvdW5kID0gc3R5bGVkLmRpdmBcbiAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7XG4gIGhlaWdodDogMTAwJTtcbiAgaW5zZXQ6IDA7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgd2lkdGg6IDEwMCU7XG5gLCBQb3BvdmVyUG9ydGFsID0gKHByb3BzKSA9PiB7XG4gIGNvbnN0ICQgPSBjKDYpLCB7XG4gICAgY2hpbGRyZW4sXG4gICAgb25EaXNtaXNzLFxuICAgIHNldEJvdW5kYXJ5RWxlbWVudFxuICB9ID0gcHJvcHMsIGhhbmRsZUNsaWNrID0gX3RlbXAkMTtcbiAgbGV0IHQwO1xuICAkWzBdICE9PSBvbkRpc21pc3MgPyAodDAgPSAvKiBAX19QVVJFX18gKi8ganN4KFBvcnRhbEJhY2tncm91bmQsIHsgb25DbGlja0NhcHR1cmU6IG9uRGlzbWlzcyB9KSwgJFswXSA9IG9uRGlzbWlzcywgJFsxXSA9IHQwKSA6IHQwID0gJFsxXTtcbiAgbGV0IHQxO1xuICByZXR1cm4gJFsyXSAhPT0gY2hpbGRyZW4gfHwgJFszXSAhPT0gc2V0Qm91bmRhcnlFbGVtZW50IHx8ICRbNF0gIT09IHQwID8gKHQxID0gLyogQF9fUFVSRV9fICovIGpzeChQb3J0YWwsIHsgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3hzKFBvcnRhbENvbnRhaW5lciwgeyBcImRhdGEtc2FuaXR5LW92ZXJsYXktZWxlbWVudFwiOiAhMCwgcmVmOiBzZXRCb3VuZGFyeUVsZW1lbnQsIG9uQ2xpY2s6IGhhbmRsZUNsaWNrLCBjaGlsZHJlbjogW1xuICAgIHQwLFxuICAgIGNoaWxkcmVuXG4gIF0gfSkgfSksICRbMl0gPSBjaGlsZHJlbiwgJFszXSA9IHNldEJvdW5kYXJ5RWxlbWVudCwgJFs0XSA9IHQwLCAkWzVdID0gdDEpIDogdDEgPSAkWzVdLCB0MTtcbn07XG5mdW5jdGlvbiBfdGVtcCQxKGV2ZW50KSB7XG4gIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xufVxuZnVuY3Rpb24gZGVmaW5lRXZlbnQob3B0aW9ucykge1xuICByZXR1cm4ge1xuICAgIHR5cGU6IFwibG9nXCIsXG4gICAgbmFtZTogb3B0aW9ucy5uYW1lLFxuICAgIHZlcnNpb246IG9wdGlvbnMudmVyc2lvbixcbiAgICBkZXNjcmlwdGlvbjogb3B0aW9ucy5kZXNjcmlwdGlvbixcbiAgICBtYXhTYW1wbGVSYXRlOiBvcHRpb25zLm1heFNhbXBsZVJhdGUsXG4gICAgc2NoZW1hOiB2b2lkIDBcbiAgfTtcbn1cbmNvbnN0IGV2ZW50cyA9IHtcbiAgXCJWaXN1YWwgRWRpdGluZyBEcmFnIFNlcXVlbmNlIENvbXBsZXRlZFwiOiBkZWZpbmVFdmVudCh7XG4gICAgbmFtZTogXCJWaXN1YWwgRWRpdGluZyBEcmFnIFNlcXVlbmNlIENvbXBsZXRlZFwiLFxuICAgIGRlc2NyaXB0aW9uOiBcIkFuIGFycmF5IGlzIHN1Y2Nlc3NmdWxseSByZW9yZGVyZWQgdXNpbmcgZHJhZyBhbmQgZHJvcC5cIixcbiAgICB2ZXJzaW9uOiAxXG4gIH0pLFxuICBcIlZpc3VhbCBFZGl0aW5nIERyYWcgTWluaW1hcCBFbmFibGVkXCI6IGRlZmluZUV2ZW50KHtcbiAgICBuYW1lOiBcIlZpc3VhbCBFZGl0aW5nIERyYWcgTWluaW1hcCBFbmFibGVkXCIsXG4gICAgZGVzY3JpcHRpb246IFwiVGhlIHpvb21lZC1vdXQgbWluaW1hcCB2aWV3IGlzIGVuYWJsZWQgZHVyaW5nIGEgZHJhZyBzZXF1ZW5jZS5cIixcbiAgICB2ZXJzaW9uOiAxXG4gIH0pLFxuICBcIlZpc3VhbCBFZGl0aW5nIENvbnRleHQgTWVudSBJdGVtIFJlbW92ZWRcIjogZGVmaW5lRXZlbnQoe1xuICAgIG5hbWU6IFwiVmlzdWFsIEVkaXRpbmcgQ29udGV4dCBNZW51IEl0ZW0gUmVtb3ZlZFwiLFxuICAgIGRlc2NyaXB0aW9uOiBcIkFuIGl0ZW0gaXMgcmVtb3ZlZCB1c2luZyB0aGUgQ29udGV4dCBNZW51LlwiLFxuICAgIHZlcnNpb246IDFcbiAgfSksXG4gIFwiVmlzdWFsIEVkaXRpbmcgQ29udGV4dCBNZW51IEl0ZW0gRHVwbGljYXRlZFwiOiBkZWZpbmVFdmVudCh7XG4gICAgbmFtZTogXCJWaXN1YWwgRWRpdGluZyBDb250ZXh0IE1lbnUgSXRlbSBEdXBsaWNhdGVkXCIsXG4gICAgZGVzY3JpcHRpb246IFwiQW4gaXRlbSBpcyBkdXBsaWNhdGVkIHVzaW5nIHRoZSBDb250ZXh0IE1lbnUuXCIsXG4gICAgdmVyc2lvbjogMVxuICB9KSxcbiAgXCJWaXN1YWwgRWRpdGluZyBDb250ZXh0IE1lbnUgSXRlbSBNb3ZlZFwiOiBkZWZpbmVFdmVudCh7XG4gICAgbmFtZTogXCJWaXN1YWwgRWRpdGluZyBDb250ZXh0IE1lbnUgSXRlbSBNb3ZlZFwiLFxuICAgIGRlc2NyaXB0aW9uOiBcIkFuIGl0ZW0gaXMgbW92ZWQgdXNpbmcgdGhlIENvbnRleHQgTWVudS5cIixcbiAgICB2ZXJzaW9uOiAxXG4gIH0pLFxuICBcIlZpc3VhbCBFZGl0aW5nIENvbnRleHQgTWVudSBJdGVtIEluc2VydGVkXCI6IGRlZmluZUV2ZW50KHtcbiAgICBuYW1lOiBcIlZpc3VhbCBFZGl0aW5nIENvbnRleHQgTWVudSBJdGVtIEluc2VydGVkXCIsXG4gICAgZGVzY3JpcHRpb246IFwiQW4gaXRlbSBpcyBpbnNlcnRlZCB1c2luZyB0aGUgQ29udGV4dCBNZW51LlwiLFxuICAgIHZlcnNpb246IDFcbiAgfSksXG4gIFwiVmlzdWFsIEVkaXRpbmcgSW5zZXJ0IE1lbnUgSXRlbSBJbnNlcnRlZFwiOiBkZWZpbmVFdmVudCh7XG4gICAgbmFtZTogXCJWaXN1YWwgRWRpdGluZyBJbnNlcnQgTWVudSBJdGVtIEluc2VydGVkXCIsXG4gICAgZGVzY3JpcHRpb246IFwiQW4gaXRlbSBpcyBpbnNlcnRlZCB1c2luZyB0aGUgSW5zZXJ0IE1lbnUuXCIsXG4gICAgdmVyc2lvbjogMVxuICB9KSxcbiAgXCJWaXN1YWwgRWRpdGluZyBPdmVybGF5IENsaWNrZWRcIjogZGVmaW5lRXZlbnQoe1xuICAgIG5hbWU6IFwiVmlzdWFsIEVkaXRpbmcgT3ZlcmxheSBDbGlja2VkXCIsXG4gICAgZGVzY3JpcHRpb246IFwiQW4gT3ZlcmxheSBpcyBjbGlja2VkLlwiLFxuICAgIHZlcnNpb246IDFcbiAgfSlcbn0sIFRlbGVtZXRyeUNvbnRleHQgPSBjcmVhdGVDb250ZXh0KHZvaWQgMCk7XG5mdW5jdGlvbiB1c2VUZWxlbWV0cnkoKSB7XG4gIGNvbnN0IGNvbnRleHQgPSB1c2VDb250ZXh0KFRlbGVtZXRyeUNvbnRleHQpO1xuICBpZiAoIWNvbnRleHQpXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiVGVsZW1ldHJ5IGNvbnRleHQgaXMgbWlzc2luZ1wiKTtcbiAgcmV0dXJuIGNvbnRleHQ7XG59XG5jb25zdCBsYWJlbHMgPSB7XG4gIFwiaW5zZXJ0LW1lbnUuZmlsdGVyLmFsbC1pdGVtc1wiOiBcIkFsbFwiLFxuICBcImluc2VydC1tZW51LnNlYXJjaC5uby1yZXN1bHRzXCI6IFwiTm8gcmVzdWx0c1wiLFxuICBcImluc2VydC1tZW51LnNlYXJjaC5wbGFjZWhvbGRlclwiOiBcIkZpbHRlciB0eXBlc1xcdTIwMjZcIixcbiAgXCJpbnNlcnQtbWVudS50b2dnbGUtZ3JpZC12aWV3LnRvb2x0aXBcIjogXCJUb2dnbGUgZ3JpZCB2aWV3XCIsXG4gIFwiaW5zZXJ0LW1lbnUudG9nZ2xlLWxpc3Qtdmlldy50b29sdGlwXCI6IFwiVG9nZ2xlIGxpc3Qgdmlld1wiXG59LCBJbnNlcnRNZW51ID0gKHByb3BzKSA9PiB7XG4gIGNvbnN0ICQgPSBjKDExKSwge1xuICAgIG5vZGUsXG4gICAgb25TZWxlY3RcbiAgfSA9IHByb3BzO1xuICBsZXQgdDA7XG4gICRbMF0gIT09IG5vZGUub3B0aW9ucz8uaW5zZXJ0TWVudSA/ICh0MCA9IG5vZGUub3B0aW9ucz8uaW5zZXJ0TWVudSB8fCB7fSwgJFswXSA9IG5vZGUub3B0aW9ucz8uaW5zZXJ0TWVudSwgJFsxXSA9IHQwKSA6IHQwID0gJFsxXTtcbiAgY29uc3QgaW5zZXJ0TWVudU9wdGlvbnMgPSB0MDtcbiAgbGV0IHQxO1xuICAkWzJdICE9PSBpbnNlcnRNZW51T3B0aW9ucy52aWV3cyA/ICh0MSA9IGluc2VydE1lbnVPcHRpb25zLnZpZXdzPy5tYXAoX3RlbXApLCAkWzJdID0gaW5zZXJ0TWVudU9wdGlvbnMudmlld3MsICRbM10gPSB0MSkgOiB0MSA9ICRbM107XG4gIGNvbnN0IHZpZXdzID0gdDE7XG4gIGxldCB0MjtcbiAgJFs0XSAhPT0gbm9kZS5vZiA/ICh0MiA9IG5vZGUub2YubWFwKF90ZW1wMiksICRbNF0gPSBub2RlLm9mLCAkWzVdID0gdDIpIDogdDIgPSAkWzVdO1xuICBsZXQgdDM7XG4gIHJldHVybiAkWzZdICE9PSBpbnNlcnRNZW51T3B0aW9ucyB8fCAkWzddICE9PSBvblNlbGVjdCB8fCAkWzhdICE9PSB0MiB8fCAkWzldICE9PSB2aWV3cyA/ICh0MyA9IC8qIEBfX1BVUkVfXyAqLyBqc3goSW5zZXJ0TWVudSQxLCB7IC4uLmluc2VydE1lbnVPcHRpb25zLCBsYWJlbHMsIHNjaGVtYVR5cGVzOiB0Miwgb25TZWxlY3QsIHZpZXdzIH0pLCAkWzZdID0gaW5zZXJ0TWVudU9wdGlvbnMsICRbN10gPSBvblNlbGVjdCwgJFs4XSA9IHQyLCAkWzldID0gdmlld3MsICRbMTBdID0gdDMpIDogdDMgPSAkWzEwXSwgdDM7XG59LCBJbnNlcnRNZW51UG9wb3ZlciA9IChwcm9wcykgPT4ge1xuICBjb25zdCAkID0gYygxMSksIHtcbiAgICBub2RlLFxuICAgIG9uRGlzbWlzcyxcbiAgICBvblNlbGVjdCxcbiAgICByZWZlcmVuY2VFbGVtZW50XG4gIH0gPSBwcm9wcztcbiAgbGV0IHQwO1xuICAkWzBdICE9PSBub2RlIHx8ICRbMV0gIT09IG9uU2VsZWN0ID8gKHQwID0gLyogQF9fUFVSRV9fICovIGpzeChJbnNlcnRNZW51LCB7IG5vZGUsIG9uU2VsZWN0IH0pLCAkWzBdID0gbm9kZSwgJFsxXSA9IG9uU2VsZWN0LCAkWzJdID0gdDApIDogdDAgPSAkWzJdO1xuICBjb25zdCBwb3BvdmVyQ29udGVudCA9IHQwLCB3aWR0aCA9IChub2RlLm9wdGlvbnM/Lmluc2VydE1lbnUgfHwge30pLnZpZXdzPy5zb21lKF90ZW1wMykgPyAwIDogdm9pZCAwO1xuICBsZXQgdDE7XG4gICRbM10gPT09IFN5bWJvbC5mb3IoXCJyZWFjdC5tZW1vX2NhY2hlX3NlbnRpbmVsXCIpID8gKHQxID0gW1wiYm90dG9tXCJdLCAkWzNdID0gdDEpIDogdDEgPSAkWzNdO1xuICBsZXQgdDI7XG4gICRbNF0gIT09IHBvcG92ZXJDb250ZW50IHx8ICRbNV0gIT09IHJlZmVyZW5jZUVsZW1lbnQgfHwgJFs2XSAhPT0gd2lkdGggPyAodDIgPSAvKiBAX19QVVJFX18gKi8ganN4KFBvcG92ZXIsIHsgYW5pbWF0ZTogITAsIGNvbnN0cmFpblNpemU6ICEwLCBjb250ZW50OiBwb3BvdmVyQ29udGVudCwgZmFsbGJhY2tQbGFjZW1lbnRzOiB0MSwgb3BlbjogITAsIHBsYWNlbWVudDogXCJ0b3BcIiwgcHJldmVudE92ZXJmbG93OiAhMCwgcmVmZXJlbmNlRWxlbWVudCwgd2lkdGggfSksICRbNF0gPSBwb3BvdmVyQ29udGVudCwgJFs1XSA9IHJlZmVyZW5jZUVsZW1lbnQsICRbNl0gPSB3aWR0aCwgJFs3XSA9IHQyKSA6IHQyID0gJFs3XTtcbiAgbGV0IHQzO1xuICByZXR1cm4gJFs4XSAhPT0gb25EaXNtaXNzIHx8ICRbOV0gIT09IHQyID8gKHQzID0gLyogQF9fUFVSRV9fICovIGpzeChQb3BvdmVyUG9ydGFsLCB7IG9uRGlzbWlzcywgY2hpbGRyZW46IHQyIH0pLCAkWzhdID0gb25EaXNtaXNzLCAkWzldID0gdDIsICRbMTBdID0gdDMpIDogdDMgPSAkWzEwXSwgdDM7XG59O1xuZnVuY3Rpb24gX3RlbXAodmlldykge1xuICByZXR1cm4gdmlldy5uYW1lID09PSBcImdyaWRcIiA/IHtcbiAgICAuLi52aWV3LFxuICAgIHByZXZpZXdJbWFnZVVybDogKG5hbWUpID0+IHZpZXcucHJldmlld0ltYWdlVXJscz8uW25hbWVdXG4gIH0gOiB2aWV3O1xufVxuZnVuY3Rpb24gX3RlbXAyKHR5cGUpIHtcbiAgcmV0dXJuIHtcbiAgICAuLi50eXBlLFxuICAgIGljb246IGdldE5vZGVJY29uKHR5cGUpXG4gIH07XG59XG5mdW5jdGlvbiBfdGVtcDModmlldykge1xuICByZXR1cm4gdmlldy5uYW1lID09PSBcImdyaWRcIjtcbn1cbmNvbnN0IFBvaW50ZXJFdmVudHMgPSAodDApID0+IHtcbiAgY29uc3QgJCA9IGMoMTApO1xuICBsZXQgY2hpbGRyZW4sIHJlc3QsIHN0eWxlO1xuICAkWzBdICE9PSB0MCA/ICh7XG4gICAgY2hpbGRyZW4sXG4gICAgc3R5bGUsXG4gICAgLi4ucmVzdFxuICB9ID0gdDAsICRbMF0gPSB0MCwgJFsxXSA9IGNoaWxkcmVuLCAkWzJdID0gcmVzdCwgJFszXSA9IHN0eWxlKSA6IChjaGlsZHJlbiA9ICRbMV0sIHJlc3QgPSAkWzJdLCBzdHlsZSA9ICRbM10pO1xuICBsZXQgdDE7XG4gICRbNF0gIT09IHN0eWxlID8gKHQxID0ge1xuICAgIC4uLnN0eWxlLFxuICAgIHBvaW50ZXJFdmVudHM6IFwiYWxsXCJcbiAgfSwgJFs0XSA9IHN0eWxlLCAkWzVdID0gdDEpIDogdDEgPSAkWzVdO1xuICBsZXQgdDI7XG4gIHJldHVybiAkWzZdICE9PSBjaGlsZHJlbiB8fCAkWzddICE9PSByZXN0IHx8ICRbOF0gIT09IHQxID8gKHQyID0gLyogQF9fUFVSRV9fICovIGpzeChcImRpdlwiLCB7IHN0eWxlOiB0MSwgXCJkYXRhLXNhbml0eS1vdmVybGF5LWVsZW1lbnRcIjogITAsIC4uLnJlc3QsIGNoaWxkcmVuIH0pLCAkWzZdID0gY2hpbGRyZW4sICRbN10gPSByZXN0LCAkWzhdID0gdDEsICRbOV0gPSB0MikgOiB0MiA9ICRbOV0sIHQyO1xufTtcbmV4cG9ydCB7XG4gIEluc2VydE1lbnUsXG4gIEluc2VydE1lbnVQb3BvdmVyLFxuICBQb2ludGVyRXZlbnRzLFxuICBQb3BvdmVyUG9ydGFsLFxuICBUZWxlbWV0cnlDb250ZXh0LFxuICBldmVudHMsXG4gIGdldE5vZGVJY29uLFxuICB1c2VUZWxlbWV0cnlcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1Qb2ludGVyRXZlbnRzLmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/_chunks-es/PointerEvents.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/_chunks-es/SharedStateContext.js":
/*!*******************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/_chunks-es/SharedStateContext.js ***!
  \*******************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SharedStateContext: () => (/* binding */ SharedStateContext),\n/* harmony export */   createOverlayController: () => (/* binding */ createOverlayController),\n/* harmony export */   sanityNodesExistInSameArray: () => (/* binding */ sanityNodesExistInSameArray),\n/* harmony export */   useOptimistic: () => (/* binding */ useOptimistic)\n/* harmony export */ });\n/* harmony import */ var react_compiler_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react-compiler-runtime */ \"(ssr)/./node_modules/.pnpm/react-compiler-runtime@19.0.0-beta-e993439-20250328_react@19.1.0/node_modules/react-compiler-runtime/dist/index.js\");\n/* harmony import */ var _sanity_client_csm__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sanity/client/csm */ \"(ssr)/./node_modules/.pnpm/@sanity+client@6.28.4_debug@4.4.0/node_modules/@sanity/client/dist/_chunks-es/resolveEditInfo.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/.pnpm/next@15.2.4_@babel+core@7.26.10_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var use_effect_event__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! use-effect-event */ \"(ssr)/./node_modules/.pnpm/use-effect-event@1.0.2_react@19.1.0/node_modules/use-effect-event/dist/index.js\");\n/* harmony import */ var _context_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./context.js */ \"(ssr)/./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/_chunks-es/context.js\");\n/* harmony import */ var _mutations_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./mutations.js */ \"(ssr)/./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/_chunks-es/mutations.js\");\n/* harmony import */ var _sanity_visual_editing_csm__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @sanity/visual-editing-csm */ \"(ssr)/./node_modules/.pnpm/@sanity+visual-editing-csm@2.0.11_@sanity+client@6.28.4_@sanity+types@3.83.0_@types+react@19.1.0_/node_modules/@sanity/visual-editing-csm/dist/index.js\");\n/* harmony import */ var _vercel_stega__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @vercel/stega */ \"(ssr)/./node_modules/.pnpm/@vercel+stega@0.1.2/node_modules/@vercel/stega/dist/index.mjs\");\n\n\n\n\n\n\n\n\nfunction useOptimistic(passthrough, reducer) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_0__.c)(21), [pristine, setPristine] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!0), [optimistic, setOptimistic] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(passthrough), [lastEvent, setLastEvent] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null), [lastPassthrough, setLastPassthrough] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(passthrough), actor = (0,_mutations_js__WEBPACK_IMPORTED_MODULE_3__.useOptimisticActor)();\n  let t0;\n  $[0] !== reducer ? (t0 = (action, prevState) => (Array.isArray(reducer) ? reducer : [reducer]).reduce((acc, reducer_0) => reducer_0(acc, {\n    document: action.document,\n    id: (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_4__.getPublishedId)(action.id),\n    originalId: action.id,\n    type: action.type\n  }), prevState), $[0] = reducer, $[1] = t0) : t0 = $[1];\n  const reduceStateFromAction = (0,use_effect_event__WEBPACK_IMPORTED_MODULE_5__.useEffectEvent)(t0);\n  let t1;\n  $[2] !== passthrough ? (t1 = () => setLastPassthrough(passthrough), $[2] = passthrough, $[3] = t1) : t1 = $[3];\n  const updateLastPassthrough = (0,use_effect_event__WEBPACK_IMPORTED_MODULE_5__.useEffectEvent)(t1);\n  let t2;\n  $[4] !== actor || $[5] !== reduceStateFromAction || $[6] !== updateLastPassthrough ? (t2 = () => {\n    if ((0,_context_js__WEBPACK_IMPORTED_MODULE_6__.isEmptyActor)(actor))\n      return;\n    let pristineTimeout;\n    const rebasedSub = actor.on(\"rebased.local\", (_event) => {\n      const event = {\n        document: _event.document,\n        id: _event.id,\n        originalId: (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_4__.getPublishedId)(_event.id),\n        type: \"mutate\"\n      };\n      setOptimistic((prevState_0) => reduceStateFromAction(event, prevState_0)), setLastEvent(event), updateLastPassthrough(), setPristine(!1), clearTimeout(pristineTimeout);\n    }), pristineSub = actor.on(\"pristine\", () => {\n      pristineTimeout = setTimeout(() => {\n        (0,react__WEBPACK_IMPORTED_MODULE_1__.startTransition)(() => setPristine(!0));\n      }, 15e3);\n    });\n    return () => {\n      rebasedSub.unsubscribe(), pristineSub.unsubscribe();\n    };\n  }, $[4] = actor, $[5] = reduceStateFromAction, $[6] = updateLastPassthrough, $[7] = t2) : t2 = $[7];\n  let t3;\n  $[8] !== actor ? (t3 = [actor], $[8] = actor, $[9] = t3) : t3 = $[9], (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(t2, t3);\n  let t4;\n  $[10] !== lastEvent || $[11] !== lastPassthrough || $[12] !== passthrough || $[13] !== pristine || $[14] !== reduceStateFromAction ? (t4 = () => {\n    if (!pristine) {\n      if (!lastEvent)\n        throw new Error(\"No last event found when syncing passthrough\");\n      lastPassthrough !== passthrough && (0,react__WEBPACK_IMPORTED_MODULE_1__.startTransition)(() => {\n        setOptimistic(reduceStateFromAction(lastEvent, passthrough)), setLastPassthrough(passthrough);\n      });\n    }\n  }, $[10] = lastEvent, $[11] = lastPassthrough, $[12] = passthrough, $[13] = pristine, $[14] = reduceStateFromAction, $[15] = t4) : t4 = $[15];\n  let t5;\n  return $[16] !== lastEvent || $[17] !== lastPassthrough || $[18] !== passthrough || $[19] !== pristine ? (t5 = [lastEvent, lastPassthrough, passthrough, pristine], $[16] = lastEvent, $[17] = lastPassthrough, $[18] = passthrough, $[19] = pristine, $[20] = t5) : t5 = $[20], (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(t4, t5), pristine ? passthrough : optimistic;\n}\nconst byteToHex = [];\nfor (let i = 0; i < 256; ++i)\n  byteToHex.push((i + 256).toString(16).slice(1));\nfunction unsafeStringify(arr, offset = 0) {\n  return (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + \"-\" + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + \"-\" + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + \"-\" + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + \"-\" + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase();\n}\nlet getRandomValues;\nconst rnds8 = new Uint8Array(16);\nfunction rng() {\n  if (!getRandomValues) {\n    if (typeof crypto > \"u\" || !crypto.getRandomValues)\n      throw new Error(\"crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported\");\n    getRandomValues = crypto.getRandomValues.bind(crypto);\n  }\n  return getRandomValues(rnds8);\n}\nconst randomUUID = typeof crypto < \"u\" && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nvar native = {\n  randomUUID\n};\nfunction v4(options, buf, offset) {\n  if (native.randomUUID && !options)\n    return native.randomUUID();\n  options = options || {};\n  const rnds = options.random ?? options.rng?.() ?? rng();\n  if (rnds.length < 16)\n    throw new Error(\"Random bytes length must be >= 16\");\n  return rnds[6] = rnds[6] & 15 | 64, rnds[8] = rnds[8] & 63 | 128, unsafeStringify(rnds);\n}\nfunction getRect(element) {\n  const domRect = element.getBoundingClientRect();\n  return {\n    x: domRect.x + scrollX,\n    y: domRect.y + scrollY,\n    w: domRect.width,\n    h: domRect.height\n  };\n}\nfunction offsetRect(rect, px, axis) {\n  return axis === \"x\" ? {\n    x: rect.x + px,\n    y: rect.y,\n    w: rect.w - 2 * px,\n    h: rect.h\n  } : {\n    x: rect.x,\n    y: rect.y + px,\n    w: rect.w,\n    h: rect.h - 2 * px\n  };\n}\nfunction rayIntersect(l1, l2) {\n  const {\n    x1,\n    y1,\n    x2,\n    y2\n  } = l1, {\n    x1: x3,\n    y1: y3,\n    x2: x4,\n    y2: y4\n  } = l2;\n  if (x1 === x2 && y1 === y2 || x3 === x4 && y3 === y4)\n    return !1;\n  const denominator = (y4 - y3) * (x2 - x1) - (x4 - x3) * (y2 - y1);\n  if (denominator === 0)\n    return !1;\n  const ua = ((x4 - x3) * (y1 - y3) - (y4 - y3) * (x1 - x3)) / denominator, ub = ((x2 - x1) * (y1 - y3) - (y2 - y1) * (x1 - x3)) / denominator;\n  if (ua < 0 || ua > 1 || ub < 0 || ub > 1)\n    return !1;\n  const x = x1 + ua * (x2 - x1), y = y1 + ua * (y2 - y1);\n  return {\n    x,\n    y\n  };\n}\nfunction rectEqual(r1, r2) {\n  return r1.x === r2.x && r1.y === r2.y && r1.w === r2.w && r1.h === r2.h;\n}\nfunction rayRectIntersections(line, rect) {\n  const rectLines = [{\n    x1: rect.x,\n    y1: rect.y,\n    x2: rect.x + rect.w,\n    y2: rect.y\n  }, {\n    x1: rect.x + rect.w,\n    y1: rect.y,\n    x2: rect.x + rect.w,\n    y2: rect.y + rect.h\n  }, {\n    x1: rect.x + rect.w,\n    y1: rect.y + rect.h,\n    x2: rect.x,\n    y2: rect.y + rect.h\n  }, {\n    x1: rect.x,\n    y1: rect.y + rect.h,\n    x2: rect.x,\n    y2: rect.y\n  }], intersections = [];\n  for (let i = 0; i < rectLines.length; i++) {\n    const intersection = rayIntersect(line, rectLines[i]);\n    if (intersection) {\n      let isDuplicate = !1;\n      for (let j = 0; j < intersections.length; j++)\n        intersections[j].x === intersection.x && intersections[j].y === intersection.y && (isDuplicate = !0);\n      isDuplicate || intersections.push(intersection);\n    }\n  }\n  return intersections.length === 0 ? !1 : intersections.sort((a, b) => pointDist(a, {\n    x: line.x1,\n    y: line.y1\n  }) - pointDist(b, {\n    x: line.x1,\n    y: line.y1\n  }));\n}\nfunction pointDist(p1, p2) {\n  const a = p1.x - p2.x, b = p1.y - p2.y;\n  return Math.sqrt(a * a + b * b);\n}\nfunction pointInBounds(point, bounds) {\n  const withinX = point.x >= bounds.x && point.x <= bounds.x + bounds.w, withinY = point.y >= bounds.y && point.y <= bounds.y + bounds.h;\n  return withinX && withinY;\n}\nfunction findClosestIntersection(ray, targets, flow) {\n  const rayOrigin = {\n    x: ray.x1,\n    y: ray.y1\n  };\n  if (targets.some((t) => pointInBounds(rayOrigin, offsetRect(t, Math.min(t.w, t.h) / 10, flow === \"horizontal\" ? \"x\" : \"y\")))) return null;\n  let closestIntersection, closestRect;\n  for (const target of targets) {\n    const intersections = rayRectIntersections(ray, offsetRect(target, Math.min(target.w, target.h) / 10, flow === \"horizontal\" ? \"x\" : \"y\"));\n    if (intersections) {\n      const firstIntersection = intersections[0];\n      closestIntersection ? pointDist(rayOrigin, firstIntersection) < pointDist(rayOrigin, closestIntersection) && (closestIntersection = firstIntersection, closestRect = target) : (closestIntersection = firstIntersection, closestRect = target);\n    }\n  }\n  return closestRect || null;\n}\nfunction scaleRect(rect, scale, origin) {\n  const {\n    x,\n    y,\n    w,\n    h\n  } = rect, {\n    x: originX,\n    y: originY\n  } = origin, newX = originX + (x - originX) * scale, newY = originY + (y - originY) * scale, newWidth = w * scale, newHeight = h * scale;\n  return {\n    x: newX,\n    y: newY,\n    w: newWidth,\n    h: newHeight\n  };\n}\nfunction getRectGroupXExtent(rects) {\n  const minGroupX = Math.max(0, Math.min(...rects.map((r) => r.x))), maxGroupX = Math.min(document.body.offsetWidth, Math.max(...rects.map((r) => r.x + r.w)));\n  return {\n    min: minGroupX,\n    max: maxGroupX,\n    width: maxGroupX - minGroupX\n  };\n}\nfunction getRectGroupYExtent(rects) {\n  const minGroupY = Math.max(0, Math.min(...rects.map((r) => r.y))), maxGroupY = Math.min(document.body.scrollHeight, Math.max(...rects.map((r) => r.y + r.h)));\n  return {\n    min: minGroupY,\n    max: maxGroupY,\n    height: maxGroupY - minGroupY\n  };\n}\nfunction calcTargetFlow(targets) {\n  return targets.some((t1) => targets.filter((t2) => !rectEqual(t1, t2)).some((t2) => t1.y === t2.y)) ? \"horizontal\" : \"vertical\";\n}\nfunction calcInsertPosition(origin, targets, flow) {\n  if (flow === \"horizontal\") {\n    const rayLeft = {\n      x1: origin.x,\n      y1: origin.y,\n      x2: origin.x - 1e8,\n      y2: origin.y\n    }, rayRight = {\n      x1: origin.x,\n      y1: origin.y,\n      x2: origin.x + 1e8,\n      y2: origin.y\n    };\n    return {\n      left: findClosestIntersection(rayLeft, targets, flow),\n      right: findClosestIntersection(rayRight, targets, flow)\n    };\n  } else {\n    const rayTop = {\n      x1: origin.x,\n      y1: origin.y,\n      x2: origin.x,\n      y2: origin.y - 1e8\n    }, rayBottom = {\n      x1: origin.x,\n      y1: origin.y,\n      x2: origin.x,\n      y2: origin.y + 1e8\n    };\n    return {\n      top: findClosestIntersection(rayTop, targets, flow),\n      bottom: findClosestIntersection(rayBottom, targets, flow)\n    };\n  }\n}\nfunction findRectSanityData(rect, overlayGroup) {\n  return overlayGroup.find((e) => rectEqual(getRect(e.elements.element), rect))?.sanity;\n}\nfunction resolveInsertPosition(overlayGroup, insertPosition, flow) {\n  return Object.values(insertPosition).every((v) => v === null) ? null : flow === \"horizontal\" ? {\n    left: insertPosition.left ? {\n      rect: insertPosition.left,\n      sanity: findRectSanityData(insertPosition.left, overlayGroup)\n    } : null,\n    right: insertPosition.right ? {\n      rect: insertPosition.right,\n      sanity: findRectSanityData(insertPosition.right, overlayGroup)\n    } : null\n  } : {\n    top: insertPosition.top ? {\n      rect: insertPosition.top,\n      sanity: findRectSanityData(insertPosition.top, overlayGroup)\n    } : null,\n    bottom: insertPosition.bottom ? {\n      rect: insertPosition.bottom,\n      sanity: findRectSanityData(insertPosition.bottom, overlayGroup)\n    } : null\n  };\n}\nfunction calcMousePos(e) {\n  const bodyBounds = document.body.getBoundingClientRect();\n  return {\n    x: Math.max(bodyBounds.x, Math.min(e.clientX, bodyBounds.x + bodyBounds.width)),\n    y: e.clientY + window.scrollY\n  };\n}\nfunction calcMousePosInverseTransform(mousePos2) {\n  const body = document.body, transform = window.getComputedStyle(body).transform;\n  if (transform === \"none\")\n    return {\n      x: mousePos2.x,\n      y: mousePos2.y\n    };\n  const inverseMatrix = new DOMMatrix(transform).inverse(), transformedPoint = new DOMPoint(mousePos2.x, mousePos2.y).matrixTransform(inverseMatrix);\n  return {\n    x: transformedPoint.x,\n    y: transformedPoint.y\n  };\n}\nfunction buildPreviewSkeleton(mousePos2, element, scaleFactor) {\n  const bounds = getRect(element), children = [...element.querySelectorAll(\":where(h1, h2, h3, h4, p, a, img, span, button):not(:has(*))\")];\n  mousePos2.x <= bounds.x && (mousePos2.x = bounds.x), mousePos2.x >= bounds.x + bounds.w && (mousePos2.x = bounds.x + bounds.w), mousePos2.y >= bounds.y + bounds.h && (mousePos2.y = bounds.y + bounds.h), mousePos2.y <= bounds.y && (mousePos2.y = bounds.y);\n  const childRects = children.map((child) => {\n    const rect = scaleRect(getRect(child), scaleFactor, {\n      x: bounds.x,\n      y: bounds.y\n    });\n    return {\n      x: rect.x - bounds.x,\n      y: rect.y - bounds.y,\n      w: rect.w,\n      h: rect.h,\n      tagName: child.tagName\n    };\n  });\n  return {\n    offsetX: (bounds.x - mousePos2.x) * scaleFactor,\n    offsetY: (bounds.y - mousePos2.y) * scaleFactor,\n    w: bounds.w * scaleFactor,\n    h: bounds.h * scaleFactor,\n    maxWidth: bounds.w * scaleFactor * 0.75,\n    childRects\n  };\n}\nconst minDragDelta = 4;\nasync function applyMinimapWrapperTransform(target, scaleFactor, minYScaled, handler, rectUpdateFrequency) {\n  return new Promise((resolve) => {\n    target.addEventListener(\"transitionend\", () => {\n      setTimeout(() => {\n        handler({\n          type: \"overlay/dragEndMinimapTransition\"\n        });\n      }, rectUpdateFrequency * 2), resolve();\n    }, {\n      once: !0\n    }), handler({\n      type: \"overlay/dragStartMinimapTransition\"\n    }), handler({\n      type: \"overlay/dragToggleMinimap\",\n      display: !0\n    }), document.body.style.overflow = \"hidden\", document.body.style.height = \"100%\", document.documentElement.style.overflow = \"initial\", document.documentElement.style.height = \"100%\", setTimeout(() => {\n      target.style.transformOrigin = \"50% 0px\", target.style.transition = \"transform 150ms ease\", target.style.transform = `translate3d(0px, ${-minYScaled + scrollY}px, 0px) scale(${scaleFactor})`;\n    }, 25);\n  });\n}\nfunction calcMinimapTransformValues(rects, groupHeightOverride) {\n  let groupHeight = groupHeightOverride || getRectGroupYExtent(rects).height;\n  const padding = 100;\n  groupHeight += padding * 2;\n  const scaleFactor = groupHeight > window.innerHeight ? window.innerHeight / groupHeight : 1, scaledRects = rects.map((r) => scaleRect(r, scaleFactor, {\n    x: window.innerWidth / 2,\n    y: 0\n  })), {\n    min: minYScaled\n  } = getRectGroupYExtent(scaledRects);\n  return {\n    scaleFactor,\n    minYScaled: minYScaled - padding * scaleFactor\n  };\n}\nfunction calcGroupBoundsPreview(rects) {\n  const groupBoundsX = getRectGroupXExtent(rects), groupBoundsY = getRectGroupYExtent(rects), offsetDist = 8, canOffsetX = groupBoundsX.min > offsetDist && groupBoundsX.min + groupBoundsX.width <= window.innerWidth - offsetDist, canOffsetY = groupBoundsY.min > offsetDist && groupBoundsY.min + groupBoundsY.height <= document.body.scrollHeight - offsetDist, canOffset = canOffsetX && canOffsetY;\n  return {\n    x: canOffset ? groupBoundsX.min - offsetDist : groupBoundsX.min,\n    y: canOffset ? groupBoundsY.min - offsetDist : groupBoundsY.min,\n    w: canOffset ? groupBoundsX.width + offsetDist * 2 : groupBoundsX.width,\n    h: canOffset ? groupBoundsY.height + offsetDist * 2 : groupBoundsY.height\n  };\n}\nasync function resetMinimapWrapperTransform(endYOrigin, target, prescaleHeight2, handler, rectUpdateFrequency, previousRootStyleValues2) {\n  return new Promise((resolve) => {\n    const transform = window.getComputedStyle(target).transform;\n    if (new DOMMatrix(transform).a === 1) return;\n    const maxScroll = prescaleHeight2 - window.innerHeight, prevScrollY = scrollY;\n    endYOrigin -= window.innerHeight / 2, endYOrigin < 0 && (endYOrigin = 0), target.addEventListener(\"transitionend\", () => {\n      target.style.transition = \"none\", target.style.transform = \"none\", scrollTo({\n        top: endYOrigin,\n        behavior: \"instant\"\n      }), setTimeout(() => {\n        handler({\n          type: \"overlay/dragEndMinimapTransition\"\n        }), handler({\n          type: \"overlay/dragToggleMinimap\",\n          display: !1\n        });\n      }, rectUpdateFrequency * 2), resolve();\n    }, {\n      once: !0\n    }), handler({\n      type: \"overlay/dragStartMinimapTransition\"\n    }), target.style.transform = `translateY(${Math.max(prevScrollY - endYOrigin, -maxScroll + prevScrollY)}px) scale(1)`, previousRootStyleValues2 && (document.body.style.overflow = previousRootStyleValues2.body.overflow, document.body.style.height = previousRootStyleValues2.body.height, document.documentElement.style.overflow = previousRootStyleValues2.documentElement.overflow, document.documentElement.style.height = previousRootStyleValues2.documentElement.height);\n  });\n}\nlet minimapScaleApplied = !1, mousePosInverseTransform = {\n  y: 0\n}, mousePos = {\n  x: 0,\n  y: 0\n}, prescaleHeight = typeof document > \"u\" ? 0 : document.documentElement.scrollHeight, previousRootStyleValues = null;\nfunction handleOverlayDrag(opts) {\n  const {\n    mouseEvent,\n    element,\n    overlayGroup,\n    handler,\n    target,\n    onSequenceStart,\n    onSequenceEnd\n  } = opts;\n  if (mouseEvent.button !== 0) return;\n  window.focus();\n  const rectUpdateFrequency = 150;\n  let rects = overlayGroup.map((e) => getRect(e.elements.element));\n  const flow = element.getAttribute(\"data-sanity-drag-flow\") || calcTargetFlow(rects), dragGroup = element.getAttribute(\"data-sanity-drag-group\"), disableMinimap = !!element.getAttribute(\"data-sanity-drag-minimap-disable\"), preventInsertDefault = !!element.getAttribute(\"data-sanity-drag-prevent-default\"), documentHeightOverride = element.getAttribute(\"data-unstable_sanity-drag-document-height\"), groupHeightOverride = element.getAttribute(\"data-unstable_sanity-drag-group-height\");\n  let insertPosition = null;\n  const initialMousePos = calcMousePos(mouseEvent), scaleTarget = document.body, {\n    minYScaled,\n    scaleFactor\n  } = calcMinimapTransformValues(rects, groupHeightOverride ? ~~groupHeightOverride : null);\n  let sequenceStarted = !1, minimapPromptShown = !1, mousedown = !0;\n  minimapScaleApplied || (previousRootStyleValues = {\n    body: {\n      overflow: window.getComputedStyle(document.body).overflow,\n      height: window.getComputedStyle(document.body).height\n    },\n    documentElement: {\n      overflow: window.getComputedStyle(document.documentElement).overflow,\n      height: window.getComputedStyle(document.documentElement).height\n    }\n  }, prescaleHeight = documentHeightOverride ? ~~documentHeightOverride : document.documentElement.scrollHeight);\n  const rectsInterval = setInterval(() => {\n    rects = overlayGroup.map((e) => getRect(e.elements.element));\n  }, rectUpdateFrequency), applyMinimap = () => {\n    if (scaleFactor >= 1) return;\n    const skeleton = buildPreviewSkeleton(mousePos, element, scaleFactor);\n    handler({\n      type: \"overlay/dragUpdateSkeleton\",\n      skeleton\n    }), handler({\n      type: \"overlay/dragToggleMinimapPrompt\",\n      display: !1\n    }), applyMinimapWrapperTransform(scaleTarget, scaleFactor, minYScaled, handler, rectUpdateFrequency).then(() => {\n      setTimeout(() => {\n        handler({\n          type: \"overlay/dragUpdateGroupRect\",\n          groupRect: calcGroupBoundsPreview(rects)\n        });\n      }, rectUpdateFrequency * 2);\n    });\n  }, handleScroll = (e) => {\n    Math.abs(e.deltaY) >= 10 && scaleFactor < 1 && !minimapScaleApplied && !minimapPromptShown && !disableMinimap && mousedown && (handler({\n      type: \"overlay/dragToggleMinimapPrompt\",\n      display: !0\n    }), minimapPromptShown = !0), e.shiftKey && !minimapScaleApplied && !disableMinimap && (window.dispatchEvent(new CustomEvent(\"unstable_sanity/dragApplyMinimap\")), minimapScaleApplied = !0, setTimeout(() => {\n      applyMinimap();\n    }, 50));\n  }, handleMouseMove = (e) => {\n    if (e.preventDefault(), mousePos = calcMousePos(e), mousePosInverseTransform = calcMousePosInverseTransform(mousePos), Math.abs(pointDist(mousePos, initialMousePos)) < minDragDelta) return;\n    if (!sequenceStarted) {\n      const groupRect = calcGroupBoundsPreview(rects), skeleton = buildPreviewSkeleton(mousePos, element, 1);\n      handler({\n        type: \"overlay/dragStart\",\n        flow\n      }), handler({\n        type: \"overlay/dragUpdateSkeleton\",\n        skeleton\n      }), handler({\n        type: \"overlay/dragUpdateGroupRect\",\n        groupRect\n      }), sequenceStarted = !0, onSequenceStart();\n    }\n    handler({\n      type: \"overlay/dragUpdateCursorPosition\",\n      x: mousePos.x,\n      y: mousePos.y\n    }), e.shiftKey && !minimapScaleApplied && !disableMinimap && (window.dispatchEvent(new CustomEvent(\"unstable_sanity/dragApplyMinimap\")), minimapScaleApplied = !0, setTimeout(() => {\n      applyMinimap();\n    }, 50));\n    const newInsertPosition = calcInsertPosition(mousePos, rects, flow);\n    JSON.stringify(insertPosition) !== JSON.stringify(newInsertPosition) && (insertPosition = newInsertPosition, handler({\n      type: \"overlay/dragUpdateInsertPosition\",\n      insertPosition: resolveInsertPosition(overlayGroup, insertPosition, flow)\n    }));\n  }, handleMouseUp = () => {\n    mousedown = !1, handler({\n      type: \"overlay/dragEnd\",\n      target,\n      insertPosition: insertPosition ? resolveInsertPosition(overlayGroup, insertPosition, flow) : null,\n      dragGroup,\n      flow,\n      preventInsertDefault\n    }), minimapPromptShown && handler({\n      type: \"overlay/dragToggleMinimapPrompt\",\n      display: !1\n    }), minimapScaleApplied || (clearInterval(rectsInterval), onSequenceEnd(), removeFrameListeners(), removeKeyListeners()), removeMouseListeners();\n  }, handleKeyup = (e) => {\n    if (e.key === \"Shift\" && minimapScaleApplied) {\n      minimapScaleApplied = !1;\n      const skeleton = buildPreviewSkeleton(mousePos, element, 1 / scaleFactor);\n      handler({\n        type: \"overlay/dragUpdateSkeleton\",\n        skeleton\n      }), window.dispatchEvent(new CustomEvent(\"unstable_sanity/dragResetMinimap\")), setTimeout(() => {\n        resetMinimapWrapperTransform(mousePosInverseTransform.y, scaleTarget, prescaleHeight, handler, rectUpdateFrequency, previousRootStyleValues);\n      }, 50), handler({\n        type: \"overlay/dragUpdateGroupRect\",\n        groupRect: null\n      }), mousedown || (clearInterval(rectsInterval), removeMouseListeners(), removeFrameListeners(), removeKeyListeners(), onSequenceEnd());\n    }\n  }, handleBlur = () => {\n    handler({\n      type: \"overlay/dragUpdateGroupRect\",\n      groupRect: null\n    }), window.dispatchEvent(new CustomEvent(\"unstable_sanity/dragResetMinimap\")), setTimeout(() => {\n      resetMinimapWrapperTransform(mousePosInverseTransform.y, scaleTarget, prescaleHeight, handler, rectUpdateFrequency, previousRootStyleValues).then(() => {\n        minimapScaleApplied = !1;\n      });\n    }, 50), clearInterval(rectsInterval), removeMouseListeners(), removeFrameListeners(), removeKeyListeners(), onSequenceEnd();\n  }, removeMouseListeners = () => {\n    window.removeEventListener(\"mousemove\", handleMouseMove), window.removeEventListener(\"wheel\", handleScroll), window.removeEventListener(\"mouseup\", handleMouseUp);\n  }, removeKeyListeners = () => {\n    window.removeEventListener(\"keyup\", handleKeyup);\n  }, removeFrameListeners = () => {\n    window.removeEventListener(\"blur\", handleBlur);\n  };\n  window.addEventListener(\"blur\", handleBlur), window.addEventListener(\"keyup\", handleKeyup), window.addEventListener(\"wheel\", handleScroll), window.addEventListener(\"mousemove\", handleMouseMove), window.addEventListener(\"mouseup\", handleMouseUp);\n}\nconst isElementNode$1 = (target) => target instanceof HTMLElement || target instanceof SVGElement;\nfunction findNonInlineElement(element) {\n  const {\n    display\n  } = window.getComputedStyle(element);\n  if (display !== \"inline\") return element;\n  const parent = element.parentElement;\n  return parent ? findNonInlineElement(parent) : null;\n}\nconst findOverlayElement = (el) => !el || !isElementNode$1(el) ? null : el.dataset?.sanityOverlayElement ? el : findOverlayElement(el.parentElement);\nfunction testVercelStegaRegex(input) {\n  return _vercel_stega__WEBPACK_IMPORTED_MODULE_2__.VERCEL_STEGA_REGEX.lastIndex = 0, _vercel_stega__WEBPACK_IMPORTED_MODULE_2__.VERCEL_STEGA_REGEX.test(input);\n}\nfunction decodeStega(str, isAltText = !1) {\n  try {\n    const decoded = (0,_vercel_stega__WEBPACK_IMPORTED_MODULE_2__.vercelStegaDecode)(str);\n    return !decoded || decoded.origin !== \"sanity.io\" ? null : (isAltText && (decoded.href = decoded.href?.replace(\".alt\", \"\")), decoded);\n  } catch (err) {\n    return console.error(\"Failed to decode stega for string: \", str, \"with the original error: \", err), null;\n  }\n}\nfunction testAndDecodeStega(str, isAltText = !1) {\n  return testVercelStegaRegex(str) ? decodeStega(str, isAltText) : null;\n}\nconst isElementNode = (node) => node.nodeType === Node.ELEMENT_NODE, isImgElement = (el) => el.tagName === \"IMG\", isTimeElement = (el) => el.tagName === \"TIME\", isSvgRootElement = (el) => el.tagName.toUpperCase() === \"SVG\";\nfunction isSanityNode(node) {\n  return \"path\" in node;\n}\nfunction findCommonPath(first, second) {\n  let firstParts = first.split(\".\"), secondParts = second.split(\".\");\n  const maxLength = Math.min(firstParts.length, secondParts.length);\n  return firstParts = firstParts.slice(0, maxLength).reverse(), secondParts = secondParts.slice(0, maxLength).reverse(), firstParts.reduce((parts, part, i) => part === secondParts[i] ? [...parts, part] : [], []).reverse().join(\".\");\n}\nfunction findCommonSanityData(nodes) {\n  if (!nodes.length || !nodes.map((n) => isSanityNode(n)).every((n, _i, arr) => n === arr[0]))\n    return;\n  if (!isSanityNode(nodes[0])) return nodes[0];\n  const sanityNodes = nodes.filter(isSanityNode);\n  let common = nodes[0];\n  const consistentValueKeys = [\"projectId\", \"dataset\", \"id\", \"baseUrl\", \"workspace\", \"tool\"];\n  for (let i = 1; i < sanityNodes.length; i++) {\n    const node = sanityNodes[i];\n    if (consistentValueKeys.some((key) => node[key] !== common?.[key])) {\n      common = void 0;\n      break;\n    }\n    common.path = findCommonPath(common.path, node.path);\n  }\n  return common;\n}\nfunction findSanityNodes(el) {\n  const elements = [];\n  function addElement(element, data) {\n    const sanity = (0,_sanity_visual_editing_csm__WEBPACK_IMPORTED_MODULE_7__.decodeSanityNodeData)(data);\n    if (!sanity)\n      return;\n    const measureElement = findNonInlineElement(element);\n    measureElement && elements.push({\n      elements: {\n        element,\n        measureElement\n      },\n      sanity\n    });\n  }\n  if (el)\n    for (const node of el.childNodes) {\n      const {\n        nodeType,\n        parentElement,\n        textContent\n      } = node;\n      if (isElementNode(node) && node.dataset?.sanityEditTarget !== void 0) {\n        const nodesInTarget = findSanityNodes(node).map(({\n          sanity\n        }) => sanity);\n        if (!nodesInTarget.map((n) => isSanityNode(n)).every((n, _i, arr) => n === arr[0]))\n          continue;\n        const commonData = findCommonSanityData(nodesInTarget);\n        commonData && elements.push({\n          elements: {\n            element: node,\n            measureElement: node\n          },\n          sanity: commonData\n        });\n      } else if (nodeType === Node.TEXT_NODE && parentElement && textContent) {\n        const data = testAndDecodeStega(textContent);\n        if (!data) continue;\n        addElement(parentElement, data);\n      } else if (isElementNode(node)) {\n        if (node.tagName === \"SCRIPT\" || node.tagName === \"SANITY-VISUAL-EDITING\")\n          continue;\n        if (node.dataset?.sanity)\n          addElement(node, node.dataset.sanity);\n        else if (node.dataset?.sanityEditInfo)\n          addElement(node, node.dataset.sanityEditInfo);\n        else if (isImgElement(node)) {\n          const data = testAndDecodeStega(node.alt, !0);\n          if (!data) continue;\n          addElement(node, data);\n          continue;\n        } else if (isTimeElement(node)) {\n          const data = testAndDecodeStega(node.dateTime, !0);\n          if (!data) continue;\n          addElement(node, data);\n        } else if (isSvgRootElement(node)) {\n          if (!node.ariaLabel) continue;\n          const data = testAndDecodeStega(node.ariaLabel, !0);\n          if (!data) continue;\n          addElement(node, data);\n        }\n        elements.push(...findSanityNodes(node));\n      }\n    }\n  return elements;\n}\nfunction isSanityArrayPath(path) {\n  const lastDotIndex = path.lastIndexOf(\".\");\n  return path.substring(lastDotIndex, path.length).includes(\"[\");\n}\nfunction getSanityNodeArrayPath(path) {\n  if (!isSanityArrayPath(path)) return null;\n  const split = path.split(\".\");\n  return split[split.length - 1] = split[split.length - 1].replace(/\\[.*?\\]/g, \"[]\"), split.join(\".\");\n}\nfunction sanityNodesExistInSameArray(sanityNode1, sanityNode2) {\n  return !isSanityArrayPath(sanityNode1.path) || !isSanityArrayPath(sanityNode2.path) ? !1 : getSanityNodeArrayPath(sanityNode1.path) === getSanityNodeArrayPath(sanityNode2.path);\n}\nfunction resolveDragAndDropGroup(element, sanity, elementSet, elementsMap) {\n  if (!element.getAttribute(\"data-sanity\") || element.getAttribute(\"data-sanity-drag-disable\") || !sanity || !isSanityNode(sanity) || !isSanityArrayPath(sanity.path)) return null;\n  const targetDragGroup = element.getAttribute(\"data-sanity-drag-group\"), group = [...elementSet].reduce((acc, el) => {\n    const elData = elementsMap.get(el), elDragDisabled = el.getAttribute(\"data-sanity-drag-disable\"), elDragGroup = el.getAttribute(\"data-sanity-drag-group\"), elHasSanityAttribution = el.getAttribute(\"data-sanity\") !== null, sharedDragGroup = targetDragGroup !== null ? targetDragGroup === elDragGroup : !0;\n    return elData && !elDragDisabled && isSanityNode(elData.sanity) && sanityNodesExistInSameArray(sanity, elData.sanity) && sharedDragGroup && elHasSanityAttribution && acc.push(elData), acc;\n  }, []);\n  return group.length <= 1 ? null : group;\n}\nfunction createOverlayController({\n  handler,\n  overlayElement,\n  inFrame,\n  inPopUp,\n  optimisticActorReady\n}) {\n  let activated = !1;\n  const elementIdMap = /* @__PURE__ */ new Map(), elementsMap = /* @__PURE__ */ new WeakMap(), elementSet = /* @__PURE__ */ new Set(), measureElements = /* @__PURE__ */ new WeakMap(), cursorMap = /* @__PURE__ */ new WeakMap();\n  let ro, io, mo, activeDragSequence = !1, hoverStack = [];\n  const getHoveredElement = () => hoverStack[hoverStack.length - 1];\n  function addEventHandlers(el, handlers) {\n    el.addEventListener(\"click\", handlers.click, {\n      capture: !0\n    }), el.addEventListener(\"contextmenu\", handlers.contextmenu, {\n      capture: !0\n    }), el.addEventListener(\"mousemove\", handlers.mousemove, {\n      once: !0,\n      capture: !0\n    }), el.addEventListener(\"mousedown\", handlers.mousedown, {\n      capture: !0\n    });\n  }\n  function removeEventHandlers(el, handlers) {\n    el.removeEventListener(\"click\", handlers.click, {\n      capture: !0\n    }), el.removeEventListener(\"contextmenu\", handlers.contextmenu, {\n      capture: !0\n    }), el.removeEventListener(\"mousemove\", handlers.mousemove, {\n      capture: !0\n    }), el.removeEventListener(\"mousedown\", handlers.mousedown, {\n      capture: !0\n    }), el.removeEventListener(\"mouseenter\", handlers.mouseenter), el.removeEventListener(\"mouseleave\", handlers.mouseleave);\n  }\n  function activateElement({\n    id,\n    elements,\n    handlers\n  }) {\n    const {\n      element,\n      measureElement\n    } = elements;\n    addEventHandlers(element, handlers), ro.observe(measureElement), handler({\n      type: \"element/activate\",\n      id\n    });\n  }\n  function deactivateElement({\n    id,\n    elements,\n    handlers\n  }) {\n    const {\n      element,\n      measureElement\n    } = elements;\n    removeEventHandlers(element, handlers), ro.unobserve(measureElement), hoverStack = hoverStack.filter((el) => el !== element), handler({\n      type: \"element/deactivate\",\n      id\n    });\n  }\n  function setOverlayCursor(element) {\n    if (!(!inFrame && !inPopUp || !optimisticActorReady))\n      for (const hoverstackElement of hoverStack) {\n        if (element === hoverstackElement) {\n          const targetSanityData = elementsMap.get(element)?.sanity;\n          if (!targetSanityData || !isSanityNode(targetSanityData)) return;\n          if (resolveDragAndDropGroup(element, targetSanityData, elementSet, elementsMap)) {\n            const existingCursor = element.style.cursor;\n            existingCursor && cursorMap.set(element, existingCursor), handler({\n              type: \"overlay/setCursor\",\n              element,\n              cursor: \"move\"\n            });\n            continue;\n          }\n        }\n        restoreOverlayCursor(hoverstackElement);\n      }\n  }\n  function restoreOverlayCursor(element) {\n    const previousCursor = cursorMap.get(element);\n    handler({\n      type: \"overlay/setCursor\",\n      element,\n      cursor: previousCursor\n    });\n  }\n  function registerElement({\n    elements,\n    sanity\n  }) {\n    const {\n      element,\n      measureElement\n    } = elements, eventHandlers = {\n      click(event) {\n        const target = event.target;\n        if (element === getHoveredElement() && element.contains(target)) {\n          inFrame && (event.preventDefault(), event.stopPropagation());\n          const sanity2 = elementsMap.get(element)?.sanity;\n          sanity2 && !activeDragSequence && handler({\n            type: \"element/click\",\n            id,\n            sanity: sanity2\n          });\n        }\n      },\n      contextmenu(event) {\n        if (!(\"path\" in sanity) || !inFrame && !inPopUp || !optimisticActorReady || !sanity.path.split(\".\").pop()?.includes(\"[_key==\")) return;\n        const target = event.target;\n        element === getHoveredElement() && element.contains(target) && ((inFrame || inPopUp) && (event.preventDefault(), event.stopPropagation()), handler({\n          type: \"element/contextmenu\",\n          id,\n          position: {\n            x: event.clientX,\n            y: event.clientY\n          },\n          sanity\n        }));\n      },\n      mousedown(event) {\n        if (event.preventDefault(), event.currentTarget !== hoverStack.at(-1) || element.getAttribute(\"data-sanity-drag-disable\") || !inFrame && !inPopUp || !optimisticActorReady) return;\n        const targetSanityData = elementsMap.get(element)?.sanity;\n        if (!targetSanityData || !isSanityNode(targetSanityData) || !isSanityArrayPath(targetSanityData.path)) return;\n        const dragGroup = resolveDragAndDropGroup(element, sanity, elementSet, elementsMap);\n        dragGroup && handleOverlayDrag({\n          element,\n          handler,\n          mouseEvent: event,\n          overlayGroup: dragGroup,\n          target: targetSanityData,\n          onSequenceStart: () => {\n            activeDragSequence = !0;\n          },\n          onSequenceEnd: () => {\n            setTimeout(() => {\n              activeDragSequence = !1;\n            }, 250);\n          }\n        });\n      },\n      mousemove(event) {\n        eventHandlers.mouseenter(event);\n        const el = event.currentTarget;\n        el && (el.addEventListener(\"mouseenter\", eventHandlers.mouseenter), el.addEventListener(\"mouseleave\", eventHandlers.mouseleave));\n      },\n      mouseenter() {\n        document.querySelector(\"vercel-live-feedback\") && element.closest(\"[data-vercel-edit-info]\") || element.closest(\"[data-vercel-edit-target]\") || (hoverStack.push(element), handler({\n          type: \"element/mouseenter\",\n          id,\n          rect: getRect(element)\n        }), setOverlayCursor(element));\n      },\n      mouseleave(e) {\n        function leave() {\n          hoverStack.pop();\n          const hoveredElement = getHoveredElement();\n          if (handler({\n            type: \"element/mouseleave\",\n            id\n          }), hoveredElement) {\n            setOverlayCursor(hoveredElement);\n            const overlayElement2 = elementsMap.get(hoveredElement);\n            overlayElement2 && handler({\n              type: \"element/mouseenter\",\n              id: overlayElement2.id,\n              rect: getRect(hoveredElement)\n            });\n          }\n          restoreOverlayCursor(element);\n        }\n        function addDeferredLeave(el) {\n          const deferredLeave = (e2) => {\n            const {\n              relatedTarget: relatedTarget2\n            } = e2;\n            findOverlayElement(relatedTarget2) ? relatedTarget2 && isElementNode$1(relatedTarget2) && (el.removeEventListener(\"mouseleave\", deferredLeave), addDeferredLeave(relatedTarget2)) : (el.removeEventListener(\"mouseleave\", deferredLeave), leave());\n          };\n          el.addEventListener(\"mouseleave\", deferredLeave);\n        }\n        const {\n          relatedTarget\n        } = e, container = findOverlayElement(relatedTarget), isInteractiveOverlayElement = overlayElement.contains(container);\n        if (isElementNode$1(container) && isInteractiveOverlayElement)\n          return addDeferredLeave(container);\n        leave();\n      }\n    }, id = v4(), sanityNode = {\n      id,\n      elements,\n      sanity,\n      handlers: eventHandlers\n    };\n    elementSet.add(element), measureElements.set(measureElement, element), elementIdMap.set(id, element), elementsMap.set(element, sanityNode), io?.observe(element), handler({\n      type: \"element/register\",\n      id,\n      element,\n      rect: getRect(element),\n      sanity,\n      dragDisabled: !!element.getAttribute(\"data-sanity-drag-disable\")\n    }), activated && activateElement(sanityNode);\n  }\n  function updateElement({\n    elements,\n    sanity\n  }) {\n    const {\n      element\n    } = elements, overlayElement2 = elementsMap.get(element);\n    overlayElement2 && (elementsMap.set(element, {\n      ...overlayElement2,\n      sanity\n    }), handler({\n      type: \"element/update\",\n      id: overlayElement2.id,\n      rect: getRect(element),\n      sanity\n    }));\n  }\n  function parseElements(node) {\n    const sanityNodes = findSanityNodes(node);\n    for (const sanityNode of sanityNodes) {\n      const {\n        element\n      } = sanityNode.elements;\n      elementsMap.has(element) ? updateElement(sanityNode) : registerElement(sanityNode);\n    }\n  }\n  function unregisterElement(element) {\n    const overlayElement2 = elementsMap.get(element);\n    if (overlayElement2) {\n      const {\n        id,\n        handlers\n      } = overlayElement2;\n      removeEventHandlers(element, handlers), ro.unobserve(element), elementsMap.delete(element), elementSet.delete(element), elementIdMap.delete(id), handler({\n        type: \"element/unregister\",\n        id\n      });\n    }\n  }\n  function handleMutation(mutations) {\n    let mutationWasInScope = !1;\n    for (const mutation of mutations) {\n      const {\n        target,\n        type\n      } = mutation, node = type === \"characterData\" ? target.parentElement : target;\n      node === overlayElement || overlayElement.contains(node) || (mutationWasInScope = !0, isElementNode$1(node) && parseElements({\n        childNodes: [node]\n      }));\n    }\n    if (mutationWasInScope)\n      for (const element of elementSet)\n        element.isConnected || unregisterElement(element);\n  }\n  function updateRect(el) {\n    const overlayElement2 = elementsMap.get(el);\n    overlayElement2 && handler({\n      type: \"element/updateRect\",\n      id: overlayElement2.id,\n      rect: getRect(el)\n    });\n  }\n  function handleResize(entries) {\n    for (const entry of entries) {\n      const target = entry.target;\n      if (isElementNode$1(target)) {\n        const element = measureElements.get(target);\n        if (!element) return;\n        updateRect(element);\n      }\n    }\n  }\n  function handleIntersection(entries) {\n    if (activated)\n      for (const entry of entries) {\n        const {\n          target\n        } = entry, match = isElementNode$1(target) && elementsMap.get(target);\n        match && (entry.isIntersecting ? activateElement(match) : deactivateElement(match));\n      }\n  }\n  function handleBlur(event) {\n    const element = findOverlayElement(event.target);\n    if (element) {\n      element.dataset.sanityOverlayElement === \"capture\" && (event.preventDefault(), event.stopPropagation());\n      return;\n    }\n    hoverStack = [], handler({\n      type: \"overlay/blur\"\n    });\n  }\n  function handleWindowResize() {\n    for (const element of elementSet)\n      updateRect(element);\n  }\n  function handleKeydown(event) {\n    event.key === \"Escape\" && (hoverStack = [], handler({\n      type: \"overlay/blur\"\n    }));\n  }\n  function handleWindowScroll(event) {\n    const {\n      target\n    } = event;\n    if (!(target === window.document || !isElementNode$1(target)))\n      for (const element of elementSet)\n        target.contains(element) && updateRect(element);\n  }\n  function activate() {\n    activated || (io = new IntersectionObserver(handleIntersection, {\n      threshold: 0.3\n    }), elementSet.forEach((element) => io.observe(element)), handler({\n      type: \"overlay/activate\"\n    }), activated = !0);\n  }\n  function deactivate() {\n    activated && (io?.disconnect(), elementSet.forEach((element) => {\n      const overlayElement2 = elementsMap.get(element);\n      overlayElement2 && deactivateElement(overlayElement2);\n    }), handler({\n      type: \"overlay/deactivate\"\n    }), activated = !1);\n  }\n  function destroy() {\n    window.removeEventListener(\"click\", handleBlur), window.removeEventListener(\"contextmenu\", handleBlur), window.removeEventListener(\"keydown\", handleKeydown), window.removeEventListener(\"resize\", handleWindowResize), window.removeEventListener(\"scroll\", handleWindowScroll), mo.disconnect(), ro.disconnect(), elementSet.forEach((element) => {\n      unregisterElement(element);\n    }), elementIdMap.clear(), elementSet.clear(), hoverStack = [], deactivate();\n  }\n  function create() {\n    window.addEventListener(\"click\", handleBlur), window.addEventListener(\"contextmenu\", handleBlur), window.addEventListener(\"keydown\", handleKeydown), window.addEventListener(\"resize\", handleWindowResize), window.addEventListener(\"scroll\", handleWindowScroll, {\n      capture: !0,\n      passive: !0\n    }), ro = new ResizeObserver(handleResize), mo = new MutationObserver(handleMutation), mo.observe(document.body, {\n      attributes: !0,\n      characterData: !0,\n      childList: !0,\n      subtree: !0\n    }), parseElements(document.body), activate();\n  }\n  return window.document.fonts.ready.then(() => {\n    for (const element of elementSet)\n      updateRect(element);\n  }), create(), {\n    activate,\n    deactivate,\n    destroy\n  };\n}\nconst SharedStateContext = (0,react__WEBPACK_IMPORTED_MODULE_1__.createContext)(null);\n\n//# sourceMappingURL=SharedStateContext.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHNhbml0eSt2aXN1YWwtZWRpdGluZ0AyLjEzLjE1X0BlbW90aW9uK2lzLXByb3AtdmFsaWRAMS4yLjJfQHNhbml0eStjbGllbnRANi4yOC40X0BzYW5pXzhjMjAzM2ZlYWJkNWY1ODRhZjQ0NjliZmNlMTQxNTNmL25vZGVfbW9kdWxlcy9Ac2FuaXR5L3Zpc3VhbC1lZGl0aW5nL2Rpc3QvX2NodW5rcy1lcy9TaGFyZWRTdGF0ZUNvbnRleHQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQTJDO0FBQ1M7QUFDd0I7QUFDMUI7QUFDTjtBQUNRO0FBQ2M7QUFDSTtBQUN0RTtBQUNBLFlBQVkseURBQUMsZ0NBQWdDLCtDQUFRLG9DQUFvQywrQ0FBUSwyQ0FBMkMsK0NBQVEsZ0RBQWdELCtDQUFRLHVCQUF1QixpRUFBa0I7QUFDclA7QUFDQTtBQUNBO0FBQ0EsUUFBUSxrRUFBYztBQUN0QjtBQUNBO0FBQ0EsR0FBRztBQUNILGdDQUFnQyxnRUFBYztBQUM5QztBQUNBO0FBQ0EsZ0NBQWdDLGdFQUFjO0FBQzlDO0FBQ0E7QUFDQSxRQUFRLHlEQUFZO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixrRUFBYztBQUNsQztBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxRQUFRLHNEQUFlO0FBQ3ZCLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esd0VBQXdFLGdEQUFTO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsc0RBQWU7QUFDeEQ7QUFDQSxPQUFPO0FBQ1A7QUFDQSxHQUFHO0FBQ0g7QUFDQSxtUkFBbVIsZ0RBQVM7QUFDNVI7QUFDQTtBQUNBLGdCQUFnQixTQUFTO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxrQkFBa0Isc0JBQXNCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQiwwQkFBMEI7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ04sSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsK0lBQStJLHNCQUFzQixpQkFBaUIsWUFBWTtBQUNsTSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUssMENBQTBDLDZEQUE2RDtBQUM1RyxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULE9BQU87QUFDUCxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyw2REFBa0IsZ0JBQWdCLDZEQUFrQjtBQUM3RDtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsZ0VBQWlCO0FBQ3JDO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLHdCQUF3QjtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsZ0ZBQW9CO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBLFNBQVM7QUFDVCxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLG9EQUFhO0FBTXRDO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy9wZXRyb2t2YXJ0c2lhbnlpL2NvZGUvZ2VvbXVuZHVzLXdlYnNpdGUvbm9kZV9tb2R1bGVzLy5wbnBtL0BzYW5pdHkrdmlzdWFsLWVkaXRpbmdAMi4xMy4xNV9AZW1vdGlvbitpcy1wcm9wLXZhbGlkQDEuMi4yX0BzYW5pdHkrY2xpZW50QDYuMjguNF9Ac2FuaV84YzIwMzNmZWFiZDVmNTg0YWY0NDY5YmZjZTE0MTUzZi9ub2RlX21vZHVsZXMvQHNhbml0eS92aXN1YWwtZWRpdGluZy9kaXN0L19jaHVua3MtZXMvU2hhcmVkU3RhdGVDb250ZXh0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGMgfSBmcm9tIFwicmVhY3QtY29tcGlsZXItcnVudGltZVwiO1xuaW1wb3J0IHsgZ2V0UHVibGlzaGVkSWQgfSBmcm9tIFwiQHNhbml0eS9jbGllbnQvY3NtXCI7XG5pbXBvcnQgeyB1c2VTdGF0ZSwgdXNlRWZmZWN0LCBzdGFydFRyYW5zaXRpb24sIGNyZWF0ZUNvbnRleHQgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IHVzZUVmZmVjdEV2ZW50IH0gZnJvbSBcInVzZS1lZmZlY3QtZXZlbnRcIjtcbmltcG9ydCB7IGlzRW1wdHlBY3RvciB9IGZyb20gXCIuL2NvbnRleHQuanNcIjtcbmltcG9ydCB7IHVzZU9wdGltaXN0aWNBY3RvciB9IGZyb20gXCIuL211dGF0aW9ucy5qc1wiO1xuaW1wb3J0IHsgZGVjb2RlU2FuaXR5Tm9kZURhdGEgfSBmcm9tIFwiQHNhbml0eS92aXN1YWwtZWRpdGluZy1jc21cIjtcbmltcG9ydCB7IHZlcmNlbFN0ZWdhRGVjb2RlLCBWRVJDRUxfU1RFR0FfUkVHRVggfSBmcm9tIFwiQHZlcmNlbC9zdGVnYVwiO1xuZnVuY3Rpb24gdXNlT3B0aW1pc3RpYyhwYXNzdGhyb3VnaCwgcmVkdWNlcikge1xuICBjb25zdCAkID0gYygyMSksIFtwcmlzdGluZSwgc2V0UHJpc3RpbmVdID0gdXNlU3RhdGUoITApLCBbb3B0aW1pc3RpYywgc2V0T3B0aW1pc3RpY10gPSB1c2VTdGF0ZShwYXNzdGhyb3VnaCksIFtsYXN0RXZlbnQsIHNldExhc3RFdmVudF0gPSB1c2VTdGF0ZShudWxsKSwgW2xhc3RQYXNzdGhyb3VnaCwgc2V0TGFzdFBhc3N0aHJvdWdoXSA9IHVzZVN0YXRlKHBhc3N0aHJvdWdoKSwgYWN0b3IgPSB1c2VPcHRpbWlzdGljQWN0b3IoKTtcbiAgbGV0IHQwO1xuICAkWzBdICE9PSByZWR1Y2VyID8gKHQwID0gKGFjdGlvbiwgcHJldlN0YXRlKSA9PiAoQXJyYXkuaXNBcnJheShyZWR1Y2VyKSA/IHJlZHVjZXIgOiBbcmVkdWNlcl0pLnJlZHVjZSgoYWNjLCByZWR1Y2VyXzApID0+IHJlZHVjZXJfMChhY2MsIHtcbiAgICBkb2N1bWVudDogYWN0aW9uLmRvY3VtZW50LFxuICAgIGlkOiBnZXRQdWJsaXNoZWRJZChhY3Rpb24uaWQpLFxuICAgIG9yaWdpbmFsSWQ6IGFjdGlvbi5pZCxcbiAgICB0eXBlOiBhY3Rpb24udHlwZVxuICB9KSwgcHJldlN0YXRlKSwgJFswXSA9IHJlZHVjZXIsICRbMV0gPSB0MCkgOiB0MCA9ICRbMV07XG4gIGNvbnN0IHJlZHVjZVN0YXRlRnJvbUFjdGlvbiA9IHVzZUVmZmVjdEV2ZW50KHQwKTtcbiAgbGV0IHQxO1xuICAkWzJdICE9PSBwYXNzdGhyb3VnaCA/ICh0MSA9ICgpID0+IHNldExhc3RQYXNzdGhyb3VnaChwYXNzdGhyb3VnaCksICRbMl0gPSBwYXNzdGhyb3VnaCwgJFszXSA9IHQxKSA6IHQxID0gJFszXTtcbiAgY29uc3QgdXBkYXRlTGFzdFBhc3N0aHJvdWdoID0gdXNlRWZmZWN0RXZlbnQodDEpO1xuICBsZXQgdDI7XG4gICRbNF0gIT09IGFjdG9yIHx8ICRbNV0gIT09IHJlZHVjZVN0YXRlRnJvbUFjdGlvbiB8fCAkWzZdICE9PSB1cGRhdGVMYXN0UGFzc3Rocm91Z2ggPyAodDIgPSAoKSA9PiB7XG4gICAgaWYgKGlzRW1wdHlBY3RvcihhY3RvcikpXG4gICAgICByZXR1cm47XG4gICAgbGV0IHByaXN0aW5lVGltZW91dDtcbiAgICBjb25zdCByZWJhc2VkU3ViID0gYWN0b3Iub24oXCJyZWJhc2VkLmxvY2FsXCIsIChfZXZlbnQpID0+IHtcbiAgICAgIGNvbnN0IGV2ZW50ID0ge1xuICAgICAgICBkb2N1bWVudDogX2V2ZW50LmRvY3VtZW50LFxuICAgICAgICBpZDogX2V2ZW50LmlkLFxuICAgICAgICBvcmlnaW5hbElkOiBnZXRQdWJsaXNoZWRJZChfZXZlbnQuaWQpLFxuICAgICAgICB0eXBlOiBcIm11dGF0ZVwiXG4gICAgICB9O1xuICAgICAgc2V0T3B0aW1pc3RpYygocHJldlN0YXRlXzApID0+IHJlZHVjZVN0YXRlRnJvbUFjdGlvbihldmVudCwgcHJldlN0YXRlXzApKSwgc2V0TGFzdEV2ZW50KGV2ZW50KSwgdXBkYXRlTGFzdFBhc3N0aHJvdWdoKCksIHNldFByaXN0aW5lKCExKSwgY2xlYXJUaW1lb3V0KHByaXN0aW5lVGltZW91dCk7XG4gICAgfSksIHByaXN0aW5lU3ViID0gYWN0b3Iub24oXCJwcmlzdGluZVwiLCAoKSA9PiB7XG4gICAgICBwcmlzdGluZVRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgc3RhcnRUcmFuc2l0aW9uKCgpID0+IHNldFByaXN0aW5lKCEwKSk7XG4gICAgICB9LCAxNWUzKTtcbiAgICB9KTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgcmViYXNlZFN1Yi51bnN1YnNjcmliZSgpLCBwcmlzdGluZVN1Yi51bnN1YnNjcmliZSgpO1xuICAgIH07XG4gIH0sICRbNF0gPSBhY3RvciwgJFs1XSA9IHJlZHVjZVN0YXRlRnJvbUFjdGlvbiwgJFs2XSA9IHVwZGF0ZUxhc3RQYXNzdGhyb3VnaCwgJFs3XSA9IHQyKSA6IHQyID0gJFs3XTtcbiAgbGV0IHQzO1xuICAkWzhdICE9PSBhY3RvciA/ICh0MyA9IFthY3Rvcl0sICRbOF0gPSBhY3RvciwgJFs5XSA9IHQzKSA6IHQzID0gJFs5XSwgdXNlRWZmZWN0KHQyLCB0Myk7XG4gIGxldCB0NDtcbiAgJFsxMF0gIT09IGxhc3RFdmVudCB8fCAkWzExXSAhPT0gbGFzdFBhc3N0aHJvdWdoIHx8ICRbMTJdICE9PSBwYXNzdGhyb3VnaCB8fCAkWzEzXSAhPT0gcHJpc3RpbmUgfHwgJFsxNF0gIT09IHJlZHVjZVN0YXRlRnJvbUFjdGlvbiA/ICh0NCA9ICgpID0+IHtcbiAgICBpZiAoIXByaXN0aW5lKSB7XG4gICAgICBpZiAoIWxhc3RFdmVudClcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gbGFzdCBldmVudCBmb3VuZCB3aGVuIHN5bmNpbmcgcGFzc3Rocm91Z2hcIik7XG4gICAgICBsYXN0UGFzc3Rocm91Z2ggIT09IHBhc3N0aHJvdWdoICYmIHN0YXJ0VHJhbnNpdGlvbigoKSA9PiB7XG4gICAgICAgIHNldE9wdGltaXN0aWMocmVkdWNlU3RhdGVGcm9tQWN0aW9uKGxhc3RFdmVudCwgcGFzc3Rocm91Z2gpKSwgc2V0TGFzdFBhc3N0aHJvdWdoKHBhc3N0aHJvdWdoKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSwgJFsxMF0gPSBsYXN0RXZlbnQsICRbMTFdID0gbGFzdFBhc3N0aHJvdWdoLCAkWzEyXSA9IHBhc3N0aHJvdWdoLCAkWzEzXSA9IHByaXN0aW5lLCAkWzE0XSA9IHJlZHVjZVN0YXRlRnJvbUFjdGlvbiwgJFsxNV0gPSB0NCkgOiB0NCA9ICRbMTVdO1xuICBsZXQgdDU7XG4gIHJldHVybiAkWzE2XSAhPT0gbGFzdEV2ZW50IHx8ICRbMTddICE9PSBsYXN0UGFzc3Rocm91Z2ggfHwgJFsxOF0gIT09IHBhc3N0aHJvdWdoIHx8ICRbMTldICE9PSBwcmlzdGluZSA/ICh0NSA9IFtsYXN0RXZlbnQsIGxhc3RQYXNzdGhyb3VnaCwgcGFzc3Rocm91Z2gsIHByaXN0aW5lXSwgJFsxNl0gPSBsYXN0RXZlbnQsICRbMTddID0gbGFzdFBhc3N0aHJvdWdoLCAkWzE4XSA9IHBhc3N0aHJvdWdoLCAkWzE5XSA9IHByaXN0aW5lLCAkWzIwXSA9IHQ1KSA6IHQ1ID0gJFsyMF0sIHVzZUVmZmVjdCh0NCwgdDUpLCBwcmlzdGluZSA/IHBhc3N0aHJvdWdoIDogb3B0aW1pc3RpYztcbn1cbmNvbnN0IGJ5dGVUb0hleCA9IFtdO1xuZm9yIChsZXQgaSA9IDA7IGkgPCAyNTY7ICsraSlcbiAgYnl0ZVRvSGV4LnB1c2goKGkgKyAyNTYpLnRvU3RyaW5nKDE2KS5zbGljZSgxKSk7XG5mdW5jdGlvbiB1bnNhZmVTdHJpbmdpZnkoYXJyLCBvZmZzZXQgPSAwKSB7XG4gIHJldHVybiAoYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAwXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDFdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMl1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAzXV0gKyBcIi1cIiArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgNF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA1XV0gKyBcIi1cIiArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgNl1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA3XV0gKyBcIi1cIiArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgOF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA5XV0gKyBcIi1cIiArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTBdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTFdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTJdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTNdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTRdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTVdXSkudG9Mb3dlckNhc2UoKTtcbn1cbmxldCBnZXRSYW5kb21WYWx1ZXM7XG5jb25zdCBybmRzOCA9IG5ldyBVaW50OEFycmF5KDE2KTtcbmZ1bmN0aW9uIHJuZygpIHtcbiAgaWYgKCFnZXRSYW5kb21WYWx1ZXMpIHtcbiAgICBpZiAodHlwZW9mIGNyeXB0byA+IFwidVwiIHx8ICFjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKVxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiY3J5cHRvLmdldFJhbmRvbVZhbHVlcygpIG5vdCBzdXBwb3J0ZWQuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vdXVpZGpzL3V1aWQjZ2V0cmFuZG9tdmFsdWVzLW5vdC1zdXBwb3J0ZWRcIik7XG4gICAgZ2V0UmFuZG9tVmFsdWVzID0gY3J5cHRvLmdldFJhbmRvbVZhbHVlcy5iaW5kKGNyeXB0byk7XG4gIH1cbiAgcmV0dXJuIGdldFJhbmRvbVZhbHVlcyhybmRzOCk7XG59XG5jb25zdCByYW5kb21VVUlEID0gdHlwZW9mIGNyeXB0byA8IFwidVwiICYmIGNyeXB0by5yYW5kb21VVUlEICYmIGNyeXB0by5yYW5kb21VVUlELmJpbmQoY3J5cHRvKTtcbnZhciBuYXRpdmUgPSB7XG4gIHJhbmRvbVVVSURcbn07XG5mdW5jdGlvbiB2NChvcHRpb25zLCBidWYsIG9mZnNldCkge1xuICBpZiAobmF0aXZlLnJhbmRvbVVVSUQgJiYgIW9wdGlvbnMpXG4gICAgcmV0dXJuIG5hdGl2ZS5yYW5kb21VVUlEKCk7XG4gIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICBjb25zdCBybmRzID0gb3B0aW9ucy5yYW5kb20gPz8gb3B0aW9ucy5ybmc/LigpID8/IHJuZygpO1xuICBpZiAocm5kcy5sZW5ndGggPCAxNilcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJSYW5kb20gYnl0ZXMgbGVuZ3RoIG11c3QgYmUgPj0gMTZcIik7XG4gIHJldHVybiBybmRzWzZdID0gcm5kc1s2XSAmIDE1IHwgNjQsIHJuZHNbOF0gPSBybmRzWzhdICYgNjMgfCAxMjgsIHVuc2FmZVN0cmluZ2lmeShybmRzKTtcbn1cbmZ1bmN0aW9uIGdldFJlY3QoZWxlbWVudCkge1xuICBjb25zdCBkb21SZWN0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgcmV0dXJuIHtcbiAgICB4OiBkb21SZWN0LnggKyBzY3JvbGxYLFxuICAgIHk6IGRvbVJlY3QueSArIHNjcm9sbFksXG4gICAgdzogZG9tUmVjdC53aWR0aCxcbiAgICBoOiBkb21SZWN0LmhlaWdodFxuICB9O1xufVxuZnVuY3Rpb24gb2Zmc2V0UmVjdChyZWN0LCBweCwgYXhpcykge1xuICByZXR1cm4gYXhpcyA9PT0gXCJ4XCIgPyB7XG4gICAgeDogcmVjdC54ICsgcHgsXG4gICAgeTogcmVjdC55LFxuICAgIHc6IHJlY3QudyAtIDIgKiBweCxcbiAgICBoOiByZWN0LmhcbiAgfSA6IHtcbiAgICB4OiByZWN0LngsXG4gICAgeTogcmVjdC55ICsgcHgsXG4gICAgdzogcmVjdC53LFxuICAgIGg6IHJlY3QuaCAtIDIgKiBweFxuICB9O1xufVxuZnVuY3Rpb24gcmF5SW50ZXJzZWN0KGwxLCBsMikge1xuICBjb25zdCB7XG4gICAgeDEsXG4gICAgeTEsXG4gICAgeDIsXG4gICAgeTJcbiAgfSA9IGwxLCB7XG4gICAgeDE6IHgzLFxuICAgIHkxOiB5MyxcbiAgICB4MjogeDQsXG4gICAgeTI6IHk0XG4gIH0gPSBsMjtcbiAgaWYgKHgxID09PSB4MiAmJiB5MSA9PT0geTIgfHwgeDMgPT09IHg0ICYmIHkzID09PSB5NClcbiAgICByZXR1cm4gITE7XG4gIGNvbnN0IGRlbm9taW5hdG9yID0gKHk0IC0geTMpICogKHgyIC0geDEpIC0gKHg0IC0geDMpICogKHkyIC0geTEpO1xuICBpZiAoZGVub21pbmF0b3IgPT09IDApXG4gICAgcmV0dXJuICExO1xuICBjb25zdCB1YSA9ICgoeDQgLSB4MykgKiAoeTEgLSB5MykgLSAoeTQgLSB5MykgKiAoeDEgLSB4MykpIC8gZGVub21pbmF0b3IsIHViID0gKCh4MiAtIHgxKSAqICh5MSAtIHkzKSAtICh5MiAtIHkxKSAqICh4MSAtIHgzKSkgLyBkZW5vbWluYXRvcjtcbiAgaWYgKHVhIDwgMCB8fCB1YSA+IDEgfHwgdWIgPCAwIHx8IHViID4gMSlcbiAgICByZXR1cm4gITE7XG4gIGNvbnN0IHggPSB4MSArIHVhICogKHgyIC0geDEpLCB5ID0geTEgKyB1YSAqICh5MiAtIHkxKTtcbiAgcmV0dXJuIHtcbiAgICB4LFxuICAgIHlcbiAgfTtcbn1cbmZ1bmN0aW9uIHJlY3RFcXVhbChyMSwgcjIpIHtcbiAgcmV0dXJuIHIxLnggPT09IHIyLnggJiYgcjEueSA9PT0gcjIueSAmJiByMS53ID09PSByMi53ICYmIHIxLmggPT09IHIyLmg7XG59XG5mdW5jdGlvbiByYXlSZWN0SW50ZXJzZWN0aW9ucyhsaW5lLCByZWN0KSB7XG4gIGNvbnN0IHJlY3RMaW5lcyA9IFt7XG4gICAgeDE6IHJlY3QueCxcbiAgICB5MTogcmVjdC55LFxuICAgIHgyOiByZWN0LnggKyByZWN0LncsXG4gICAgeTI6IHJlY3QueVxuICB9LCB7XG4gICAgeDE6IHJlY3QueCArIHJlY3QudyxcbiAgICB5MTogcmVjdC55LFxuICAgIHgyOiByZWN0LnggKyByZWN0LncsXG4gICAgeTI6IHJlY3QueSArIHJlY3QuaFxuICB9LCB7XG4gICAgeDE6IHJlY3QueCArIHJlY3QudyxcbiAgICB5MTogcmVjdC55ICsgcmVjdC5oLFxuICAgIHgyOiByZWN0LngsXG4gICAgeTI6IHJlY3QueSArIHJlY3QuaFxuICB9LCB7XG4gICAgeDE6IHJlY3QueCxcbiAgICB5MTogcmVjdC55ICsgcmVjdC5oLFxuICAgIHgyOiByZWN0LngsXG4gICAgeTI6IHJlY3QueVxuICB9XSwgaW50ZXJzZWN0aW9ucyA9IFtdO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHJlY3RMaW5lcy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IGludGVyc2VjdGlvbiA9IHJheUludGVyc2VjdChsaW5lLCByZWN0TGluZXNbaV0pO1xuICAgIGlmIChpbnRlcnNlY3Rpb24pIHtcbiAgICAgIGxldCBpc0R1cGxpY2F0ZSA9ICExO1xuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBpbnRlcnNlY3Rpb25zLmxlbmd0aDsgaisrKVxuICAgICAgICBpbnRlcnNlY3Rpb25zW2pdLnggPT09IGludGVyc2VjdGlvbi54ICYmIGludGVyc2VjdGlvbnNbal0ueSA9PT0gaW50ZXJzZWN0aW9uLnkgJiYgKGlzRHVwbGljYXRlID0gITApO1xuICAgICAgaXNEdXBsaWNhdGUgfHwgaW50ZXJzZWN0aW9ucy5wdXNoKGludGVyc2VjdGlvbik7XG4gICAgfVxuICB9XG4gIHJldHVybiBpbnRlcnNlY3Rpb25zLmxlbmd0aCA9PT0gMCA/ICExIDogaW50ZXJzZWN0aW9ucy5zb3J0KChhLCBiKSA9PiBwb2ludERpc3QoYSwge1xuICAgIHg6IGxpbmUueDEsXG4gICAgeTogbGluZS55MVxuICB9KSAtIHBvaW50RGlzdChiLCB7XG4gICAgeDogbGluZS54MSxcbiAgICB5OiBsaW5lLnkxXG4gIH0pKTtcbn1cbmZ1bmN0aW9uIHBvaW50RGlzdChwMSwgcDIpIHtcbiAgY29uc3QgYSA9IHAxLnggLSBwMi54LCBiID0gcDEueSAtIHAyLnk7XG4gIHJldHVybiBNYXRoLnNxcnQoYSAqIGEgKyBiICogYik7XG59XG5mdW5jdGlvbiBwb2ludEluQm91bmRzKHBvaW50LCBib3VuZHMpIHtcbiAgY29uc3Qgd2l0aGluWCA9IHBvaW50LnggPj0gYm91bmRzLnggJiYgcG9pbnQueCA8PSBib3VuZHMueCArIGJvdW5kcy53LCB3aXRoaW5ZID0gcG9pbnQueSA+PSBib3VuZHMueSAmJiBwb2ludC55IDw9IGJvdW5kcy55ICsgYm91bmRzLmg7XG4gIHJldHVybiB3aXRoaW5YICYmIHdpdGhpblk7XG59XG5mdW5jdGlvbiBmaW5kQ2xvc2VzdEludGVyc2VjdGlvbihyYXksIHRhcmdldHMsIGZsb3cpIHtcbiAgY29uc3QgcmF5T3JpZ2luID0ge1xuICAgIHg6IHJheS54MSxcbiAgICB5OiByYXkueTFcbiAgfTtcbiAgaWYgKHRhcmdldHMuc29tZSgodCkgPT4gcG9pbnRJbkJvdW5kcyhyYXlPcmlnaW4sIG9mZnNldFJlY3QodCwgTWF0aC5taW4odC53LCB0LmgpIC8gMTAsIGZsb3cgPT09IFwiaG9yaXpvbnRhbFwiID8gXCJ4XCIgOiBcInlcIikpKSkgcmV0dXJuIG51bGw7XG4gIGxldCBjbG9zZXN0SW50ZXJzZWN0aW9uLCBjbG9zZXN0UmVjdDtcbiAgZm9yIChjb25zdCB0YXJnZXQgb2YgdGFyZ2V0cykge1xuICAgIGNvbnN0IGludGVyc2VjdGlvbnMgPSByYXlSZWN0SW50ZXJzZWN0aW9ucyhyYXksIG9mZnNldFJlY3QodGFyZ2V0LCBNYXRoLm1pbih0YXJnZXQudywgdGFyZ2V0LmgpIC8gMTAsIGZsb3cgPT09IFwiaG9yaXpvbnRhbFwiID8gXCJ4XCIgOiBcInlcIikpO1xuICAgIGlmIChpbnRlcnNlY3Rpb25zKSB7XG4gICAgICBjb25zdCBmaXJzdEludGVyc2VjdGlvbiA9IGludGVyc2VjdGlvbnNbMF07XG4gICAgICBjbG9zZXN0SW50ZXJzZWN0aW9uID8gcG9pbnREaXN0KHJheU9yaWdpbiwgZmlyc3RJbnRlcnNlY3Rpb24pIDwgcG9pbnREaXN0KHJheU9yaWdpbiwgY2xvc2VzdEludGVyc2VjdGlvbikgJiYgKGNsb3Nlc3RJbnRlcnNlY3Rpb24gPSBmaXJzdEludGVyc2VjdGlvbiwgY2xvc2VzdFJlY3QgPSB0YXJnZXQpIDogKGNsb3Nlc3RJbnRlcnNlY3Rpb24gPSBmaXJzdEludGVyc2VjdGlvbiwgY2xvc2VzdFJlY3QgPSB0YXJnZXQpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gY2xvc2VzdFJlY3QgfHwgbnVsbDtcbn1cbmZ1bmN0aW9uIHNjYWxlUmVjdChyZWN0LCBzY2FsZSwgb3JpZ2luKSB7XG4gIGNvbnN0IHtcbiAgICB4LFxuICAgIHksXG4gICAgdyxcbiAgICBoXG4gIH0gPSByZWN0LCB7XG4gICAgeDogb3JpZ2luWCxcbiAgICB5OiBvcmlnaW5ZXG4gIH0gPSBvcmlnaW4sIG5ld1ggPSBvcmlnaW5YICsgKHggLSBvcmlnaW5YKSAqIHNjYWxlLCBuZXdZID0gb3JpZ2luWSArICh5IC0gb3JpZ2luWSkgKiBzY2FsZSwgbmV3V2lkdGggPSB3ICogc2NhbGUsIG5ld0hlaWdodCA9IGggKiBzY2FsZTtcbiAgcmV0dXJuIHtcbiAgICB4OiBuZXdYLFxuICAgIHk6IG5ld1ksXG4gICAgdzogbmV3V2lkdGgsXG4gICAgaDogbmV3SGVpZ2h0XG4gIH07XG59XG5mdW5jdGlvbiBnZXRSZWN0R3JvdXBYRXh0ZW50KHJlY3RzKSB7XG4gIGNvbnN0IG1pbkdyb3VwWCA9IE1hdGgubWF4KDAsIE1hdGgubWluKC4uLnJlY3RzLm1hcCgocikgPT4gci54KSkpLCBtYXhHcm91cFggPSBNYXRoLm1pbihkb2N1bWVudC5ib2R5Lm9mZnNldFdpZHRoLCBNYXRoLm1heCguLi5yZWN0cy5tYXAoKHIpID0+IHIueCArIHIudykpKTtcbiAgcmV0dXJuIHtcbiAgICBtaW46IG1pbkdyb3VwWCxcbiAgICBtYXg6IG1heEdyb3VwWCxcbiAgICB3aWR0aDogbWF4R3JvdXBYIC0gbWluR3JvdXBYXG4gIH07XG59XG5mdW5jdGlvbiBnZXRSZWN0R3JvdXBZRXh0ZW50KHJlY3RzKSB7XG4gIGNvbnN0IG1pbkdyb3VwWSA9IE1hdGgubWF4KDAsIE1hdGgubWluKC4uLnJlY3RzLm1hcCgocikgPT4gci55KSkpLCBtYXhHcm91cFkgPSBNYXRoLm1pbihkb2N1bWVudC5ib2R5LnNjcm9sbEhlaWdodCwgTWF0aC5tYXgoLi4ucmVjdHMubWFwKChyKSA9PiByLnkgKyByLmgpKSk7XG4gIHJldHVybiB7XG4gICAgbWluOiBtaW5Hcm91cFksXG4gICAgbWF4OiBtYXhHcm91cFksXG4gICAgaGVpZ2h0OiBtYXhHcm91cFkgLSBtaW5Hcm91cFlcbiAgfTtcbn1cbmZ1bmN0aW9uIGNhbGNUYXJnZXRGbG93KHRhcmdldHMpIHtcbiAgcmV0dXJuIHRhcmdldHMuc29tZSgodDEpID0+IHRhcmdldHMuZmlsdGVyKCh0MikgPT4gIXJlY3RFcXVhbCh0MSwgdDIpKS5zb21lKCh0MikgPT4gdDEueSA9PT0gdDIueSkpID8gXCJob3Jpem9udGFsXCIgOiBcInZlcnRpY2FsXCI7XG59XG5mdW5jdGlvbiBjYWxjSW5zZXJ0UG9zaXRpb24ob3JpZ2luLCB0YXJnZXRzLCBmbG93KSB7XG4gIGlmIChmbG93ID09PSBcImhvcml6b250YWxcIikge1xuICAgIGNvbnN0IHJheUxlZnQgPSB7XG4gICAgICB4MTogb3JpZ2luLngsXG4gICAgICB5MTogb3JpZ2luLnksXG4gICAgICB4Mjogb3JpZ2luLnggLSAxZTgsXG4gICAgICB5Mjogb3JpZ2luLnlcbiAgICB9LCByYXlSaWdodCA9IHtcbiAgICAgIHgxOiBvcmlnaW4ueCxcbiAgICAgIHkxOiBvcmlnaW4ueSxcbiAgICAgIHgyOiBvcmlnaW4ueCArIDFlOCxcbiAgICAgIHkyOiBvcmlnaW4ueVxuICAgIH07XG4gICAgcmV0dXJuIHtcbiAgICAgIGxlZnQ6IGZpbmRDbG9zZXN0SW50ZXJzZWN0aW9uKHJheUxlZnQsIHRhcmdldHMsIGZsb3cpLFxuICAgICAgcmlnaHQ6IGZpbmRDbG9zZXN0SW50ZXJzZWN0aW9uKHJheVJpZ2h0LCB0YXJnZXRzLCBmbG93KVxuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgY29uc3QgcmF5VG9wID0ge1xuICAgICAgeDE6IG9yaWdpbi54LFxuICAgICAgeTE6IG9yaWdpbi55LFxuICAgICAgeDI6IG9yaWdpbi54LFxuICAgICAgeTI6IG9yaWdpbi55IC0gMWU4XG4gICAgfSwgcmF5Qm90dG9tID0ge1xuICAgICAgeDE6IG9yaWdpbi54LFxuICAgICAgeTE6IG9yaWdpbi55LFxuICAgICAgeDI6IG9yaWdpbi54LFxuICAgICAgeTI6IG9yaWdpbi55ICsgMWU4XG4gICAgfTtcbiAgICByZXR1cm4ge1xuICAgICAgdG9wOiBmaW5kQ2xvc2VzdEludGVyc2VjdGlvbihyYXlUb3AsIHRhcmdldHMsIGZsb3cpLFxuICAgICAgYm90dG9tOiBmaW5kQ2xvc2VzdEludGVyc2VjdGlvbihyYXlCb3R0b20sIHRhcmdldHMsIGZsb3cpXG4gICAgfTtcbiAgfVxufVxuZnVuY3Rpb24gZmluZFJlY3RTYW5pdHlEYXRhKHJlY3QsIG92ZXJsYXlHcm91cCkge1xuICByZXR1cm4gb3ZlcmxheUdyb3VwLmZpbmQoKGUpID0+IHJlY3RFcXVhbChnZXRSZWN0KGUuZWxlbWVudHMuZWxlbWVudCksIHJlY3QpKT8uc2FuaXR5O1xufVxuZnVuY3Rpb24gcmVzb2x2ZUluc2VydFBvc2l0aW9uKG92ZXJsYXlHcm91cCwgaW5zZXJ0UG9zaXRpb24sIGZsb3cpIHtcbiAgcmV0dXJuIE9iamVjdC52YWx1ZXMoaW5zZXJ0UG9zaXRpb24pLmV2ZXJ5KCh2KSA9PiB2ID09PSBudWxsKSA/IG51bGwgOiBmbG93ID09PSBcImhvcml6b250YWxcIiA/IHtcbiAgICBsZWZ0OiBpbnNlcnRQb3NpdGlvbi5sZWZ0ID8ge1xuICAgICAgcmVjdDogaW5zZXJ0UG9zaXRpb24ubGVmdCxcbiAgICAgIHNhbml0eTogZmluZFJlY3RTYW5pdHlEYXRhKGluc2VydFBvc2l0aW9uLmxlZnQsIG92ZXJsYXlHcm91cClcbiAgICB9IDogbnVsbCxcbiAgICByaWdodDogaW5zZXJ0UG9zaXRpb24ucmlnaHQgPyB7XG4gICAgICByZWN0OiBpbnNlcnRQb3NpdGlvbi5yaWdodCxcbiAgICAgIHNhbml0eTogZmluZFJlY3RTYW5pdHlEYXRhKGluc2VydFBvc2l0aW9uLnJpZ2h0LCBvdmVybGF5R3JvdXApXG4gICAgfSA6IG51bGxcbiAgfSA6IHtcbiAgICB0b3A6IGluc2VydFBvc2l0aW9uLnRvcCA/IHtcbiAgICAgIHJlY3Q6IGluc2VydFBvc2l0aW9uLnRvcCxcbiAgICAgIHNhbml0eTogZmluZFJlY3RTYW5pdHlEYXRhKGluc2VydFBvc2l0aW9uLnRvcCwgb3ZlcmxheUdyb3VwKVxuICAgIH0gOiBudWxsLFxuICAgIGJvdHRvbTogaW5zZXJ0UG9zaXRpb24uYm90dG9tID8ge1xuICAgICAgcmVjdDogaW5zZXJ0UG9zaXRpb24uYm90dG9tLFxuICAgICAgc2FuaXR5OiBmaW5kUmVjdFNhbml0eURhdGEoaW5zZXJ0UG9zaXRpb24uYm90dG9tLCBvdmVybGF5R3JvdXApXG4gICAgfSA6IG51bGxcbiAgfTtcbn1cbmZ1bmN0aW9uIGNhbGNNb3VzZVBvcyhlKSB7XG4gIGNvbnN0IGJvZHlCb3VuZHMgPSBkb2N1bWVudC5ib2R5LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICByZXR1cm4ge1xuICAgIHg6IE1hdGgubWF4KGJvZHlCb3VuZHMueCwgTWF0aC5taW4oZS5jbGllbnRYLCBib2R5Qm91bmRzLnggKyBib2R5Qm91bmRzLndpZHRoKSksXG4gICAgeTogZS5jbGllbnRZICsgd2luZG93LnNjcm9sbFlcbiAgfTtcbn1cbmZ1bmN0aW9uIGNhbGNNb3VzZVBvc0ludmVyc2VUcmFuc2Zvcm0obW91c2VQb3MyKSB7XG4gIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5ib2R5LCB0cmFuc2Zvcm0gPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShib2R5KS50cmFuc2Zvcm07XG4gIGlmICh0cmFuc2Zvcm0gPT09IFwibm9uZVwiKVxuICAgIHJldHVybiB7XG4gICAgICB4OiBtb3VzZVBvczIueCxcbiAgICAgIHk6IG1vdXNlUG9zMi55XG4gICAgfTtcbiAgY29uc3QgaW52ZXJzZU1hdHJpeCA9IG5ldyBET01NYXRyaXgodHJhbnNmb3JtKS5pbnZlcnNlKCksIHRyYW5zZm9ybWVkUG9pbnQgPSBuZXcgRE9NUG9pbnQobW91c2VQb3MyLngsIG1vdXNlUG9zMi55KS5tYXRyaXhUcmFuc2Zvcm0oaW52ZXJzZU1hdHJpeCk7XG4gIHJldHVybiB7XG4gICAgeDogdHJhbnNmb3JtZWRQb2ludC54LFxuICAgIHk6IHRyYW5zZm9ybWVkUG9pbnQueVxuICB9O1xufVxuZnVuY3Rpb24gYnVpbGRQcmV2aWV3U2tlbGV0b24obW91c2VQb3MyLCBlbGVtZW50LCBzY2FsZUZhY3Rvcikge1xuICBjb25zdCBib3VuZHMgPSBnZXRSZWN0KGVsZW1lbnQpLCBjaGlsZHJlbiA9IFsuLi5lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCI6d2hlcmUoaDEsIGgyLCBoMywgaDQsIHAsIGEsIGltZywgc3BhbiwgYnV0dG9uKTpub3QoOmhhcygqKSlcIildO1xuICBtb3VzZVBvczIueCA8PSBib3VuZHMueCAmJiAobW91c2VQb3MyLnggPSBib3VuZHMueCksIG1vdXNlUG9zMi54ID49IGJvdW5kcy54ICsgYm91bmRzLncgJiYgKG1vdXNlUG9zMi54ID0gYm91bmRzLnggKyBib3VuZHMudyksIG1vdXNlUG9zMi55ID49IGJvdW5kcy55ICsgYm91bmRzLmggJiYgKG1vdXNlUG9zMi55ID0gYm91bmRzLnkgKyBib3VuZHMuaCksIG1vdXNlUG9zMi55IDw9IGJvdW5kcy55ICYmIChtb3VzZVBvczIueSA9IGJvdW5kcy55KTtcbiAgY29uc3QgY2hpbGRSZWN0cyA9IGNoaWxkcmVuLm1hcCgoY2hpbGQpID0+IHtcbiAgICBjb25zdCByZWN0ID0gc2NhbGVSZWN0KGdldFJlY3QoY2hpbGQpLCBzY2FsZUZhY3Rvciwge1xuICAgICAgeDogYm91bmRzLngsXG4gICAgICB5OiBib3VuZHMueVxuICAgIH0pO1xuICAgIHJldHVybiB7XG4gICAgICB4OiByZWN0LnggLSBib3VuZHMueCxcbiAgICAgIHk6IHJlY3QueSAtIGJvdW5kcy55LFxuICAgICAgdzogcmVjdC53LFxuICAgICAgaDogcmVjdC5oLFxuICAgICAgdGFnTmFtZTogY2hpbGQudGFnTmFtZVxuICAgIH07XG4gIH0pO1xuICByZXR1cm4ge1xuICAgIG9mZnNldFg6IChib3VuZHMueCAtIG1vdXNlUG9zMi54KSAqIHNjYWxlRmFjdG9yLFxuICAgIG9mZnNldFk6IChib3VuZHMueSAtIG1vdXNlUG9zMi55KSAqIHNjYWxlRmFjdG9yLFxuICAgIHc6IGJvdW5kcy53ICogc2NhbGVGYWN0b3IsXG4gICAgaDogYm91bmRzLmggKiBzY2FsZUZhY3RvcixcbiAgICBtYXhXaWR0aDogYm91bmRzLncgKiBzY2FsZUZhY3RvciAqIDAuNzUsXG4gICAgY2hpbGRSZWN0c1xuICB9O1xufVxuY29uc3QgbWluRHJhZ0RlbHRhID0gNDtcbmFzeW5jIGZ1bmN0aW9uIGFwcGx5TWluaW1hcFdyYXBwZXJUcmFuc2Zvcm0odGFyZ2V0LCBzY2FsZUZhY3RvciwgbWluWVNjYWxlZCwgaGFuZGxlciwgcmVjdFVwZGF0ZUZyZXF1ZW5jeSkge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICB0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcihcInRyYW5zaXRpb25lbmRcIiwgKCkgPT4ge1xuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGhhbmRsZXIoe1xuICAgICAgICAgIHR5cGU6IFwib3ZlcmxheS9kcmFnRW5kTWluaW1hcFRyYW5zaXRpb25cIlxuICAgICAgICB9KTtcbiAgICAgIH0sIHJlY3RVcGRhdGVGcmVxdWVuY3kgKiAyKSwgcmVzb2x2ZSgpO1xuICAgIH0sIHtcbiAgICAgIG9uY2U6ICEwXG4gICAgfSksIGhhbmRsZXIoe1xuICAgICAgdHlwZTogXCJvdmVybGF5L2RyYWdTdGFydE1pbmltYXBUcmFuc2l0aW9uXCJcbiAgICB9KSwgaGFuZGxlcih7XG4gICAgICB0eXBlOiBcIm92ZXJsYXkvZHJhZ1RvZ2dsZU1pbmltYXBcIixcbiAgICAgIGRpc3BsYXk6ICEwXG4gICAgfSksIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSBcImhpZGRlblwiLCBkb2N1bWVudC5ib2R5LnN0eWxlLmhlaWdodCA9IFwiMTAwJVwiLCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUub3ZlcmZsb3cgPSBcImluaXRpYWxcIiwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLmhlaWdodCA9IFwiMTAwJVwiLCBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHRhcmdldC5zdHlsZS50cmFuc2Zvcm1PcmlnaW4gPSBcIjUwJSAwcHhcIiwgdGFyZ2V0LnN0eWxlLnRyYW5zaXRpb24gPSBcInRyYW5zZm9ybSAxNTBtcyBlYXNlXCIsIHRhcmdldC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlM2QoMHB4LCAkey1taW5ZU2NhbGVkICsgc2Nyb2xsWX1weCwgMHB4KSBzY2FsZSgke3NjYWxlRmFjdG9yfSlgO1xuICAgIH0sIDI1KTtcbiAgfSk7XG59XG5mdW5jdGlvbiBjYWxjTWluaW1hcFRyYW5zZm9ybVZhbHVlcyhyZWN0cywgZ3JvdXBIZWlnaHRPdmVycmlkZSkge1xuICBsZXQgZ3JvdXBIZWlnaHQgPSBncm91cEhlaWdodE92ZXJyaWRlIHx8IGdldFJlY3RHcm91cFlFeHRlbnQocmVjdHMpLmhlaWdodDtcbiAgY29uc3QgcGFkZGluZyA9IDEwMDtcbiAgZ3JvdXBIZWlnaHQgKz0gcGFkZGluZyAqIDI7XG4gIGNvbnN0IHNjYWxlRmFjdG9yID0gZ3JvdXBIZWlnaHQgPiB3aW5kb3cuaW5uZXJIZWlnaHQgPyB3aW5kb3cuaW5uZXJIZWlnaHQgLyBncm91cEhlaWdodCA6IDEsIHNjYWxlZFJlY3RzID0gcmVjdHMubWFwKChyKSA9PiBzY2FsZVJlY3Qociwgc2NhbGVGYWN0b3IsIHtcbiAgICB4OiB3aW5kb3cuaW5uZXJXaWR0aCAvIDIsXG4gICAgeTogMFxuICB9KSksIHtcbiAgICBtaW46IG1pbllTY2FsZWRcbiAgfSA9IGdldFJlY3RHcm91cFlFeHRlbnQoc2NhbGVkUmVjdHMpO1xuICByZXR1cm4ge1xuICAgIHNjYWxlRmFjdG9yLFxuICAgIG1pbllTY2FsZWQ6IG1pbllTY2FsZWQgLSBwYWRkaW5nICogc2NhbGVGYWN0b3JcbiAgfTtcbn1cbmZ1bmN0aW9uIGNhbGNHcm91cEJvdW5kc1ByZXZpZXcocmVjdHMpIHtcbiAgY29uc3QgZ3JvdXBCb3VuZHNYID0gZ2V0UmVjdEdyb3VwWEV4dGVudChyZWN0cyksIGdyb3VwQm91bmRzWSA9IGdldFJlY3RHcm91cFlFeHRlbnQocmVjdHMpLCBvZmZzZXREaXN0ID0gOCwgY2FuT2Zmc2V0WCA9IGdyb3VwQm91bmRzWC5taW4gPiBvZmZzZXREaXN0ICYmIGdyb3VwQm91bmRzWC5taW4gKyBncm91cEJvdW5kc1gud2lkdGggPD0gd2luZG93LmlubmVyV2lkdGggLSBvZmZzZXREaXN0LCBjYW5PZmZzZXRZID0gZ3JvdXBCb3VuZHNZLm1pbiA+IG9mZnNldERpc3QgJiYgZ3JvdXBCb3VuZHNZLm1pbiArIGdyb3VwQm91bmRzWS5oZWlnaHQgPD0gZG9jdW1lbnQuYm9keS5zY3JvbGxIZWlnaHQgLSBvZmZzZXREaXN0LCBjYW5PZmZzZXQgPSBjYW5PZmZzZXRYICYmIGNhbk9mZnNldFk7XG4gIHJldHVybiB7XG4gICAgeDogY2FuT2Zmc2V0ID8gZ3JvdXBCb3VuZHNYLm1pbiAtIG9mZnNldERpc3QgOiBncm91cEJvdW5kc1gubWluLFxuICAgIHk6IGNhbk9mZnNldCA/IGdyb3VwQm91bmRzWS5taW4gLSBvZmZzZXREaXN0IDogZ3JvdXBCb3VuZHNZLm1pbixcbiAgICB3OiBjYW5PZmZzZXQgPyBncm91cEJvdW5kc1gud2lkdGggKyBvZmZzZXREaXN0ICogMiA6IGdyb3VwQm91bmRzWC53aWR0aCxcbiAgICBoOiBjYW5PZmZzZXQgPyBncm91cEJvdW5kc1kuaGVpZ2h0ICsgb2Zmc2V0RGlzdCAqIDIgOiBncm91cEJvdW5kc1kuaGVpZ2h0XG4gIH07XG59XG5hc3luYyBmdW5jdGlvbiByZXNldE1pbmltYXBXcmFwcGVyVHJhbnNmb3JtKGVuZFlPcmlnaW4sIHRhcmdldCwgcHJlc2NhbGVIZWlnaHQyLCBoYW5kbGVyLCByZWN0VXBkYXRlRnJlcXVlbmN5LCBwcmV2aW91c1Jvb3RTdHlsZVZhbHVlczIpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgY29uc3QgdHJhbnNmb3JtID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodGFyZ2V0KS50cmFuc2Zvcm07XG4gICAgaWYgKG5ldyBET01NYXRyaXgodHJhbnNmb3JtKS5hID09PSAxKSByZXR1cm47XG4gICAgY29uc3QgbWF4U2Nyb2xsID0gcHJlc2NhbGVIZWlnaHQyIC0gd2luZG93LmlubmVySGVpZ2h0LCBwcmV2U2Nyb2xsWSA9IHNjcm9sbFk7XG4gICAgZW5kWU9yaWdpbiAtPSB3aW5kb3cuaW5uZXJIZWlnaHQgLyAyLCBlbmRZT3JpZ2luIDwgMCAmJiAoZW5kWU9yaWdpbiA9IDApLCB0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcihcInRyYW5zaXRpb25lbmRcIiwgKCkgPT4ge1xuICAgICAgdGFyZ2V0LnN0eWxlLnRyYW5zaXRpb24gPSBcIm5vbmVcIiwgdGFyZ2V0LnN0eWxlLnRyYW5zZm9ybSA9IFwibm9uZVwiLCBzY3JvbGxUbyh7XG4gICAgICAgIHRvcDogZW5kWU9yaWdpbixcbiAgICAgICAgYmVoYXZpb3I6IFwiaW5zdGFudFwiXG4gICAgICB9KSwgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGhhbmRsZXIoe1xuICAgICAgICAgIHR5cGU6IFwib3ZlcmxheS9kcmFnRW5kTWluaW1hcFRyYW5zaXRpb25cIlxuICAgICAgICB9KSwgaGFuZGxlcih7XG4gICAgICAgICAgdHlwZTogXCJvdmVybGF5L2RyYWdUb2dnbGVNaW5pbWFwXCIsXG4gICAgICAgICAgZGlzcGxheTogITFcbiAgICAgICAgfSk7XG4gICAgICB9LCByZWN0VXBkYXRlRnJlcXVlbmN5ICogMiksIHJlc29sdmUoKTtcbiAgICB9LCB7XG4gICAgICBvbmNlOiAhMFxuICAgIH0pLCBoYW5kbGVyKHtcbiAgICAgIHR5cGU6IFwib3ZlcmxheS9kcmFnU3RhcnRNaW5pbWFwVHJhbnNpdGlvblwiXG4gICAgfSksIHRhcmdldC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWSgke01hdGgubWF4KHByZXZTY3JvbGxZIC0gZW5kWU9yaWdpbiwgLW1heFNjcm9sbCArIHByZXZTY3JvbGxZKX1weCkgc2NhbGUoMSlgLCBwcmV2aW91c1Jvb3RTdHlsZVZhbHVlczIgJiYgKGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSBwcmV2aW91c1Jvb3RTdHlsZVZhbHVlczIuYm9keS5vdmVyZmxvdywgZG9jdW1lbnQuYm9keS5zdHlsZS5oZWlnaHQgPSBwcmV2aW91c1Jvb3RTdHlsZVZhbHVlczIuYm9keS5oZWlnaHQsIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5vdmVyZmxvdyA9IHByZXZpb3VzUm9vdFN0eWxlVmFsdWVzMi5kb2N1bWVudEVsZW1lbnQub3ZlcmZsb3csIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5oZWlnaHQgPSBwcmV2aW91c1Jvb3RTdHlsZVZhbHVlczIuZG9jdW1lbnRFbGVtZW50LmhlaWdodCk7XG4gIH0pO1xufVxubGV0IG1pbmltYXBTY2FsZUFwcGxpZWQgPSAhMSwgbW91c2VQb3NJbnZlcnNlVHJhbnNmb3JtID0ge1xuICB5OiAwXG59LCBtb3VzZVBvcyA9IHtcbiAgeDogMCxcbiAgeTogMFxufSwgcHJlc2NhbGVIZWlnaHQgPSB0eXBlb2YgZG9jdW1lbnQgPiBcInVcIiA/IDAgOiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsSGVpZ2h0LCBwcmV2aW91c1Jvb3RTdHlsZVZhbHVlcyA9IG51bGw7XG5mdW5jdGlvbiBoYW5kbGVPdmVybGF5RHJhZyhvcHRzKSB7XG4gIGNvbnN0IHtcbiAgICBtb3VzZUV2ZW50LFxuICAgIGVsZW1lbnQsXG4gICAgb3ZlcmxheUdyb3VwLFxuICAgIGhhbmRsZXIsXG4gICAgdGFyZ2V0LFxuICAgIG9uU2VxdWVuY2VTdGFydCxcbiAgICBvblNlcXVlbmNlRW5kXG4gIH0gPSBvcHRzO1xuICBpZiAobW91c2VFdmVudC5idXR0b24gIT09IDApIHJldHVybjtcbiAgd2luZG93LmZvY3VzKCk7XG4gIGNvbnN0IHJlY3RVcGRhdGVGcmVxdWVuY3kgPSAxNTA7XG4gIGxldCByZWN0cyA9IG92ZXJsYXlHcm91cC5tYXAoKGUpID0+IGdldFJlY3QoZS5lbGVtZW50cy5lbGVtZW50KSk7XG4gIGNvbnN0IGZsb3cgPSBlbGVtZW50LmdldEF0dHJpYnV0ZShcImRhdGEtc2FuaXR5LWRyYWctZmxvd1wiKSB8fCBjYWxjVGFyZ2V0RmxvdyhyZWN0cyksIGRyYWdHcm91cCA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS1zYW5pdHktZHJhZy1ncm91cFwiKSwgZGlzYWJsZU1pbmltYXAgPSAhIWVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS1zYW5pdHktZHJhZy1taW5pbWFwLWRpc2FibGVcIiksIHByZXZlbnRJbnNlcnREZWZhdWx0ID0gISFlbGVtZW50LmdldEF0dHJpYnV0ZShcImRhdGEtc2FuaXR5LWRyYWctcHJldmVudC1kZWZhdWx0XCIpLCBkb2N1bWVudEhlaWdodE92ZXJyaWRlID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXVuc3RhYmxlX3Nhbml0eS1kcmFnLWRvY3VtZW50LWhlaWdodFwiKSwgZ3JvdXBIZWlnaHRPdmVycmlkZSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS11bnN0YWJsZV9zYW5pdHktZHJhZy1ncm91cC1oZWlnaHRcIik7XG4gIGxldCBpbnNlcnRQb3NpdGlvbiA9IG51bGw7XG4gIGNvbnN0IGluaXRpYWxNb3VzZVBvcyA9IGNhbGNNb3VzZVBvcyhtb3VzZUV2ZW50KSwgc2NhbGVUYXJnZXQgPSBkb2N1bWVudC5ib2R5LCB7XG4gICAgbWluWVNjYWxlZCxcbiAgICBzY2FsZUZhY3RvclxuICB9ID0gY2FsY01pbmltYXBUcmFuc2Zvcm1WYWx1ZXMocmVjdHMsIGdyb3VwSGVpZ2h0T3ZlcnJpZGUgPyB+fmdyb3VwSGVpZ2h0T3ZlcnJpZGUgOiBudWxsKTtcbiAgbGV0IHNlcXVlbmNlU3RhcnRlZCA9ICExLCBtaW5pbWFwUHJvbXB0U2hvd24gPSAhMSwgbW91c2Vkb3duID0gITA7XG4gIG1pbmltYXBTY2FsZUFwcGxpZWQgfHwgKHByZXZpb3VzUm9vdFN0eWxlVmFsdWVzID0ge1xuICAgIGJvZHk6IHtcbiAgICAgIG92ZXJmbG93OiB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5vdmVyZmxvdyxcbiAgICAgIGhlaWdodDogd2luZG93LmdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuaGVpZ2h0XG4gICAgfSxcbiAgICBkb2N1bWVudEVsZW1lbnQ6IHtcbiAgICAgIG92ZXJmbG93OiB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpLm92ZXJmbG93LFxuICAgICAgaGVpZ2h0OiB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpLmhlaWdodFxuICAgIH1cbiAgfSwgcHJlc2NhbGVIZWlnaHQgPSBkb2N1bWVudEhlaWdodE92ZXJyaWRlID8gfn5kb2N1bWVudEhlaWdodE92ZXJyaWRlIDogZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbEhlaWdodCk7XG4gIGNvbnN0IHJlY3RzSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgcmVjdHMgPSBvdmVybGF5R3JvdXAubWFwKChlKSA9PiBnZXRSZWN0KGUuZWxlbWVudHMuZWxlbWVudCkpO1xuICB9LCByZWN0VXBkYXRlRnJlcXVlbmN5KSwgYXBwbHlNaW5pbWFwID0gKCkgPT4ge1xuICAgIGlmIChzY2FsZUZhY3RvciA+PSAxKSByZXR1cm47XG4gICAgY29uc3Qgc2tlbGV0b24gPSBidWlsZFByZXZpZXdTa2VsZXRvbihtb3VzZVBvcywgZWxlbWVudCwgc2NhbGVGYWN0b3IpO1xuICAgIGhhbmRsZXIoe1xuICAgICAgdHlwZTogXCJvdmVybGF5L2RyYWdVcGRhdGVTa2VsZXRvblwiLFxuICAgICAgc2tlbGV0b25cbiAgICB9KSwgaGFuZGxlcih7XG4gICAgICB0eXBlOiBcIm92ZXJsYXkvZHJhZ1RvZ2dsZU1pbmltYXBQcm9tcHRcIixcbiAgICAgIGRpc3BsYXk6ICExXG4gICAgfSksIGFwcGx5TWluaW1hcFdyYXBwZXJUcmFuc2Zvcm0oc2NhbGVUYXJnZXQsIHNjYWxlRmFjdG9yLCBtaW5ZU2NhbGVkLCBoYW5kbGVyLCByZWN0VXBkYXRlRnJlcXVlbmN5KS50aGVuKCgpID0+IHtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBoYW5kbGVyKHtcbiAgICAgICAgICB0eXBlOiBcIm92ZXJsYXkvZHJhZ1VwZGF0ZUdyb3VwUmVjdFwiLFxuICAgICAgICAgIGdyb3VwUmVjdDogY2FsY0dyb3VwQm91bmRzUHJldmlldyhyZWN0cylcbiAgICAgICAgfSk7XG4gICAgICB9LCByZWN0VXBkYXRlRnJlcXVlbmN5ICogMik7XG4gICAgfSk7XG4gIH0sIGhhbmRsZVNjcm9sbCA9IChlKSA9PiB7XG4gICAgTWF0aC5hYnMoZS5kZWx0YVkpID49IDEwICYmIHNjYWxlRmFjdG9yIDwgMSAmJiAhbWluaW1hcFNjYWxlQXBwbGllZCAmJiAhbWluaW1hcFByb21wdFNob3duICYmICFkaXNhYmxlTWluaW1hcCAmJiBtb3VzZWRvd24gJiYgKGhhbmRsZXIoe1xuICAgICAgdHlwZTogXCJvdmVybGF5L2RyYWdUb2dnbGVNaW5pbWFwUHJvbXB0XCIsXG4gICAgICBkaXNwbGF5OiAhMFxuICAgIH0pLCBtaW5pbWFwUHJvbXB0U2hvd24gPSAhMCksIGUuc2hpZnRLZXkgJiYgIW1pbmltYXBTY2FsZUFwcGxpZWQgJiYgIWRpc2FibGVNaW5pbWFwICYmICh3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoXCJ1bnN0YWJsZV9zYW5pdHkvZHJhZ0FwcGx5TWluaW1hcFwiKSksIG1pbmltYXBTY2FsZUFwcGxpZWQgPSAhMCwgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBhcHBseU1pbmltYXAoKTtcbiAgICB9LCA1MCkpO1xuICB9LCBoYW5kbGVNb3VzZU1vdmUgPSAoZSkgPT4ge1xuICAgIGlmIChlLnByZXZlbnREZWZhdWx0KCksIG1vdXNlUG9zID0gY2FsY01vdXNlUG9zKGUpLCBtb3VzZVBvc0ludmVyc2VUcmFuc2Zvcm0gPSBjYWxjTW91c2VQb3NJbnZlcnNlVHJhbnNmb3JtKG1vdXNlUG9zKSwgTWF0aC5hYnMocG9pbnREaXN0KG1vdXNlUG9zLCBpbml0aWFsTW91c2VQb3MpKSA8IG1pbkRyYWdEZWx0YSkgcmV0dXJuO1xuICAgIGlmICghc2VxdWVuY2VTdGFydGVkKSB7XG4gICAgICBjb25zdCBncm91cFJlY3QgPSBjYWxjR3JvdXBCb3VuZHNQcmV2aWV3KHJlY3RzKSwgc2tlbGV0b24gPSBidWlsZFByZXZpZXdTa2VsZXRvbihtb3VzZVBvcywgZWxlbWVudCwgMSk7XG4gICAgICBoYW5kbGVyKHtcbiAgICAgICAgdHlwZTogXCJvdmVybGF5L2RyYWdTdGFydFwiLFxuICAgICAgICBmbG93XG4gICAgICB9KSwgaGFuZGxlcih7XG4gICAgICAgIHR5cGU6IFwib3ZlcmxheS9kcmFnVXBkYXRlU2tlbGV0b25cIixcbiAgICAgICAgc2tlbGV0b25cbiAgICAgIH0pLCBoYW5kbGVyKHtcbiAgICAgICAgdHlwZTogXCJvdmVybGF5L2RyYWdVcGRhdGVHcm91cFJlY3RcIixcbiAgICAgICAgZ3JvdXBSZWN0XG4gICAgICB9KSwgc2VxdWVuY2VTdGFydGVkID0gITAsIG9uU2VxdWVuY2VTdGFydCgpO1xuICAgIH1cbiAgICBoYW5kbGVyKHtcbiAgICAgIHR5cGU6IFwib3ZlcmxheS9kcmFnVXBkYXRlQ3Vyc29yUG9zaXRpb25cIixcbiAgICAgIHg6IG1vdXNlUG9zLngsXG4gICAgICB5OiBtb3VzZVBvcy55XG4gICAgfSksIGUuc2hpZnRLZXkgJiYgIW1pbmltYXBTY2FsZUFwcGxpZWQgJiYgIWRpc2FibGVNaW5pbWFwICYmICh3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoXCJ1bnN0YWJsZV9zYW5pdHkvZHJhZ0FwcGx5TWluaW1hcFwiKSksIG1pbmltYXBTY2FsZUFwcGxpZWQgPSAhMCwgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBhcHBseU1pbmltYXAoKTtcbiAgICB9LCA1MCkpO1xuICAgIGNvbnN0IG5ld0luc2VydFBvc2l0aW9uID0gY2FsY0luc2VydFBvc2l0aW9uKG1vdXNlUG9zLCByZWN0cywgZmxvdyk7XG4gICAgSlNPTi5zdHJpbmdpZnkoaW5zZXJ0UG9zaXRpb24pICE9PSBKU09OLnN0cmluZ2lmeShuZXdJbnNlcnRQb3NpdGlvbikgJiYgKGluc2VydFBvc2l0aW9uID0gbmV3SW5zZXJ0UG9zaXRpb24sIGhhbmRsZXIoe1xuICAgICAgdHlwZTogXCJvdmVybGF5L2RyYWdVcGRhdGVJbnNlcnRQb3NpdGlvblwiLFxuICAgICAgaW5zZXJ0UG9zaXRpb246IHJlc29sdmVJbnNlcnRQb3NpdGlvbihvdmVybGF5R3JvdXAsIGluc2VydFBvc2l0aW9uLCBmbG93KVxuICAgIH0pKTtcbiAgfSwgaGFuZGxlTW91c2VVcCA9ICgpID0+IHtcbiAgICBtb3VzZWRvd24gPSAhMSwgaGFuZGxlcih7XG4gICAgICB0eXBlOiBcIm92ZXJsYXkvZHJhZ0VuZFwiLFxuICAgICAgdGFyZ2V0LFxuICAgICAgaW5zZXJ0UG9zaXRpb246IGluc2VydFBvc2l0aW9uID8gcmVzb2x2ZUluc2VydFBvc2l0aW9uKG92ZXJsYXlHcm91cCwgaW5zZXJ0UG9zaXRpb24sIGZsb3cpIDogbnVsbCxcbiAgICAgIGRyYWdHcm91cCxcbiAgICAgIGZsb3csXG4gICAgICBwcmV2ZW50SW5zZXJ0RGVmYXVsdFxuICAgIH0pLCBtaW5pbWFwUHJvbXB0U2hvd24gJiYgaGFuZGxlcih7XG4gICAgICB0eXBlOiBcIm92ZXJsYXkvZHJhZ1RvZ2dsZU1pbmltYXBQcm9tcHRcIixcbiAgICAgIGRpc3BsYXk6ICExXG4gICAgfSksIG1pbmltYXBTY2FsZUFwcGxpZWQgfHwgKGNsZWFySW50ZXJ2YWwocmVjdHNJbnRlcnZhbCksIG9uU2VxdWVuY2VFbmQoKSwgcmVtb3ZlRnJhbWVMaXN0ZW5lcnMoKSwgcmVtb3ZlS2V5TGlzdGVuZXJzKCkpLCByZW1vdmVNb3VzZUxpc3RlbmVycygpO1xuICB9LCBoYW5kbGVLZXl1cCA9IChlKSA9PiB7XG4gICAgaWYgKGUua2V5ID09PSBcIlNoaWZ0XCIgJiYgbWluaW1hcFNjYWxlQXBwbGllZCkge1xuICAgICAgbWluaW1hcFNjYWxlQXBwbGllZCA9ICExO1xuICAgICAgY29uc3Qgc2tlbGV0b24gPSBidWlsZFByZXZpZXdTa2VsZXRvbihtb3VzZVBvcywgZWxlbWVudCwgMSAvIHNjYWxlRmFjdG9yKTtcbiAgICAgIGhhbmRsZXIoe1xuICAgICAgICB0eXBlOiBcIm92ZXJsYXkvZHJhZ1VwZGF0ZVNrZWxldG9uXCIsXG4gICAgICAgIHNrZWxldG9uXG4gICAgICB9KSwgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KFwidW5zdGFibGVfc2FuaXR5L2RyYWdSZXNldE1pbmltYXBcIikpLCBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgcmVzZXRNaW5pbWFwV3JhcHBlclRyYW5zZm9ybShtb3VzZVBvc0ludmVyc2VUcmFuc2Zvcm0ueSwgc2NhbGVUYXJnZXQsIHByZXNjYWxlSGVpZ2h0LCBoYW5kbGVyLCByZWN0VXBkYXRlRnJlcXVlbmN5LCBwcmV2aW91c1Jvb3RTdHlsZVZhbHVlcyk7XG4gICAgICB9LCA1MCksIGhhbmRsZXIoe1xuICAgICAgICB0eXBlOiBcIm92ZXJsYXkvZHJhZ1VwZGF0ZUdyb3VwUmVjdFwiLFxuICAgICAgICBncm91cFJlY3Q6IG51bGxcbiAgICAgIH0pLCBtb3VzZWRvd24gfHwgKGNsZWFySW50ZXJ2YWwocmVjdHNJbnRlcnZhbCksIHJlbW92ZU1vdXNlTGlzdGVuZXJzKCksIHJlbW92ZUZyYW1lTGlzdGVuZXJzKCksIHJlbW92ZUtleUxpc3RlbmVycygpLCBvblNlcXVlbmNlRW5kKCkpO1xuICAgIH1cbiAgfSwgaGFuZGxlQmx1ciA9ICgpID0+IHtcbiAgICBoYW5kbGVyKHtcbiAgICAgIHR5cGU6IFwib3ZlcmxheS9kcmFnVXBkYXRlR3JvdXBSZWN0XCIsXG4gICAgICBncm91cFJlY3Q6IG51bGxcbiAgICB9KSwgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KFwidW5zdGFibGVfc2FuaXR5L2RyYWdSZXNldE1pbmltYXBcIikpLCBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHJlc2V0TWluaW1hcFdyYXBwZXJUcmFuc2Zvcm0obW91c2VQb3NJbnZlcnNlVHJhbnNmb3JtLnksIHNjYWxlVGFyZ2V0LCBwcmVzY2FsZUhlaWdodCwgaGFuZGxlciwgcmVjdFVwZGF0ZUZyZXF1ZW5jeSwgcHJldmlvdXNSb290U3R5bGVWYWx1ZXMpLnRoZW4oKCkgPT4ge1xuICAgICAgICBtaW5pbWFwU2NhbGVBcHBsaWVkID0gITE7XG4gICAgICB9KTtcbiAgICB9LCA1MCksIGNsZWFySW50ZXJ2YWwocmVjdHNJbnRlcnZhbCksIHJlbW92ZU1vdXNlTGlzdGVuZXJzKCksIHJlbW92ZUZyYW1lTGlzdGVuZXJzKCksIHJlbW92ZUtleUxpc3RlbmVycygpLCBvblNlcXVlbmNlRW5kKCk7XG4gIH0sIHJlbW92ZU1vdXNlTGlzdGVuZXJzID0gKCkgPT4ge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIGhhbmRsZU1vdXNlTW92ZSksIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwid2hlZWxcIiwgaGFuZGxlU2Nyb2xsKSwgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIGhhbmRsZU1vdXNlVXApO1xuICB9LCByZW1vdmVLZXlMaXN0ZW5lcnMgPSAoKSA9PiB7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCBoYW5kbGVLZXl1cCk7XG4gIH0sIHJlbW92ZUZyYW1lTGlzdGVuZXJzID0gKCkgPT4ge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwiYmx1clwiLCBoYW5kbGVCbHVyKTtcbiAgfTtcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIGhhbmRsZUJsdXIpLCB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIGhhbmRsZUtleXVwKSwgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJ3aGVlbFwiLCBoYW5kbGVTY3JvbGwpLCB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBoYW5kbGVNb3VzZU1vdmUpLCB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgaGFuZGxlTW91c2VVcCk7XG59XG5jb25zdCBpc0VsZW1lbnROb2RlJDEgPSAodGFyZ2V0KSA9PiB0YXJnZXQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCB8fCB0YXJnZXQgaW5zdGFuY2VvZiBTVkdFbGVtZW50O1xuZnVuY3Rpb24gZmluZE5vbklubGluZUVsZW1lbnQoZWxlbWVudCkge1xuICBjb25zdCB7XG4gICAgZGlzcGxheVxuICB9ID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWxlbWVudCk7XG4gIGlmIChkaXNwbGF5ICE9PSBcImlubGluZVwiKSByZXR1cm4gZWxlbWVudDtcbiAgY29uc3QgcGFyZW50ID0gZWxlbWVudC5wYXJlbnRFbGVtZW50O1xuICByZXR1cm4gcGFyZW50ID8gZmluZE5vbklubGluZUVsZW1lbnQocGFyZW50KSA6IG51bGw7XG59XG5jb25zdCBmaW5kT3ZlcmxheUVsZW1lbnQgPSAoZWwpID0+ICFlbCB8fCAhaXNFbGVtZW50Tm9kZSQxKGVsKSA/IG51bGwgOiBlbC5kYXRhc2V0Py5zYW5pdHlPdmVybGF5RWxlbWVudCA/IGVsIDogZmluZE92ZXJsYXlFbGVtZW50KGVsLnBhcmVudEVsZW1lbnQpO1xuZnVuY3Rpb24gdGVzdFZlcmNlbFN0ZWdhUmVnZXgoaW5wdXQpIHtcbiAgcmV0dXJuIFZFUkNFTF9TVEVHQV9SRUdFWC5sYXN0SW5kZXggPSAwLCBWRVJDRUxfU1RFR0FfUkVHRVgudGVzdChpbnB1dCk7XG59XG5mdW5jdGlvbiBkZWNvZGVTdGVnYShzdHIsIGlzQWx0VGV4dCA9ICExKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgZGVjb2RlZCA9IHZlcmNlbFN0ZWdhRGVjb2RlKHN0cik7XG4gICAgcmV0dXJuICFkZWNvZGVkIHx8IGRlY29kZWQub3JpZ2luICE9PSBcInNhbml0eS5pb1wiID8gbnVsbCA6IChpc0FsdFRleHQgJiYgKGRlY29kZWQuaHJlZiA9IGRlY29kZWQuaHJlZj8ucmVwbGFjZShcIi5hbHRcIiwgXCJcIikpLCBkZWNvZGVkKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgcmV0dXJuIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gZGVjb2RlIHN0ZWdhIGZvciBzdHJpbmc6IFwiLCBzdHIsIFwid2l0aCB0aGUgb3JpZ2luYWwgZXJyb3I6IFwiLCBlcnIpLCBudWxsO1xuICB9XG59XG5mdW5jdGlvbiB0ZXN0QW5kRGVjb2RlU3RlZ2Eoc3RyLCBpc0FsdFRleHQgPSAhMSkge1xuICByZXR1cm4gdGVzdFZlcmNlbFN0ZWdhUmVnZXgoc3RyKSA/IGRlY29kZVN0ZWdhKHN0ciwgaXNBbHRUZXh0KSA6IG51bGw7XG59XG5jb25zdCBpc0VsZW1lbnROb2RlID0gKG5vZGUpID0+IG5vZGUubm9kZVR5cGUgPT09IE5vZGUuRUxFTUVOVF9OT0RFLCBpc0ltZ0VsZW1lbnQgPSAoZWwpID0+IGVsLnRhZ05hbWUgPT09IFwiSU1HXCIsIGlzVGltZUVsZW1lbnQgPSAoZWwpID0+IGVsLnRhZ05hbWUgPT09IFwiVElNRVwiLCBpc1N2Z1Jvb3RFbGVtZW50ID0gKGVsKSA9PiBlbC50YWdOYW1lLnRvVXBwZXJDYXNlKCkgPT09IFwiU1ZHXCI7XG5mdW5jdGlvbiBpc1Nhbml0eU5vZGUobm9kZSkge1xuICByZXR1cm4gXCJwYXRoXCIgaW4gbm9kZTtcbn1cbmZ1bmN0aW9uIGZpbmRDb21tb25QYXRoKGZpcnN0LCBzZWNvbmQpIHtcbiAgbGV0IGZpcnN0UGFydHMgPSBmaXJzdC5zcGxpdChcIi5cIiksIHNlY29uZFBhcnRzID0gc2Vjb25kLnNwbGl0KFwiLlwiKTtcbiAgY29uc3QgbWF4TGVuZ3RoID0gTWF0aC5taW4oZmlyc3RQYXJ0cy5sZW5ndGgsIHNlY29uZFBhcnRzLmxlbmd0aCk7XG4gIHJldHVybiBmaXJzdFBhcnRzID0gZmlyc3RQYXJ0cy5zbGljZSgwLCBtYXhMZW5ndGgpLnJldmVyc2UoKSwgc2Vjb25kUGFydHMgPSBzZWNvbmRQYXJ0cy5zbGljZSgwLCBtYXhMZW5ndGgpLnJldmVyc2UoKSwgZmlyc3RQYXJ0cy5yZWR1Y2UoKHBhcnRzLCBwYXJ0LCBpKSA9PiBwYXJ0ID09PSBzZWNvbmRQYXJ0c1tpXSA/IFsuLi5wYXJ0cywgcGFydF0gOiBbXSwgW10pLnJldmVyc2UoKS5qb2luKFwiLlwiKTtcbn1cbmZ1bmN0aW9uIGZpbmRDb21tb25TYW5pdHlEYXRhKG5vZGVzKSB7XG4gIGlmICghbm9kZXMubGVuZ3RoIHx8ICFub2Rlcy5tYXAoKG4pID0+IGlzU2FuaXR5Tm9kZShuKSkuZXZlcnkoKG4sIF9pLCBhcnIpID0+IG4gPT09IGFyclswXSkpXG4gICAgcmV0dXJuO1xuICBpZiAoIWlzU2FuaXR5Tm9kZShub2Rlc1swXSkpIHJldHVybiBub2Rlc1swXTtcbiAgY29uc3Qgc2FuaXR5Tm9kZXMgPSBub2Rlcy5maWx0ZXIoaXNTYW5pdHlOb2RlKTtcbiAgbGV0IGNvbW1vbiA9IG5vZGVzWzBdO1xuICBjb25zdCBjb25zaXN0ZW50VmFsdWVLZXlzID0gW1wicHJvamVjdElkXCIsIFwiZGF0YXNldFwiLCBcImlkXCIsIFwiYmFzZVVybFwiLCBcIndvcmtzcGFjZVwiLCBcInRvb2xcIl07XG4gIGZvciAobGV0IGkgPSAxOyBpIDwgc2FuaXR5Tm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBub2RlID0gc2FuaXR5Tm9kZXNbaV07XG4gICAgaWYgKGNvbnNpc3RlbnRWYWx1ZUtleXMuc29tZSgoa2V5KSA9PiBub2RlW2tleV0gIT09IGNvbW1vbj8uW2tleV0pKSB7XG4gICAgICBjb21tb24gPSB2b2lkIDA7XG4gICAgICBicmVhaztcbiAgICB9XG4gICAgY29tbW9uLnBhdGggPSBmaW5kQ29tbW9uUGF0aChjb21tb24ucGF0aCwgbm9kZS5wYXRoKTtcbiAgfVxuICByZXR1cm4gY29tbW9uO1xufVxuZnVuY3Rpb24gZmluZFNhbml0eU5vZGVzKGVsKSB7XG4gIGNvbnN0IGVsZW1lbnRzID0gW107XG4gIGZ1bmN0aW9uIGFkZEVsZW1lbnQoZWxlbWVudCwgZGF0YSkge1xuICAgIGNvbnN0IHNhbml0eSA9IGRlY29kZVNhbml0eU5vZGVEYXRhKGRhdGEpO1xuICAgIGlmICghc2FuaXR5KVxuICAgICAgcmV0dXJuO1xuICAgIGNvbnN0IG1lYXN1cmVFbGVtZW50ID0gZmluZE5vbklubGluZUVsZW1lbnQoZWxlbWVudCk7XG4gICAgbWVhc3VyZUVsZW1lbnQgJiYgZWxlbWVudHMucHVzaCh7XG4gICAgICBlbGVtZW50czoge1xuICAgICAgICBlbGVtZW50LFxuICAgICAgICBtZWFzdXJlRWxlbWVudFxuICAgICAgfSxcbiAgICAgIHNhbml0eVxuICAgIH0pO1xuICB9XG4gIGlmIChlbClcbiAgICBmb3IgKGNvbnN0IG5vZGUgb2YgZWwuY2hpbGROb2Rlcykge1xuICAgICAgY29uc3Qge1xuICAgICAgICBub2RlVHlwZSxcbiAgICAgICAgcGFyZW50RWxlbWVudCxcbiAgICAgICAgdGV4dENvbnRlbnRcbiAgICAgIH0gPSBub2RlO1xuICAgICAgaWYgKGlzRWxlbWVudE5vZGUobm9kZSkgJiYgbm9kZS5kYXRhc2V0Py5zYW5pdHlFZGl0VGFyZ2V0ICE9PSB2b2lkIDApIHtcbiAgICAgICAgY29uc3Qgbm9kZXNJblRhcmdldCA9IGZpbmRTYW5pdHlOb2Rlcyhub2RlKS5tYXAoKHtcbiAgICAgICAgICBzYW5pdHlcbiAgICAgICAgfSkgPT4gc2FuaXR5KTtcbiAgICAgICAgaWYgKCFub2Rlc0luVGFyZ2V0Lm1hcCgobikgPT4gaXNTYW5pdHlOb2RlKG4pKS5ldmVyeSgobiwgX2ksIGFycikgPT4gbiA9PT0gYXJyWzBdKSlcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgY29uc3QgY29tbW9uRGF0YSA9IGZpbmRDb21tb25TYW5pdHlEYXRhKG5vZGVzSW5UYXJnZXQpO1xuICAgICAgICBjb21tb25EYXRhICYmIGVsZW1lbnRzLnB1c2goe1xuICAgICAgICAgIGVsZW1lbnRzOiB7XG4gICAgICAgICAgICBlbGVtZW50OiBub2RlLFxuICAgICAgICAgICAgbWVhc3VyZUVsZW1lbnQ6IG5vZGVcbiAgICAgICAgICB9LFxuICAgICAgICAgIHNhbml0eTogY29tbW9uRGF0YVxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAobm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFICYmIHBhcmVudEVsZW1lbnQgJiYgdGV4dENvbnRlbnQpIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IHRlc3RBbmREZWNvZGVTdGVnYSh0ZXh0Q29udGVudCk7XG4gICAgICAgIGlmICghZGF0YSkgY29udGludWU7XG4gICAgICAgIGFkZEVsZW1lbnQocGFyZW50RWxlbWVudCwgZGF0YSk7XG4gICAgICB9IGVsc2UgaWYgKGlzRWxlbWVudE5vZGUobm9kZSkpIHtcbiAgICAgICAgaWYgKG5vZGUudGFnTmFtZSA9PT0gXCJTQ1JJUFRcIiB8fCBub2RlLnRhZ05hbWUgPT09IFwiU0FOSVRZLVZJU1VBTC1FRElUSU5HXCIpXG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIGlmIChub2RlLmRhdGFzZXQ/LnNhbml0eSlcbiAgICAgICAgICBhZGRFbGVtZW50KG5vZGUsIG5vZGUuZGF0YXNldC5zYW5pdHkpO1xuICAgICAgICBlbHNlIGlmIChub2RlLmRhdGFzZXQ/LnNhbml0eUVkaXRJbmZvKVxuICAgICAgICAgIGFkZEVsZW1lbnQobm9kZSwgbm9kZS5kYXRhc2V0LnNhbml0eUVkaXRJbmZvKTtcbiAgICAgICAgZWxzZSBpZiAoaXNJbWdFbGVtZW50KG5vZGUpKSB7XG4gICAgICAgICAgY29uc3QgZGF0YSA9IHRlc3RBbmREZWNvZGVTdGVnYShub2RlLmFsdCwgITApO1xuICAgICAgICAgIGlmICghZGF0YSkgY29udGludWU7XG4gICAgICAgICAgYWRkRWxlbWVudChub2RlLCBkYXRhKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfSBlbHNlIGlmIChpc1RpbWVFbGVtZW50KG5vZGUpKSB7XG4gICAgICAgICAgY29uc3QgZGF0YSA9IHRlc3RBbmREZWNvZGVTdGVnYShub2RlLmRhdGVUaW1lLCAhMCk7XG4gICAgICAgICAgaWYgKCFkYXRhKSBjb250aW51ZTtcbiAgICAgICAgICBhZGRFbGVtZW50KG5vZGUsIGRhdGEpO1xuICAgICAgICB9IGVsc2UgaWYgKGlzU3ZnUm9vdEVsZW1lbnQobm9kZSkpIHtcbiAgICAgICAgICBpZiAoIW5vZGUuYXJpYUxhYmVsKSBjb250aW51ZTtcbiAgICAgICAgICBjb25zdCBkYXRhID0gdGVzdEFuZERlY29kZVN0ZWdhKG5vZGUuYXJpYUxhYmVsLCAhMCk7XG4gICAgICAgICAgaWYgKCFkYXRhKSBjb250aW51ZTtcbiAgICAgICAgICBhZGRFbGVtZW50KG5vZGUsIGRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIGVsZW1lbnRzLnB1c2goLi4uZmluZFNhbml0eU5vZGVzKG5vZGUpKTtcbiAgICAgIH1cbiAgICB9XG4gIHJldHVybiBlbGVtZW50cztcbn1cbmZ1bmN0aW9uIGlzU2FuaXR5QXJyYXlQYXRoKHBhdGgpIHtcbiAgY29uc3QgbGFzdERvdEluZGV4ID0gcGF0aC5sYXN0SW5kZXhPZihcIi5cIik7XG4gIHJldHVybiBwYXRoLnN1YnN0cmluZyhsYXN0RG90SW5kZXgsIHBhdGgubGVuZ3RoKS5pbmNsdWRlcyhcIltcIik7XG59XG5mdW5jdGlvbiBnZXRTYW5pdHlOb2RlQXJyYXlQYXRoKHBhdGgpIHtcbiAgaWYgKCFpc1Nhbml0eUFycmF5UGF0aChwYXRoKSkgcmV0dXJuIG51bGw7XG4gIGNvbnN0IHNwbGl0ID0gcGF0aC5zcGxpdChcIi5cIik7XG4gIHJldHVybiBzcGxpdFtzcGxpdC5sZW5ndGggLSAxXSA9IHNwbGl0W3NwbGl0Lmxlbmd0aCAtIDFdLnJlcGxhY2UoL1xcWy4qP1xcXS9nLCBcIltdXCIpLCBzcGxpdC5qb2luKFwiLlwiKTtcbn1cbmZ1bmN0aW9uIHNhbml0eU5vZGVzRXhpc3RJblNhbWVBcnJheShzYW5pdHlOb2RlMSwgc2FuaXR5Tm9kZTIpIHtcbiAgcmV0dXJuICFpc1Nhbml0eUFycmF5UGF0aChzYW5pdHlOb2RlMS5wYXRoKSB8fCAhaXNTYW5pdHlBcnJheVBhdGgoc2FuaXR5Tm9kZTIucGF0aCkgPyAhMSA6IGdldFNhbml0eU5vZGVBcnJheVBhdGgoc2FuaXR5Tm9kZTEucGF0aCkgPT09IGdldFNhbml0eU5vZGVBcnJheVBhdGgoc2FuaXR5Tm9kZTIucGF0aCk7XG59XG5mdW5jdGlvbiByZXNvbHZlRHJhZ0FuZERyb3BHcm91cChlbGVtZW50LCBzYW5pdHksIGVsZW1lbnRTZXQsIGVsZW1lbnRzTWFwKSB7XG4gIGlmICghZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXNhbml0eVwiKSB8fCBlbGVtZW50LmdldEF0dHJpYnV0ZShcImRhdGEtc2FuaXR5LWRyYWctZGlzYWJsZVwiKSB8fCAhc2FuaXR5IHx8ICFpc1Nhbml0eU5vZGUoc2FuaXR5KSB8fCAhaXNTYW5pdHlBcnJheVBhdGgoc2FuaXR5LnBhdGgpKSByZXR1cm4gbnVsbDtcbiAgY29uc3QgdGFyZ2V0RHJhZ0dyb3VwID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXNhbml0eS1kcmFnLWdyb3VwXCIpLCBncm91cCA9IFsuLi5lbGVtZW50U2V0XS5yZWR1Y2UoKGFjYywgZWwpID0+IHtcbiAgICBjb25zdCBlbERhdGEgPSBlbGVtZW50c01hcC5nZXQoZWwpLCBlbERyYWdEaXNhYmxlZCA9IGVsLmdldEF0dHJpYnV0ZShcImRhdGEtc2FuaXR5LWRyYWctZGlzYWJsZVwiKSwgZWxEcmFnR3JvdXAgPSBlbC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXNhbml0eS1kcmFnLWdyb3VwXCIpLCBlbEhhc1Nhbml0eUF0dHJpYnV0aW9uID0gZWwuZ2V0QXR0cmlidXRlKFwiZGF0YS1zYW5pdHlcIikgIT09IG51bGwsIHNoYXJlZERyYWdHcm91cCA9IHRhcmdldERyYWdHcm91cCAhPT0gbnVsbCA/IHRhcmdldERyYWdHcm91cCA9PT0gZWxEcmFnR3JvdXAgOiAhMDtcbiAgICByZXR1cm4gZWxEYXRhICYmICFlbERyYWdEaXNhYmxlZCAmJiBpc1Nhbml0eU5vZGUoZWxEYXRhLnNhbml0eSkgJiYgc2FuaXR5Tm9kZXNFeGlzdEluU2FtZUFycmF5KHNhbml0eSwgZWxEYXRhLnNhbml0eSkgJiYgc2hhcmVkRHJhZ0dyb3VwICYmIGVsSGFzU2FuaXR5QXR0cmlidXRpb24gJiYgYWNjLnB1c2goZWxEYXRhKSwgYWNjO1xuICB9LCBbXSk7XG4gIHJldHVybiBncm91cC5sZW5ndGggPD0gMSA/IG51bGwgOiBncm91cDtcbn1cbmZ1bmN0aW9uIGNyZWF0ZU92ZXJsYXlDb250cm9sbGVyKHtcbiAgaGFuZGxlcixcbiAgb3ZlcmxheUVsZW1lbnQsXG4gIGluRnJhbWUsXG4gIGluUG9wVXAsXG4gIG9wdGltaXN0aWNBY3RvclJlYWR5XG59KSB7XG4gIGxldCBhY3RpdmF0ZWQgPSAhMTtcbiAgY29uc3QgZWxlbWVudElkTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKSwgZWxlbWVudHNNYXAgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKSwgZWxlbWVudFNldCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCksIG1lYXN1cmVFbGVtZW50cyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgV2Vha01hcCgpLCBjdXJzb3JNYXAgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTtcbiAgbGV0IHJvLCBpbywgbW8sIGFjdGl2ZURyYWdTZXF1ZW5jZSA9ICExLCBob3ZlclN0YWNrID0gW107XG4gIGNvbnN0IGdldEhvdmVyZWRFbGVtZW50ID0gKCkgPT4gaG92ZXJTdGFja1tob3ZlclN0YWNrLmxlbmd0aCAtIDFdO1xuICBmdW5jdGlvbiBhZGRFdmVudEhhbmRsZXJzKGVsLCBoYW5kbGVycykge1xuICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVycy5jbGljaywge1xuICAgICAgY2FwdHVyZTogITBcbiAgICB9KSwgZWwuYWRkRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIGhhbmRsZXJzLmNvbnRleHRtZW51LCB7XG4gICAgICBjYXB0dXJlOiAhMFxuICAgIH0pLCBlbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIGhhbmRsZXJzLm1vdXNlbW92ZSwge1xuICAgICAgb25jZTogITAsXG4gICAgICBjYXB0dXJlOiAhMFxuICAgIH0pLCBlbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGhhbmRsZXJzLm1vdXNlZG93biwge1xuICAgICAgY2FwdHVyZTogITBcbiAgICB9KTtcbiAgfVxuICBmdW5jdGlvbiByZW1vdmVFdmVudEhhbmRsZXJzKGVsLCBoYW5kbGVycykge1xuICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVycy5jbGljaywge1xuICAgICAgY2FwdHVyZTogITBcbiAgICB9KSwgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIGhhbmRsZXJzLmNvbnRleHRtZW51LCB7XG4gICAgICBjYXB0dXJlOiAhMFxuICAgIH0pLCBlbC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIGhhbmRsZXJzLm1vdXNlbW92ZSwge1xuICAgICAgY2FwdHVyZTogITBcbiAgICB9KSwgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBoYW5kbGVycy5tb3VzZWRvd24sIHtcbiAgICAgIGNhcHR1cmU6ICEwXG4gICAgfSksIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWVudGVyXCIsIGhhbmRsZXJzLm1vdXNlZW50ZXIpLCBlbC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2VsZWF2ZVwiLCBoYW5kbGVycy5tb3VzZWxlYXZlKTtcbiAgfVxuICBmdW5jdGlvbiBhY3RpdmF0ZUVsZW1lbnQoe1xuICAgIGlkLFxuICAgIGVsZW1lbnRzLFxuICAgIGhhbmRsZXJzXG4gIH0pIHtcbiAgICBjb25zdCB7XG4gICAgICBlbGVtZW50LFxuICAgICAgbWVhc3VyZUVsZW1lbnRcbiAgICB9ID0gZWxlbWVudHM7XG4gICAgYWRkRXZlbnRIYW5kbGVycyhlbGVtZW50LCBoYW5kbGVycyksIHJvLm9ic2VydmUobWVhc3VyZUVsZW1lbnQpLCBoYW5kbGVyKHtcbiAgICAgIHR5cGU6IFwiZWxlbWVudC9hY3RpdmF0ZVwiLFxuICAgICAgaWRcbiAgICB9KTtcbiAgfVxuICBmdW5jdGlvbiBkZWFjdGl2YXRlRWxlbWVudCh7XG4gICAgaWQsXG4gICAgZWxlbWVudHMsXG4gICAgaGFuZGxlcnNcbiAgfSkge1xuICAgIGNvbnN0IHtcbiAgICAgIGVsZW1lbnQsXG4gICAgICBtZWFzdXJlRWxlbWVudFxuICAgIH0gPSBlbGVtZW50cztcbiAgICByZW1vdmVFdmVudEhhbmRsZXJzKGVsZW1lbnQsIGhhbmRsZXJzKSwgcm8udW5vYnNlcnZlKG1lYXN1cmVFbGVtZW50KSwgaG92ZXJTdGFjayA9IGhvdmVyU3RhY2suZmlsdGVyKChlbCkgPT4gZWwgIT09IGVsZW1lbnQpLCBoYW5kbGVyKHtcbiAgICAgIHR5cGU6IFwiZWxlbWVudC9kZWFjdGl2YXRlXCIsXG4gICAgICBpZFxuICAgIH0pO1xuICB9XG4gIGZ1bmN0aW9uIHNldE92ZXJsYXlDdXJzb3IoZWxlbWVudCkge1xuICAgIGlmICghKCFpbkZyYW1lICYmICFpblBvcFVwIHx8ICFvcHRpbWlzdGljQWN0b3JSZWFkeSkpXG4gICAgICBmb3IgKGNvbnN0IGhvdmVyc3RhY2tFbGVtZW50IG9mIGhvdmVyU3RhY2spIHtcbiAgICAgICAgaWYgKGVsZW1lbnQgPT09IGhvdmVyc3RhY2tFbGVtZW50KSB7XG4gICAgICAgICAgY29uc3QgdGFyZ2V0U2FuaXR5RGF0YSA9IGVsZW1lbnRzTWFwLmdldChlbGVtZW50KT8uc2FuaXR5O1xuICAgICAgICAgIGlmICghdGFyZ2V0U2FuaXR5RGF0YSB8fCAhaXNTYW5pdHlOb2RlKHRhcmdldFNhbml0eURhdGEpKSByZXR1cm47XG4gICAgICAgICAgaWYgKHJlc29sdmVEcmFnQW5kRHJvcEdyb3VwKGVsZW1lbnQsIHRhcmdldFNhbml0eURhdGEsIGVsZW1lbnRTZXQsIGVsZW1lbnRzTWFwKSkge1xuICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdDdXJzb3IgPSBlbGVtZW50LnN0eWxlLmN1cnNvcjtcbiAgICAgICAgICAgIGV4aXN0aW5nQ3Vyc29yICYmIGN1cnNvck1hcC5zZXQoZWxlbWVudCwgZXhpc3RpbmdDdXJzb3IpLCBoYW5kbGVyKHtcbiAgICAgICAgICAgICAgdHlwZTogXCJvdmVybGF5L3NldEN1cnNvclwiLFxuICAgICAgICAgICAgICBlbGVtZW50LFxuICAgICAgICAgICAgICBjdXJzb3I6IFwibW92ZVwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXN0b3JlT3ZlcmxheUN1cnNvcihob3ZlcnN0YWNrRWxlbWVudCk7XG4gICAgICB9XG4gIH1cbiAgZnVuY3Rpb24gcmVzdG9yZU92ZXJsYXlDdXJzb3IoZWxlbWVudCkge1xuICAgIGNvbnN0IHByZXZpb3VzQ3Vyc29yID0gY3Vyc29yTWFwLmdldChlbGVtZW50KTtcbiAgICBoYW5kbGVyKHtcbiAgICAgIHR5cGU6IFwib3ZlcmxheS9zZXRDdXJzb3JcIixcbiAgICAgIGVsZW1lbnQsXG4gICAgICBjdXJzb3I6IHByZXZpb3VzQ3Vyc29yXG4gICAgfSk7XG4gIH1cbiAgZnVuY3Rpb24gcmVnaXN0ZXJFbGVtZW50KHtcbiAgICBlbGVtZW50cyxcbiAgICBzYW5pdHlcbiAgfSkge1xuICAgIGNvbnN0IHtcbiAgICAgIGVsZW1lbnQsXG4gICAgICBtZWFzdXJlRWxlbWVudFxuICAgIH0gPSBlbGVtZW50cywgZXZlbnRIYW5kbGVycyA9IHtcbiAgICAgIGNsaWNrKGV2ZW50KSB7XG4gICAgICAgIGNvbnN0IHRhcmdldCA9IGV2ZW50LnRhcmdldDtcbiAgICAgICAgaWYgKGVsZW1lbnQgPT09IGdldEhvdmVyZWRFbGVtZW50KCkgJiYgZWxlbWVudC5jb250YWlucyh0YXJnZXQpKSB7XG4gICAgICAgICAgaW5GcmFtZSAmJiAoZXZlbnQucHJldmVudERlZmF1bHQoKSwgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCkpO1xuICAgICAgICAgIGNvbnN0IHNhbml0eTIgPSBlbGVtZW50c01hcC5nZXQoZWxlbWVudCk/LnNhbml0eTtcbiAgICAgICAgICBzYW5pdHkyICYmICFhY3RpdmVEcmFnU2VxdWVuY2UgJiYgaGFuZGxlcih7XG4gICAgICAgICAgICB0eXBlOiBcImVsZW1lbnQvY2xpY2tcIixcbiAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgc2FuaXR5OiBzYW5pdHkyXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBjb250ZXh0bWVudShldmVudCkge1xuICAgICAgICBpZiAoIShcInBhdGhcIiBpbiBzYW5pdHkpIHx8ICFpbkZyYW1lICYmICFpblBvcFVwIHx8ICFvcHRpbWlzdGljQWN0b3JSZWFkeSB8fCAhc2FuaXR5LnBhdGguc3BsaXQoXCIuXCIpLnBvcCgpPy5pbmNsdWRlcyhcIltfa2V5PT1cIikpIHJldHVybjtcbiAgICAgICAgY29uc3QgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xuICAgICAgICBlbGVtZW50ID09PSBnZXRIb3ZlcmVkRWxlbWVudCgpICYmIGVsZW1lbnQuY29udGFpbnModGFyZ2V0KSAmJiAoKGluRnJhbWUgfHwgaW5Qb3BVcCkgJiYgKGV2ZW50LnByZXZlbnREZWZhdWx0KCksIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpKSwgaGFuZGxlcih7XG4gICAgICAgICAgdHlwZTogXCJlbGVtZW50L2NvbnRleHRtZW51XCIsXG4gICAgICAgICAgaWQsXG4gICAgICAgICAgcG9zaXRpb246IHtcbiAgICAgICAgICAgIHg6IGV2ZW50LmNsaWVudFgsXG4gICAgICAgICAgICB5OiBldmVudC5jbGllbnRZXG4gICAgICAgICAgfSxcbiAgICAgICAgICBzYW5pdHlcbiAgICAgICAgfSkpO1xuICAgICAgfSxcbiAgICAgIG1vdXNlZG93bihldmVudCkge1xuICAgICAgICBpZiAoZXZlbnQucHJldmVudERlZmF1bHQoKSwgZXZlbnQuY3VycmVudFRhcmdldCAhPT0gaG92ZXJTdGFjay5hdCgtMSkgfHwgZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXNhbml0eS1kcmFnLWRpc2FibGVcIikgfHwgIWluRnJhbWUgJiYgIWluUG9wVXAgfHwgIW9wdGltaXN0aWNBY3RvclJlYWR5KSByZXR1cm47XG4gICAgICAgIGNvbnN0IHRhcmdldFNhbml0eURhdGEgPSBlbGVtZW50c01hcC5nZXQoZWxlbWVudCk/LnNhbml0eTtcbiAgICAgICAgaWYgKCF0YXJnZXRTYW5pdHlEYXRhIHx8ICFpc1Nhbml0eU5vZGUodGFyZ2V0U2FuaXR5RGF0YSkgfHwgIWlzU2FuaXR5QXJyYXlQYXRoKHRhcmdldFNhbml0eURhdGEucGF0aCkpIHJldHVybjtcbiAgICAgICAgY29uc3QgZHJhZ0dyb3VwID0gcmVzb2x2ZURyYWdBbmREcm9wR3JvdXAoZWxlbWVudCwgc2FuaXR5LCBlbGVtZW50U2V0LCBlbGVtZW50c01hcCk7XG4gICAgICAgIGRyYWdHcm91cCAmJiBoYW5kbGVPdmVybGF5RHJhZyh7XG4gICAgICAgICAgZWxlbWVudCxcbiAgICAgICAgICBoYW5kbGVyLFxuICAgICAgICAgIG1vdXNlRXZlbnQ6IGV2ZW50LFxuICAgICAgICAgIG92ZXJsYXlHcm91cDogZHJhZ0dyb3VwLFxuICAgICAgICAgIHRhcmdldDogdGFyZ2V0U2FuaXR5RGF0YSxcbiAgICAgICAgICBvblNlcXVlbmNlU3RhcnQ6ICgpID0+IHtcbiAgICAgICAgICAgIGFjdGl2ZURyYWdTZXF1ZW5jZSA9ICEwO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgb25TZXF1ZW5jZUVuZDogKCkgPT4ge1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgIGFjdGl2ZURyYWdTZXF1ZW5jZSA9ICExO1xuICAgICAgICAgICAgfSwgMjUwKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIG1vdXNlbW92ZShldmVudCkge1xuICAgICAgICBldmVudEhhbmRsZXJzLm1vdXNlZW50ZXIoZXZlbnQpO1xuICAgICAgICBjb25zdCBlbCA9IGV2ZW50LmN1cnJlbnRUYXJnZXQ7XG4gICAgICAgIGVsICYmIChlbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VlbnRlclwiLCBldmVudEhhbmRsZXJzLm1vdXNlZW50ZXIpLCBlbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VsZWF2ZVwiLCBldmVudEhhbmRsZXJzLm1vdXNlbGVhdmUpKTtcbiAgICAgIH0sXG4gICAgICBtb3VzZWVudGVyKCkge1xuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwidmVyY2VsLWxpdmUtZmVlZGJhY2tcIikgJiYgZWxlbWVudC5jbG9zZXN0KFwiW2RhdGEtdmVyY2VsLWVkaXQtaW5mb11cIikgfHwgZWxlbWVudC5jbG9zZXN0KFwiW2RhdGEtdmVyY2VsLWVkaXQtdGFyZ2V0XVwiKSB8fCAoaG92ZXJTdGFjay5wdXNoKGVsZW1lbnQpLCBoYW5kbGVyKHtcbiAgICAgICAgICB0eXBlOiBcImVsZW1lbnQvbW91c2VlbnRlclwiLFxuICAgICAgICAgIGlkLFxuICAgICAgICAgIHJlY3Q6IGdldFJlY3QoZWxlbWVudClcbiAgICAgICAgfSksIHNldE92ZXJsYXlDdXJzb3IoZWxlbWVudCkpO1xuICAgICAgfSxcbiAgICAgIG1vdXNlbGVhdmUoZSkge1xuICAgICAgICBmdW5jdGlvbiBsZWF2ZSgpIHtcbiAgICAgICAgICBob3ZlclN0YWNrLnBvcCgpO1xuICAgICAgICAgIGNvbnN0IGhvdmVyZWRFbGVtZW50ID0gZ2V0SG92ZXJlZEVsZW1lbnQoKTtcbiAgICAgICAgICBpZiAoaGFuZGxlcih7XG4gICAgICAgICAgICB0eXBlOiBcImVsZW1lbnQvbW91c2VsZWF2ZVwiLFxuICAgICAgICAgICAgaWRcbiAgICAgICAgICB9KSwgaG92ZXJlZEVsZW1lbnQpIHtcbiAgICAgICAgICAgIHNldE92ZXJsYXlDdXJzb3IoaG92ZXJlZEVsZW1lbnQpO1xuICAgICAgICAgICAgY29uc3Qgb3ZlcmxheUVsZW1lbnQyID0gZWxlbWVudHNNYXAuZ2V0KGhvdmVyZWRFbGVtZW50KTtcbiAgICAgICAgICAgIG92ZXJsYXlFbGVtZW50MiAmJiBoYW5kbGVyKHtcbiAgICAgICAgICAgICAgdHlwZTogXCJlbGVtZW50L21vdXNlZW50ZXJcIixcbiAgICAgICAgICAgICAgaWQ6IG92ZXJsYXlFbGVtZW50Mi5pZCxcbiAgICAgICAgICAgICAgcmVjdDogZ2V0UmVjdChob3ZlcmVkRWxlbWVudClcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXN0b3JlT3ZlcmxheUN1cnNvcihlbGVtZW50KTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBhZGREZWZlcnJlZExlYXZlKGVsKSB7XG4gICAgICAgICAgY29uc3QgZGVmZXJyZWRMZWF2ZSA9IChlMikgPT4ge1xuICAgICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgICByZWxhdGVkVGFyZ2V0OiByZWxhdGVkVGFyZ2V0MlxuICAgICAgICAgICAgfSA9IGUyO1xuICAgICAgICAgICAgZmluZE92ZXJsYXlFbGVtZW50KHJlbGF0ZWRUYXJnZXQyKSA/IHJlbGF0ZWRUYXJnZXQyICYmIGlzRWxlbWVudE5vZGUkMShyZWxhdGVkVGFyZ2V0MikgJiYgKGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWxlYXZlXCIsIGRlZmVycmVkTGVhdmUpLCBhZGREZWZlcnJlZExlYXZlKHJlbGF0ZWRUYXJnZXQyKSkgOiAoZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlbGVhdmVcIiwgZGVmZXJyZWRMZWF2ZSksIGxlYXZlKCkpO1xuICAgICAgICAgIH07XG4gICAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbGVhdmVcIiwgZGVmZXJyZWRMZWF2ZSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIHJlbGF0ZWRUYXJnZXRcbiAgICAgICAgfSA9IGUsIGNvbnRhaW5lciA9IGZpbmRPdmVybGF5RWxlbWVudChyZWxhdGVkVGFyZ2V0KSwgaXNJbnRlcmFjdGl2ZU92ZXJsYXlFbGVtZW50ID0gb3ZlcmxheUVsZW1lbnQuY29udGFpbnMoY29udGFpbmVyKTtcbiAgICAgICAgaWYgKGlzRWxlbWVudE5vZGUkMShjb250YWluZXIpICYmIGlzSW50ZXJhY3RpdmVPdmVybGF5RWxlbWVudClcbiAgICAgICAgICByZXR1cm4gYWRkRGVmZXJyZWRMZWF2ZShjb250YWluZXIpO1xuICAgICAgICBsZWF2ZSgpO1xuICAgICAgfVxuICAgIH0sIGlkID0gdjQoKSwgc2FuaXR5Tm9kZSA9IHtcbiAgICAgIGlkLFxuICAgICAgZWxlbWVudHMsXG4gICAgICBzYW5pdHksXG4gICAgICBoYW5kbGVyczogZXZlbnRIYW5kbGVyc1xuICAgIH07XG4gICAgZWxlbWVudFNldC5hZGQoZWxlbWVudCksIG1lYXN1cmVFbGVtZW50cy5zZXQobWVhc3VyZUVsZW1lbnQsIGVsZW1lbnQpLCBlbGVtZW50SWRNYXAuc2V0KGlkLCBlbGVtZW50KSwgZWxlbWVudHNNYXAuc2V0KGVsZW1lbnQsIHNhbml0eU5vZGUpLCBpbz8ub2JzZXJ2ZShlbGVtZW50KSwgaGFuZGxlcih7XG4gICAgICB0eXBlOiBcImVsZW1lbnQvcmVnaXN0ZXJcIixcbiAgICAgIGlkLFxuICAgICAgZWxlbWVudCxcbiAgICAgIHJlY3Q6IGdldFJlY3QoZWxlbWVudCksXG4gICAgICBzYW5pdHksXG4gICAgICBkcmFnRGlzYWJsZWQ6ICEhZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXNhbml0eS1kcmFnLWRpc2FibGVcIilcbiAgICB9KSwgYWN0aXZhdGVkICYmIGFjdGl2YXRlRWxlbWVudChzYW5pdHlOb2RlKTtcbiAgfVxuICBmdW5jdGlvbiB1cGRhdGVFbGVtZW50KHtcbiAgICBlbGVtZW50cyxcbiAgICBzYW5pdHlcbiAgfSkge1xuICAgIGNvbnN0IHtcbiAgICAgIGVsZW1lbnRcbiAgICB9ID0gZWxlbWVudHMsIG92ZXJsYXlFbGVtZW50MiA9IGVsZW1lbnRzTWFwLmdldChlbGVtZW50KTtcbiAgICBvdmVybGF5RWxlbWVudDIgJiYgKGVsZW1lbnRzTWFwLnNldChlbGVtZW50LCB7XG4gICAgICAuLi5vdmVybGF5RWxlbWVudDIsXG4gICAgICBzYW5pdHlcbiAgICB9KSwgaGFuZGxlcih7XG4gICAgICB0eXBlOiBcImVsZW1lbnQvdXBkYXRlXCIsXG4gICAgICBpZDogb3ZlcmxheUVsZW1lbnQyLmlkLFxuICAgICAgcmVjdDogZ2V0UmVjdChlbGVtZW50KSxcbiAgICAgIHNhbml0eVxuICAgIH0pKTtcbiAgfVxuICBmdW5jdGlvbiBwYXJzZUVsZW1lbnRzKG5vZGUpIHtcbiAgICBjb25zdCBzYW5pdHlOb2RlcyA9IGZpbmRTYW5pdHlOb2Rlcyhub2RlKTtcbiAgICBmb3IgKGNvbnN0IHNhbml0eU5vZGUgb2Ygc2FuaXR5Tm9kZXMpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgZWxlbWVudFxuICAgICAgfSA9IHNhbml0eU5vZGUuZWxlbWVudHM7XG4gICAgICBlbGVtZW50c01hcC5oYXMoZWxlbWVudCkgPyB1cGRhdGVFbGVtZW50KHNhbml0eU5vZGUpIDogcmVnaXN0ZXJFbGVtZW50KHNhbml0eU5vZGUpO1xuICAgIH1cbiAgfVxuICBmdW5jdGlvbiB1bnJlZ2lzdGVyRWxlbWVudChlbGVtZW50KSB7XG4gICAgY29uc3Qgb3ZlcmxheUVsZW1lbnQyID0gZWxlbWVudHNNYXAuZ2V0KGVsZW1lbnQpO1xuICAgIGlmIChvdmVybGF5RWxlbWVudDIpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgaWQsXG4gICAgICAgIGhhbmRsZXJzXG4gICAgICB9ID0gb3ZlcmxheUVsZW1lbnQyO1xuICAgICAgcmVtb3ZlRXZlbnRIYW5kbGVycyhlbGVtZW50LCBoYW5kbGVycyksIHJvLnVub2JzZXJ2ZShlbGVtZW50KSwgZWxlbWVudHNNYXAuZGVsZXRlKGVsZW1lbnQpLCBlbGVtZW50U2V0LmRlbGV0ZShlbGVtZW50KSwgZWxlbWVudElkTWFwLmRlbGV0ZShpZCksIGhhbmRsZXIoe1xuICAgICAgICB0eXBlOiBcImVsZW1lbnQvdW5yZWdpc3RlclwiLFxuICAgICAgICBpZFxuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIGhhbmRsZU11dGF0aW9uKG11dGF0aW9ucykge1xuICAgIGxldCBtdXRhdGlvbldhc0luU2NvcGUgPSAhMTtcbiAgICBmb3IgKGNvbnN0IG11dGF0aW9uIG9mIG11dGF0aW9ucykge1xuICAgICAgY29uc3Qge1xuICAgICAgICB0YXJnZXQsXG4gICAgICAgIHR5cGVcbiAgICAgIH0gPSBtdXRhdGlvbiwgbm9kZSA9IHR5cGUgPT09IFwiY2hhcmFjdGVyRGF0YVwiID8gdGFyZ2V0LnBhcmVudEVsZW1lbnQgOiB0YXJnZXQ7XG4gICAgICBub2RlID09PSBvdmVybGF5RWxlbWVudCB8fCBvdmVybGF5RWxlbWVudC5jb250YWlucyhub2RlKSB8fCAobXV0YXRpb25XYXNJblNjb3BlID0gITAsIGlzRWxlbWVudE5vZGUkMShub2RlKSAmJiBwYXJzZUVsZW1lbnRzKHtcbiAgICAgICAgY2hpbGROb2RlczogW25vZGVdXG4gICAgICB9KSk7XG4gICAgfVxuICAgIGlmIChtdXRhdGlvbldhc0luU2NvcGUpXG4gICAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgZWxlbWVudFNldClcbiAgICAgICAgZWxlbWVudC5pc0Nvbm5lY3RlZCB8fCB1bnJlZ2lzdGVyRWxlbWVudChlbGVtZW50KTtcbiAgfVxuICBmdW5jdGlvbiB1cGRhdGVSZWN0KGVsKSB7XG4gICAgY29uc3Qgb3ZlcmxheUVsZW1lbnQyID0gZWxlbWVudHNNYXAuZ2V0KGVsKTtcbiAgICBvdmVybGF5RWxlbWVudDIgJiYgaGFuZGxlcih7XG4gICAgICB0eXBlOiBcImVsZW1lbnQvdXBkYXRlUmVjdFwiLFxuICAgICAgaWQ6IG92ZXJsYXlFbGVtZW50Mi5pZCxcbiAgICAgIHJlY3Q6IGdldFJlY3QoZWwpXG4gICAgfSk7XG4gIH1cbiAgZnVuY3Rpb24gaGFuZGxlUmVzaXplKGVudHJpZXMpIHtcbiAgICBmb3IgKGNvbnN0IGVudHJ5IG9mIGVudHJpZXMpIHtcbiAgICAgIGNvbnN0IHRhcmdldCA9IGVudHJ5LnRhcmdldDtcbiAgICAgIGlmIChpc0VsZW1lbnROb2RlJDEodGFyZ2V0KSkge1xuICAgICAgICBjb25zdCBlbGVtZW50ID0gbWVhc3VyZUVsZW1lbnRzLmdldCh0YXJnZXQpO1xuICAgICAgICBpZiAoIWVsZW1lbnQpIHJldHVybjtcbiAgICAgICAgdXBkYXRlUmVjdChlbGVtZW50KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gaGFuZGxlSW50ZXJzZWN0aW9uKGVudHJpZXMpIHtcbiAgICBpZiAoYWN0aXZhdGVkKVxuICAgICAgZm9yIChjb25zdCBlbnRyeSBvZiBlbnRyaWVzKSB7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICB0YXJnZXRcbiAgICAgICAgfSA9IGVudHJ5LCBtYXRjaCA9IGlzRWxlbWVudE5vZGUkMSh0YXJnZXQpICYmIGVsZW1lbnRzTWFwLmdldCh0YXJnZXQpO1xuICAgICAgICBtYXRjaCAmJiAoZW50cnkuaXNJbnRlcnNlY3RpbmcgPyBhY3RpdmF0ZUVsZW1lbnQobWF0Y2gpIDogZGVhY3RpdmF0ZUVsZW1lbnQobWF0Y2gpKTtcbiAgICAgIH1cbiAgfVxuICBmdW5jdGlvbiBoYW5kbGVCbHVyKGV2ZW50KSB7XG4gICAgY29uc3QgZWxlbWVudCA9IGZpbmRPdmVybGF5RWxlbWVudChldmVudC50YXJnZXQpO1xuICAgIGlmIChlbGVtZW50KSB7XG4gICAgICBlbGVtZW50LmRhdGFzZXQuc2FuaXR5T3ZlcmxheUVsZW1lbnQgPT09IFwiY2FwdHVyZVwiICYmIChldmVudC5wcmV2ZW50RGVmYXVsdCgpLCBldmVudC5zdG9wUHJvcGFnYXRpb24oKSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGhvdmVyU3RhY2sgPSBbXSwgaGFuZGxlcih7XG4gICAgICB0eXBlOiBcIm92ZXJsYXkvYmx1clwiXG4gICAgfSk7XG4gIH1cbiAgZnVuY3Rpb24gaGFuZGxlV2luZG93UmVzaXplKCkge1xuICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiBlbGVtZW50U2V0KVxuICAgICAgdXBkYXRlUmVjdChlbGVtZW50KTtcbiAgfVxuICBmdW5jdGlvbiBoYW5kbGVLZXlkb3duKGV2ZW50KSB7XG4gICAgZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiICYmIChob3ZlclN0YWNrID0gW10sIGhhbmRsZXIoe1xuICAgICAgdHlwZTogXCJvdmVybGF5L2JsdXJcIlxuICAgIH0pKTtcbiAgfVxuICBmdW5jdGlvbiBoYW5kbGVXaW5kb3dTY3JvbGwoZXZlbnQpIHtcbiAgICBjb25zdCB7XG4gICAgICB0YXJnZXRcbiAgICB9ID0gZXZlbnQ7XG4gICAgaWYgKCEodGFyZ2V0ID09PSB3aW5kb3cuZG9jdW1lbnQgfHwgIWlzRWxlbWVudE5vZGUkMSh0YXJnZXQpKSlcbiAgICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiBlbGVtZW50U2V0KVxuICAgICAgICB0YXJnZXQuY29udGFpbnMoZWxlbWVudCkgJiYgdXBkYXRlUmVjdChlbGVtZW50KTtcbiAgfVxuICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICBhY3RpdmF0ZWQgfHwgKGlvID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKGhhbmRsZUludGVyc2VjdGlvbiwge1xuICAgICAgdGhyZXNob2xkOiAwLjNcbiAgICB9KSwgZWxlbWVudFNldC5mb3JFYWNoKChlbGVtZW50KSA9PiBpby5vYnNlcnZlKGVsZW1lbnQpKSwgaGFuZGxlcih7XG4gICAgICB0eXBlOiBcIm92ZXJsYXkvYWN0aXZhdGVcIlxuICAgIH0pLCBhY3RpdmF0ZWQgPSAhMCk7XG4gIH1cbiAgZnVuY3Rpb24gZGVhY3RpdmF0ZSgpIHtcbiAgICBhY3RpdmF0ZWQgJiYgKGlvPy5kaXNjb25uZWN0KCksIGVsZW1lbnRTZXQuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xuICAgICAgY29uc3Qgb3ZlcmxheUVsZW1lbnQyID0gZWxlbWVudHNNYXAuZ2V0KGVsZW1lbnQpO1xuICAgICAgb3ZlcmxheUVsZW1lbnQyICYmIGRlYWN0aXZhdGVFbGVtZW50KG92ZXJsYXlFbGVtZW50Mik7XG4gICAgfSksIGhhbmRsZXIoe1xuICAgICAgdHlwZTogXCJvdmVybGF5L2RlYWN0aXZhdGVcIlxuICAgIH0pLCBhY3RpdmF0ZWQgPSAhMSk7XG4gIH1cbiAgZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUJsdXIpLCB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIGhhbmRsZUJsdXIpLCB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlS2V5ZG93biksIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIGhhbmRsZVdpbmRvd1Jlc2l6ZSksIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsIGhhbmRsZVdpbmRvd1Njcm9sbCksIG1vLmRpc2Nvbm5lY3QoKSwgcm8uZGlzY29ubmVjdCgpLCBlbGVtZW50U2V0LmZvckVhY2goKGVsZW1lbnQpID0+IHtcbiAgICAgIHVucmVnaXN0ZXJFbGVtZW50KGVsZW1lbnQpO1xuICAgIH0pLCBlbGVtZW50SWRNYXAuY2xlYXIoKSwgZWxlbWVudFNldC5jbGVhcigpLCBob3ZlclN0YWNrID0gW10sIGRlYWN0aXZhdGUoKTtcbiAgfVxuICBmdW5jdGlvbiBjcmVhdGUoKSB7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVCbHVyKSwgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCBoYW5kbGVCbHVyKSwgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUtleWRvd24pLCB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCBoYW5kbGVXaW5kb3dSZXNpemUpLCB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCBoYW5kbGVXaW5kb3dTY3JvbGwsIHtcbiAgICAgIGNhcHR1cmU6ICEwLFxuICAgICAgcGFzc2l2ZTogITBcbiAgICB9KSwgcm8gPSBuZXcgUmVzaXplT2JzZXJ2ZXIoaGFuZGxlUmVzaXplKSwgbW8gPSBuZXcgTXV0YXRpb25PYnNlcnZlcihoYW5kbGVNdXRhdGlvbiksIG1vLm9ic2VydmUoZG9jdW1lbnQuYm9keSwge1xuICAgICAgYXR0cmlidXRlczogITAsXG4gICAgICBjaGFyYWN0ZXJEYXRhOiAhMCxcbiAgICAgIGNoaWxkTGlzdDogITAsXG4gICAgICBzdWJ0cmVlOiAhMFxuICAgIH0pLCBwYXJzZUVsZW1lbnRzKGRvY3VtZW50LmJvZHkpLCBhY3RpdmF0ZSgpO1xuICB9XG4gIHJldHVybiB3aW5kb3cuZG9jdW1lbnQuZm9udHMucmVhZHkudGhlbigoKSA9PiB7XG4gICAgZm9yIChjb25zdCBlbGVtZW50IG9mIGVsZW1lbnRTZXQpXG4gICAgICB1cGRhdGVSZWN0KGVsZW1lbnQpO1xuICB9KSwgY3JlYXRlKCksIHtcbiAgICBhY3RpdmF0ZSxcbiAgICBkZWFjdGl2YXRlLFxuICAgIGRlc3Ryb3lcbiAgfTtcbn1cbmNvbnN0IFNoYXJlZFN0YXRlQ29udGV4dCA9IGNyZWF0ZUNvbnRleHQobnVsbCk7XG5leHBvcnQge1xuICBTaGFyZWRTdGF0ZUNvbnRleHQsXG4gIGNyZWF0ZU92ZXJsYXlDb250cm9sbGVyLFxuICBzYW5pdHlOb2Rlc0V4aXN0SW5TYW1lQXJyYXksXG4gIHVzZU9wdGltaXN0aWNcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1TaGFyZWRTdGF0ZUNvbnRleHQuanMubWFwXG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/_chunks-es/SharedStateContext.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/_chunks-es/context.js":
/*!********************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/_chunks-es/context.js ***!
  \********************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   actor: () => (/* binding */ actor),\n/* harmony export */   emptyActor: () => (/* binding */ emptyActor),\n/* harmony export */   isEmptyActor: () => (/* binding */ isEmptyActor),\n/* harmony export */   listeners: () => (/* binding */ listeners),\n/* harmony export */   setActor: () => (/* binding */ setActor)\n/* harmony export */ });\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/.pnpm/xstate@5.19.2/node_modules/xstate/actors/dist/xstate-actors.development.esm.js\");\n\nconst emptyActor = (0,xstate__WEBPACK_IMPORTED_MODULE_0__.createEmptyActor)();\nlet actor = emptyActor;\nconst listeners = /* @__PURE__ */ new Set();\nfunction isEmptyActor(actor2) {\n  return actor2 === emptyActor;\n}\nfunction setActor(nextActor) {\n  actor = nextActor;\n  for (const onActorChange of listeners)\n    onActorChange();\n}\n\n//# sourceMappingURL=context.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHNhbml0eSt2aXN1YWwtZWRpdGluZ0AyLjEzLjE1X0BlbW90aW9uK2lzLXByb3AtdmFsaWRAMS4yLjJfQHNhbml0eStjbGllbnRANi4yOC40X0BzYW5pXzhjMjAzM2ZlYWJkNWY1ODRhZjQ0NjliZmNlMTQxNTNmL25vZGVfbW9kdWxlcy9Ac2FuaXR5L3Zpc3VhbC1lZGl0aW5nL2Rpc3QvX2NodW5rcy1lcy9jb250ZXh0LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUEwQztBQUMxQyxtQkFBbUIsd0RBQWdCO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBT0U7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL3BldHJva3ZhcnRzaWFueWkvY29kZS9nZW9tdW5kdXMtd2Vic2l0ZS9ub2RlX21vZHVsZXMvLnBucG0vQHNhbml0eSt2aXN1YWwtZWRpdGluZ0AyLjEzLjE1X0BlbW90aW9uK2lzLXByb3AtdmFsaWRAMS4yLjJfQHNhbml0eStjbGllbnRANi4yOC40X0BzYW5pXzhjMjAzM2ZlYWJkNWY1ODRhZjQ0NjliZmNlMTQxNTNmL25vZGVfbW9kdWxlcy9Ac2FuaXR5L3Zpc3VhbC1lZGl0aW5nL2Rpc3QvX2NodW5rcy1lcy9jb250ZXh0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUVtcHR5QWN0b3IgfSBmcm9tIFwieHN0YXRlXCI7XG5jb25zdCBlbXB0eUFjdG9yID0gY3JlYXRlRW1wdHlBY3RvcigpO1xubGV0IGFjdG9yID0gZW1wdHlBY3RvcjtcbmNvbnN0IGxpc3RlbmVycyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCk7XG5mdW5jdGlvbiBpc0VtcHR5QWN0b3IoYWN0b3IyKSB7XG4gIHJldHVybiBhY3RvcjIgPT09IGVtcHR5QWN0b3I7XG59XG5mdW5jdGlvbiBzZXRBY3RvcihuZXh0QWN0b3IpIHtcbiAgYWN0b3IgPSBuZXh0QWN0b3I7XG4gIGZvciAoY29uc3Qgb25BY3RvckNoYW5nZSBvZiBsaXN0ZW5lcnMpXG4gICAgb25BY3RvckNoYW5nZSgpO1xufVxuZXhwb3J0IHtcbiAgYWN0b3IsXG4gIGVtcHR5QWN0b3IsXG4gIGlzRW1wdHlBY3RvcixcbiAgbGlzdGVuZXJzLFxuICBzZXRBY3RvclxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNvbnRleHQuanMubWFwXG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/_chunks-es/context.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/_chunks-es/mutations.js":
/*!**********************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/_chunks-es/mutations.js ***!
  \**********************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   get: () => (/* binding */ get),\n/* harmony export */   getArrayDuplicatePatches: () => (/* binding */ getArrayDuplicatePatches),\n/* harmony export */   getArrayInsertPatches: () => (/* binding */ getArrayInsertPatches),\n/* harmony export */   getArrayItemKeyAndParentPath: () => (/* binding */ getArrayItemKeyAndParentPath),\n/* harmony export */   getArrayMovePatches: () => (/* binding */ getArrayMovePatches),\n/* harmony export */   getArrayRemovePatches: () => (/* binding */ getArrayRemovePatches),\n/* harmony export */   useDocuments: () => (/* binding */ useDocuments),\n/* harmony export */   useOptimisticActor: () => (/* binding */ useOptimisticActor),\n/* harmony export */   useOptimisticActorReady: () => (/* binding */ useOptimisticActorReady)\n/* harmony export */ });\n/* harmony import */ var react_compiler_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react-compiler-runtime */ \"(ssr)/./node_modules/.pnpm/react-compiler-runtime@19.0.0-beta-e993439-20250328_react@19.1.0/node_modules/react-compiler-runtime/dist/index.js\");\n/* harmony import */ var _sanity_client_csm__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sanity/client/csm */ \"(ssr)/./node_modules/.pnpm/@sanity+client@6.28.4_debug@4.4.0/node_modules/@sanity/client/dist/_chunks-es/resolveEditInfo.js\");\n/* harmony import */ var _sanity_mutate__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sanity/mutate */ \"(ssr)/./node_modules/.pnpm/@sanity+mutate@0.11.0-canary.4_xstate@5.19.2/node_modules/@sanity/mutate/dist/index.js\");\n/* harmony import */ var _sanity_presentation_comlink__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sanity/presentation-comlink */ \"(ssr)/./node_modules/.pnpm/@sanity+presentation-comlink@1.0.14_@sanity+client@6.28.4_@sanity+types@3.83.0_@types+react@19.1.0_/node_modules/@sanity/presentation-comlink/dist/index.js\");\n/* harmony import */ var _context_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./context.js */ \"(ssr)/./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/_chunks-es/context.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/.pnpm/next@15.2.4_@babel+core@7.26.10_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var get_random_values_esm__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! get-random-values-esm */ \"(ssr)/./node_modules/.pnpm/get-random-values-esm@1.0.2/node_modules/get-random-values-esm/index.mjs\");\n\n\n\n\n\n\n\nconst reKeySegment$1 = /_key\\s*==\\s*['\"](.*)['\"]/, reIndexTuple = /^\\d*:\\d*$/;\nfunction isIndexSegment(segment) {\n  return typeof segment == \"number\" || typeof segment == \"string\" && /^\\[\\d+\\]$/.test(segment);\n}\nfunction isKeySegment(segment) {\n  return typeof segment == \"string\" ? reKeySegment$1.test(segment.trim()) : typeof segment == \"object\" && \"_key\" in segment;\n}\nfunction isIndexTuple(segment) {\n  if (typeof segment == \"string\" && reIndexTuple.test(segment))\n    return !0;\n  if (!Array.isArray(segment) || segment.length !== 2)\n    return !1;\n  const [from, to] = segment;\n  return (typeof from == \"number\" || from === \"\") && (typeof to == \"number\" || to === \"\");\n}\nconst rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g, reKeySegment = /_key\\s*==\\s*['\"](.*)['\"]/;\nfunction get(obj, path, defaultVal) {\n  const select = typeof path == \"string\" ? fromString(path) : path;\n  if (!Array.isArray(select))\n    throw new Error(\"Path must be an array or a string\");\n  let acc = obj;\n  for (let i = 0; i < select.length; i++) {\n    const segment = select[i];\n    if (isIndexSegment(segment)) {\n      if (!Array.isArray(acc))\n        return defaultVal;\n      acc = acc[segment];\n    }\n    if (isKeySegment(segment)) {\n      if (!Array.isArray(acc))\n        return defaultVal;\n      acc = acc.find((item) => item._key === segment._key);\n    }\n    if (typeof segment == \"string\" && (acc = typeof acc == \"object\" && acc !== null ? acc[segment] : void 0), typeof acc > \"u\")\n      return defaultVal;\n  }\n  return acc;\n}\nfunction fromString(path) {\n  if (typeof path != \"string\")\n    throw new Error(\"Path is not a string\");\n  const segments = path.match(rePropName);\n  if (!segments)\n    throw new Error(\"Invalid path string\");\n  return segments.map(normalizePathSegment);\n}\nfunction normalizePathSegment(segment) {\n  return isIndexSegment(segment) ? normalizeIndexSegment(segment) : isKeySegment(segment) ? normalizeKeySegment(segment) : isIndexTuple(segment) ? normalizeIndexTupleSegment(segment) : segment;\n}\nfunction normalizeIndexSegment(segment) {\n  return Number(segment.replace(/[^\\d]/g, \"\"));\n}\nfunction normalizeKeySegment(segment) {\n  return { _key: segment.match(reKeySegment)[1] };\n}\nfunction normalizeIndexTupleSegment(segment) {\n  const [from, to] = segment.split(\":\").map((seg) => seg === \"\" ? seg : Number(seg));\n  return [from, to];\n}\nfunction useOptimisticActor() {\n  return (0,react__WEBPACK_IMPORTED_MODULE_1__.useSyncExternalStore)(_temp, _temp2, _temp3);\n}\nfunction _temp3() {\n  return _context_js__WEBPACK_IMPORTED_MODULE_2__.emptyActor;\n}\nfunction _temp2() {\n  return _context_js__WEBPACK_IMPORTED_MODULE_2__.actor;\n}\nfunction _temp(listener) {\n  return _context_js__WEBPACK_IMPORTED_MODULE_2__.listeners.add(listener), () => _context_js__WEBPACK_IMPORTED_MODULE_2__.listeners.delete(listener);\n}\nfunction useOptimisticActorReady() {\n  const actor2 = useOptimisticActor();\n  let t0;\n  return t0 = !(0,_context_js__WEBPACK_IMPORTED_MODULE_2__.isEmptyActor)(actor2), t0;\n}\nfunction debounce(fn, timeout) {\n  let timer;\n  return (...args) => {\n    clearTimeout(timer), timer = setTimeout(() => {\n      fn.apply(fn, args);\n    }, timeout);\n  };\n}\nfunction getDocumentsAndSnapshot(id, actor2) {\n  const inFrame = (0,_sanity_presentation_comlink__WEBPACK_IMPORTED_MODULE_3__.isMaybePreviewIframe)(), inPopUp = (0,_sanity_presentation_comlink__WEBPACK_IMPORTED_MODULE_3__.isMaybePreviewWindow)();\n  if ((0,_context_js__WEBPACK_IMPORTED_MODULE_2__.isEmptyActor)(actor2) || !inFrame && !inPopUp)\n    throw new Error(\"The `useDocuments` hook cannot be used in this context\");\n  const draftId = (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_4__.getDraftId)(id), publishedId = (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_4__.getPublishedId)(id), documents = actor2.getSnapshot().context?.documents, draftDoc = documents?.[draftId], publishedDoc = documents?.[publishedId], doc = draftDoc || publishedDoc;\n  if (!doc)\n    throw new Error(`Document \"${id}\" not found`);\n  const snapshot = draftDoc.getSnapshot().context?.local || publishedDoc.getSnapshot().context?.local, snapshotPromise = new Promise((resolve) => {\n    if (snapshot)\n      resolve(snapshot);\n    else {\n      const subscriber = doc.on(\"ready\", (event) => {\n        const {\n          snapshot: snapshot2\n        } = event;\n        resolve(snapshot2 || null), subscriber.unsubscribe();\n      });\n    }\n  });\n  return {\n    draftDoc,\n    draftId,\n    getSnapshot: () => snapshotPromise,\n    publishedDoc,\n    publishedId,\n    /**\n     * @deprecated - use `getSnapshot` instead\n     */\n    get snapshot() {\n      if (!snapshot)\n        throw new Error(`Snapshot for document \"${id}\" not found`);\n      return snapshot;\n    }\n  };\n}\nfunction createDocumentCommit(id, actor2) {\n  return () => {\n    const {\n      draftDoc\n    } = getDocumentsAndSnapshot(id, actor2);\n    draftDoc.send({\n      type: \"submit\"\n    });\n  };\n}\nfunction createDocumentGet(id, actor2) {\n  return (path) => {\n    const {\n      snapshot\n    } = getDocumentsAndSnapshot(id, actor2);\n    return path ? get(snapshot, path) : snapshot;\n  };\n}\nfunction createDocumentGetSnapshot(id, actor2) {\n  const {\n    getSnapshot\n  } = getDocumentsAndSnapshot(id, actor2);\n  return getSnapshot;\n}\nfunction createDocumentPatch(id, actor2) {\n  return async (patches, options) => {\n    const result = getDocumentsAndSnapshot(id, actor2), {\n      draftDoc,\n      draftId,\n      getSnapshot,\n      publishedId\n    } = result, {\n      commit = !0\n    } = options || {}, resolvedPatches = await (typeof patches == \"function\" ? patches({\n      draftId,\n      publishedId,\n      /**\n       * @deprecated - use `getSnapshot` instead\n       */\n      get snapshot() {\n        return result.snapshot;\n      },\n      getSnapshot\n    }) : patches), _snapshot = await getSnapshot();\n    if (!_snapshot)\n      throw new Error(`Snapshot for document \"${id}\" not found`);\n    draftDoc.send({\n      type: \"mutate\",\n      mutations: [\n        // Attempt to create the draft document, it might not exist if the\n        // snapshot was from the published document\n        (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.createIfNotExists)({\n          ..._snapshot,\n          _id: draftId\n        }),\n        // Patch the draft document with the resolved patches\n        (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.patch)(draftId, resolvedPatches)\n      ]\n    }), commit && (typeof commit == \"object\" && \"debounce\" in commit ? debounce(() => draftDoc.send({\n      type: \"submit\"\n    }), commit.debounce)() : draftDoc.send({\n      type: \"submit\"\n    }));\n  };\n}\nfunction useDocuments() {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_0__.c)(7), actor2 = useOptimisticActor();\n  let t0;\n  $[0] !== actor2 ? (t0 = (documentId) => ({\n    id: documentId,\n    commit: createDocumentCommit(documentId, actor2),\n    get: createDocumentGet(documentId, actor2),\n    getSnapshot: createDocumentGetSnapshot(documentId, actor2),\n    patch: createDocumentPatch(documentId, actor2)\n  }), $[0] = actor2, $[1] = t0) : t0 = $[1];\n  const getDocument = t0;\n  let t1;\n  $[2] !== actor2 ? (t1 = (id, mutations, options) => {\n    const {\n      draftDoc\n    } = getDocumentsAndSnapshot(id, actor2), {\n      commit: t22\n    } = options || {}, commit = t22 === void 0 ? !0 : t22;\n    draftDoc.send({\n      type: \"mutate\",\n      mutations\n    }), commit && (typeof commit == \"object\" && \"debounce\" in commit ? debounce(() => draftDoc.send({\n      type: \"submit\"\n    }), commit.debounce)() : draftDoc.send({\n      type: \"submit\"\n    }));\n  }, $[2] = actor2, $[3] = t1) : t1 = $[3];\n  const mutateDocument = t1;\n  let t2;\n  return $[4] !== getDocument || $[5] !== mutateDocument ? (t2 = {\n    getDocument,\n    mutateDocument\n  }, $[4] = getDocument, $[5] = mutateDocument, $[6] = t2) : t2 = $[6], t2;\n}\nfunction whatwgRNG(length = 16) {\n  const rnds8 = new Uint8Array(length);\n  return (0,get_random_values_esm__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(rnds8), rnds8;\n}\nconst getByteHexTable = /* @__PURE__ */ (() => {\n  let table;\n  return () => {\n    if (table)\n      return table;\n    table = [];\n    for (let i = 0; i < 256; ++i)\n      table[i] = (i + 256).toString(16).slice(1);\n    return table;\n  };\n})();\nfunction randomKey(length) {\n  const table = getByteHexTable();\n  return whatwgRNG(length).reduce((str, n) => str + table[n], \"\").slice(0, length);\n}\nfunction getArrayItemKeyAndParentPath(pathOrNode) {\n  const elementPath = typeof pathOrNode == \"string\" ? pathOrNode : pathOrNode.path, lastDotIndex = elementPath.lastIndexOf(\".\"), lastPathItem = elementPath.substring(lastDotIndex + 1, elementPath.length);\n  if (!lastPathItem.indexOf(\"[\")) throw new Error(\"Invalid path: not an array\");\n  const lastArrayIndex = elementPath.lastIndexOf(\"[\"), path = elementPath.substring(0, lastArrayIndex);\n  let key, hasExplicitKey;\n  if (lastPathItem.includes(\"_key\")) {\n    const startIndex = lastPathItem.indexOf('\"') + 1, endIndex = lastPathItem.indexOf('\"', startIndex);\n    key = lastPathItem.substring(startIndex, endIndex), hasExplicitKey = !0;\n  } else {\n    const startIndex = lastPathItem.indexOf(\"[\") + 1, endIndex = lastPathItem.indexOf(\"]\", startIndex);\n    key = lastPathItem.substring(startIndex, endIndex), hasExplicitKey = !1;\n  }\n  if (!path || !key) throw new Error(\"Invalid path\");\n  return {\n    path,\n    key,\n    hasExplicitKey\n  };\n}\nfunction getArrayDuplicatePatches(node, snapshot, position = \"after\") {\n  const {\n    path: arrayPath,\n    key: itemKey\n  } = getArrayItemKeyAndParentPath(node), duplicate = {\n    ...get(snapshot, node.path),\n    _key: randomKey()\n  };\n  return [(0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.insert)(duplicate, position, {\n    _key: itemKey\n  }))];\n}\nfunction getArrayRemovePatches(node, snapshot) {\n  const {\n    path: arrayPath,\n    key: itemKey\n  } = getArrayItemKeyAndParentPath(node), currentIndex = get(snapshot, arrayPath).findIndex((item) => item._key === itemKey);\n  return [(0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.truncate)(currentIndex, currentIndex + 1))];\n}\nfunction getArrayInsertPatches(node, insertType, position) {\n  const {\n    path: arrayPath,\n    key: itemKey\n  } = getArrayItemKeyAndParentPath(node), insertKey = randomKey();\n  return [(0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.insert)([{\n    _type: insertType,\n    _key: insertKey\n  }], position, {\n    _key: itemKey\n  }))];\n}\nasync function getArrayMovePatches(node, doc, moveTo) {\n  if (!node.type) throw new Error(\"Node type is missing\");\n  const {\n    path: arrayPath,\n    key: itemKey\n  } = getArrayItemKeyAndParentPath(node), snapshot = await doc.getSnapshot(), array = get(snapshot, arrayPath), item = get(snapshot, node.path), currentIndex = array.findIndex((item2) => item2._key === itemKey);\n  let nextIndex = -1, position = \"before\";\n  if (moveTo === \"first\") {\n    if (currentIndex === 0) return [];\n    nextIndex = 0, position = \"before\";\n  } else if (moveTo === \"last\") {\n    if (currentIndex === array.length - 1) return [];\n    nextIndex = -1, position = \"after\";\n  } else if (moveTo === \"next\") {\n    if (currentIndex === array.length - 1) return [];\n    nextIndex = currentIndex, position = \"after\";\n  } else if (moveTo === \"previous\") {\n    if (currentIndex === 0) return [];\n    nextIndex = currentIndex - 1, position = \"before\";\n  }\n  return [(0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.truncate)(currentIndex, currentIndex + 1)), (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.insert)(item, position, nextIndex))];\n}\n\n//# sourceMappingURL=mutations.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHNhbml0eSt2aXN1YWwtZWRpdGluZ0AyLjEzLjE1X0BlbW90aW9uK2lzLXByb3AtdmFsaWRAMS4yLjJfQHNhbml0eStjbGllbnRANi4yOC40X0BzYW5pXzhjMjAzM2ZlYWJkNWY1ODRhZjQ0NjliZmNlMTQxNTNmL25vZGVfbW9kdWxlcy9Ac2FuaXR5L3Zpc3VhbC1lZGl0aW5nL2Rpc3QvX2NodW5rcy1lcy9tdXRhdGlvbnMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUEyQztBQUNxQjtBQUNnQjtBQUNVO0FBQ2hCO0FBQzdCO0FBQ087QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLG1CQUFtQjtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLDJEQUFvQjtBQUM3QjtBQUNBO0FBQ0EsU0FBUyxtREFBVTtBQUNuQjtBQUNBO0FBQ0EsU0FBUyw4Q0FBSztBQUNkO0FBQ0E7QUFDQSxTQUFTLGtEQUFTLHNCQUFzQixrREFBUztBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUseURBQVk7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixrRkFBb0IsY0FBYyxrRkFBb0I7QUFDeEUsTUFBTSx5REFBWTtBQUNsQjtBQUNBLGtCQUFrQiw4REFBVSxvQkFBb0Isa0VBQWM7QUFDOUQ7QUFDQSxpQ0FBaUMsR0FBRztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBLE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0RBQWtELEdBQUc7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsTUFBTSxlQUFlO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0EsZ0RBQWdELEdBQUc7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlCO0FBQ3pCO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxRQUFRLHFEQUFLO0FBQ2I7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsWUFBWSx5REFBQztBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNLGVBQWU7QUFDckI7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLFNBQVMsaUVBQWU7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsU0FBUztBQUM3QjtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsVUFBVSxrREFBRSxZQUFZLHNEQUFNO0FBQzlCO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osVUFBVSxrREFBRSxZQUFZLHdEQUFRO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osVUFBVSxrREFBRSxZQUFZLHNEQUFNO0FBQzlCO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxVQUFVLGtEQUFFLFlBQVksd0RBQVEsbUNBQW1DLGtEQUFFLFlBQVksc0RBQU07QUFDdkY7QUFXRTtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvcGV0cm9rdmFydHNpYW55aS9jb2RlL2dlb211bmR1cy13ZWJzaXRlL25vZGVfbW9kdWxlcy8ucG5wbS9Ac2FuaXR5K3Zpc3VhbC1lZGl0aW5nQDIuMTMuMTVfQGVtb3Rpb24raXMtcHJvcC12YWxpZEAxLjIuMl9Ac2FuaXR5K2NsaWVudEA2LjI4LjRfQHNhbmlfOGMyMDMzZmVhYmQ1ZjU4NGFmNDQ2OWJmY2UxNDE1M2Yvbm9kZV9tb2R1bGVzL0BzYW5pdHkvdmlzdWFsLWVkaXRpbmcvZGlzdC9fY2h1bmtzLWVzL211dGF0aW9ucy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjIH0gZnJvbSBcInJlYWN0LWNvbXBpbGVyLXJ1bnRpbWVcIjtcbmltcG9ydCB7IGdldERyYWZ0SWQsIGdldFB1Ymxpc2hlZElkIH0gZnJvbSBcIkBzYW5pdHkvY2xpZW50L2NzbVwiO1xuaW1wb3J0IHsgY3JlYXRlSWZOb3RFeGlzdHMsIHBhdGNoLCBhdCwgaW5zZXJ0LCB0cnVuY2F0ZSB9IGZyb20gXCJAc2FuaXR5L211dGF0ZVwiO1xuaW1wb3J0IHsgaXNNYXliZVByZXZpZXdJZnJhbWUsIGlzTWF5YmVQcmV2aWV3V2luZG93IH0gZnJvbSBcIkBzYW5pdHkvcHJlc2VudGF0aW9uLWNvbWxpbmtcIjtcbmltcG9ydCB7IGlzRW1wdHlBY3RvciwgbGlzdGVuZXJzLCBhY3RvciwgZW1wdHlBY3RvciB9IGZyb20gXCIuL2NvbnRleHQuanNcIjtcbmltcG9ydCB7IHVzZVN5bmNFeHRlcm5hbFN0b3JlIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgZ2V0UmFuZG9tVmFsdWVzIGZyb20gXCJnZXQtcmFuZG9tLXZhbHVlcy1lc21cIjtcbmNvbnN0IHJlS2V5U2VnbWVudCQxID0gL19rZXlcXHMqPT1cXHMqWydcIl0oLiopWydcIl0vLCByZUluZGV4VHVwbGUgPSAvXlxcZCo6XFxkKiQvO1xuZnVuY3Rpb24gaXNJbmRleFNlZ21lbnQoc2VnbWVudCkge1xuICByZXR1cm4gdHlwZW9mIHNlZ21lbnQgPT0gXCJudW1iZXJcIiB8fCB0eXBlb2Ygc2VnbWVudCA9PSBcInN0cmluZ1wiICYmIC9eXFxbXFxkK1xcXSQvLnRlc3Qoc2VnbWVudCk7XG59XG5mdW5jdGlvbiBpc0tleVNlZ21lbnQoc2VnbWVudCkge1xuICByZXR1cm4gdHlwZW9mIHNlZ21lbnQgPT0gXCJzdHJpbmdcIiA/IHJlS2V5U2VnbWVudCQxLnRlc3Qoc2VnbWVudC50cmltKCkpIDogdHlwZW9mIHNlZ21lbnQgPT0gXCJvYmplY3RcIiAmJiBcIl9rZXlcIiBpbiBzZWdtZW50O1xufVxuZnVuY3Rpb24gaXNJbmRleFR1cGxlKHNlZ21lbnQpIHtcbiAgaWYgKHR5cGVvZiBzZWdtZW50ID09IFwic3RyaW5nXCIgJiYgcmVJbmRleFR1cGxlLnRlc3Qoc2VnbWVudCkpXG4gICAgcmV0dXJuICEwO1xuICBpZiAoIUFycmF5LmlzQXJyYXkoc2VnbWVudCkgfHwgc2VnbWVudC5sZW5ndGggIT09IDIpXG4gICAgcmV0dXJuICExO1xuICBjb25zdCBbZnJvbSwgdG9dID0gc2VnbWVudDtcbiAgcmV0dXJuICh0eXBlb2YgZnJvbSA9PSBcIm51bWJlclwiIHx8IGZyb20gPT09IFwiXCIpICYmICh0eXBlb2YgdG8gPT0gXCJudW1iZXJcIiB8fCB0byA9PT0gXCJcIik7XG59XG5jb25zdCByZVByb3BOYW1lID0gL1teLltcXF1dK3xcXFsoPzooLT9cXGQrKD86XFwuXFxkKyk/KXwoW1wiJ10pKCg/Oig/IVxcMilbXlxcXFxdfFxcXFwuKSo/KVxcMilcXF18KD89KD86XFwufFxcW1xcXSkoPzpcXC58XFxbXFxdfCQpKS9nLCByZUtleVNlZ21lbnQgPSAvX2tleVxccyo9PVxccypbJ1wiXSguKilbJ1wiXS87XG5mdW5jdGlvbiBnZXQob2JqLCBwYXRoLCBkZWZhdWx0VmFsKSB7XG4gIGNvbnN0IHNlbGVjdCA9IHR5cGVvZiBwYXRoID09IFwic3RyaW5nXCIgPyBmcm9tU3RyaW5nKHBhdGgpIDogcGF0aDtcbiAgaWYgKCFBcnJheS5pc0FycmF5KHNlbGVjdCkpXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiUGF0aCBtdXN0IGJlIGFuIGFycmF5IG9yIGEgc3RyaW5nXCIpO1xuICBsZXQgYWNjID0gb2JqO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHNlbGVjdC5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IHNlZ21lbnQgPSBzZWxlY3RbaV07XG4gICAgaWYgKGlzSW5kZXhTZWdtZW50KHNlZ21lbnQpKSB7XG4gICAgICBpZiAoIUFycmF5LmlzQXJyYXkoYWNjKSlcbiAgICAgICAgcmV0dXJuIGRlZmF1bHRWYWw7XG4gICAgICBhY2MgPSBhY2Nbc2VnbWVudF07XG4gICAgfVxuICAgIGlmIChpc0tleVNlZ21lbnQoc2VnbWVudCkpIHtcbiAgICAgIGlmICghQXJyYXkuaXNBcnJheShhY2MpKVxuICAgICAgICByZXR1cm4gZGVmYXVsdFZhbDtcbiAgICAgIGFjYyA9IGFjYy5maW5kKChpdGVtKSA9PiBpdGVtLl9rZXkgPT09IHNlZ21lbnQuX2tleSk7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygc2VnbWVudCA9PSBcInN0cmluZ1wiICYmIChhY2MgPSB0eXBlb2YgYWNjID09IFwib2JqZWN0XCIgJiYgYWNjICE9PSBudWxsID8gYWNjW3NlZ21lbnRdIDogdm9pZCAwKSwgdHlwZW9mIGFjYyA+IFwidVwiKVxuICAgICAgcmV0dXJuIGRlZmF1bHRWYWw7XG4gIH1cbiAgcmV0dXJuIGFjYztcbn1cbmZ1bmN0aW9uIGZyb21TdHJpbmcocGF0aCkge1xuICBpZiAodHlwZW9mIHBhdGggIT0gXCJzdHJpbmdcIilcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJQYXRoIGlzIG5vdCBhIHN0cmluZ1wiKTtcbiAgY29uc3Qgc2VnbWVudHMgPSBwYXRoLm1hdGNoKHJlUHJvcE5hbWUpO1xuICBpZiAoIXNlZ21lbnRzKVxuICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgcGF0aCBzdHJpbmdcIik7XG4gIHJldHVybiBzZWdtZW50cy5tYXAobm9ybWFsaXplUGF0aFNlZ21lbnQpO1xufVxuZnVuY3Rpb24gbm9ybWFsaXplUGF0aFNlZ21lbnQoc2VnbWVudCkge1xuICByZXR1cm4gaXNJbmRleFNlZ21lbnQoc2VnbWVudCkgPyBub3JtYWxpemVJbmRleFNlZ21lbnQoc2VnbWVudCkgOiBpc0tleVNlZ21lbnQoc2VnbWVudCkgPyBub3JtYWxpemVLZXlTZWdtZW50KHNlZ21lbnQpIDogaXNJbmRleFR1cGxlKHNlZ21lbnQpID8gbm9ybWFsaXplSW5kZXhUdXBsZVNlZ21lbnQoc2VnbWVudCkgOiBzZWdtZW50O1xufVxuZnVuY3Rpb24gbm9ybWFsaXplSW5kZXhTZWdtZW50KHNlZ21lbnQpIHtcbiAgcmV0dXJuIE51bWJlcihzZWdtZW50LnJlcGxhY2UoL1teXFxkXS9nLCBcIlwiKSk7XG59XG5mdW5jdGlvbiBub3JtYWxpemVLZXlTZWdtZW50KHNlZ21lbnQpIHtcbiAgcmV0dXJuIHsgX2tleTogc2VnbWVudC5tYXRjaChyZUtleVNlZ21lbnQpWzFdIH07XG59XG5mdW5jdGlvbiBub3JtYWxpemVJbmRleFR1cGxlU2VnbWVudChzZWdtZW50KSB7XG4gIGNvbnN0IFtmcm9tLCB0b10gPSBzZWdtZW50LnNwbGl0KFwiOlwiKS5tYXAoKHNlZykgPT4gc2VnID09PSBcIlwiID8gc2VnIDogTnVtYmVyKHNlZykpO1xuICByZXR1cm4gW2Zyb20sIHRvXTtcbn1cbmZ1bmN0aW9uIHVzZU9wdGltaXN0aWNBY3RvcigpIHtcbiAgcmV0dXJuIHVzZVN5bmNFeHRlcm5hbFN0b3JlKF90ZW1wLCBfdGVtcDIsIF90ZW1wMyk7XG59XG5mdW5jdGlvbiBfdGVtcDMoKSB7XG4gIHJldHVybiBlbXB0eUFjdG9yO1xufVxuZnVuY3Rpb24gX3RlbXAyKCkge1xuICByZXR1cm4gYWN0b3I7XG59XG5mdW5jdGlvbiBfdGVtcChsaXN0ZW5lcikge1xuICByZXR1cm4gbGlzdGVuZXJzLmFkZChsaXN0ZW5lciksICgpID0+IGxpc3RlbmVycy5kZWxldGUobGlzdGVuZXIpO1xufVxuZnVuY3Rpb24gdXNlT3B0aW1pc3RpY0FjdG9yUmVhZHkoKSB7XG4gIGNvbnN0IGFjdG9yMiA9IHVzZU9wdGltaXN0aWNBY3RvcigpO1xuICBsZXQgdDA7XG4gIHJldHVybiB0MCA9ICFpc0VtcHR5QWN0b3IoYWN0b3IyKSwgdDA7XG59XG5mdW5jdGlvbiBkZWJvdW5jZShmbiwgdGltZW91dCkge1xuICBsZXQgdGltZXI7XG4gIHJldHVybiAoLi4uYXJncykgPT4ge1xuICAgIGNsZWFyVGltZW91dCh0aW1lciksIHRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBmbi5hcHBseShmbiwgYXJncyk7XG4gICAgfSwgdGltZW91dCk7XG4gIH07XG59XG5mdW5jdGlvbiBnZXREb2N1bWVudHNBbmRTbmFwc2hvdChpZCwgYWN0b3IyKSB7XG4gIGNvbnN0IGluRnJhbWUgPSBpc01heWJlUHJldmlld0lmcmFtZSgpLCBpblBvcFVwID0gaXNNYXliZVByZXZpZXdXaW5kb3coKTtcbiAgaWYgKGlzRW1wdHlBY3RvcihhY3RvcjIpIHx8ICFpbkZyYW1lICYmICFpblBvcFVwKVxuICAgIHRocm93IG5ldyBFcnJvcihcIlRoZSBgdXNlRG9jdW1lbnRzYCBob29rIGNhbm5vdCBiZSB1c2VkIGluIHRoaXMgY29udGV4dFwiKTtcbiAgY29uc3QgZHJhZnRJZCA9IGdldERyYWZ0SWQoaWQpLCBwdWJsaXNoZWRJZCA9IGdldFB1Ymxpc2hlZElkKGlkKSwgZG9jdW1lbnRzID0gYWN0b3IyLmdldFNuYXBzaG90KCkuY29udGV4dD8uZG9jdW1lbnRzLCBkcmFmdERvYyA9IGRvY3VtZW50cz8uW2RyYWZ0SWRdLCBwdWJsaXNoZWREb2MgPSBkb2N1bWVudHM/LltwdWJsaXNoZWRJZF0sIGRvYyA9IGRyYWZ0RG9jIHx8IHB1Ymxpc2hlZERvYztcbiAgaWYgKCFkb2MpXG4gICAgdGhyb3cgbmV3IEVycm9yKGBEb2N1bWVudCBcIiR7aWR9XCIgbm90IGZvdW5kYCk7XG4gIGNvbnN0IHNuYXBzaG90ID0gZHJhZnREb2MuZ2V0U25hcHNob3QoKS5jb250ZXh0Py5sb2NhbCB8fCBwdWJsaXNoZWREb2MuZ2V0U25hcHNob3QoKS5jb250ZXh0Py5sb2NhbCwgc25hcHNob3RQcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICBpZiAoc25hcHNob3QpXG4gICAgICByZXNvbHZlKHNuYXBzaG90KTtcbiAgICBlbHNlIHtcbiAgICAgIGNvbnN0IHN1YnNjcmliZXIgPSBkb2Mub24oXCJyZWFkeVwiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIHNuYXBzaG90OiBzbmFwc2hvdDJcbiAgICAgICAgfSA9IGV2ZW50O1xuICAgICAgICByZXNvbHZlKHNuYXBzaG90MiB8fCBudWxsKSwgc3Vic2NyaWJlci51bnN1YnNjcmliZSgpO1xuICAgICAgfSk7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIHtcbiAgICBkcmFmdERvYyxcbiAgICBkcmFmdElkLFxuICAgIGdldFNuYXBzaG90OiAoKSA9PiBzbmFwc2hvdFByb21pc2UsXG4gICAgcHVibGlzaGVkRG9jLFxuICAgIHB1Ymxpc2hlZElkLFxuICAgIC8qKlxuICAgICAqIEBkZXByZWNhdGVkIC0gdXNlIGBnZXRTbmFwc2hvdGAgaW5zdGVhZFxuICAgICAqL1xuICAgIGdldCBzbmFwc2hvdCgpIHtcbiAgICAgIGlmICghc25hcHNob3QpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgU25hcHNob3QgZm9yIGRvY3VtZW50IFwiJHtpZH1cIiBub3QgZm91bmRgKTtcbiAgICAgIHJldHVybiBzbmFwc2hvdDtcbiAgICB9XG4gIH07XG59XG5mdW5jdGlvbiBjcmVhdGVEb2N1bWVudENvbW1pdChpZCwgYWN0b3IyKSB7XG4gIHJldHVybiAoKSA9PiB7XG4gICAgY29uc3Qge1xuICAgICAgZHJhZnREb2NcbiAgICB9ID0gZ2V0RG9jdW1lbnRzQW5kU25hcHNob3QoaWQsIGFjdG9yMik7XG4gICAgZHJhZnREb2Muc2VuZCh7XG4gICAgICB0eXBlOiBcInN1Ym1pdFwiXG4gICAgfSk7XG4gIH07XG59XG5mdW5jdGlvbiBjcmVhdGVEb2N1bWVudEdldChpZCwgYWN0b3IyKSB7XG4gIHJldHVybiAocGF0aCkgPT4ge1xuICAgIGNvbnN0IHtcbiAgICAgIHNuYXBzaG90XG4gICAgfSA9IGdldERvY3VtZW50c0FuZFNuYXBzaG90KGlkLCBhY3RvcjIpO1xuICAgIHJldHVybiBwYXRoID8gZ2V0KHNuYXBzaG90LCBwYXRoKSA6IHNuYXBzaG90O1xuICB9O1xufVxuZnVuY3Rpb24gY3JlYXRlRG9jdW1lbnRHZXRTbmFwc2hvdChpZCwgYWN0b3IyKSB7XG4gIGNvbnN0IHtcbiAgICBnZXRTbmFwc2hvdFxuICB9ID0gZ2V0RG9jdW1lbnRzQW5kU25hcHNob3QoaWQsIGFjdG9yMik7XG4gIHJldHVybiBnZXRTbmFwc2hvdDtcbn1cbmZ1bmN0aW9uIGNyZWF0ZURvY3VtZW50UGF0Y2goaWQsIGFjdG9yMikge1xuICByZXR1cm4gYXN5bmMgKHBhdGNoZXMsIG9wdGlvbnMpID0+IHtcbiAgICBjb25zdCByZXN1bHQgPSBnZXREb2N1bWVudHNBbmRTbmFwc2hvdChpZCwgYWN0b3IyKSwge1xuICAgICAgZHJhZnREb2MsXG4gICAgICBkcmFmdElkLFxuICAgICAgZ2V0U25hcHNob3QsXG4gICAgICBwdWJsaXNoZWRJZFxuICAgIH0gPSByZXN1bHQsIHtcbiAgICAgIGNvbW1pdCA9ICEwXG4gICAgfSA9IG9wdGlvbnMgfHwge30sIHJlc29sdmVkUGF0Y2hlcyA9IGF3YWl0ICh0eXBlb2YgcGF0Y2hlcyA9PSBcImZ1bmN0aW9uXCIgPyBwYXRjaGVzKHtcbiAgICAgIGRyYWZ0SWQsXG4gICAgICBwdWJsaXNoZWRJZCxcbiAgICAgIC8qKlxuICAgICAgICogQGRlcHJlY2F0ZWQgLSB1c2UgYGdldFNuYXBzaG90YCBpbnN0ZWFkXG4gICAgICAgKi9cbiAgICAgIGdldCBzbmFwc2hvdCgpIHtcbiAgICAgICAgcmV0dXJuIHJlc3VsdC5zbmFwc2hvdDtcbiAgICAgIH0sXG4gICAgICBnZXRTbmFwc2hvdFxuICAgIH0pIDogcGF0Y2hlcyksIF9zbmFwc2hvdCA9IGF3YWl0IGdldFNuYXBzaG90KCk7XG4gICAgaWYgKCFfc25hcHNob3QpXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFNuYXBzaG90IGZvciBkb2N1bWVudCBcIiR7aWR9XCIgbm90IGZvdW5kYCk7XG4gICAgZHJhZnREb2Muc2VuZCh7XG4gICAgICB0eXBlOiBcIm11dGF0ZVwiLFxuICAgICAgbXV0YXRpb25zOiBbXG4gICAgICAgIC8vIEF0dGVtcHQgdG8gY3JlYXRlIHRoZSBkcmFmdCBkb2N1bWVudCwgaXQgbWlnaHQgbm90IGV4aXN0IGlmIHRoZVxuICAgICAgICAvLyBzbmFwc2hvdCB3YXMgZnJvbSB0aGUgcHVibGlzaGVkIGRvY3VtZW50XG4gICAgICAgIGNyZWF0ZUlmTm90RXhpc3RzKHtcbiAgICAgICAgICAuLi5fc25hcHNob3QsXG4gICAgICAgICAgX2lkOiBkcmFmdElkXG4gICAgICAgIH0pLFxuICAgICAgICAvLyBQYXRjaCB0aGUgZHJhZnQgZG9jdW1lbnQgd2l0aCB0aGUgcmVzb2x2ZWQgcGF0Y2hlc1xuICAgICAgICBwYXRjaChkcmFmdElkLCByZXNvbHZlZFBhdGNoZXMpXG4gICAgICBdXG4gICAgfSksIGNvbW1pdCAmJiAodHlwZW9mIGNvbW1pdCA9PSBcIm9iamVjdFwiICYmIFwiZGVib3VuY2VcIiBpbiBjb21taXQgPyBkZWJvdW5jZSgoKSA9PiBkcmFmdERvYy5zZW5kKHtcbiAgICAgIHR5cGU6IFwic3VibWl0XCJcbiAgICB9KSwgY29tbWl0LmRlYm91bmNlKSgpIDogZHJhZnREb2Muc2VuZCh7XG4gICAgICB0eXBlOiBcInN1Ym1pdFwiXG4gICAgfSkpO1xuICB9O1xufVxuZnVuY3Rpb24gdXNlRG9jdW1lbnRzKCkge1xuICBjb25zdCAkID0gYyg3KSwgYWN0b3IyID0gdXNlT3B0aW1pc3RpY0FjdG9yKCk7XG4gIGxldCB0MDtcbiAgJFswXSAhPT0gYWN0b3IyID8gKHQwID0gKGRvY3VtZW50SWQpID0+ICh7XG4gICAgaWQ6IGRvY3VtZW50SWQsXG4gICAgY29tbWl0OiBjcmVhdGVEb2N1bWVudENvbW1pdChkb2N1bWVudElkLCBhY3RvcjIpLFxuICAgIGdldDogY3JlYXRlRG9jdW1lbnRHZXQoZG9jdW1lbnRJZCwgYWN0b3IyKSxcbiAgICBnZXRTbmFwc2hvdDogY3JlYXRlRG9jdW1lbnRHZXRTbmFwc2hvdChkb2N1bWVudElkLCBhY3RvcjIpLFxuICAgIHBhdGNoOiBjcmVhdGVEb2N1bWVudFBhdGNoKGRvY3VtZW50SWQsIGFjdG9yMilcbiAgfSksICRbMF0gPSBhY3RvcjIsICRbMV0gPSB0MCkgOiB0MCA9ICRbMV07XG4gIGNvbnN0IGdldERvY3VtZW50ID0gdDA7XG4gIGxldCB0MTtcbiAgJFsyXSAhPT0gYWN0b3IyID8gKHQxID0gKGlkLCBtdXRhdGlvbnMsIG9wdGlvbnMpID0+IHtcbiAgICBjb25zdCB7XG4gICAgICBkcmFmdERvY1xuICAgIH0gPSBnZXREb2N1bWVudHNBbmRTbmFwc2hvdChpZCwgYWN0b3IyKSwge1xuICAgICAgY29tbWl0OiB0MjJcbiAgICB9ID0gb3B0aW9ucyB8fCB7fSwgY29tbWl0ID0gdDIyID09PSB2b2lkIDAgPyAhMCA6IHQyMjtcbiAgICBkcmFmdERvYy5zZW5kKHtcbiAgICAgIHR5cGU6IFwibXV0YXRlXCIsXG4gICAgICBtdXRhdGlvbnNcbiAgICB9KSwgY29tbWl0ICYmICh0eXBlb2YgY29tbWl0ID09IFwib2JqZWN0XCIgJiYgXCJkZWJvdW5jZVwiIGluIGNvbW1pdCA/IGRlYm91bmNlKCgpID0+IGRyYWZ0RG9jLnNlbmQoe1xuICAgICAgdHlwZTogXCJzdWJtaXRcIlxuICAgIH0pLCBjb21taXQuZGVib3VuY2UpKCkgOiBkcmFmdERvYy5zZW5kKHtcbiAgICAgIHR5cGU6IFwic3VibWl0XCJcbiAgICB9KSk7XG4gIH0sICRbMl0gPSBhY3RvcjIsICRbM10gPSB0MSkgOiB0MSA9ICRbM107XG4gIGNvbnN0IG11dGF0ZURvY3VtZW50ID0gdDE7XG4gIGxldCB0MjtcbiAgcmV0dXJuICRbNF0gIT09IGdldERvY3VtZW50IHx8ICRbNV0gIT09IG11dGF0ZURvY3VtZW50ID8gKHQyID0ge1xuICAgIGdldERvY3VtZW50LFxuICAgIG11dGF0ZURvY3VtZW50XG4gIH0sICRbNF0gPSBnZXREb2N1bWVudCwgJFs1XSA9IG11dGF0ZURvY3VtZW50LCAkWzZdID0gdDIpIDogdDIgPSAkWzZdLCB0Mjtcbn1cbmZ1bmN0aW9uIHdoYXR3Z1JORyhsZW5ndGggPSAxNikge1xuICBjb25zdCBybmRzOCA9IG5ldyBVaW50OEFycmF5KGxlbmd0aCk7XG4gIHJldHVybiBnZXRSYW5kb21WYWx1ZXMocm5kczgpLCBybmRzODtcbn1cbmNvbnN0IGdldEJ5dGVIZXhUYWJsZSA9IC8qIEBfX1BVUkVfXyAqLyAoKCkgPT4ge1xuICBsZXQgdGFibGU7XG4gIHJldHVybiAoKSA9PiB7XG4gICAgaWYgKHRhYmxlKVxuICAgICAgcmV0dXJuIHRhYmxlO1xuICAgIHRhYmxlID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAyNTY7ICsraSlcbiAgICAgIHRhYmxlW2ldID0gKGkgKyAyNTYpLnRvU3RyaW5nKDE2KS5zbGljZSgxKTtcbiAgICByZXR1cm4gdGFibGU7XG4gIH07XG59KSgpO1xuZnVuY3Rpb24gcmFuZG9tS2V5KGxlbmd0aCkge1xuICBjb25zdCB0YWJsZSA9IGdldEJ5dGVIZXhUYWJsZSgpO1xuICByZXR1cm4gd2hhdHdnUk5HKGxlbmd0aCkucmVkdWNlKChzdHIsIG4pID0+IHN0ciArIHRhYmxlW25dLCBcIlwiKS5zbGljZSgwLCBsZW5ndGgpO1xufVxuZnVuY3Rpb24gZ2V0QXJyYXlJdGVtS2V5QW5kUGFyZW50UGF0aChwYXRoT3JOb2RlKSB7XG4gIGNvbnN0IGVsZW1lbnRQYXRoID0gdHlwZW9mIHBhdGhPck5vZGUgPT0gXCJzdHJpbmdcIiA/IHBhdGhPck5vZGUgOiBwYXRoT3JOb2RlLnBhdGgsIGxhc3REb3RJbmRleCA9IGVsZW1lbnRQYXRoLmxhc3RJbmRleE9mKFwiLlwiKSwgbGFzdFBhdGhJdGVtID0gZWxlbWVudFBhdGguc3Vic3RyaW5nKGxhc3REb3RJbmRleCArIDEsIGVsZW1lbnRQYXRoLmxlbmd0aCk7XG4gIGlmICghbGFzdFBhdGhJdGVtLmluZGV4T2YoXCJbXCIpKSB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHBhdGg6IG5vdCBhbiBhcnJheVwiKTtcbiAgY29uc3QgbGFzdEFycmF5SW5kZXggPSBlbGVtZW50UGF0aC5sYXN0SW5kZXhPZihcIltcIiksIHBhdGggPSBlbGVtZW50UGF0aC5zdWJzdHJpbmcoMCwgbGFzdEFycmF5SW5kZXgpO1xuICBsZXQga2V5LCBoYXNFeHBsaWNpdEtleTtcbiAgaWYgKGxhc3RQYXRoSXRlbS5pbmNsdWRlcyhcIl9rZXlcIikpIHtcbiAgICBjb25zdCBzdGFydEluZGV4ID0gbGFzdFBhdGhJdGVtLmluZGV4T2YoJ1wiJykgKyAxLCBlbmRJbmRleCA9IGxhc3RQYXRoSXRlbS5pbmRleE9mKCdcIicsIHN0YXJ0SW5kZXgpO1xuICAgIGtleSA9IGxhc3RQYXRoSXRlbS5zdWJzdHJpbmcoc3RhcnRJbmRleCwgZW5kSW5kZXgpLCBoYXNFeHBsaWNpdEtleSA9ICEwO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IHN0YXJ0SW5kZXggPSBsYXN0UGF0aEl0ZW0uaW5kZXhPZihcIltcIikgKyAxLCBlbmRJbmRleCA9IGxhc3RQYXRoSXRlbS5pbmRleE9mKFwiXVwiLCBzdGFydEluZGV4KTtcbiAgICBrZXkgPSBsYXN0UGF0aEl0ZW0uc3Vic3RyaW5nKHN0YXJ0SW5kZXgsIGVuZEluZGV4KSwgaGFzRXhwbGljaXRLZXkgPSAhMTtcbiAgfVxuICBpZiAoIXBhdGggfHwgIWtleSkgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBwYXRoXCIpO1xuICByZXR1cm4ge1xuICAgIHBhdGgsXG4gICAga2V5LFxuICAgIGhhc0V4cGxpY2l0S2V5XG4gIH07XG59XG5mdW5jdGlvbiBnZXRBcnJheUR1cGxpY2F0ZVBhdGNoZXMobm9kZSwgc25hcHNob3QsIHBvc2l0aW9uID0gXCJhZnRlclwiKSB7XG4gIGNvbnN0IHtcbiAgICBwYXRoOiBhcnJheVBhdGgsXG4gICAga2V5OiBpdGVtS2V5XG4gIH0gPSBnZXRBcnJheUl0ZW1LZXlBbmRQYXJlbnRQYXRoKG5vZGUpLCBkdXBsaWNhdGUgPSB7XG4gICAgLi4uZ2V0KHNuYXBzaG90LCBub2RlLnBhdGgpLFxuICAgIF9rZXk6IHJhbmRvbUtleSgpXG4gIH07XG4gIHJldHVybiBbYXQoYXJyYXlQYXRoLCBpbnNlcnQoZHVwbGljYXRlLCBwb3NpdGlvbiwge1xuICAgIF9rZXk6IGl0ZW1LZXlcbiAgfSkpXTtcbn1cbmZ1bmN0aW9uIGdldEFycmF5UmVtb3ZlUGF0Y2hlcyhub2RlLCBzbmFwc2hvdCkge1xuICBjb25zdCB7XG4gICAgcGF0aDogYXJyYXlQYXRoLFxuICAgIGtleTogaXRlbUtleVxuICB9ID0gZ2V0QXJyYXlJdGVtS2V5QW5kUGFyZW50UGF0aChub2RlKSwgY3VycmVudEluZGV4ID0gZ2V0KHNuYXBzaG90LCBhcnJheVBhdGgpLmZpbmRJbmRleCgoaXRlbSkgPT4gaXRlbS5fa2V5ID09PSBpdGVtS2V5KTtcbiAgcmV0dXJuIFthdChhcnJheVBhdGgsIHRydW5jYXRlKGN1cnJlbnRJbmRleCwgY3VycmVudEluZGV4ICsgMSkpXTtcbn1cbmZ1bmN0aW9uIGdldEFycmF5SW5zZXJ0UGF0Y2hlcyhub2RlLCBpbnNlcnRUeXBlLCBwb3NpdGlvbikge1xuICBjb25zdCB7XG4gICAgcGF0aDogYXJyYXlQYXRoLFxuICAgIGtleTogaXRlbUtleVxuICB9ID0gZ2V0QXJyYXlJdGVtS2V5QW5kUGFyZW50UGF0aChub2RlKSwgaW5zZXJ0S2V5ID0gcmFuZG9tS2V5KCk7XG4gIHJldHVybiBbYXQoYXJyYXlQYXRoLCBpbnNlcnQoW3tcbiAgICBfdHlwZTogaW5zZXJ0VHlwZSxcbiAgICBfa2V5OiBpbnNlcnRLZXlcbiAgfV0sIHBvc2l0aW9uLCB7XG4gICAgX2tleTogaXRlbUtleVxuICB9KSldO1xufVxuYXN5bmMgZnVuY3Rpb24gZ2V0QXJyYXlNb3ZlUGF0Y2hlcyhub2RlLCBkb2MsIG1vdmVUbykge1xuICBpZiAoIW5vZGUudHlwZSkgdGhyb3cgbmV3IEVycm9yKFwiTm9kZSB0eXBlIGlzIG1pc3NpbmdcIik7XG4gIGNvbnN0IHtcbiAgICBwYXRoOiBhcnJheVBhdGgsXG4gICAga2V5OiBpdGVtS2V5XG4gIH0gPSBnZXRBcnJheUl0ZW1LZXlBbmRQYXJlbnRQYXRoKG5vZGUpLCBzbmFwc2hvdCA9IGF3YWl0IGRvYy5nZXRTbmFwc2hvdCgpLCBhcnJheSA9IGdldChzbmFwc2hvdCwgYXJyYXlQYXRoKSwgaXRlbSA9IGdldChzbmFwc2hvdCwgbm9kZS5wYXRoKSwgY3VycmVudEluZGV4ID0gYXJyYXkuZmluZEluZGV4KChpdGVtMikgPT4gaXRlbTIuX2tleSA9PT0gaXRlbUtleSk7XG4gIGxldCBuZXh0SW5kZXggPSAtMSwgcG9zaXRpb24gPSBcImJlZm9yZVwiO1xuICBpZiAobW92ZVRvID09PSBcImZpcnN0XCIpIHtcbiAgICBpZiAoY3VycmVudEluZGV4ID09PSAwKSByZXR1cm4gW107XG4gICAgbmV4dEluZGV4ID0gMCwgcG9zaXRpb24gPSBcImJlZm9yZVwiO1xuICB9IGVsc2UgaWYgKG1vdmVUbyA9PT0gXCJsYXN0XCIpIHtcbiAgICBpZiAoY3VycmVudEluZGV4ID09PSBhcnJheS5sZW5ndGggLSAxKSByZXR1cm4gW107XG4gICAgbmV4dEluZGV4ID0gLTEsIHBvc2l0aW9uID0gXCJhZnRlclwiO1xuICB9IGVsc2UgaWYgKG1vdmVUbyA9PT0gXCJuZXh0XCIpIHtcbiAgICBpZiAoY3VycmVudEluZGV4ID09PSBhcnJheS5sZW5ndGggLSAxKSByZXR1cm4gW107XG4gICAgbmV4dEluZGV4ID0gY3VycmVudEluZGV4LCBwb3NpdGlvbiA9IFwiYWZ0ZXJcIjtcbiAgfSBlbHNlIGlmIChtb3ZlVG8gPT09IFwicHJldmlvdXNcIikge1xuICAgIGlmIChjdXJyZW50SW5kZXggPT09IDApIHJldHVybiBbXTtcbiAgICBuZXh0SW5kZXggPSBjdXJyZW50SW5kZXggLSAxLCBwb3NpdGlvbiA9IFwiYmVmb3JlXCI7XG4gIH1cbiAgcmV0dXJuIFthdChhcnJheVBhdGgsIHRydW5jYXRlKGN1cnJlbnRJbmRleCwgY3VycmVudEluZGV4ICsgMSkpLCBhdChhcnJheVBhdGgsIGluc2VydChpdGVtLCBwb3NpdGlvbiwgbmV4dEluZGV4KSldO1xufVxuZXhwb3J0IHtcbiAgZ2V0LFxuICBnZXRBcnJheUR1cGxpY2F0ZVBhdGNoZXMsXG4gIGdldEFycmF5SW5zZXJ0UGF0Y2hlcyxcbiAgZ2V0QXJyYXlJdGVtS2V5QW5kUGFyZW50UGF0aCxcbiAgZ2V0QXJyYXlNb3ZlUGF0Y2hlcyxcbiAgZ2V0QXJyYXlSZW1vdmVQYXRjaGVzLFxuICB1c2VEb2N1bWVudHMsXG4gIHVzZU9wdGltaXN0aWNBY3RvcixcbiAgdXNlT3B0aW1pc3RpY0FjdG9yUmVhZHlcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tdXRhdGlvbnMuanMubWFwXG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/_chunks-es/mutations.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/optimistic/index.js":
/*!******************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/optimistic/index.js ***!
  \******************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   actor: () => (/* reexport safe */ _chunks_es_context_js__WEBPACK_IMPORTED_MODULE_6__.actor),\n/* harmony export */   createDatasetMutator: () => (/* binding */ createDatasetMutator),\n/* harmony export */   createDocumentMutator: () => (/* binding */ createDocumentMutator),\n/* harmony export */   emptyActor: () => (/* reexport safe */ _chunks_es_context_js__WEBPACK_IMPORTED_MODULE_6__.emptyActor),\n/* harmony export */   isEmptyActor: () => (/* reexport safe */ _chunks_es_context_js__WEBPACK_IMPORTED_MODULE_6__.isEmptyActor),\n/* harmony export */   listeners: () => (/* reexport safe */ _chunks_es_context_js__WEBPACK_IMPORTED_MODULE_6__.listeners),\n/* harmony export */   setActor: () => (/* reexport safe */ _chunks_es_context_js__WEBPACK_IMPORTED_MODULE_6__.setActor)\n/* harmony export */ });\n/* harmony import */ var _chunks_es_context_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../_chunks-es/context.js */ \"(ssr)/./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/_chunks-es/context.js\");\n/* harmony import */ var _sanity_mutate_unstable_machine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sanity/mutate/_unstable_machine */ \"(ssr)/./node_modules/.pnpm/@sanity+mutate@0.11.0-canary.4_xstate@5.19.2/node_modules/@sanity/mutate/dist/_unstable_machine.js\");\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/.pnpm/xstate@5.19.2/node_modules/xstate/actors/dist/xstate-actors.development.esm.js\");\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/.pnpm/xstate@5.19.2/node_modules/xstate/dist/log-0acd9069.development.esm.js\");\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/.pnpm/xstate@5.19.2/node_modules/xstate/dist/xstate.development.esm.js\");\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/.pnpm/xstate@5.19.2/node_modules/xstate/dist/raise-1db27a82.development.esm.js\");\n/* harmony import */ var _sanity_mutate__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sanity/mutate */ \"(ssr)/./node_modules/.pnpm/@sanity+mutate@0.11.0-canary.4_xstate@5.19.2/node_modules/@sanity/mutate/dist/index.js\");\n\n\n\n\nconst createDocumentMutator = (comlink) => {\n  const fetchSnapshot = (0,xstate__WEBPACK_IMPORTED_MODULE_0__.fromPromise)(async ({\n    input,\n    signal\n  }) => {\n    const {\n      id\n    } = input, {\n      snapshot\n    } = await comlink.fetch(\"visual-editing/fetch-snapshot\", {\n      documentId: id\n    }, {\n      signal\n    });\n    return snapshot;\n  }), submitMutations = (0,xstate__WEBPACK_IMPORTED_MODULE_0__.fromPromise)(async ({\n    input\n  }) => {\n    const {\n      transactions\n    } = input;\n    for (const transaction of transactions) {\n      const data = _sanity_mutate__WEBPACK_IMPORTED_MODULE_1__.SanityEncoder.encodeTransaction(transaction);\n      return comlink.post(\"visual-editing/mutate\", data);\n    }\n  });\n  return _sanity_mutate_unstable_machine__WEBPACK_IMPORTED_MODULE_2__.documentMutatorMachine.provide({\n    actions: {\n      \"send sync event to parent\": (0,xstate__WEBPACK_IMPORTED_MODULE_3__.b)(({\n        enqueue\n      }) => {\n        enqueue.sendParent(({\n          context\n        }) => ({\n          type: \"sync\",\n          id: context.id,\n          document: context.remote\n        })), enqueue.emit(({\n          context\n        }) => ({\n          type: \"ready\",\n          snapshot: context.local\n        }));\n      })\n    },\n    actors: {\n      \"fetch remote snapshot\": fetchSnapshot,\n      \"submit mutations as transactions\": submitMutations\n    }\n  });\n}, datasetMutatorMachine = (0,xstate__WEBPACK_IMPORTED_MODULE_4__.setup)({\n  types: {},\n  actions: {\n    \"emit sync event\": (0,xstate__WEBPACK_IMPORTED_MODULE_3__.e)(({\n      event\n    }) => ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"sync\"), event)),\n    \"emit mutation event\": (0,xstate__WEBPACK_IMPORTED_MODULE_3__.e)(({\n      event\n    }) => ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"mutation\"), event)),\n    \"emit rebased event\": (0,xstate__WEBPACK_IMPORTED_MODULE_3__.e)(({\n      event\n    }) => ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, [\"rebased.local\", \"rebased.remote\"]), event)),\n    \"emit pristine event\": (0,xstate__WEBPACK_IMPORTED_MODULE_3__.e)(({\n      event\n    }) => ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, [\"pristine\"]), event)),\n    \"add document actor\": (0,xstate__WEBPACK_IMPORTED_MODULE_3__.a)({\n      documents: ({\n        context,\n        event,\n        spawn\n      }) => {\n        (0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"observe\");\n        const id = event.documentId;\n        return context.documents[id] ? context.documents : {\n          ...context.documents,\n          [id]: spawn(\"documentMutatorMachine\", {\n            input: {\n              id,\n              client: context.client,\n              sharedListener: context.sharedListener || (0,_sanity_mutate_unstable_machine__WEBPACK_IMPORTED_MODULE_2__.createSharedListener)(context.client)\n            },\n            id\n          })\n        };\n      }\n    }),\n    \"stop remote snapshot\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.R)(({\n      context,\n      event\n    }) => ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"unobserve\"), context.documents[event.documentId])),\n    \"remove remote snapshot from context\": (0,xstate__WEBPACK_IMPORTED_MODULE_3__.a)({\n      documents: ({\n        context,\n        event\n      }) => {\n        if ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"unobserve\"), !context.documents[event.documentId]) return context.documents;\n        const {\n          [event.documentId]: _,\n          ...documents\n        } = context.documents;\n        return documents;\n      }\n    })\n  },\n  actors: {\n    documentMutatorMachine: _sanity_mutate_unstable_machine__WEBPACK_IMPORTED_MODULE_2__.documentMutatorMachine\n  }\n}).createMachine({\n  /** @xstate-layout N4IgpgJg5mDOIC5QBsD2BjAhsgIhgrgLZgB2ALgMTICWsZpA2gAwC6ioADqrNWdaiXYgAHogC0ADgBMAOgkA2ACyKArBICcTdfKXSANCACeiFQHYZpgMxWV800yYqp6gIyn5AXw8G0WXAWJyCnwSGjpGViEuHj4BIVEEKUt5OSlFU1smFwkFW0sDY0T1GRUXRXkXKVN7HSYJJkUvHwxsPHQiUjIZDgAnWj4SMApCfDJMemY2JBBo3n5BaYSXeVlbKRUsiXdFSxcXfKNERSqZTbr1zVMJNyaQX1aAzpkIah6yQwp0VEJCXkmo7hzOKLRDLFwyFxaSzXKTOKQudSKCQFRDOczqCSWJjwjbHCQqRFebwgEioCBwIT3fztQJkAExebxcQuFEIZaWGRIrF7dSXKTyFSNYlUtodcjdPp0aiDelAhagBLpVmWAmc46mNwSZTyLQuFS3EWPcUvN6FTiA2LykSoq6c6wbCqVUzparKioyRFVfkq1zqNSWIkeIA */\n  id: \"dataset-mutator\",\n  context: ({\n    input\n  }) => ({\n    documents: {},\n    client: input.client,\n    sharedListener: input.sharedListener\n  }),\n  on: {\n    sync: {\n      actions: [\"emit sync event\"]\n    },\n    mutation: {\n      actions: [\"emit mutation event\"]\n    },\n    \"rebased.*\": {\n      actions: [\"emit rebased event\"]\n    },\n    pristine: {\n      actions: [\"emit pristine event\"]\n    },\n    observe: {\n      actions: [\"add document actor\"]\n    },\n    unobserve: {\n      actions: [\"stop remote snapshot\", \"remove remote snapshot from context\"]\n    }\n  },\n  initial: \"pristine\",\n  states: {\n    pristine: {}\n  }\n}), createDatasetMutator = (comlink) => datasetMutatorMachine.provide({\n  actors: {\n    documentMutatorMachine: createDocumentMutator(comlink)\n  }\n});\n\n//# sourceMappingURL=index.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHNhbml0eSt2aXN1YWwtZWRpdGluZ0AyLjEzLjE1X0BlbW90aW9uK2lzLXByb3AtdmFsaWRAMS4yLjJfQHNhbml0eStjbGllbnRANi4yOC40X0BzYW5pXzhjMjAzM2ZlYWJkNWY1ODRhZjQ0NjliZmNlMTQxNTNmL25vZGVfbW9kdWxlcy9Ac2FuaXR5L3Zpc3VhbC1lZGl0aW5nL2Rpc3Qvb3B0aW1pc3RpYy9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFnRztBQUNBO0FBQ0U7QUFDbkQ7QUFDL0M7QUFDQSx3QkFBd0IsbURBQVc7QUFDbkM7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRyxxQkFBcUIsbURBQVc7QUFDbkM7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLG1CQUFtQix5REFBYTtBQUNoQztBQUNBO0FBQ0EsR0FBRztBQUNILFNBQVMsbUZBQXNCO0FBQy9CO0FBQ0EsbUNBQW1DLHlDQUFjO0FBQ2pEO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxDQUFDLDBCQUEwQiw2Q0FBSztBQUNoQyxXQUFXO0FBQ1g7QUFDQSx1QkFBdUIseUNBQUk7QUFDM0I7QUFDQSxLQUFLLE1BQU0sbURBQVc7QUFDdEIsMkJBQTJCLHlDQUFJO0FBQy9CO0FBQ0EsS0FBSyxNQUFNLG1EQUFXO0FBQ3RCLDBCQUEwQix5Q0FBSTtBQUM5QjtBQUNBLEtBQUssTUFBTSxtREFBVztBQUN0QiwyQkFBMkIseUNBQUk7QUFDL0I7QUFDQSxLQUFLLE1BQU0sbURBQVc7QUFDdEIsMEJBQTBCLHlDQUFNO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLFFBQVEsbURBQVc7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3REFBd0QscUZBQW9CO0FBQzVFLGFBQWE7QUFDYjtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsS0FBSztBQUNMLDRCQUE0Qix5Q0FBUztBQUNyQztBQUNBO0FBQ0EsS0FBSyxNQUFNLG1EQUFXO0FBQ3RCLDJDQUEyQyx5Q0FBTTtBQUNqRDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsWUFBWSxtREFBVztBQUN2QjtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFTQztBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvcGV0cm9rdmFydHNpYW55aS9jb2RlL2dlb211bmR1cy13ZWJzaXRlL25vZGVfbW9kdWxlcy8ucG5wbS9Ac2FuaXR5K3Zpc3VhbC1lZGl0aW5nQDIuMTMuMTVfQGVtb3Rpb24raXMtcHJvcC12YWxpZEAxLjIuMl9Ac2FuaXR5K2NsaWVudEA2LjI4LjRfQHNhbmlfOGMyMDMzZmVhYmQ1ZjU4NGFmNDQ2OWJmY2UxNDE1M2Yvbm9kZV9tb2R1bGVzL0BzYW5pdHkvdmlzdWFsLWVkaXRpbmcvZGlzdC9vcHRpbWlzdGljL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGFjdG9yLCBlbXB0eUFjdG9yLCBpc0VtcHR5QWN0b3IsIGxpc3RlbmVycywgc2V0QWN0b3IgfSBmcm9tIFwiLi4vX2NodW5rcy1lcy9jb250ZXh0LmpzXCI7XG5pbXBvcnQgeyBkb2N1bWVudE11dGF0b3JNYWNoaW5lLCBjcmVhdGVTaGFyZWRMaXN0ZW5lciB9IGZyb20gXCJAc2FuaXR5L211dGF0ZS9fdW5zdGFibGVfbWFjaGluZVwiO1xuaW1wb3J0IHsgZnJvbVByb21pc2UsIGVucXVldWVBY3Rpb25zLCBzZXR1cCwgYXNzaWduLCBzdG9wQ2hpbGQsIGVtaXQsIGFzc2VydEV2ZW50IH0gZnJvbSBcInhzdGF0ZVwiO1xuaW1wb3J0IHsgU2FuaXR5RW5jb2RlciB9IGZyb20gXCJAc2FuaXR5L211dGF0ZVwiO1xuY29uc3QgY3JlYXRlRG9jdW1lbnRNdXRhdG9yID0gKGNvbWxpbmspID0+IHtcbiAgY29uc3QgZmV0Y2hTbmFwc2hvdCA9IGZyb21Qcm9taXNlKGFzeW5jICh7XG4gICAgaW5wdXQsXG4gICAgc2lnbmFsXG4gIH0pID0+IHtcbiAgICBjb25zdCB7XG4gICAgICBpZFxuICAgIH0gPSBpbnB1dCwge1xuICAgICAgc25hcHNob3RcbiAgICB9ID0gYXdhaXQgY29tbGluay5mZXRjaChcInZpc3VhbC1lZGl0aW5nL2ZldGNoLXNuYXBzaG90XCIsIHtcbiAgICAgIGRvY3VtZW50SWQ6IGlkXG4gICAgfSwge1xuICAgICAgc2lnbmFsXG4gICAgfSk7XG4gICAgcmV0dXJuIHNuYXBzaG90O1xuICB9KSwgc3VibWl0TXV0YXRpb25zID0gZnJvbVByb21pc2UoYXN5bmMgKHtcbiAgICBpbnB1dFxuICB9KSA9PiB7XG4gICAgY29uc3Qge1xuICAgICAgdHJhbnNhY3Rpb25zXG4gICAgfSA9IGlucHV0O1xuICAgIGZvciAoY29uc3QgdHJhbnNhY3Rpb24gb2YgdHJhbnNhY3Rpb25zKSB7XG4gICAgICBjb25zdCBkYXRhID0gU2FuaXR5RW5jb2Rlci5lbmNvZGVUcmFuc2FjdGlvbih0cmFuc2FjdGlvbik7XG4gICAgICByZXR1cm4gY29tbGluay5wb3N0KFwidmlzdWFsLWVkaXRpbmcvbXV0YXRlXCIsIGRhdGEpO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiBkb2N1bWVudE11dGF0b3JNYWNoaW5lLnByb3ZpZGUoe1xuICAgIGFjdGlvbnM6IHtcbiAgICAgIFwic2VuZCBzeW5jIGV2ZW50IHRvIHBhcmVudFwiOiBlbnF1ZXVlQWN0aW9ucygoe1xuICAgICAgICBlbnF1ZXVlXG4gICAgICB9KSA9PiB7XG4gICAgICAgIGVucXVldWUuc2VuZFBhcmVudCgoe1xuICAgICAgICAgIGNvbnRleHRcbiAgICAgICAgfSkgPT4gKHtcbiAgICAgICAgICB0eXBlOiBcInN5bmNcIixcbiAgICAgICAgICBpZDogY29udGV4dC5pZCxcbiAgICAgICAgICBkb2N1bWVudDogY29udGV4dC5yZW1vdGVcbiAgICAgICAgfSkpLCBlbnF1ZXVlLmVtaXQoKHtcbiAgICAgICAgICBjb250ZXh0XG4gICAgICAgIH0pID0+ICh7XG4gICAgICAgICAgdHlwZTogXCJyZWFkeVwiLFxuICAgICAgICAgIHNuYXBzaG90OiBjb250ZXh0LmxvY2FsXG4gICAgICAgIH0pKTtcbiAgICAgIH0pXG4gICAgfSxcbiAgICBhY3RvcnM6IHtcbiAgICAgIFwiZmV0Y2ggcmVtb3RlIHNuYXBzaG90XCI6IGZldGNoU25hcHNob3QsXG4gICAgICBcInN1Ym1pdCBtdXRhdGlvbnMgYXMgdHJhbnNhY3Rpb25zXCI6IHN1Ym1pdE11dGF0aW9uc1xuICAgIH1cbiAgfSk7XG59LCBkYXRhc2V0TXV0YXRvck1hY2hpbmUgPSBzZXR1cCh7XG4gIHR5cGVzOiB7fSxcbiAgYWN0aW9uczoge1xuICAgIFwiZW1pdCBzeW5jIGV2ZW50XCI6IGVtaXQoKHtcbiAgICAgIGV2ZW50XG4gICAgfSkgPT4gKGFzc2VydEV2ZW50KGV2ZW50LCBcInN5bmNcIiksIGV2ZW50KSksXG4gICAgXCJlbWl0IG11dGF0aW9uIGV2ZW50XCI6IGVtaXQoKHtcbiAgICAgIGV2ZW50XG4gICAgfSkgPT4gKGFzc2VydEV2ZW50KGV2ZW50LCBcIm11dGF0aW9uXCIpLCBldmVudCkpLFxuICAgIFwiZW1pdCByZWJhc2VkIGV2ZW50XCI6IGVtaXQoKHtcbiAgICAgIGV2ZW50XG4gICAgfSkgPT4gKGFzc2VydEV2ZW50KGV2ZW50LCBbXCJyZWJhc2VkLmxvY2FsXCIsIFwicmViYXNlZC5yZW1vdGVcIl0pLCBldmVudCkpLFxuICAgIFwiZW1pdCBwcmlzdGluZSBldmVudFwiOiBlbWl0KCh7XG4gICAgICBldmVudFxuICAgIH0pID0+IChhc3NlcnRFdmVudChldmVudCwgW1wicHJpc3RpbmVcIl0pLCBldmVudCkpLFxuICAgIFwiYWRkIGRvY3VtZW50IGFjdG9yXCI6IGFzc2lnbih7XG4gICAgICBkb2N1bWVudHM6ICh7XG4gICAgICAgIGNvbnRleHQsXG4gICAgICAgIGV2ZW50LFxuICAgICAgICBzcGF3blxuICAgICAgfSkgPT4ge1xuICAgICAgICBhc3NlcnRFdmVudChldmVudCwgXCJvYnNlcnZlXCIpO1xuICAgICAgICBjb25zdCBpZCA9IGV2ZW50LmRvY3VtZW50SWQ7XG4gICAgICAgIHJldHVybiBjb250ZXh0LmRvY3VtZW50c1tpZF0gPyBjb250ZXh0LmRvY3VtZW50cyA6IHtcbiAgICAgICAgICAuLi5jb250ZXh0LmRvY3VtZW50cyxcbiAgICAgICAgICBbaWRdOiBzcGF3bihcImRvY3VtZW50TXV0YXRvck1hY2hpbmVcIiwge1xuICAgICAgICAgICAgaW5wdXQ6IHtcbiAgICAgICAgICAgICAgaWQsXG4gICAgICAgICAgICAgIGNsaWVudDogY29udGV4dC5jbGllbnQsXG4gICAgICAgICAgICAgIHNoYXJlZExpc3RlbmVyOiBjb250ZXh0LnNoYXJlZExpc3RlbmVyIHx8IGNyZWF0ZVNoYXJlZExpc3RlbmVyKGNvbnRleHQuY2xpZW50KVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGlkXG4gICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9KSxcbiAgICBcInN0b3AgcmVtb3RlIHNuYXBzaG90XCI6IHN0b3BDaGlsZCgoe1xuICAgICAgY29udGV4dCxcbiAgICAgIGV2ZW50XG4gICAgfSkgPT4gKGFzc2VydEV2ZW50KGV2ZW50LCBcInVub2JzZXJ2ZVwiKSwgY29udGV4dC5kb2N1bWVudHNbZXZlbnQuZG9jdW1lbnRJZF0pKSxcbiAgICBcInJlbW92ZSByZW1vdGUgc25hcHNob3QgZnJvbSBjb250ZXh0XCI6IGFzc2lnbih7XG4gICAgICBkb2N1bWVudHM6ICh7XG4gICAgICAgIGNvbnRleHQsXG4gICAgICAgIGV2ZW50XG4gICAgICB9KSA9PiB7XG4gICAgICAgIGlmIChhc3NlcnRFdmVudChldmVudCwgXCJ1bm9ic2VydmVcIiksICFjb250ZXh0LmRvY3VtZW50c1tldmVudC5kb2N1bWVudElkXSkgcmV0dXJuIGNvbnRleHQuZG9jdW1lbnRzO1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgW2V2ZW50LmRvY3VtZW50SWRdOiBfLFxuICAgICAgICAgIC4uLmRvY3VtZW50c1xuICAgICAgICB9ID0gY29udGV4dC5kb2N1bWVudHM7XG4gICAgICAgIHJldHVybiBkb2N1bWVudHM7XG4gICAgICB9XG4gICAgfSlcbiAgfSxcbiAgYWN0b3JzOiB7XG4gICAgZG9jdW1lbnRNdXRhdG9yTWFjaGluZVxuICB9XG59KS5jcmVhdGVNYWNoaW5lKHtcbiAgLyoqIEB4c3RhdGUtbGF5b3V0IE40SWdwZ0pnNW1ET0lDNVFCc0QyQmpBaHNnSWhncmdMWmdCMkFMZ01USUNXc1pwQTJnQXdDNmlvQURxck5XZGFpWFlnQUhvZ0MwQURnQk1BT2drQTJBQ3lLQXJCSUNjVGRmS1hTQU5DQUNlaUZRSFlacGdNeFdWODAweVlxcDZnSXluNUFYdzhHMFdYQVdKeUNud1NHanBHVmlFdUhqNEJJVkVFS1V0NU9TbEZVMXNtRndrRlcwc0RZMFQxR1JVWFJYa1hLVk43SFNZSkprVXZId3hzUEhRaVVqSVpEZ0FuV2o0U01BcENmREpNZW1ZMkpCQm8zbjVCYVlTWGVWbGJLUlVzaVhkRlN4Y1hmS05FUlNxWlRicjF6Vk1KTnlhUVgxYUF6cGtJYWg2eVF3cDBWRUpDWGttbzdoek9LTFJETEZ3eUZ4YVN6WEtUT0tRdWRTS0NRRlJET2N6cUNTV0pqd2piSENRcVJGZWJ3Z0Vpb0NCd0lUM2Z6dFFKa0FFeGVieGNRdUZFSVphV0dSSXJGN2RTWEtUeUZTTllsVXRvZGNqZFBwMGFpRGVsQWhhZ0JMcFZtV0FtYzQ2bU53U1pUeUxRdUZTM0VXUGNVdk42RlRpQTJMeWtTb3E2YzZ3YkNxVlV6cGFyS2lveVJGVmZrcTF6cU5TV0lrZUlBICovXG4gIGlkOiBcImRhdGFzZXQtbXV0YXRvclwiLFxuICBjb250ZXh0OiAoe1xuICAgIGlucHV0XG4gIH0pID0+ICh7XG4gICAgZG9jdW1lbnRzOiB7fSxcbiAgICBjbGllbnQ6IGlucHV0LmNsaWVudCxcbiAgICBzaGFyZWRMaXN0ZW5lcjogaW5wdXQuc2hhcmVkTGlzdGVuZXJcbiAgfSksXG4gIG9uOiB7XG4gICAgc3luYzoge1xuICAgICAgYWN0aW9uczogW1wiZW1pdCBzeW5jIGV2ZW50XCJdXG4gICAgfSxcbiAgICBtdXRhdGlvbjoge1xuICAgICAgYWN0aW9uczogW1wiZW1pdCBtdXRhdGlvbiBldmVudFwiXVxuICAgIH0sXG4gICAgXCJyZWJhc2VkLipcIjoge1xuICAgICAgYWN0aW9uczogW1wiZW1pdCByZWJhc2VkIGV2ZW50XCJdXG4gICAgfSxcbiAgICBwcmlzdGluZToge1xuICAgICAgYWN0aW9uczogW1wiZW1pdCBwcmlzdGluZSBldmVudFwiXVxuICAgIH0sXG4gICAgb2JzZXJ2ZToge1xuICAgICAgYWN0aW9uczogW1wiYWRkIGRvY3VtZW50IGFjdG9yXCJdXG4gICAgfSxcbiAgICB1bm9ic2VydmU6IHtcbiAgICAgIGFjdGlvbnM6IFtcInN0b3AgcmVtb3RlIHNuYXBzaG90XCIsIFwicmVtb3ZlIHJlbW90ZSBzbmFwc2hvdCBmcm9tIGNvbnRleHRcIl1cbiAgICB9XG4gIH0sXG4gIGluaXRpYWw6IFwicHJpc3RpbmVcIixcbiAgc3RhdGVzOiB7XG4gICAgcHJpc3RpbmU6IHt9XG4gIH1cbn0pLCBjcmVhdGVEYXRhc2V0TXV0YXRvciA9IChjb21saW5rKSA9PiBkYXRhc2V0TXV0YXRvck1hY2hpbmUucHJvdmlkZSh7XG4gIGFjdG9yczoge1xuICAgIGRvY3VtZW50TXV0YXRvck1hY2hpbmU6IGNyZWF0ZURvY3VtZW50TXV0YXRvcihjb21saW5rKVxuICB9XG59KTtcbmV4cG9ydCB7XG4gIGFjdG9yLFxuICBjcmVhdGVEYXRhc2V0TXV0YXRvcixcbiAgY3JlYXRlRG9jdW1lbnRNdXRhdG9yLFxuICBlbXB0eUFjdG9yLFxuICBpc0VtcHR5QWN0b3IsXG4gIGxpc3RlbmVycyxcbiAgc2V0QWN0b3Jcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXBcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/optimistic/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/react/index.js":
/*!*************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/react/index.js ***!
  \*************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VisualEditing: () => (/* binding */ VisualEditing),\n/* harmony export */   createDataAttribute: () => (/* reexport safe */ _sanity_visual_editing_csm__WEBPACK_IMPORTED_MODULE_11__.createDataAttribute),\n/* harmony export */   createDatasetMutator: () => (/* reexport safe */ _optimistic_index_js__WEBPACK_IMPORTED_MODULE_19__.createDatasetMutator),\n/* harmony export */   createDocumentMutator: () => (/* reexport safe */ _optimistic_index_js__WEBPACK_IMPORTED_MODULE_19__.createDocumentMutator),\n/* harmony export */   emptyActor: () => (/* reexport safe */ _chunks_es_context_js__WEBPACK_IMPORTED_MODULE_21__.emptyActor),\n/* harmony export */   useDocuments: () => (/* reexport safe */ _chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.useDocuments),\n/* harmony export */   useOptimistic: () => (/* reexport safe */ _chunks_es_SharedStateContext_js__WEBPACK_IMPORTED_MODULE_13__.useOptimistic),\n/* harmony export */   useOptimisticActor: () => (/* reexport safe */ _chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.useOptimisticActor)\n/* harmony export */ });\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-runtime */ \"(ssr)/./node_modules/.pnpm/next@15.2.4_@babel+core@7.26.10_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.js\");\n/* harmony import */ var react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-compiler-runtime */ \"(ssr)/./node_modules/.pnpm/react-compiler-runtime@19.0.0-beta-e993439-20250328_react@19.1.0/node_modules/react-compiler-runtime/dist/index.js\");\n/* harmony import */ var _sanity_presentation_comlink__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @sanity/presentation-comlink */ \"(ssr)/./node_modules/.pnpm/@sanity+presentation-comlink@1.0.14_@sanity+client@6.28.4_@sanity+types@3.83.0_@types+react@19.1.0_/node_modules/@sanity/presentation-comlink/dist/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/.pnpm/next@15.2.4_@babel+core@7.26.10_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-dom */ \"(ssr)/./node_modules/.pnpm/next@15.2.4_@babel+core@7.26.10_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react-dom.js\");\n/* harmony import */ var _sanity_client_csm__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @sanity/client/csm */ \"(ssr)/./node_modules/.pnpm/@sanity+client@6.28.4_debug@4.4.0/node_modules/@sanity/client/dist/_chunks-es/resolveEditInfo.js\");\n/* harmony import */ var _sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @sanity/ui/_visual-editing */ \"(ssr)/./node_modules/.pnpm/@sanity+ui@2.15.13_@emotion+is-prop-valid@1.2.2_react-dom@19.1.0_react@19.1.0__react-is_6a53d62aae3ab5ea8599da7dda1e9a92/node_modules/@sanity/ui/dist/_chunks-es/_visual-editing.mjs\");\n/* harmony import */ var styled_components__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! styled-components */ \"(ssr)/./node_modules/.pnpm/styled-components@6.1.17_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/styled-components/dist/styled-components.esm.js\");\n/* harmony import */ var _chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../_chunks-es/mutations.js */ \"(ssr)/./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/_chunks-es/mutations.js\");\n/* harmony import */ var _chunks_es_SharedStateContext_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../_chunks-es/SharedStateContext.js */ \"(ssr)/./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/_chunks-es/SharedStateContext.js\");\n/* harmony import */ var _sanity_mutate__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sanity/mutate */ \"(ssr)/./node_modules/.pnpm/@sanity+mutate@0.11.0-canary.4_xstate@5.19.2/node_modules/@sanity/mutate/dist/index.js\");\n/* harmony import */ var _chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../_chunks-es/PointerEvents.js */ \"(ssr)/./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/_chunks-es/PointerEvents.js\");\n/* harmony import */ var _sanity_icons__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @sanity/icons */ \"(ssr)/./node_modules/.pnpm/@sanity+icons@3.7.0_react@19.1.0/node_modules/@sanity/icons/dist/index.js\");\n/* harmony import */ var _sanity_visual_editing_csm__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @sanity/visual-editing-csm */ \"(ssr)/./node_modules/.pnpm/@sanity+visual-editing-csm@2.0.11_@sanity+client@6.28.4_@sanity+types@3.83.0_@types+react@19.1.0_/node_modules/@sanity/visual-editing-csm/dist/index.js\");\n/* harmony import */ var scroll_into_view_if_needed__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! scroll-into-view-if-needed */ \"(ssr)/./node_modules/.pnpm/scroll-into-view-if-needed@3.1.0/node_modules/scroll-into-view-if-needed/dist/index.js\");\n/* harmony import */ var _sanity_comlink__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @sanity/comlink */ \"(ssr)/./node_modules/.pnpm/@sanity+comlink@3.0.1/node_modules/@sanity/comlink/dist/index.js\");\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/.pnpm/xstate@5.19.2/node_modules/xstate/dist/raise-1db27a82.development.esm.js\");\n/* harmony import */ var _chunks_es_context_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../_chunks-es/context.js */ \"(ssr)/./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/_chunks-es/context.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! rxjs */ \"(ssr)/./node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/ReplaySubject.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! rxjs */ \"(ssr)/./node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/Subject.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! rxjs */ \"(ssr)/./node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/observable/merge.js\");\n/* harmony import */ var _optimistic_index_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../optimistic/index.js */ \"(ssr)/./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/optimistic/index.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst History = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(8), {\n    comlink,\n    history\n  } = props;\n  let t0, t1;\n  $[0] !== comlink || $[1] !== history ? (t0 = () => comlink?.on(\"presentation/navigate\", (data) => {\n    history?.update(data);\n  }), t1 = [comlink, history], $[0] = comlink, $[1] = history, $[2] = t0, $[3] = t1) : (t0 = $[2], t1 = $[3]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t0, t1);\n  let t2, t3;\n  return $[4] !== comlink || $[5] !== history ? (t2 = () => {\n    if (history)\n      return history.subscribe((update) => {\n        update.title = update.title || document.title, comlink?.post(\"visual-editing/navigate\", update);\n      });\n  }, t3 = [comlink, history], $[4] = comlink, $[5] = history, $[6] = t2, $[7] = t3) : (t2 = $[6], t3 = $[7]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t2, t3), null;\n}, Meta = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(3), {\n    comlink\n  } = props;\n  let t0, t1;\n  return $[0] !== comlink ? (t0 = () => {\n    const sendMeta = () => {\n      comlink.post(\"visual-editing/meta\", {\n        title: document.title\n      });\n    }, observer = new MutationObserver((t2) => {\n      const [mutation] = t2;\n      mutation.target.nodeName === \"TITLE\" && sendMeta();\n    });\n    return observer.observe(document.head, {\n      subtree: !0,\n      characterData: !0,\n      childList: !0\n    }), sendMeta(), () => observer.disconnect();\n  }, t1 = [comlink], $[0] = comlink, $[1] = t0, $[2] = t1) : (t0 = $[1], t1 = $[2]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t0, t1), null;\n};\nfunction getReferenceNodeAndInsertPosition(position) {\n  if (position) {\n    const {\n      top,\n      right,\n      bottom,\n      left\n    } = position;\n    if (left || top)\n      return {\n        node: (left ?? top).sanity,\n        position: \"after\"\n      };\n    if (right || bottom)\n      return {\n        node: (right ?? bottom).sanity,\n        position: \"before\"\n      };\n  }\n}\nfunction useDragEndEvents() {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(4), {\n    getDocument\n  } = (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.useDocuments)();\n  let t0, t1;\n  $[0] !== getDocument ? (t0 = () => {\n    const handler = (e) => {\n      const {\n        insertPosition,\n        target,\n        preventInsertDefault\n      } = e.detail;\n      if (preventInsertDefault)\n        return;\n      const reference = getReferenceNodeAndInsertPosition(insertPosition);\n      if (reference) {\n        const doc = getDocument(target.id), {\n          node,\n          position\n        } = reference, {\n          key: targetKey,\n          hasExplicitKey\n        } = (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayItemKeyAndParentPath)(target), {\n          path: arrayPath,\n          key: referenceItemKey\n        } = (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayItemKeyAndParentPath)(node);\n        arrayPath && referenceItemKey && referenceItemKey !== targetKey && doc.patch(async (t22) => {\n          const {\n            getSnapshot\n          } = t22, snapshot = await getSnapshot(), elementValue = (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.get)(snapshot, target.path);\n          return hasExplicitKey ? [(0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.remove)({\n            _key: targetKey\n          })), (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.insert)(elementValue, position, {\n            _key: referenceItemKey\n          }))] : [(0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.remove)(~~targetKey)), (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.insert)(elementValue, position, referenceItemKey > targetKey ? ~~referenceItemKey - 1 : ~~referenceItemKey))];\n        });\n      }\n    };\n    return window.addEventListener(\"sanity/dragEnd\", handler), () => {\n      window.removeEventListener(\"sanity/dragEnd\", handler);\n    };\n  }, t1 = [getDocument], $[0] = getDocument, $[1] = t0, $[2] = t1) : (t0 = $[1], t1 = $[2]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t0, t1);\n  const dispatchDragEndEvent = _temp$9;\n  let t2;\n  return $[3] === Symbol.for(\"react.memo_cache_sentinel\") ? (t2 = {\n    dispatchDragEndEvent\n  }, $[3] = t2) : t2 = $[3], t2;\n}\nfunction _temp$9(event) {\n  const customEvent = new CustomEvent(\"sanity/dragEnd\", {\n    detail: event,\n    cancelable: !0\n  });\n  window.dispatchEvent(customEvent);\n}\nconst SchemaContext = (0,react__WEBPACK_IMPORTED_MODULE_2__.createContext)(null);\nfunction useSchema() {\n  const context = (0,react__WEBPACK_IMPORTED_MODULE_2__.useContext)(SchemaContext);\n  if (!context)\n    throw new Error(\"Schema context is missing\");\n  return context;\n}\nfunction getArrayRemoveAction(node, doc) {\n  if (!node.type) throw new Error(\"Node type is missing\");\n  return () => doc.patch(async ({\n    getSnapshot\n  }) => (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayRemovePatches)(node, await getSnapshot()));\n}\nfunction getArrayInsertAction(node, doc, insertType, position) {\n  if (!node.type) throw new Error(\"Node type is missing\");\n  return () => doc.patch(() => (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayInsertPatches)(node, insertType, position));\n}\nfunction getDuplicateAction(node, doc) {\n  if (!node.type) throw new Error(\"Node type is missing\");\n  return () => doc.patch(async ({\n    getSnapshot\n  }) => (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayDuplicatePatches)(node, await getSnapshot()));\n}\nfunction getContextMenuItems(context) {\n  const {\n    node,\n    field,\n    parent,\n    doc\n  } = context;\n  return field?.type === \"arrayItem\" ? getContextMenuArrayItems({\n    node,\n    field,\n    doc\n  }) : parent?.type === \"union\" ? getContextMenuUnionItems({\n    node,\n    parent,\n    doc\n  }) : Promise.resolve([]);\n}\nfunction getDuplicateItem(context) {\n  const {\n    node,\n    doc\n  } = context;\n  return doc ? [{\n    type: \"action\",\n    label: \"Duplicate\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.CopyIcon,\n    action: getDuplicateAction(node, doc),\n    telemetryEvent: \"Visual Editing Context Menu Item Duplicated\"\n  }] : [];\n}\nfunction getRemoveItems(context) {\n  const {\n    node,\n    doc\n  } = context;\n  return doc ? [{\n    type: \"action\",\n    label: \"Remove\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.RemoveIcon,\n    action: getArrayRemoveAction(node, doc),\n    telemetryEvent: \"Visual Editing Context Menu Item Removed\"\n  }] : [];\n}\nasync function getMoveItems(context, withDivider = !0) {\n  const {\n    node,\n    doc\n  } = context;\n  if (!doc) return [];\n  const items = [], groupItems = [], [moveUpPatches, moveDownPatches, moveFirstPatches, moveLastPatches] = await Promise.all([(0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayMovePatches)(node, doc, \"previous\"), (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayMovePatches)(node, doc, \"next\"), (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayMovePatches)(node, doc, \"first\"), (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayMovePatches)(node, doc, \"last\")]);\n  return moveFirstPatches.length && groupItems.push({\n    type: \"action\",\n    label: \"To top\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.PublishIcon,\n    action: () => doc.patch(moveFirstPatches),\n    telemetryEvent: \"Visual Editing Context Menu Item Moved\"\n  }), moveUpPatches.length && groupItems.push({\n    type: \"action\",\n    label: \"Up\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.ArrowUpIcon,\n    action: () => doc.patch(moveUpPatches),\n    telemetryEvent: \"Visual Editing Context Menu Item Moved\"\n  }), moveDownPatches.length && groupItems.push({\n    type: \"action\",\n    label: \"Down\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.ArrowDownIcon,\n    action: () => doc.patch(moveDownPatches),\n    telemetryEvent: \"Visual Editing Context Menu Item Moved\"\n  }), moveLastPatches.length && groupItems.push({\n    type: \"action\",\n    label: \"To bottom\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.UnpublishIcon,\n    action: () => doc.patch(moveLastPatches),\n    telemetryEvent: \"Visual Editing Context Menu Item Moved\"\n  }), groupItems.length && (items.push({\n    type: \"group\",\n    label: \"Move\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.SortIcon,\n    items: groupItems\n  }), withDivider && items.push({\n    type: \"divider\"\n  })), items;\n}\nasync function getContextMenuArrayItems(context) {\n  const {\n    node,\n    field,\n    doc\n  } = context, items = [];\n  return items.push(...getDuplicateItem(context)), items.push(...getRemoveItems(context)), items.push(...await getMoveItems(context)), items.push({\n    type: \"action\",\n    label: \"Insert before\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.InsertAboveIcon,\n    action: getArrayInsertAction(node, doc, field.name, \"before\"),\n    telemetryEvent: \"Visual Editing Context Menu Item Inserted\"\n  }), items.push({\n    type: \"action\",\n    label: \"Insert after\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.InsertBelowIcon,\n    action: getArrayInsertAction(node, doc, field.name, \"after\"),\n    telemetryEvent: \"Visual Editing Context Menu Item Inserted\"\n  }), items;\n}\nconst InsertMenuWrapper = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(12), {\n    label,\n    parent,\n    width,\n    onSelect,\n    boundaryElement\n  } = props;\n  let t0;\n  $[0] === Symbol.for(\"react.memo_cache_sentinel\") ? (t0 = [\"left-start\", \"right\", \"left\", \"right-end\", \"left-end\", \"bottom\", \"top\"], $[0] = t0) : t0 = $[0];\n  let t1;\n  $[1] === Symbol.for(\"react.memo_cache_sentinel\") ? (t1 = [4, 4, 4, 4], $[1] = t1) : t1 = $[1];\n  let t2;\n  $[2] !== boundaryElement || $[3] !== width ? (t2 = {\n    arrow: !1,\n    constrainSize: !0,\n    floatingBoundary: boundaryElement,\n    padding: 0,\n    placement: \"right-start\",\n    fallbackPlacements: t0,\n    preventOverflow: !0,\n    width,\n    __unstable_margins: t1\n  }, $[2] = boundaryElement, $[3] = width, $[4] = t2) : t2 = $[4];\n  let t3;\n  $[5] !== onSelect || $[6] !== parent ? (t3 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.InsertMenu, { node: parent, onSelect }), $[5] = onSelect, $[6] = parent, $[7] = t3) : t3 = $[7];\n  let t4;\n  return $[8] !== label || $[9] !== t2 || $[10] !== t3 ? (t4 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.MenuGroup, { fontSize: 1, icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.InsertBelowIcon, padding: 2, popover: t2, space: 2, text: label, children: t3 }), $[8] = label, $[9] = t2, $[10] = t3, $[11] = t4) : t4 = $[11], t4;\n};\nasync function getContextMenuUnionItems(context) {\n  const {\n    doc,\n    node,\n    parent\n  } = context, items = [];\n  if (items.push(...getDuplicateItem(context)), items.push(...getRemoveItems(context)), items.push(...await getMoveItems(context)), parent.options?.insertMenu) {\n    const width = (parent.options.insertMenu || {}).views?.some((view) => view.name === \"grid\") ? 0 : void 0;\n    items.push({\n      type: \"custom\",\n      component: ({\n        boundaryElement,\n        sendTelemetry\n      }) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(InsertMenuWrapper, { label: \"Insert before\", onSelect: (schemaType) => {\n        getArrayInsertAction(node, doc, schemaType.name, \"before\")(), sendTelemetry(\"Visual Editing Context Menu Item Inserted\", null);\n      }, parent, width, boundaryElement })\n    }), items.push({\n      type: \"custom\",\n      component: ({\n        boundaryElement,\n        sendTelemetry\n      }) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(InsertMenuWrapper, { label: \"Insert after\", onSelect: (schemaType) => {\n        getArrayInsertAction(node, doc, schemaType.name, \"after\")(), sendTelemetry(\"Visual Editing Context Menu Item Inserted\", null);\n      }, parent, width, boundaryElement })\n    });\n  } else\n    items.push({\n      type: \"group\",\n      label: \"Insert before\",\n      icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.InsertAboveIcon,\n      items: parent.of.filter((item) => item.type === \"unionOption\").map((t) => ({\n        type: \"action\",\n        icon: (0,_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.getNodeIcon)(t),\n        label: t.name === \"block\" ? \"Paragraph\" : t.title || t.name,\n        action: getArrayInsertAction(node, doc, t.name, \"before\"),\n        telemetryEvent: \"Visual Editing Context Menu Item Inserted\"\n      }))\n    }), items.push({\n      type: \"group\",\n      label: \"Insert after\",\n      icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.InsertBelowIcon,\n      items: parent.of.filter((item) => item.type === \"unionOption\").map((t) => ({\n        type: \"action\",\n        label: t.name === \"block\" ? \"Paragraph\" : t.title || t.name,\n        icon: (0,_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.getNodeIcon)(t),\n        action: getArrayInsertAction(node, doc, t.name, \"after\"),\n        telemetryEvent: \"Visual Editing Context Menu Item Inserted\"\n      }))\n    });\n  return items;\n}\nconst POPOVER_MARGINS = [-4, 4, -4, 4];\nfunction ContextMenuItem(props) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(27), {\n    node,\n    onDismiss,\n    boundaryElement\n  } = props, sendTelemetry = (0,_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.useTelemetry)();\n  let t0;\n  $[0] !== node || $[1] !== onDismiss || $[2] !== sendTelemetry ? (t0 = () => {\n    node.type === \"action\" && (node.action?.(), onDismiss?.(), node.telemetryEvent && sendTelemetry(node.telemetryEvent, null));\n  }, $[0] = node, $[1] = onDismiss, $[2] = sendTelemetry, $[3] = t0) : t0 = $[3];\n  const onClick = t0;\n  if (node.type === \"divider\") {\n    let t1;\n    return $[4] === Symbol.for(\"react.memo_cache_sentinel\") ? (t1 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.MenuDivider, {}), $[4] = t1) : t1 = $[4], t1;\n  }\n  if (node.type === \"action\") {\n    const t1 = !node.action;\n    let t2;\n    return $[5] !== node.hotkeys || $[6] !== node.icon || $[7] !== node.label || $[8] !== onClick || $[9] !== t1 ? (t2 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.MenuItem, { fontSize: 1, hotkeys: node.hotkeys, icon: node.icon, padding: 2, space: 2, text: node.label, disabled: t1, onClick }), $[5] = node.hotkeys, $[6] = node.icon, $[7] = node.label, $[8] = onClick, $[9] = t1, $[10] = t2) : t2 = $[10], t2;\n  }\n  if (node.type === \"group\") {\n    const t1 = node.icon;\n    let t2;\n    $[11] === Symbol.for(\"react.memo_cache_sentinel\") ? (t2 = {\n      arrow: !1,\n      constrainSize: !0,\n      placement: \"right-start\",\n      fallbackPlacements: [\"left-start\", \"right\", \"left\", \"right-end\", \"left-end\", \"bottom\", \"top\"],\n      preventOverflow: !0,\n      __unstable_margins: POPOVER_MARGINS\n    }, $[11] = t2) : t2 = $[11];\n    const t3 = node.label;\n    let t4;\n    if ($[12] !== boundaryElement || $[13] !== node.items || $[14] !== onDismiss) {\n      let t52;\n      $[16] !== boundaryElement || $[17] !== onDismiss ? (t52 = (item, itemIndex) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(ContextMenuItem, { node: item, onDismiss, boundaryElement }, itemIndex), $[16] = boundaryElement, $[17] = onDismiss, $[18] = t52) : t52 = $[18], t4 = node.items.map(t52), $[12] = boundaryElement, $[13] = node.items, $[14] = onDismiss, $[15] = t4;\n    } else\n      t4 = $[15];\n    let t5;\n    return $[19] !== node.icon || $[20] !== node.label || $[21] !== t4 ? (t5 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.MenuGroup, { fontSize: 1, icon: t1, padding: 2, popover: t2, space: 2, text: t3, children: t4 }), $[19] = node.icon, $[20] = node.label, $[21] = t4, $[22] = t5) : t5 = $[22], t5;\n  }\n  if (node.type === \"custom\") {\n    const {\n      component: Component\n    } = node;\n    let t1;\n    return $[23] !== Component || $[24] !== boundaryElement || $[25] !== sendTelemetry ? (t1 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Component, { boundaryElement, sendTelemetry }), $[23] = Component, $[24] = boundaryElement, $[25] = sendTelemetry, $[26] = t1) : t1 = $[26], t1;\n  }\n  return null;\n}\nconst ContextMenu = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(43), {\n    node,\n    onDismiss,\n    position: t0\n  } = props, {\n    x,\n    y\n  } = t0, [boundaryElement, setBoundaryElement] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null), {\n    getField\n  } = useSchema(), {\n    getDocument\n  } = (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.useDocuments)();\n  let t1;\n  $[0] !== getField || $[1] !== node ? (t1 = getField(node), $[0] = getField, $[1] = node, $[2] = t1) : t1 = $[2];\n  const {\n    field,\n    parent\n  } = t1;\n  let t2;\n  t2 = field?.title || field?.name || \"Unknown type\";\n  const title = t2, [items, setItems] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(void 0);\n  let t3, t4;\n  $[3] !== field || $[4] !== getDocument || $[5] !== node || $[6] !== parent ? (t3 = () => {\n    (async () => {\n      const doc = getDocument(node.id);\n      if (!doc)\n        return;\n      const items_0 = await getContextMenuItems({\n        node,\n        field,\n        parent,\n        doc\n      });\n      setItems(items_0);\n    })();\n  }, t4 = [field, node, parent, getDocument], $[3] = field, $[4] = getDocument, $[5] = node, $[6] = parent, $[7] = t3, $[8] = t4) : (t3 = $[7], t4 = $[8]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t3, t4);\n  let t5, t6;\n  $[9] !== x || $[10] !== y ? (t6 = {\n    getBoundingClientRect: () => ({\n      bottom: y,\n      left: x,\n      right: x,\n      top: y,\n      width: 0,\n      height: 0\n    })\n  }, $[9] = x, $[10] = y, $[11] = t6) : t6 = $[11], t5 = t6;\n  const contextMenuReferenceElement = t5;\n  let t7, t8;\n  $[12] !== field ? (t8 = (0,_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.getNodeIcon)(field), $[12] = field, $[13] = t8) : t8 = $[13], t7 = t8;\n  const icon = t7;\n  let t9;\n  $[14] === Symbol.for(\"react.memo_cache_sentinel\") ? (t9 = {\n    minWidth: 120,\n    maxWidth: 160\n  }, $[14] = t9) : t9 = $[14];\n  let t10;\n  $[15] !== icon || $[16] !== items ? (t10 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Box, { flex: \"none\", children: items ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Text, { size: 1, children: icon }) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Spinner, { size: 1 }) }), $[15] = icon, $[16] = items, $[17] = t10) : t10 = $[17];\n  const t11 = items ? title : \"Loading...\";\n  let t12;\n  $[18] !== t11 ? (t12 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Stack, { flex: 1, space: 2, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Text, { size: 1, weight: \"semibold\", children: t11 }) }), $[18] = t11, $[19] = t12) : t12 = $[19];\n  let t13;\n  $[20] !== t10 || $[21] !== t12 ? (t13 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Flex, { gap: 2, padding: 2, children: [\n    t10,\n    t12\n  ] }), $[20] = t10, $[21] = t12, $[22] = t13) : t13 = $[22];\n  let t14;\n  $[23] !== boundaryElement || $[24] !== items || $[25] !== onDismiss ? (t14 = items && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.MenuDivider, {}),\n    items.map((item, i) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(ContextMenuItem, { node: item, onDismiss, boundaryElement }, i))\n  ] }), $[23] = boundaryElement, $[24] = items, $[25] = onDismiss, $[26] = t14) : t14 = $[26];\n  let t15;\n  $[27] !== t13 || $[28] !== t14 ? (t15 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Menu, { style: t9, children: [\n    t13,\n    t14\n  ] }), $[27] = t13, $[28] = t14, $[29] = t15) : t15 = $[29];\n  const t16 = `${x}-${y}`;\n  let t17;\n  $[30] !== x || $[31] !== y ? (t17 = {\n    position: \"absolute\",\n    left: x,\n    top: y\n  }, $[30] = x, $[31] = y, $[32] = t17) : t17 = $[32];\n  let t18;\n  $[33] !== t16 || $[34] !== t17 ? (t18 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"div\", { style: t17 }, t16), $[33] = t16, $[34] = t17, $[35] = t18) : t18 = $[35];\n  let t19;\n  $[36] !== contextMenuReferenceElement || $[37] !== t15 || $[38] !== t18 ? (t19 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Popover, { __unstable_margins: POPOVER_MARGINS, arrow: !1, open: !0, placement: \"right-start\", referenceElement: contextMenuReferenceElement, content: t15, children: t18 }), $[36] = contextMenuReferenceElement, $[37] = t15, $[38] = t18, $[39] = t19) : t19 = $[39];\n  let t20;\n  return $[40] !== onDismiss || $[41] !== t19 ? (t20 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.PopoverPortal, { setBoundaryElement, onDismiss, children: t19 }), $[40] = onDismiss, $[41] = t19, $[42] = t20) : t20 = $[42], t20;\n};\nfunction getLinkHref(href, referer) {\n  try {\n    const parsed = new URL(href, typeof location > \"u\" ? void 0 : location.origin);\n    if (parsed.hash) {\n      const hash = new URL(getLinkHref(parsed.hash.slice(1), referer));\n      return `${parsed.origin}${parsed.pathname}${parsed.search}#${hash.pathname}${hash.search}`;\n    }\n    return parsed.searchParams.set(\"preview\", referer), parsed.toString();\n  } catch {\n    return href;\n  }\n}\nconst PreviewSnapshotsContext = (0,react__WEBPACK_IMPORTED_MODULE_2__.createContext)(null);\nfunction usePreviewSnapshots() {\n  const context = (0,react__WEBPACK_IMPORTED_MODULE_2__.useContext)(PreviewSnapshotsContext);\n  if (!context)\n    throw new Error(\"Preview Snapshots context is missing\");\n  return context;\n}\nconst isReactElementOverlayComponent = (component) => (0,react__WEBPACK_IMPORTED_MODULE_2__.isValidElement)(component), Root$3 = (0,styled_components__WEBPACK_IMPORTED_MODULE_9__.styled)((0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Card))`\n  background-color: var(--overlay-bg);\n  border-radius: 3px;\n  pointer-events: none;\n  position: absolute;\n  will-change: transform;\n  box-shadow: var(--overlay-box-shadow);\n  transition: none;\n\n  --overlay-bg: transparent;\n  --overlay-box-shadow: inset 0 0 0 1px transparent;\n\n  [data-overlays] & {\n    --overlay-bg: color-mix(in srgb, transparent 95%, var(--card-focus-ring-color));\n    --overlay-box-shadow: inset 0 0 0 2px\n      color-mix(in srgb, transparent 50%, var(--card-focus-ring-color));\n  }\n\n  [data-fading-out] & {\n    transition:\n      box-shadow 1550ms,\n      background-color 1550ms;\n\n    --overlay-bg: rgba(0, 0, 255, 0);\n    --overlay-box-shadow: inset 0 0 0 1px transparent;\n  }\n\n  &[data-focused] {\n    --overlay-box-shadow: inset 0 0 0 1px var(--card-focus-ring-color);\n  }\n\n  &[data-hovered]:not([data-focused]) {\n    transition: none;\n    --overlay-box-shadow: inset 0 0 0 2px var(--card-focus-ring-color);\n  }\n\n  /* [data-unmounted] & {\n    --overlay-box-shadow: inset 0 0 0 1px var(--card-focus-ring-color);\n  } */\n\n  :link {\n    text-decoration: none;\n  }\n`, Actions = (0,styled_components__WEBPACK_IMPORTED_MODULE_9__.styled)((0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Flex))`\n  bottom: 100%;\n  cursor: pointer;\n  pointer-events: none;\n  position: absolute;\n  right: 0;\n\n  [data-hovered] & {\n    pointer-events: all;\n  }\n\n  [data-flipped] & {\n    bottom: auto;\n    top: 100%;\n  }\n`, Tab = (0,styled_components__WEBPACK_IMPORTED_MODULE_9__.styled)((0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Flex))`\n  bottom: 100%;\n  cursor: pointer;\n  pointer-events: none;\n  position: absolute;\n  left: 0;\n\n  [data-hovered] & {\n    pointer-events: all;\n  }\n\n  [data-flipped] & {\n    bottom: auto;\n    top: 100%;\n  }\n`, ActionOpen = (0,styled_components__WEBPACK_IMPORTED_MODULE_9__.styled)((0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Card))`\n  cursor: pointer;\n  background-color: var(--card-focus-ring-color);\n  right: 0;\n  border-radius: 3px;\n\n  & [data-ui='Text'] {\n    color: #fff;\n    white-space: nowrap;\n  }\n`, Labels = (0,styled_components__WEBPACK_IMPORTED_MODULE_9__.styled)((0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Flex))`\n  display: flex;\n  align-items: center;\n  background-color: var(--card-focus-ring-color);\n  right: 0;\n  border-radius: 3px;\n  & [data-ui='Text'],\n  & [data-sanity-icon] {\n    color: #fff;\n    white-space: nowrap;\n  }\n`;\nfunction createIntentLink(node) {\n  const {\n    id,\n    type,\n    path,\n    baseUrl,\n    tool,\n    workspace\n  } = node;\n  return (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_10__.createEditUrl)({\n    baseUrl,\n    workspace,\n    tool,\n    type,\n    id,\n    path: (0,_sanity_visual_editing_csm__WEBPACK_IMPORTED_MODULE_11__.pathToUrlString)(_sanity_client_csm__WEBPACK_IMPORTED_MODULE_10__.studioPath.fromString(path))\n  });\n}\nconst ElementOverlayInner = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(35), {\n    element,\n    focused,\n    componentResolver,\n    node,\n    showActions,\n    draggable\n  } = props, {\n    getField,\n    getType\n  } = useSchema();\n  let t0;\n  $[0] !== getType || $[1] !== node ? (t0 = getType(node), $[0] = getType, $[1] = node, $[2] = t0) : t0 = $[2];\n  const schemaType = t0;\n  let t1;\n  $[3] !== getField || $[4] !== node ? (t1 = getField(node), $[3] = getField, $[4] = node, $[5] = t1) : t1 = $[5];\n  const {\n    field,\n    parent\n  } = t1;\n  let t2;\n  $[6] !== node ? (t2 = \"path\" in node ? createIntentLink(node) : node.href, $[6] = node, $[7] = t2) : t2 = $[7];\n  const href = t2, previewSnapshots = usePreviewSnapshots();\n  let t3;\n  bb0: {\n    if (!(\"path\" in node)) {\n      t3 = void 0;\n      break bb0;\n    }\n    let t42;\n    $[8] !== node || $[9] !== previewSnapshots ? (t42 = previewSnapshots.find((snapshot) => snapshot._id === node.id)?.title, $[8] = node, $[9] = previewSnapshots, $[10] = t42) : t42 = $[10], t3 = t42;\n  }\n  const title = t3;\n  let t4;\n  bb1: {\n    if (!(\"path\" in node)) {\n      t4 = void 0;\n      break bb1;\n    }\n    if (!field || !schemaType) {\n      t4 = void 0;\n      break bb1;\n    }\n    const type = field.value.type, t52 = !!focused;\n    let t62;\n    $[11] !== element || $[12] !== field || $[13] !== node || $[14] !== parent || $[15] !== schemaType || $[16] !== t52 || $[17] !== type ? (t62 = {\n      document: schemaType,\n      element,\n      field,\n      focused: t52,\n      node,\n      parent,\n      type\n    }, $[11] = element, $[12] = field, $[13] = node, $[14] = parent, $[15] = schemaType, $[16] = t52, $[17] = type, $[18] = t62) : t62 = $[18], t4 = t62;\n  }\n  const componentContext = t4, customComponents = useCustomComponents(componentContext, componentResolver);\n  let t5;\n  $[19] !== schemaType ? (t5 = schemaType?.icon ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"div\", { dangerouslySetInnerHTML: {\n    __html: schemaType.icon\n  } }) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_6__.DocumentIcon, {}), $[19] = schemaType, $[20] = t5) : t5 = $[20];\n  const icon = t5;\n  let t6;\n  $[21] !== href || $[22] !== showActions ? (t6 = showActions ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Actions, { gap: 1, paddingY: 1, \"data-sanity-overlay-element\": !0, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Link, { href }) }) : null, $[21] = href, $[22] = showActions, $[23] = t6) : t6 = $[23];\n  let t7;\n  $[24] !== draggable || $[25] !== icon || $[26] !== title ? (t7 = title && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Tab, { gap: 1, paddingY: 1, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(Labels, { gap: 2, padding: 2, children: [\n    draggable && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Box, { marginRight: 1, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Text, { className: \"drag-handle\", size: 0, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_6__.DragHandleIcon, {}) }) }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Text, { size: 0, children: icon }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Text, { size: 1, weight: \"medium\", children: title })\n  ] }) }), $[24] = draggable, $[25] = icon, $[26] = title, $[27] = t7) : t7 = $[27];\n  let t8;\n  $[28] !== componentContext || $[29] !== customComponents ? (t8 = Array.isArray(customComponents) ? customComponents.map((t92, i) => {\n    const {\n      component: Component,\n      props: props_0\n    } = t92;\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Component, { PointerEvents: _chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.PointerEvents, ...componentContext, ...props_0 }, i);\n  }) : customComponents, $[28] = componentContext, $[29] = customComponents, $[30] = t8) : t8 = $[30];\n  let t9;\n  return $[31] !== t6 || $[32] !== t7 || $[33] !== t8 ? (t9 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: [\n    t6,\n    t7,\n    t8\n  ] }), $[31] = t6, $[32] = t7, $[33] = t8, $[34] = t9) : t9 = $[34], t9;\n}, ElementOverlay = (0,react__WEBPACK_IMPORTED_MODULE_2__.memo)(function(props) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(24), {\n    draggable,\n    focused,\n    hovered,\n    rect,\n    wasMaybeCollapsed,\n    enableScrollIntoView\n  } = props, ref = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(null), scrolledIntoViewRef = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(!1);\n  let t0;\n  const t1 = `${rect.w}px`, t2 = `${rect.h}px`, t3 = `translate(${rect.x}px, ${rect.y}px)`;\n  let t4;\n  $[0] !== t1 || $[1] !== t2 || $[2] !== t3 ? (t4 = {\n    width: t1,\n    height: t2,\n    transform: t3\n  }, $[0] = t1, $[1] = t2, $[2] = t3, $[3] = t4) : t4 = $[3], t0 = t4;\n  const style = t0;\n  let t5, t6;\n  $[4] !== enableScrollIntoView || $[5] !== focused || $[6] !== wasMaybeCollapsed ? (t5 = () => {\n    if (!scrolledIntoViewRef.current && !wasMaybeCollapsed && focused === !0 && ref.current && enableScrollIntoView) {\n      const target = ref.current;\n      (0,scroll_into_view_if_needed__WEBPACK_IMPORTED_MODULE_12__[\"default\"])(ref.current, {\n        behavior: (actions) => {\n          actions.length !== 0 && target.scrollIntoView({\n            behavior: \"smooth\",\n            block: \"center\",\n            inline: \"nearest\"\n          });\n        },\n        scrollMode: \"if-needed\",\n        block: \"center\",\n        inline: \"nearest\"\n      });\n    }\n    scrolledIntoViewRef.current = focused === !0;\n  }, t6 = [focused, wasMaybeCollapsed, enableScrollIntoView], $[4] = enableScrollIntoView, $[5] = focused, $[6] = wasMaybeCollapsed, $[7] = t5, $[8] = t6) : (t5 = $[7], t6 = $[8]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t5, t6);\n  const [isNearTop, setIsNearTop] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(!1);\n  let t7;\n  $[9] !== hovered ? (t7 = () => {\n    if (!ref.current || !hovered)\n      return;\n    const io = new IntersectionObserver((t82) => {\n      const [intersection] = t82;\n      setIsNearTop(intersection.boundingClientRect.top < 0);\n    }, {\n      threshold: 1\n    });\n    return io.observe(ref.current), () => io.disconnect();\n  }, $[9] = hovered, $[10] = t7) : t7 = $[10];\n  let t8;\n  $[11] !== hovered || $[12] !== isNearTop ? (t8 = [hovered, isNearTop], $[11] = hovered, $[12] = isNearTop, $[13] = t8) : t8 = $[13], (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t7, t8);\n  const t9 = focused ? \"\" : void 0, t10 = hovered ? \"\" : void 0, t11 = isNearTop ? \"\" : void 0, t12 = draggable ? \"\" : void 0;\n  let t13;\n  $[14] !== hovered || $[15] !== props ? (t13 = hovered && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(ElementOverlayInner, { ...props }), $[14] = hovered, $[15] = props, $[16] = t13) : t13 = $[16];\n  let t14;\n  return $[17] !== style || $[18] !== t10 || $[19] !== t11 || $[20] !== t12 || $[21] !== t13 || $[22] !== t9 ? (t14 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Root$3, { \"data-focused\": t9, \"data-hovered\": t10, \"data-flipped\": t11, \"data-draggable\": t12, ref, style, children: t13 }), $[17] = style, $[18] = t10, $[19] = t11, $[20] = t12, $[21] = t13, $[22] = t9, $[23] = t14) : t14 = $[23], t14;\n});\nfunction useCustomComponents(componentContext, componentResolver) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(4);\n  let t0;\n  bb0: {\n    if (!componentContext) {\n      t0 = void 0;\n      break bb0;\n    }\n    let t1;\n    if ($[0] !== componentContext || $[1] !== componentResolver) {\n      const resolved = componentResolver?.(componentContext);\n      if (!resolved) {\n        t0 = void 0;\n        break bb0;\n      }\n      if (isReactElementOverlayComponent(resolved)) {\n        t0 = resolved;\n        break bb0;\n      }\n      t1 = (Array.isArray(resolved) ? resolved : [resolved]).map(_temp$8), $[0] = componentContext, $[1] = componentResolver, $[2] = t1, $[3] = t0;\n    } else\n      t1 = $[2], t0 = $[3];\n    t0 = t1;\n  }\n  return t0;\n}\nfunction _temp$8(component) {\n  return typeof component == \"object\" && \"component\" in component ? component : {\n    component,\n    props: {}\n  };\n}\nconst Link = (0,react__WEBPACK_IMPORTED_MODULE_2__.memo)(function(props) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(6), referer = (0,react__WEBPACK_IMPORTED_MODULE_2__.useSyncExternalStore)(_temp2$5, _temp3$2);\n  let t0, t1;\n  $[0] !== props.href || $[1] !== referer ? (t1 = getLinkHref(props.href, referer), $[0] = props.href, $[1] = referer, $[2] = t1) : t1 = $[2], t0 = t1;\n  const href = t0;\n  let t2;\n  $[3] === Symbol.for(\"react.memo_cache_sentinel\") ? (t2 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(ActionOpen, { padding: 2, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Text, { size: 1, weight: \"medium\", children: \"Open in Studio\" }) }), $[3] = t2) : t2 = $[3];\n  let t3;\n  return $[4] !== href ? (t3 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Box, { as: \"a\", href, target: \"_blank\", rel: \"noopener noreferrer\", children: t2 }), $[4] = href, $[5] = t3) : t3 = $[5], t3;\n});\nfunction _temp2$5(onStoreChange) {\n  const handlePopState = () => onStoreChange();\n  return window.addEventListener(\"popstate\", handlePopState), () => window.removeEventListener(\"popstate\", handlePopState);\n}\nfunction _temp3$2() {\n  return window.location.href;\n}\nconst OverlayDragGroupRect = (t0) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(5), {\n    dragGroupRect\n  } = t0, t1 = `${dragGroupRect.y}px`, t2 = `${dragGroupRect.x}px`, t3 = `${dragGroupRect.w - 1}px`, t4 = `${dragGroupRect.h - 1}px`;\n  let t5;\n  return $[0] !== t1 || $[1] !== t2 || $[2] !== t3 || $[3] !== t4 ? (t5 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"div\", { style: {\n    position: \"absolute\",\n    top: t1,\n    left: t2,\n    width: t3,\n    height: t4,\n    border: \"1px dashed #f0709b\",\n    pointerEvents: \"none\"\n  } }), $[0] = t1, $[1] = t2, $[2] = t3, $[3] = t4, $[4] = t5) : t5 = $[4], t5;\n}, markerThickness = 6;\nfunction lerp(v0, v1, t) {\n  return v0 * (1 - t) + v1 * t;\n}\nconst OverlayDragInsertMarker = (t0) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(4), {\n    dragInsertPosition\n  } = t0;\n  if (dragInsertPosition === null)\n    return;\n  const flow = dragInsertPosition?.left || dragInsertPosition?.right ? \"horizontal\" : \"vertical\";\n  let x = 0, y = 0, width = 0, height = 0;\n  if (flow === \"horizontal\") {\n    const {\n      left,\n      right\n    } = dragInsertPosition;\n    if (width = markerThickness, right && left) {\n      const startX = left.rect.x + left.rect.w, endX = right.rect.x, offset = Math.min(right.rect.h, left.rect.h) * 0.0125;\n      x = lerp(startX, endX, 0.5) - markerThickness / 2, y = left.rect.y + offset, height = Math.min(right.rect.h, left.rect.h) - offset * 2;\n    } else if (right && !left) {\n      const offset_0 = right.rect.h * 0.0125;\n      x = right.rect.x - markerThickness / 2, y = right.rect.y + offset_0, height = right.rect.h - offset_0 * 2;\n    } else if (left && !right) {\n      const offset_1 = left.rect.h * 0.0125;\n      x = left.rect.x + left.rect.w - markerThickness / 2, y = left.rect.y + offset_1, height = left.rect.h - offset_1 * 2;\n    }\n  } else {\n    const {\n      bottom,\n      top\n    } = dragInsertPosition;\n    if (bottom && top) {\n      const startX_0 = Math.min(top.rect.x, bottom.rect.x), startY = top.rect.y + top.rect.h, endY = bottom.rect.y, offset_2 = Math.min(bottom.rect.w, top.rect.w) * 0.0125;\n      height = markerThickness, x = startX_0 + offset_2, y = lerp(startY, endY, 0.5) - markerThickness / 2, width = Math.max(bottom.rect.w, top.rect.w) - offset_2 * 2;\n    } else if (bottom && !top) {\n      const offset_3 = bottom.rect.w * 0.0125;\n      x = bottom.rect.x + offset_3, y = bottom.rect.y - markerThickness / 2, width = bottom.rect.w - offset_3 * 2, height = markerThickness;\n    } else if (top && !bottom) {\n      const offset_4 = top.rect.w * 0.0125;\n      x = top.rect.x + offset_4, y = top.rect.y + top.rect.h - markerThickness / 2, width = top.rect.w - offset_4 * 2, height = markerThickness;\n    }\n  }\n  const t1 = `${width}px`, t2 = `${height}px`, t3 = `translate(${x}px, ${y}px)`;\n  let t4;\n  return $[0] !== t1 || $[1] !== t2 || $[2] !== t3 ? (t4 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"div\", { style: {\n    position: \"absolute\",\n    width: t1,\n    height: t2,\n    transform: t3,\n    background: \"#556bfc\",\n    border: \"2px solid white\",\n    borderRadius: \"999px\",\n    zIndex: \"999999\"\n  } }), $[0] = t1, $[1] = t2, $[2] = t3, $[3] = t4) : t4 = $[3], t4;\n}, Root$2 = styled_components__WEBPACK_IMPORTED_MODULE_9__.styled.div`\n  --drag-preview-opacity: 0.98;\n  --drag-preview-skeleton-stroke: #ffffff;\n\n  @media (prefers-color-scheme: dark) {\n    --drag-preview-skeleton-stroke: #383d51;\n  }\n\n  position: fixed;\n  display: grid;\n  transform: ${({\n  $scaleFactor,\n  $width,\n  $height\n}) => `translate(calc(var(--drag-preview-x) - ${$width / 2}px), calc(var(--drag-preview-y) - ${$height / 2}px)) scale(${$scaleFactor})`};\n  width: ${({\n  $width\n}) => `${$width}px`};\n  height: ${({\n  $height\n}) => `${$height}px`};\n  z-index: 9999999;\n  opacity: var(--drag-preview-opacity);\n  cursor: move;\n\n  .drag-preview-content-wrapper {\n    position: relative;\n    width: 100%;\n    height: 100%;\n    container-type: inline-size;\n  }\n\n  [data-ui='card'] {\n    position: relative;\n    width: 100%;\n    height: 100%;\n  }\n\n  .drag-preview-skeleton {\n    position: absolute;\n    inset: 0;\n\n    rect {\n      stroke: var(--drag-preview-skeleton-stroke);\n    }\n  }\n\n  .drag-preview-handle {\n    position: absolute;\n    top: 4cqmin;\n    left: 4cqmin;\n    width: 6cqmin;\n    fill: var(--drag-preview-handle-fill);\n  }\n`;\nfunction clamp(number, min, max) {\n  return number < min ? min : number > max ? max : number;\n}\nfunction map(number, inMin, inMax, outMin, outMax) {\n  const mapped = (number - inMin) * (outMax - outMin) / (inMax - inMin) + outMin;\n  return clamp(mapped, outMin, outMax);\n}\nconst OverlayDragPreview = (t0) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(50), {\n    skeleton\n  } = t0, maxSkeletonWidth = Math.min(skeleton.maxWidth, window.innerWidth / 2), scaleFactor = skeleton.w > maxSkeletonWidth ? maxSkeletonWidth / skeleton.w : 1, offsetX = skeleton.offsetX * scaleFactor, offsetY = skeleton.offsetY * scaleFactor, prefersDark = (0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.usePrefersDark)(), theme = (0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.useTheme_v2)(), radius = theme.radius[~~map(skeleton.w, 0, 1920, 1, theme.radius.length - 2)];\n  let T0, T1, t1, t10, t11, t12, t13, t14, t2, t3, t4, t5, t6, t7, t8, t9;\n  if ($[0] !== offsetX || $[1] !== offsetY || $[2] !== prefersDark || $[3] !== radius || $[4] !== scaleFactor || $[5] !== skeleton.childRects || $[6] !== skeleton.h || $[7] !== skeleton.w) {\n    const imageRects = skeleton.childRects.filter(_temp$7), textRects = skeleton.childRects.filter(_temp2$4);\n    T1 = Root$2, t10 = skeleton.w, t11 = skeleton.h, t12 = offsetX, t13 = offsetY, t14 = scaleFactor, T0 = _sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Card, t5 = radius, t6 = 4, t7 = \"hidden\", t8 = \"transparent\", t9 = prefersDark ? \"dark\" : \"light\", t4 = \"drag-preview-content-wrapper\", t2 = \"drag-preview-skeleton\", t3 = `0 0 ${skeleton.w} ${skeleton.h}`, t1 = [...imageRects, ...textRects], $[0] = offsetX, $[1] = offsetY, $[2] = prefersDark, $[3] = radius, $[4] = scaleFactor, $[5] = skeleton.childRects, $[6] = skeleton.h, $[7] = skeleton.w, $[8] = T0, $[9] = T1, $[10] = t1, $[11] = t10, $[12] = t11, $[13] = t12, $[14] = t13, $[15] = t14, $[16] = t2, $[17] = t3, $[18] = t4, $[19] = t5, $[20] = t6, $[21] = t7, $[22] = t8, $[23] = t9;\n  } else\n    T0 = $[8], T1 = $[9], t1 = $[10], t10 = $[11], t11 = $[12], t12 = $[13], t13 = $[14], t14 = $[15], t2 = $[16], t3 = $[17], t4 = $[18], t5 = $[19], t6 = $[20], t7 = $[21], t8 = $[22], t9 = $[23];\n  let t15;\n  $[24] !== t1 || $[25] !== theme.color ? (t15 = t1.map((r_1, i) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"rect\", { x: r_1.x, y: r_1.y, width: r_1.w, height: r_1.h, fill: theme.color.skeleton.from }, i)), $[24] = t1, $[25] = theme.color, $[26] = t15) : t15 = $[26];\n  let t16;\n  $[27] !== t15 || $[28] !== t2 || $[29] !== t3 ? (t16 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"svg\", { className: t2, viewBox: t3, children: t15 }), $[27] = t15, $[28] = t2, $[29] = t3, $[30] = t16) : t16 = $[30];\n  let t17;\n  $[31] !== t16 || $[32] !== t4 ? (t17 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"div\", { className: t4, children: t16 }), $[31] = t16, $[32] = t4, $[33] = t17) : t17 = $[33];\n  let t18;\n  $[34] !== T0 || $[35] !== t17 || $[36] !== t5 || $[37] !== t6 || $[38] !== t7 || $[39] !== t8 || $[40] !== t9 ? (t18 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(T0, { radius: t5, shadow: t6, overflow: t7, tone: t8, scheme: t9, children: t17 }), $[34] = T0, $[35] = t17, $[36] = t5, $[37] = t6, $[38] = t7, $[39] = t8, $[40] = t9, $[41] = t18) : t18 = $[41];\n  let t19;\n  return $[42] !== T1 || $[43] !== t10 || $[44] !== t11 || $[45] !== t12 || $[46] !== t13 || $[47] !== t14 || $[48] !== t18 ? (t19 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(T1, { $width: t10, $height: t11, $offsetX: t12, $offsetY: t13, $scaleFactor: t14, children: t18 }), $[42] = T1, $[43] = t10, $[44] = t11, $[45] = t12, $[46] = t13, $[47] = t14, $[48] = t18, $[49] = t19) : t19 = $[49], t19;\n};\nfunction _temp$7(r) {\n  return r.tagName === \"IMG\";\n}\nfunction _temp2$4(r_0) {\n  return r_0.tagName !== \"IMG\";\n}\nconst Root$1 = (0,styled_components__WEBPACK_IMPORTED_MODULE_9__.styled)((0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Card))`\n  position: fixed;\n  bottom: 2rem;\n  left: 2rem;\n`, OverlayMinimapPrompt = () => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(2);\n  let t0;\n  $[0] === Symbol.for(\"react.memo_cache_sentinel\") ? (t0 = {\n    zIndex: \"999999\"\n  }, $[0] = t0) : t0 = $[0];\n  let t1;\n  return $[1] === Symbol.for(\"react.memo_cache_sentinel\") ? (t1 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Root$1, { padding: 2, shadow: 2, radius: 2, style: t0, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Flex, { align: \"center\", gap: 2, children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Hotkeys, { keys: [\"Shift\"] }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Text, { size: 1, children: \"Zoom Out\" }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_6__.ExpandIcon, {})\n  ] }) }), $[1] = t1) : t1 = $[1], t1;\n}, elementsReducer = (elements, message) => {\n  const {\n    type\n  } = message;\n  switch (type) {\n    case \"element/register\":\n      return elements.find((e) => e.id === message.id) ? elements : [...elements, {\n        id: message.id,\n        activated: !1,\n        element: message.element,\n        focused: !1,\n        hovered: !1,\n        rect: message.rect,\n        sanity: message.sanity,\n        dragDisabled: message.dragDisabled\n      }];\n    case \"element/activate\":\n      return elements.map((e) => e.id === message.id ? {\n        ...e,\n        activated: !0\n      } : e);\n    case \"element/update\":\n      return elements.map((e) => e.id === message.id ? {\n        ...e,\n        sanity: message.sanity,\n        rect: message.rect\n      } : e);\n    case \"element/unregister\":\n      return elements.filter((e) => e.id !== message.id);\n    case \"element/deactivate\":\n      return elements.map((e) => e.id === message.id ? {\n        ...e,\n        activated: !1,\n        hovered: !1\n      } : e);\n    case \"element/mouseenter\":\n      return elements.map((e) => e.id === message.id ? {\n        ...e,\n        rect: message.rect,\n        hovered: !0\n      } : {\n        ...e,\n        hovered: !1\n      });\n    case \"element/mouseleave\":\n      return elements.map((element) => element.id === message.id ? {\n        ...element,\n        hovered: !1\n      } : element);\n    case \"element/updateRect\":\n      return elements.map((element) => element.id === message.id ? {\n        ...element,\n        rect: message.rect\n      } : element);\n    case \"element/click\":\n      return elements.map((e) => ({\n        ...e,\n        focused: e.id === message.id && \"clicked\"\n      }));\n    case \"overlay/blur\":\n      return elements.map((e) => ({\n        ...e,\n        focused: !1\n      }));\n    case \"presentation/blur\":\n      return elements.map((e) => ({\n        ...e,\n        focused: !1\n      }));\n    case \"presentation/focus\": {\n      const clickedElement = elements.find((e) => e.focused === \"clicked\");\n      return elements.map((e) => {\n        const focused = \"path\" in e.sanity && e.sanity.id === message.data.id && e.sanity.path === message.data.path;\n        return clickedElement && e === clickedElement && focused ? e : {\n          ...e,\n          // Mark as a dupe if another matching item has been clicked to prevent\n          // scrolling, otherwise just set focus as a boolean\n          focused: focused && clickedElement ? \"duplicate\" : focused\n        };\n      });\n    }\n    default:\n      return elements;\n  }\n};\nfunction overlayStateReducer(state, message) {\n  const {\n    type\n  } = message;\n  let {\n    contextMenu,\n    focusPath,\n    perspective,\n    isDragging,\n    dragInsertPosition,\n    dragShowMinimap,\n    dragShowMinimapPrompt,\n    dragSkeleton,\n    dragMinimapTransition,\n    dragGroupRect\n  } = state, wasMaybeCollapsed = !1;\n  if (type === \"presentation/focus\") {\n    const prevFocusPath = state.focusPath;\n    focusPath = message.data.path, prevFocusPath !== focusPath && (wasMaybeCollapsed = prevFocusPath.slice(focusPath.length).startsWith(\"[\"));\n  }\n  return type === \"presentation/perspective\" && (perspective = message.data.perspective), type === \"element/contextmenu\" && (\"sanity\" in message ? contextMenu = {\n    node: message.sanity,\n    position: message.position\n  } : contextMenu = null), (type === \"element/click\" || type === \"element/mouseleave\" || type === \"overlay/blur\" || type === \"presentation/blur\" || type === \"presentation/focus\") && (contextMenu = null), type === \"overlay/dragUpdateInsertPosition\" && (dragInsertPosition = message.insertPosition), type === \"overlay/dragStart\" && (isDragging = !0), message.type === \"overlay/dragUpdateSkeleton\" && (dragSkeleton = message.skeleton), type === \"overlay/dragEnd\" && (isDragging = !1), message.type === \"overlay/dragToggleMinimapPrompt\" && (dragShowMinimapPrompt = message.display), type === \"overlay/dragStartMinimapTransition\" && (dragMinimapTransition = !0), type === \"overlay/dragEndMinimapTransition\" && (dragMinimapTransition = !1), type === \"overlay/dragUpdateGroupRect\" && (dragGroupRect = message.groupRect), type === \"overlay/dragToggleMinimap\" && (dragShowMinimap = message.display), {\n    ...state,\n    contextMenu,\n    elements: elementsReducer(state.elements, message),\n    dragInsertPosition,\n    dragSkeleton,\n    dragGroupRect,\n    isDragging,\n    focusPath,\n    perspective,\n    wasMaybeCollapsed,\n    dragShowMinimap,\n    dragShowMinimapPrompt,\n    dragMinimapTransition\n  };\n}\nconst PreviewSnapshotsProvider = function(props) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(13), {\n    comlink,\n    children\n  } = props;\n  let t0;\n  $[0] === Symbol.for(\"react.memo_cache_sentinel\") ? (t0 = [], $[0] = t0) : t0 = $[0];\n  const [previewSnapshots, setPreviewSnapshots] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(t0);\n  let t1;\n  $[1] !== comlink ? (t1 = async (signal) => {\n    if (comlink)\n      try {\n        const response = await comlink.fetch(\"visual-editing/preview-snapshots\", void 0, {\n          signal,\n          suppressWarnings: !0\n        });\n        setPreviewSnapshots(response.snapshots);\n      } catch {\n      }\n  }, $[1] = comlink, $[2] = t1) : t1 = $[2];\n  const fetchPreviewSnapshots = t1;\n  let t2, t3;\n  $[3] !== comlink || $[4] !== fetchPreviewSnapshots ? (t2 = () => {\n    if (!comlink)\n      return;\n    const previewSapshotsFetch = new AbortController(), unsub = comlink.onStatus(() => {\n      fetchPreviewSnapshots(previewSapshotsFetch.signal);\n    }, \"connected\");\n    return () => {\n      previewSapshotsFetch.abort(), unsub();\n    };\n  }, t3 = [comlink, fetchPreviewSnapshots], $[3] = comlink, $[4] = fetchPreviewSnapshots, $[5] = t2, $[6] = t3) : (t2 = $[5], t3 = $[6]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t2, t3);\n  let t4, t5;\n  $[7] !== comlink ? (t4 = () => comlink?.on(\"presentation/preview-snapshots\", (data) => {\n    setPreviewSnapshots(data.snapshots);\n  }), t5 = [comlink], $[7] = comlink, $[8] = t4, $[9] = t5) : (t4 = $[8], t5 = $[9]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t4, t5);\n  let t6;\n  t6 = previewSnapshots;\n  const context = t6;\n  let t7;\n  return $[10] !== children || $[11] !== context ? (t7 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(PreviewSnapshotsContext.Provider, { value: context, children }), $[10] = children, $[11] = context, $[12] = t7) : t7 = $[12], t7;\n};\nfunction isSanityNode(node) {\n  return \"path\" in node;\n}\nfunction isDocumentSchemaType(type) {\n  return type.type === \"document\";\n}\nfunction isTypeSchemaType(type) {\n  return type.type === \"type\";\n}\nfunction popUnkeyedPathSegments(path) {\n  return path.split(\".\").toReversed().reduce((acc, part) => acc.length ? [part, ...acc] : part.includes(\"[_key==\") ? [part] : [], []).join(\".\");\n}\nfunction getPathsWithUnresolvedTypes(elements) {\n  return elements.reduce((acc, element) => {\n    const {\n      sanity\n    } = element;\n    if (!(\"id\" in sanity) || !sanity.path.includes(\"[_key==\")) return acc;\n    const path = popUnkeyedPathSegments(sanity.path);\n    return acc.find((item) => item.id === sanity.id && item.path === path) || acc.push({\n      id: sanity.id,\n      path\n    }), acc;\n  }, []);\n}\nconst SchemaProvider = function(props) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(22), {\n    comlink,\n    children,\n    elements\n  } = props;\n  let t0;\n  $[0] === Symbol.for(\"react.memo_cache_sentinel\") ? (t0 = /* @__PURE__ */ new Map(), $[0] = t0) : t0 = $[0];\n  const [resolvedTypes, setResolvedTypes] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(t0), [schema, setSchema] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null);\n  let t1, t2;\n  $[1] !== comlink ? (t1 = () => {\n    if (!comlink)\n      return;\n    const fetchSchema = async function(signal) {\n      if (comlink)\n        try {\n          const response = await comlink.fetch(\"visual-editing/schema\", void 0, {\n            signal,\n            suppressWarnings: !0\n          });\n          setSchema(response.schema);\n        } catch {\n        }\n    }, schemaFetch = new AbortController(), unsub = comlink.onStatus(() => {\n      fetchSchema(schemaFetch.signal);\n    }, \"connected\");\n    return () => {\n      schemaFetch.abort(), unsub();\n    };\n  }, t2 = [comlink], $[1] = comlink, $[2] = t1, $[3] = t2) : (t1 = $[2], t2 = $[3]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t1, t2);\n  let t3;\n  $[4] === Symbol.for(\"react.memo_cache_sentinel\") ? (t3 = [], $[4] = t3) : t3 = $[4];\n  const reportedPathsRef = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(t3), t4 = (0,react__WEBPACK_IMPORTED_MODULE_2__.useDeferredValue)(elements);\n  let t5;\n  $[5] !== t4 ? (t5 = getPathsWithUnresolvedTypes(t4), $[5] = t4, $[6] = t5) : t5 = $[6];\n  const paths = t5, controllerRef = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(null);\n  let t6, t7;\n  $[7] !== comlink || $[8] !== paths ? (t6 = () => {\n    if (!paths.length || !comlink)\n      return;\n    const reportPaths = async (paths_0, signal_0) => {\n      const initialReportedPaths = reportedPathsRef.current;\n      try {\n        reportedPathsRef.current = paths_0;\n        const response_0 = await comlink.fetch(\"visual-editing/schema-union-types\", {\n          paths: paths_0\n        }, {\n          signal: signal_0,\n          suppressWarnings: !0\n        });\n        if (signal_0.aborted)\n          return;\n        setResolvedTypes(response_0.types), controllerRef.current = null;\n      } catch {\n      }\n      signal_0.aborted && (reportedPathsRef.current = initialReportedPaths);\n    };\n    paths.some((p) => !reportedPathsRef.current.find((t82) => {\n      const {\n        id,\n        path\n      } = t82;\n      return id === p.id && path === p.path;\n    })) && (controllerRef.current?.abort(), controllerRef.current = new AbortController(), reportPaths(paths, controllerRef.current.signal));\n  }, t7 = [comlink, paths], $[7] = comlink, $[8] = paths, $[9] = t6, $[10] = t7) : (t6 = $[9], t7 = $[10]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t6, t7);\n  let t8;\n  $[11] !== schema ? (t8 = (node, _type) => {\n    const type = _type || \"document\";\n    if (!schema || typeof node != \"string\" && (!isSanityNode(node) || !Array.isArray(schema)))\n      return;\n    const name = typeof node == \"string\" ? node : node.type, filter = type === \"document\" ? isDocumentSchemaType : isTypeSchemaType;\n    return schema.filter(filter).find((schemaType) => schemaType.name === name);\n  }, $[11] = schema, $[12] = t8) : t8 = $[12];\n  const getType = t8;\n  let t9;\n  $[13] !== getType || $[14] !== resolvedTypes ? (t9 = (node_0) => {\n    if (!isSanityNode(node_0))\n      return {\n        field: void 0,\n        parent: void 0\n      };\n    const schemaType_0 = getType(node_0);\n    if (!schemaType_0)\n      return {\n        field: void 0,\n        parent: void 0\n      };\n    function fieldFromPath(schemaType_1, path_0, parent, t102) {\n      const prevPath = t102 === void 0 ? [] : t102;\n      if (!schemaType_1)\n        return {\n          field: void 0,\n          parent: void 0\n        };\n      const [next, ...rest] = path_0;\n      if (\"fields\" in schemaType_1) {\n        const objectField = schemaType_1.fields[next];\n        if (!objectField && \"rest\" in schemaType_1)\n          return fieldFromPath(schemaType_1.rest, path_0, schemaType_1, prevPath);\n        if (!rest.length)\n          return {\n            field: objectField,\n            parent\n          };\n        if (!objectField)\n          throw new Error(`[@sanity/visual-editing] No field could be resolved at path: \"${[...prevPath, ...path_0].join(\".\")}\"`);\n        return fieldFromPath(objectField.value, rest, schemaType_1, [...prevPath, next]);\n      } else {\n        if (schemaType_1.type === \"array\")\n          return fieldFromPath(schemaType_1.of, path_0, schemaType_1, prevPath);\n        if (schemaType_1.type === \"arrayItem\")\n          return rest.length ? fieldFromPath(schemaType_1.value, rest, schemaType_1, [...prevPath, next]) : {\n            field: schemaType_1,\n            parent\n          };\n        if (schemaType_1.type === \"union\") {\n          const name_0 = next.startsWith(\"[_key==\") ? resolvedTypes?.get(node_0.id)?.get([prevPath.join(\".\"), next].filter(Boolean).join(\"\")) : next;\n          return fieldFromPath(schemaType_1.of.find((item) => item.type === \"unionOption\" ? item.name === name_0 : item), rest, schemaType_1, [...prevPath, next]);\n        } else {\n          if (schemaType_1.type === \"unionOption\")\n            return next ? fieldFromPath(schemaType_1.value, path_0, schemaType_1, prevPath) : {\n              field: schemaType_1,\n              parent\n            };\n          if (schemaType_1.type === \"inline\") {\n            const type_0 = getType(schemaType_1.name, \"type\");\n            return fieldFromPath(type_0.value, path_0, schemaType_1, prevPath);\n          }\n        }\n      }\n      throw new Error(`[@sanity/visual-editing] No field could be resolved at path: \"${[...prevPath, ...path_0].join(\".\")}\"`);\n    }\n    const nodePath = node_0.path.split(\".\").flatMap(_temp$6);\n    try {\n      return fieldFromPath(schemaType_0, nodePath, void 0);\n    } catch (t112) {\n      const e_0 = t112;\n      return e_0 instanceof Error && console.warn(e_0.message), {\n        field: void 0,\n        parent: void 0\n      };\n    }\n  }, $[13] = getType, $[14] = resolvedTypes, $[15] = t9) : t9 = $[15];\n  const getField = t9;\n  let t10, t11;\n  $[16] !== getField || $[17] !== getType ? (t11 = {\n    getField,\n    getType\n  }, $[16] = getField, $[17] = getType, $[18] = t11) : t11 = $[18], t10 = t11;\n  const context = t10;\n  let t12;\n  return $[19] !== children || $[20] !== context ? (t12 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SchemaContext.Provider, { value: context, children }), $[19] = children, $[20] = context, $[21] = t12) : t12 = $[21], t12;\n};\nfunction _temp$6(part) {\n  return part.includes(\"[\") ? part.split(/(\\[.+\\])/, 2) : [part];\n}\nconst createStore = (initialState) => {\n  let state = initialState;\n  const getState = () => state, listeners = /* @__PURE__ */ new Set();\n  return {\n    getState,\n    setState: (fn) => {\n      state = fn(state), listeners.forEach((l) => l());\n    },\n    subscribe: (listener) => (listeners.add(listener), () => listeners.delete(listener))\n  };\n}, store = createStore({}), SharedStateProvider = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(11), {\n    comlink,\n    children\n  } = props;\n  let t0, t1;\n  $[0] !== comlink ? (t0 = () => comlink?.on(\"presentation/shared-state\", _temp$5), t1 = [comlink], $[0] = comlink, $[1] = t0, $[2] = t1) : (t0 = $[1], t1 = $[2]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t0, t1);\n  let t2, t3;\n  $[3] !== comlink ? (t2 = () => {\n    (async function() {\n      const value = await comlink?.fetch(\"visual-editing/shared-state\", void 0, {\n        suppressWarnings: !0\n      });\n      value && store.setState(() => value.state);\n    })().catch(_temp2$3);\n  }, t3 = [comlink], $[3] = comlink, $[4] = t2, $[5] = t3) : (t2 = $[4], t3 = $[5]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t2, t3);\n  let t4, t5;\n  $[6] !== comlink ? (t5 = {\n    comlink,\n    store\n  }, $[6] = comlink, $[7] = t5) : t5 = $[7], t4 = t5;\n  const value_0 = t4;\n  let t6;\n  return $[8] !== children || $[9] !== value_0 ? (t6 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_chunks_es_SharedStateContext_js__WEBPACK_IMPORTED_MODULE_13__.SharedStateContext.Provider, { value: value_0, children }), $[8] = children, $[9] = value_0, $[10] = t6) : t6 = $[10], t6;\n};\nfunction _temp$5(data) {\n  \"value\" in data ? store.setState((prev) => ({\n    ...prev,\n    [data.key]: data.value\n  })) : store.setState((prev_0) => Object.fromEntries(Object.entries(prev_0).filter((t0) => {\n    const [key] = t0;\n    return key !== data.key;\n  })));\n}\nfunction _temp2$3(reason) {\n  console.debug(reason), console.warn(\"[@sanity/visual-editing]: Failed to fetch shared state. Check your version of `sanity` is up-to-date\");\n}\nconst TelemetryProvider = (t0) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(5), {\n    children,\n    comlink\n  } = t0;\n  let t1;\n  $[0] !== comlink ? (t1 = (name, data) => {\n    if (!comlink)\n      return;\n    const event = _chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.events[name];\n    if (event)\n      comlink.post(\"visual-editing/telemetry-log\", {\n        event,\n        data\n      });\n    else\n      throw new Error(`Telemetry event: ${name} does not exist`);\n  }, $[0] = comlink, $[1] = t1) : t1 = $[1];\n  const log = t1;\n  let t2;\n  return $[2] !== children || $[3] !== log ? (t2 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.TelemetryContext.Provider, { value: log, children }), $[2] = children, $[3] = log, $[4] = t2) : t2 = $[4], t2;\n};\nfunction useController(element, handler, inFrame, inPopUp) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(7), overlayController = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(void 0), optimisticActorReady = (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.useOptimisticActorReady)();\n  let t0, t1;\n  return $[0] !== element || $[1] !== handler || $[2] !== inFrame || $[3] !== inPopUp || $[4] !== optimisticActorReady ? (t0 = () => {\n    if (element)\n      return overlayController.current = (0,_chunks_es_SharedStateContext_js__WEBPACK_IMPORTED_MODULE_13__.createOverlayController)({\n        handler,\n        overlayElement: element,\n        inFrame,\n        inPopUp,\n        optimisticActorReady\n      }), () => {\n        overlayController.current?.destroy(), overlayController.current = void 0;\n      };\n  }, t1 = [element, handler, inFrame, inPopUp, optimisticActorReady], $[0] = element, $[1] = handler, $[2] = inFrame, $[3] = inPopUp, $[4] = optimisticActorReady, $[5] = t0, $[6] = t1) : (t0 = $[5], t1 = $[6]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t0, t1), overlayController;\n}\nfunction usePerspectiveSync(comlink, dispatch) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(4);\n  let t0, t1;\n  $[0] !== comlink || $[1] !== dispatch ? (t0 = () => {\n    const controller = new AbortController();\n    comlink?.fetch(\"visual-editing/fetch-perspective\", void 0, {\n      signal: controller.signal,\n      suppressWarnings: !0\n    }).then((data) => {\n      dispatch({\n        type: \"presentation/perspective\",\n        data\n      });\n    }).catch(_temp$4);\n    const unsub = comlink?.on(\"presentation/perspective\", (data_0) => {\n      dispatch({\n        type: \"presentation/perspective\",\n        data: data_0\n      });\n    });\n    return () => {\n      unsub?.(), controller.abort();\n    };\n  }, t1 = [comlink, dispatch], $[0] = comlink, $[1] = dispatch, $[2] = t0, $[3] = t1) : (t0 = $[2], t1 = $[3]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t0, t1);\n}\nfunction _temp$4() {\n}\nfunction isEqualSets(a, b) {\n  if (a === b) return !0;\n  if (a.size !== b.size) return !1;\n  for (const value of a) if (!b.has(value)) return !1;\n  return !0;\n}\nfunction useReportDocuments(comlink, elements, perspective) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(7), lastReported = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(void 0);\n  let t0;\n  $[0] !== comlink ? (t0 = (documents, perspective_0) => {\n    comlink?.post(\"visual-editing/documents\", {\n      documents,\n      perspective: perspective_0\n    });\n  }, $[0] = comlink, $[1] = t0) : t0 = $[1];\n  const reportDocuments = t0;\n  let t1, t2;\n  $[2] !== elements || $[3] !== perspective || $[4] !== reportDocuments ? (t1 = () => {\n    const nodes = elements.map(_temp$3).filter(_temp2$2), nodeIds = new Set(nodes.map(_temp3$1));\n    if (!lastReported.current || !isEqualSets(nodeIds, lastReported.current.nodeIds) || perspective !== lastReported.current.perspective) {\n      const documentsOnPage = Array.from(nodeIds).map((_id) => {\n        const node_0 = nodes.find((node) => node.id === _id), {\n          type,\n          projectId: _projectId,\n          dataset: _dataset\n        } = node_0;\n        return _projectId && _dataset ? {\n          _id,\n          _type: type,\n          _projectId,\n          _dataset\n        } : {\n          _id,\n          _type: type\n        };\n      });\n      lastReported.current = {\n        nodeIds,\n        perspective\n      }, reportDocuments(documentsOnPage, perspective);\n    }\n  }, t2 = [elements, perspective, reportDocuments], $[2] = elements, $[3] = perspective, $[4] = reportDocuments, $[5] = t1, $[6] = t2) : (t1 = $[5], t2 = $[6]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t1, t2);\n}\nfunction _temp3$1(e_0) {\n  return e_0.id;\n}\nfunction _temp2$2(s) {\n  return !!s;\n}\nfunction _temp$3(e) {\n  const {\n    sanity\n  } = e;\n  return \"id\" in sanity ? sanity : null;\n}\nconst Root = styled_components__WEBPACK_IMPORTED_MODULE_9__.styled.div`\n  background-color: transparent;\n  direction: ltr;\n  inset: 0;\n  pointer-events: none;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  z-index: ${({\n  $zIndex\n}) => $zIndex ?? \"9999999\"};\n`;\nfunction raf2(fn) {\n  let r0, r1;\n  return r0 = requestAnimationFrame(() => {\n    r1 = requestAnimationFrame(fn);\n  }), () => {\n    r0 !== void 0 && cancelAnimationFrame(r0), r1 !== void 0 && cancelAnimationFrame(r1);\n  };\n}\nconst DocumentReporter = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(8), {\n    documentIds\n  } = props;\n  let t0;\n  $[0] === Symbol.for(\"react.memo_cache_sentinel\") ? (t0 = [], $[0] = t0) : t0 = $[0];\n  const [uniqueIds, setUniqueIds] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(t0);\n  let t1, t2;\n  $[1] !== documentIds ? (t1 = () => {\n    setUniqueIds((prev) => {\n      const next = Array.from(new Set(documentIds));\n      return prev.length === next.length && prev.reduce(_temp$2, next)?.length === 0 ? prev : next;\n    });\n  }, t2 = [documentIds], $[1] = documentIds, $[2] = t1, $[3] = t2) : (t1 = $[2], t2 = $[3]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t1, t2);\n  const actor = (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.useOptimisticActor)();\n  let t3, t4;\n  return $[4] !== actor || $[5] !== uniqueIds ? (t3 = () => {\n    for (const id_0 of uniqueIds)\n      actor.send({\n        type: \"observe\",\n        documentId: (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_10__.getDraftId)(id_0)\n      }), actor.send({\n        type: \"observe\",\n        documentId: (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_10__.getPublishedId)(id_0)\n      });\n    return () => {\n      for (const id_1 of uniqueIds)\n        actor.send({\n          type: \"unobserve\",\n          documentId: (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_10__.getDraftId)(id_1)\n        }), actor.send({\n          type: \"unobserve\",\n          documentId: (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_10__.getPublishedId)(id_1)\n        });\n    };\n  }, t4 = [actor, uniqueIds], $[4] = actor, $[5] = uniqueIds, $[6] = t3, $[7] = t4) : (t3 = $[6], t4 = $[7]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t3, t4), null;\n}, OverlaysController = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(12), {\n    comlink,\n    dispatch,\n    inFrame,\n    inPopUp,\n    onDrag,\n    overlayEnabled,\n    rootElement\n  } = props, {\n    dispatchDragEndEvent\n  } = useDragEndEvents(), sendTelemetry = (0,_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.useTelemetry)();\n  let t0;\n  $[0] !== comlink || $[1] !== dispatch || $[2] !== dispatchDragEndEvent || $[3] !== onDrag || $[4] !== sendTelemetry ? (t0 = (message) => {\n    if (message.type === \"element/click\") {\n      const {\n        sanity\n      } = message;\n      comlink?.post(\"visual-editing/focus\", sanity), sendTelemetry(\"Visual Editing Overlay Clicked\", null);\n    } else if (message.type === \"overlay/activate\")\n      comlink?.post(\"visual-editing/toggle\", {\n        enabled: !0\n      });\n    else if (message.type === \"overlay/deactivate\")\n      comlink?.post(\"visual-editing/toggle\", {\n        enabled: !1\n      });\n    else if (message.type === \"overlay/dragEnd\") {\n      const {\n        insertPosition,\n        target,\n        dragGroup,\n        flow,\n        preventInsertDefault\n      } = message;\n      dispatchDragEndEvent({\n        insertPosition,\n        target,\n        dragGroup,\n        flow,\n        preventInsertDefault\n      }), insertPosition && sendTelemetry(\"Visual Editing Drag Sequence Completed\", null);\n    } else if (message.type === \"overlay/dragUpdateCursorPosition\") {\n      onDrag(message.x, message.y);\n      return;\n    } else if (message.type === \"overlay/dragToggleMinimap\" && message.display === !0)\n      sendTelemetry(\"Visual Editing Drag Minimap Enabled\", null);\n    else if (message.type === \"overlay/setCursor\") {\n      const {\n        element,\n        cursor\n      } = message;\n      cursor ? element.style.cursor = cursor : element.style.removeProperty(\"cursor\");\n    }\n    dispatch(message);\n  }, $[0] = comlink, $[1] = dispatch, $[2] = dispatchDragEndEvent, $[3] = onDrag, $[4] = sendTelemetry, $[5] = t0) : t0 = $[5];\n  const controller = useController(rootElement, t0, inFrame, inPopUp);\n  let t1;\n  $[6] !== controller.current || $[7] !== overlayEnabled ? (t1 = () => {\n    overlayEnabled ? controller.current?.activate() : controller.current?.deactivate();\n  }, $[6] = controller.current, $[7] = overlayEnabled, $[8] = t1) : t1 = $[8];\n  let t2;\n  return $[9] !== controller || $[10] !== overlayEnabled ? (t2 = [controller, overlayEnabled], $[9] = controller, $[10] = overlayEnabled, $[11] = t2) : t2 = $[11], (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t1, t2), null;\n}, Overlays = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(74), {\n    comlink,\n    comlinkStatus,\n    componentResolver: _componentResolver,\n    inFrame,\n    inPopUp,\n    zIndex\n  } = props, prefersDark = (0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.usePrefersDark)();\n  let t0;\n  $[0] === Symbol.for(\"react.memo_cache_sentinel\") ? (t0 = {\n    contextMenu: null,\n    dragInsertPosition: null,\n    dragShowMinimap: !1,\n    dragShowMinimapPrompt: !1,\n    dragSkeleton: null,\n    elements: [],\n    focusPath: \"\",\n    isDragging: !1,\n    perspective: \"published\",\n    wasMaybeCollapsed: !1,\n    dragMinimapTransition: !1,\n    dragGroupRect: null\n  }, $[0] = t0) : t0 = $[0];\n  const [t1, dispatch] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useReducer)(overlayStateReducer, t0), {\n    contextMenu,\n    dragInsertPosition,\n    dragShowMinimap,\n    dragShowMinimapPrompt,\n    dragSkeleton,\n    elements,\n    isDragging,\n    perspective,\n    wasMaybeCollapsed,\n    dragMinimapTransition,\n    dragGroupRect\n  } = t1, [rootElement, setRootElement] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null), [overlayEnabled, setOverlayEnabled] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(!0);\n  let t2, t3;\n  $[1] !== comlink ? (t2 = () => {\n    const unsubs = [comlink?.on(\"presentation/focus\", (data) => {\n      dispatch({\n        type: \"presentation/focus\",\n        data\n      });\n    }), comlink?.on(\"presentation/blur\", (data_0) => {\n      dispatch({\n        type: \"presentation/blur\",\n        data: data_0\n      });\n    }), comlink?.on(\"presentation/toggle-overlay\", () => {\n      setOverlayEnabled(_temp2$1);\n    })].filter(Boolean);\n    return () => unsubs.forEach(_temp3);\n  }, t3 = [comlink], $[1] = comlink, $[2] = t2, $[3] = t3) : (t2 = $[2], t3 = $[3]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t2, t3), usePerspectiveSync(comlink, dispatch), useReportDocuments(comlink, elements, perspective);\n  let t4;\n  $[4] !== rootElement ? (t4 = (x, y) => {\n    rootElement && (rootElement.style.setProperty(\"--drag-preview-x\", `${x}px`), rootElement.style.setProperty(\"--drag-preview-y\", `${y - window.scrollY}px`));\n  }, $[4] = rootElement, $[5] = t4) : t4 = $[5];\n  const updateDragPreviewCustomProps = t4;\n  let t5, t6;\n  $[6] === Symbol.for(\"react.memo_cache_sentinel\") ? (t5 = () => {\n    const handleClick = _temp4, handleKeyUp = (e) => {\n      isAltKey(e) && setOverlayEnabled(_temp5);\n    }, handleKeydown = (e_0) => {\n      isAltKey(e_0) && setOverlayEnabled(_temp6), isHotkey([\"mod\", \"\\\\\"], e_0) && setOverlayEnabled(_temp7);\n    };\n    return window.addEventListener(\"click\", handleClick), window.addEventListener(\"keydown\", handleKeydown), window.addEventListener(\"keyup\", handleKeyUp), () => {\n      window.removeEventListener(\"click\", handleClick), window.removeEventListener(\"keydown\", handleKeydown), window.removeEventListener(\"keyup\", handleKeyUp);\n    };\n  }, t6 = [setOverlayEnabled], $[6] = t5, $[7] = t6) : (t5 = $[6], t6 = $[7]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t5, t6);\n  const [overlaysFlash, setOverlaysFlash] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(!1), [fadingOut, setFadingOut] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(!1), fadeOutTimeoutRef = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(void 0);\n  let t7, t8;\n  $[8] !== overlayEnabled ? (t7 = () => {\n    if (overlayEnabled)\n      return raf2(() => {\n        setOverlaysFlash(!0), raf2(() => {\n          setFadingOut(!0), fadeOutTimeoutRef.current = setTimeout(() => {\n            setFadingOut(!1), setOverlaysFlash(!1);\n          }, 1500);\n        });\n      });\n    fadeOutTimeoutRef.current && (clearTimeout(fadeOutTimeoutRef.current), setOverlaysFlash(!1), setFadingOut(!1));\n  }, t8 = [overlayEnabled], $[8] = overlayEnabled, $[9] = t7, $[10] = t8) : (t7 = $[9], t8 = $[10]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t7, t8);\n  let t9, t10;\n  $[11] !== elements ? (t10 = elements.flatMap(_temp8), $[11] = elements, $[12] = t10) : t10 = $[12], t9 = t10;\n  const documentIds = t9;\n  let t11;\n  $[13] === Symbol.for(\"react.memo_cache_sentinel\") ? (t11 = () => {\n    dispatch({\n      type: \"overlay/blur\"\n    });\n  }, $[13] = t11) : t11 = $[13];\n  const closeContextMenu = t11, optimisticActorReady = (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.useOptimisticActorReady)();\n  let t12;\n  t12 = optimisticActorReady ? _componentResolver : void 0;\n  const componentResolver = t12;\n  let t13;\n  bb0: {\n    if ((inFrame || inPopUp) && comlinkStatus !== \"connected\" || isDragging) {\n      let t143;\n      $[14] === Symbol.for(\"react.memo_cache_sentinel\") ? (t143 = [], $[14] = t143) : t143 = $[14], t13 = t143;\n      break bb0;\n    }\n    let t142;\n    $[15] !== componentResolver || $[16] !== dragMinimapTransition || $[17] !== dragShowMinimap || $[18] !== elements || $[19] !== inFrame || $[20] !== isDragging || $[21] !== optimisticActorReady || $[22] !== wasMaybeCollapsed ? (t142 = elements.filter(_temp9).map((t152) => {\n      const {\n        id,\n        element: element_0,\n        focused,\n        hovered,\n        rect,\n        sanity,\n        dragDisabled\n      } = t152, draggable = !dragDisabled && !!element_0.getAttribute(\"data-sanity\") && optimisticActorReady && elements.some((e_2) => \"id\" in e_2.sanity && \"id\" in sanity ? (0,_chunks_es_SharedStateContext_js__WEBPACK_IMPORTED_MODULE_13__.sanityNodesExistInSameArray)(e_2.sanity, sanity) && e_2.sanity.path !== sanity.path : !1);\n      return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(ElementOverlay, { componentResolver, element: element_0, enableScrollIntoView: !isDragging && !dragMinimapTransition && !dragShowMinimap, focused, hovered, node: sanity, rect, showActions: !inFrame, draggable, isDragging: isDragging || dragMinimapTransition, wasMaybeCollapsed: focused && wasMaybeCollapsed }, id);\n    }), $[15] = componentResolver, $[16] = dragMinimapTransition, $[17] = dragShowMinimap, $[18] = elements, $[19] = inFrame, $[20] = isDragging, $[21] = optimisticActorReady, $[22] = wasMaybeCollapsed, $[23] = t142) : t142 = $[23], t13 = t142;\n  }\n  const elementsToRender = t13, t14 = prefersDark ? \"dark\" : \"light\", t15 = fadingOut ? \"\" : void 0, t16 = overlaysFlash ? \"\" : void 0;\n  let t17;\n  $[24] !== documentIds || $[25] !== perspective ? (t17 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(DocumentReporter, { documentIds, perspective }), $[24] = documentIds, $[25] = perspective, $[26] = t17) : t17 = $[26];\n  let t18;\n  $[27] !== comlink || $[28] !== inFrame || $[29] !== inPopUp || $[30] !== overlayEnabled || $[31] !== rootElement || $[32] !== updateDragPreviewCustomProps ? (t18 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(OverlaysController, { comlink, dispatch, inFrame, inPopUp, onDrag: updateDragPreviewCustomProps, overlayEnabled, rootElement }), $[27] = comlink, $[28] = inFrame, $[29] = inPopUp, $[30] = overlayEnabled, $[31] = rootElement, $[32] = updateDragPreviewCustomProps, $[33] = t18) : t18 = $[33];\n  let t19;\n  $[34] !== contextMenu ? (t19 = contextMenu && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(ContextMenu, { ...contextMenu, onDismiss: closeContextMenu }), $[34] = contextMenu, $[35] = t19) : t19 = $[35];\n  let t20;\n  $[36] !== dragGroupRect || $[37] !== dragInsertPosition || $[38] !== dragMinimapTransition || $[39] !== dragShowMinimapPrompt || $[40] !== isDragging ? (t20 = isDragging && !dragMinimapTransition && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: [\n    dragInsertPosition && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(OverlayDragInsertMarker, { dragInsertPosition }),\n    dragShowMinimapPrompt && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(OverlayMinimapPrompt, {}),\n    dragGroupRect && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(OverlayDragGroupRect, { dragGroupRect })\n  ] }), $[36] = dragGroupRect, $[37] = dragInsertPosition, $[38] = dragMinimapTransition, $[39] = dragShowMinimapPrompt, $[40] = isDragging, $[41] = t20) : t20 = $[41];\n  let t21;\n  $[42] !== dragSkeleton || $[43] !== isDragging ? (t21 = isDragging && dragSkeleton && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(OverlayDragPreview, { skeleton: dragSkeleton }), $[42] = dragSkeleton, $[43] = isDragging, $[44] = t21) : t21 = $[44];\n  let t22;\n  $[45] !== elementsToRender || $[46] !== t15 || $[47] !== t16 || $[48] !== t17 || $[49] !== t18 || $[50] !== t19 || $[51] !== t20 || $[52] !== t21 || $[53] !== zIndex ? (t22 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(Root, { \"data-fading-out\": t15, \"data-overlays\": t16, ref: setRootElement, $zIndex: zIndex, children: [\n    t17,\n    t18,\n    t19,\n    elementsToRender,\n    t20,\n    t21\n  ] }), $[45] = elementsToRender, $[46] = t15, $[47] = t16, $[48] = t17, $[49] = t18, $[50] = t19, $[51] = t20, $[52] = t21, $[53] = zIndex, $[54] = t22) : t22 = $[54];\n  let t23;\n  $[55] !== comlink || $[56] !== t22 ? (t23 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SharedStateProvider, { comlink, children: t22 }), $[55] = comlink, $[56] = t22, $[57] = t23) : t23 = $[57];\n  let t24;\n  $[58] !== comlink || $[59] !== t23 ? (t24 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(PreviewSnapshotsProvider, { comlink, children: t23 }), $[58] = comlink, $[59] = t23, $[60] = t24) : t24 = $[60];\n  let t25;\n  $[61] !== comlink || $[62] !== elements || $[63] !== t24 ? (t25 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SchemaProvider, { comlink, elements, children: t24 }), $[61] = comlink, $[62] = elements, $[63] = t24, $[64] = t25) : t25 = $[64];\n  let t26;\n  $[65] !== rootElement || $[66] !== t25 ? (t26 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.LayerProvider, { children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.PortalProvider, { element: rootElement, children: t25 }) }), $[65] = rootElement, $[66] = t25, $[67] = t26) : t26 = $[67];\n  let t27;\n  $[68] !== t14 || $[69] !== t26 ? (t27 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.ThemeProvider, { scheme: t14, theme: _sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.studioTheme, tone: \"transparent\", children: t26 }), $[68] = t14, $[69] = t26, $[70] = t27) : t27 = $[70];\n  let t28;\n  return $[71] !== comlink || $[72] !== t27 ? (t28 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(TelemetryProvider, { comlink, children: t27 }), $[71] = comlink, $[72] = t27, $[73] = t28) : t28 = $[73], t28;\n}, IS_MAC = typeof window < \"u\" && /Mac|iPod|iPhone|iPad/.test(window.navigator.platform), MODIFIERS = {\n  alt: \"altKey\",\n  ctrl: \"ctrlKey\",\n  mod: IS_MAC ? \"metaKey\" : \"ctrlKey\",\n  shift: \"shiftKey\"\n};\nfunction isHotkey(keys, event) {\n  return keys.every((key) => MODIFIERS[key] ? event[MODIFIERS[key]] : event.key === key.toUpperCase());\n}\nfunction isAltKey(event) {\n  return event.key === \"Alt\";\n}\nfunction _temp$2(acc, prevId) {\n  return acc.filter((id) => id !== prevId);\n}\nfunction _temp2$1(enabled) {\n  return !enabled;\n}\nfunction _temp3(unsub) {\n  return unsub();\n}\nfunction _temp4(event) {\n  const target = event.target;\n  if (((0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.isHTMLAnchorElement)(target) || (0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.isHTMLElement)(target) && target.closest(\"a\")) && event.altKey) {\n    event.preventDefault(), event.stopPropagation();\n    const newEvent = new MouseEvent(event.type, {\n      ...event,\n      altKey: !1,\n      bubbles: !0,\n      cancelable: !0\n    });\n    event.target?.dispatchEvent(newEvent);\n  }\n}\nfunction _temp5(enabled_0) {\n  return !enabled_0;\n}\nfunction _temp6(enabled_1) {\n  return !enabled_1;\n}\nfunction _temp7(enabled_2) {\n  return !enabled_2;\n}\nfunction _temp8(element) {\n  return \"id\" in element.sanity ? [element.sanity.id] : [];\n}\nfunction _temp9(e_1) {\n  return e_1.activated || e_1.focused;\n}\nconst Refresh = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(4), {\n    comlink,\n    refresh\n  } = props, manualRefreshRef = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(0), mutationRefreshRef = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(0);\n  let t0, t1;\n  return $[0] !== comlink || $[1] !== refresh ? (t0 = () => comlink.on(\"presentation/refresh\", (data) => {\n    if (data.source === \"manual\") {\n      clearTimeout(manualRefreshRef.current);\n      const promise = refresh(data);\n      if (promise === !1)\n        return;\n      comlink.post(\"visual-editing/refreshing\", data);\n      let timedOut;\n      timedOut = !1, manualRefreshRef.current = window.setTimeout(() => {\n        comlink.post(\"visual-editing/refreshed\", data), timedOut = !0;\n      }, 3e3), promise?.finally?.(() => {\n        timedOut || (clearTimeout(manualRefreshRef.current), comlink.post(\"visual-editing/refreshed\", data));\n      });\n    } else if (data.source === \"mutation\") {\n      clearTimeout(mutationRefreshRef.current);\n      const promise_0 = refresh(data);\n      if (promise_0 === !1)\n        return;\n      comlink.post(\"visual-editing/refreshing\", data), mutationRefreshRef.current = window.setTimeout(() => {\n        const promise_1 = refresh(data);\n        promise_1 !== !1 && (comlink.post(\"visual-editing/refreshing\", data), promise_1?.finally?.(() => {\n          comlink.post(\"visual-editing/refreshed\", data);\n        }) || comlink.post(\"visual-editing/refreshed\", data));\n      }, 1e3), promise_0?.finally?.(() => {\n        comlink.post(\"visual-editing/refreshed\", data);\n      }) || comlink.post(\"visual-editing/refreshed\", data);\n    }\n  }), t1 = [comlink, refresh], $[0] = comlink, $[1] = refresh, $[2] = t0, $[3] = t1) : (t0 = $[2], t1 = $[3]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t0, t1), null;\n};\nfunction useComlink(t0) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(9), active = t0 === void 0 ? !0 : t0, [node, setNode] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(), [status, setStatus] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(\"idle\");\n  let t1, t2;\n  $[0] !== active ? (t1 = () => {\n    if (!active)\n      return;\n    const instance = (0,_sanity_comlink__WEBPACK_IMPORTED_MODULE_14__.createNode)({\n      name: \"visual-editing\",\n      connectTo: \"presentation\"\n    }, (0,_sanity_comlink__WEBPACK_IMPORTED_MODULE_14__.createNodeMachine)().provide({\n      actors: (0,_sanity_presentation_comlink__WEBPACK_IMPORTED_MODULE_15__.createCompatibilityActors)()\n    })), unsub = instance.onStatus(() => setStatus(\"connected\"), \"connected\");\n    setNode(instance);\n    const stop = instance.start();\n    return () => {\n      unsub(), stop(), setNode(void 0);\n    };\n  }, t2 = [active], $[0] = active, $[1] = t1, $[2] = t2) : (t1 = $[1], t2 = $[2]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t1, t2);\n  let t3, t4;\n  $[3] !== status ? (t3 = () => {\n    if (status === \"connected\")\n      return;\n    const controller = new AbortController();\n    return window.addEventListener(\"message\", _temp$1, {\n      signal: controller.signal\n    }), () => {\n      controller.abort();\n    };\n  }, t4 = [status], $[3] = status, $[4] = t3, $[5] = t4) : (t3 = $[4], t4 = $[5]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t3, t4);\n  let t5;\n  return $[6] !== node || $[7] !== status ? (t5 = [node, status], $[6] = node, $[7] = status, $[8] = t5) : t5 = $[8], t5;\n}\nfunction _temp$1(t0) {\n  const {\n    data,\n    origin\n  } = t0;\n  data && typeof data == \"object\" && \"domain\" in data && data.domain === \"sanity/channels\" && \"from\" in data && data.from === \"presentation\" && \"type\" in data && data.type === \"presentation/status\" && window.parent.postMessage({\n    domain: \"sanity/channels\",\n    type: \"visual-editing/status\",\n    data: {\n      origin: location.origin\n    }\n  }, origin);\n}\nfunction createSharedListener(comlink) {\n  const incomingConnection$ = new rxjs__WEBPACK_IMPORTED_MODULE_16__.ReplaySubject(1), incomingMutations$ = new rxjs__WEBPACK_IMPORTED_MODULE_17__.Subject();\n  return comlink.fetch(\"visual-editing/snapshot-welcome\", void 0, {\n    suppressWarnings: !0\n  }).then((data) => {\n    incomingConnection$.next(data.event);\n  }).catch(() => {\n  }), comlink.on(\"presentation/snapshot-event\", (data) => {\n    data.event.type === \"reconnect\" && incomingConnection$.next(data.event), data.event.type === \"mutation\" && incomingMutations$.next(data.event);\n  }), (0,rxjs__WEBPACK_IMPORTED_MODULE_18__.merge)(incomingConnection$, incomingMutations$);\n}\nfunction useDatasetMutator(comlink) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(3);\n  let t0, t1;\n  $[0] !== comlink ? (t0 = () => {\n    if (!comlink)\n      return;\n    const listener = createSharedListener(comlink), datasetMutator = (0,_optimistic_index_js__WEBPACK_IMPORTED_MODULE_19__.createDatasetMutator)(comlink), mutator = (0,xstate__WEBPACK_IMPORTED_MODULE_20__.A)(datasetMutator, {\n      input: {\n        client: {\n          withConfig: _temp\n        },\n        sharedListener: listener\n      }\n    });\n    mutator.start();\n    const featuresFetch = new AbortController();\n    return comlink.fetch(\"visual-editing/features\", void 0, {\n      signal: featuresFetch.signal,\n      suppressWarnings: !0\n    }).then((data) => {\n      data.features.optimistic && (0,_chunks_es_context_js__WEBPACK_IMPORTED_MODULE_21__.setActor)(mutator);\n    }).catch(_temp2), () => {\n      mutator.stop(), featuresFetch.abort();\n    };\n  }, t1 = [comlink], $[0] = comlink, $[1] = t0, $[2] = t1) : (t0 = $[1], t1 = $[2]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t0, t1);\n}\nfunction _temp2() {\n  console.warn(\"[@sanity/visual-editing] Package version mismatch detected: Please update your Sanity studio to prevent potential compatibility issues.\");\n}\nfunction _temp() {\n}\nconst VisualEditing = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(22), {\n    components,\n    history,\n    portal: t0,\n    refresh,\n    zIndex\n  } = props, portal = t0 === void 0 ? !0 : t0, [inFrame, setInFrame] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null), [inPopUp, setInPopUp] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null);\n  let t1, t2;\n  $[0] === Symbol.for(\"react.memo_cache_sentinel\") ? (t1 = () => {\n    setInFrame((0,_sanity_presentation_comlink__WEBPACK_IMPORTED_MODULE_15__.isMaybePreviewIframe)()), setInPopUp((0,_sanity_presentation_comlink__WEBPACK_IMPORTED_MODULE_15__.isMaybePreviewWindow)());\n  }, t2 = [], $[0] = t1, $[1] = t2) : (t1 = $[0], t2 = $[1]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t1, t2);\n  const [portalElement, setPortalElement] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null);\n  let t3, t4;\n  $[2] !== portal ? (t3 = () => {\n    if (portal === !1)\n      return;\n    const node = document.createElement(\"sanity-visual-editing\");\n    return document.documentElement.appendChild(node), setPortalElement(node), () => {\n      setPortalElement(null), document.documentElement.contains(node) && document.documentElement.removeChild(node);\n    };\n  }, t4 = [portal], $[2] = portal, $[3] = t3, $[4] = t4) : (t3 = $[3], t4 = $[4]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t3, t4);\n  const [comlink, comlinkStatus] = useComlink(inFrame === !0 || inPopUp === !0);\n  useDatasetMutator(comlinkStatus === \"connected\" ? comlink : void 0);\n  let t5;\n  $[5] !== comlink || $[6] !== comlinkStatus || $[7] !== components || $[8] !== inFrame || $[9] !== inPopUp || $[10] !== zIndex ? (t5 = inFrame !== null && inPopUp !== null && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Overlays, { comlink, comlinkStatus, componentResolver: components, inFrame, inPopUp, zIndex }), $[5] = comlink, $[6] = comlinkStatus, $[7] = components, $[8] = inFrame, $[9] = inPopUp, $[10] = zIndex, $[11] = t5) : t5 = $[11];\n  let t6;\n  $[12] !== comlink || $[13] !== history || $[14] !== refresh ? (t6 = comlink && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(History, { comlink, history }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Meta, { comlink }),\n    refresh && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Refresh, { comlink, refresh })\n  ] }), $[12] = comlink, $[13] = history, $[14] = refresh, $[15] = t6) : t6 = $[15];\n  let t7;\n  $[16] !== t5 || $[17] !== t6 ? (t7 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: [\n    t5,\n    t6\n  ] }), $[16] = t5, $[17] = t6, $[18] = t7) : t7 = $[18];\n  const children = t7;\n  if (portal === !1 || !portalElement)\n    return children;\n  let t8;\n  return $[19] !== children || $[20] !== portalElement ? (t8 = (0,react_dom__WEBPACK_IMPORTED_MODULE_3__.createPortal)(children, portalElement), $[19] = children, $[20] = portalElement, $[21] = t8) : t8 = $[21], t8;\n};\nVisualEditing.displayName = \"VisualEditing\";\n\n//# sourceMappingURL=index.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHNhbml0eSt2aXN1YWwtZWRpdGluZ0AyLjEzLjE1X0BlbW90aW9uK2lzLXByb3AtdmFsaWRAMS4yLjJfQHNhbml0eStjbGllbnRANi4yOC40X0BzYW5pXzhjMjAzM2ZlYWJkNWY1ODRhZjQ0NjliZmNlMTQxNTNmL25vZGVfbW9kdWxlcy9Ac2FuaXR5L3Zpc3VhbC1lZGl0aW5nL2Rpc3QvcmVhY3QvaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXdEO0FBQ2I7QUFDMEU7QUFDb0M7QUFDaEg7QUFDa0Q7QUFDOEs7QUFDOU47QUFDNEw7QUFDeEc7QUFDM0Q7QUFDaEI7QUFDMkY7QUFDb0Q7QUFDdEk7QUFDSTtBQUNUO0FBQ1E7QUFDM0I7QUFDZTtBQUNFO0FBQ0Q7QUFDUztBQUNDO0FBQy9EO0FBQ0EsWUFBWSx5REFBQztBQUNiO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsR0FBRyw0R0FBNEcsZ0RBQVM7QUFDeEg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxHQUFHLDJHQUEyRyxnREFBUztBQUN2SCxDQUFDO0FBQ0QsWUFBWSx5REFBQztBQUNiO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRyxrRkFBa0YsZ0RBQVM7QUFDOUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVkseURBQUM7QUFDYjtBQUNBLElBQUksRUFBRSxxRUFBWTtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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QUFnTSxzREFBRyxhQUFhLGlGQUFpRjtBQUNqUztBQUNBLGlHQUFpRyx1REFBSSxDQUFDLHVEQUFRLElBQUk7QUFDbEgsb0JBQW9CLHNEQUFHLFlBQVksa0JBQWtCO0FBQ3JELG9CQUFvQixzREFBRyxTQUFTLFNBQVM7QUFDekMsK0JBQStCLHNEQUFHLFlBQVksa0JBQWtCO0FBQ2hFLEtBQUs7QUFDTDtBQUNBLHVEQUF1RCx1REFBSSxDQUFDLHVEQUFRLElBQUk7QUFDeEU7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtEQUErRCx1REFBWTtBQUMzRTtBQUNBO0FBVUU7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL3BldHJva3ZhcnRzaWFueWkvY29kZS9nZW9tdW5kdXMtd2Vic2l0ZS9ub2RlX21vZHVsZXMvLnBucG0vQHNhbml0eSt2aXN1YWwtZWRpdGluZ0AyLjEzLjE1X0BlbW90aW9uK2lzLXByb3AtdmFsaWRAMS4yLjJfQHNhbml0eStjbGllbnRANi4yOC40X0BzYW5pXzhjMjAzM2ZlYWJkNWY1ODRhZjQ0NjliZmNlMTQxNTNmL25vZGVfbW9kdWxlcy9Ac2FuaXR5L3Zpc3VhbC1lZGl0aW5nL2Rpc3QvcmVhY3QvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsganN4LCBqc3hzLCBGcmFnbWVudCB9IGZyb20gXCJyZWFjdC9qc3gtcnVudGltZVwiO1xuaW1wb3J0IHsgYyB9IGZyb20gXCJyZWFjdC1jb21waWxlci1ydW50aW1lXCI7XG5pbXBvcnQgeyBjcmVhdGVDb21wYXRpYmlsaXR5QWN0b3JzLCBpc01heWJlUHJldmlld0lmcmFtZSwgaXNNYXliZVByZXZpZXdXaW5kb3cgfSBmcm9tIFwiQHNhbml0eS9wcmVzZW50YXRpb24tY29tbGlua1wiO1xuaW1wb3J0IHsgdXNlRWZmZWN0LCBjcmVhdGVDb250ZXh0LCB1c2VDb250ZXh0LCB1c2VTdGF0ZSwgbWVtbywgdXNlUmVmLCBpc1ZhbGlkRWxlbWVudCwgdXNlU3luY0V4dGVybmFsU3RvcmUsIHVzZURlZmVycmVkVmFsdWUsIHVzZVJlZHVjZXIgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IGNyZWF0ZVBvcnRhbCB9IGZyb20gXCJyZWFjdC1kb21cIjtcbmltcG9ydCB7IGNyZWF0ZUVkaXRVcmwsIHN0dWRpb1BhdGgsIGdldERyYWZ0SWQsIGdldFB1Ymxpc2hlZElkIH0gZnJvbSBcIkBzYW5pdHkvY2xpZW50L2NzbVwiO1xuaW1wb3J0IHsgTWVudUdyb3VwLCBNZW51RGl2aWRlciwgTWVudUl0ZW0sIEJveCwgVGV4dCwgU3Bpbm5lciwgU3RhY2ssIEZsZXgsIE1lbnUsIFBvcG92ZXIsIENhcmQsIHVzZVByZWZlcnNEYXJrLCB1c2VUaGVtZV92MiwgSG90a2V5cywgTGF5ZXJQcm92aWRlciwgUG9ydGFsUHJvdmlkZXIsIFRoZW1lUHJvdmlkZXIsIHN0dWRpb1RoZW1lLCBpc0hUTUxBbmNob3JFbGVtZW50LCBpc0hUTUxFbGVtZW50IH0gZnJvbSBcIkBzYW5pdHkvdWkvX3Zpc3VhbC1lZGl0aW5nXCI7XG5pbXBvcnQgeyBzdHlsZWQgfSBmcm9tIFwic3R5bGVkLWNvbXBvbmVudHNcIjtcbmltcG9ydCB7IHVzZURvY3VtZW50cywgZ2V0QXJyYXlJdGVtS2V5QW5kUGFyZW50UGF0aCwgZ2V0LCBnZXRBcnJheU1vdmVQYXRjaGVzLCBnZXRBcnJheUluc2VydFBhdGNoZXMsIGdldEFycmF5RHVwbGljYXRlUGF0Y2hlcywgZ2V0QXJyYXlSZW1vdmVQYXRjaGVzLCB1c2VPcHRpbWlzdGljQWN0b3JSZWFkeSwgdXNlT3B0aW1pc3RpY0FjdG9yIH0gZnJvbSBcIi4uL19jaHVua3MtZXMvbXV0YXRpb25zLmpzXCI7XG5pbXBvcnQgeyBTaGFyZWRTdGF0ZUNvbnRleHQsIGNyZWF0ZU92ZXJsYXlDb250cm9sbGVyLCBzYW5pdHlOb2Rlc0V4aXN0SW5TYW1lQXJyYXkgfSBmcm9tIFwiLi4vX2NodW5rcy1lcy9TaGFyZWRTdGF0ZUNvbnRleHQuanNcIjtcbmltcG9ydCB7IHVzZU9wdGltaXN0aWMgfSBmcm9tIFwiLi4vX2NodW5rcy1lcy9TaGFyZWRTdGF0ZUNvbnRleHQuanNcIjtcbmltcG9ydCB7IGF0LCByZW1vdmUsIGluc2VydCB9IGZyb20gXCJAc2FuaXR5L211dGF0ZVwiO1xuaW1wb3J0IHsgZ2V0Tm9kZUljb24sIEluc2VydE1lbnUsIFBvcG92ZXJQb3J0YWwsIHVzZVRlbGVtZXRyeSwgUG9pbnRlckV2ZW50cywgVGVsZW1ldHJ5Q29udGV4dCwgZXZlbnRzIH0gZnJvbSBcIi4uL19jaHVua3MtZXMvUG9pbnRlckV2ZW50cy5qc1wiO1xuaW1wb3J0IHsgSW5zZXJ0QWJvdmVJY29uLCBJbnNlcnRCZWxvd0ljb24sIENvcHlJY29uLCBSZW1vdmVJY29uLCBTb3J0SWNvbiwgUHVibGlzaEljb24sIEFycm93VXBJY29uLCBBcnJvd0Rvd25JY29uLCBVbnB1Ymxpc2hJY29uLCBEb2N1bWVudEljb24sIERyYWdIYW5kbGVJY29uLCBFeHBhbmRJY29uIH0gZnJvbSBcIkBzYW5pdHkvaWNvbnNcIjtcbmltcG9ydCB7IHBhdGhUb1VybFN0cmluZyB9IGZyb20gXCJAc2FuaXR5L3Zpc3VhbC1lZGl0aW5nLWNzbVwiO1xuaW1wb3J0IHsgY3JlYXRlRGF0YUF0dHJpYnV0ZSB9IGZyb20gXCJAc2FuaXR5L3Zpc3VhbC1lZGl0aW5nLWNzbVwiO1xuaW1wb3J0IHNjcm9sbEludG9WaWV3IGZyb20gXCJzY3JvbGwtaW50by12aWV3LWlmLW5lZWRlZFwiO1xuaW1wb3J0IHsgY3JlYXRlTm9kZSwgY3JlYXRlTm9kZU1hY2hpbmUgfSBmcm9tIFwiQHNhbml0eS9jb21saW5rXCI7XG5pbXBvcnQgeyBjcmVhdGVBY3RvciB9IGZyb20gXCJ4c3RhdGVcIjtcbmltcG9ydCB7IHNldEFjdG9yIH0gZnJvbSBcIi4uL19jaHVua3MtZXMvY29udGV4dC5qc1wiO1xuaW1wb3J0IHsgZW1wdHlBY3RvciB9IGZyb20gXCIuLi9fY2h1bmtzLWVzL2NvbnRleHQuanNcIjtcbmltcG9ydCB7IFJlcGxheVN1YmplY3QsIFN1YmplY3QsIG1lcmdlIH0gZnJvbSBcInJ4anNcIjtcbmltcG9ydCB7IGNyZWF0ZURhdGFzZXRNdXRhdG9yIH0gZnJvbSBcIi4uL29wdGltaXN0aWMvaW5kZXguanNcIjtcbmltcG9ydCB7IGNyZWF0ZURvY3VtZW50TXV0YXRvciB9IGZyb20gXCIuLi9vcHRpbWlzdGljL2luZGV4LmpzXCI7XG5jb25zdCBIaXN0b3J5ID0gKHByb3BzKSA9PiB7XG4gIGNvbnN0ICQgPSBjKDgpLCB7XG4gICAgY29tbGluayxcbiAgICBoaXN0b3J5XG4gIH0gPSBwcm9wcztcbiAgbGV0IHQwLCB0MTtcbiAgJFswXSAhPT0gY29tbGluayB8fCAkWzFdICE9PSBoaXN0b3J5ID8gKHQwID0gKCkgPT4gY29tbGluaz8ub24oXCJwcmVzZW50YXRpb24vbmF2aWdhdGVcIiwgKGRhdGEpID0+IHtcbiAgICBoaXN0b3J5Py51cGRhdGUoZGF0YSk7XG4gIH0pLCB0MSA9IFtjb21saW5rLCBoaXN0b3J5XSwgJFswXSA9IGNvbWxpbmssICRbMV0gPSBoaXN0b3J5LCAkWzJdID0gdDAsICRbM10gPSB0MSkgOiAodDAgPSAkWzJdLCB0MSA9ICRbM10pLCB1c2VFZmZlY3QodDAsIHQxKTtcbiAgbGV0IHQyLCB0MztcbiAgcmV0dXJuICRbNF0gIT09IGNvbWxpbmsgfHwgJFs1XSAhPT0gaGlzdG9yeSA/ICh0MiA9ICgpID0+IHtcbiAgICBpZiAoaGlzdG9yeSlcbiAgICAgIHJldHVybiBoaXN0b3J5LnN1YnNjcmliZSgodXBkYXRlKSA9PiB7XG4gICAgICAgIHVwZGF0ZS50aXRsZSA9IHVwZGF0ZS50aXRsZSB8fCBkb2N1bWVudC50aXRsZSwgY29tbGluaz8ucG9zdChcInZpc3VhbC1lZGl0aW5nL25hdmlnYXRlXCIsIHVwZGF0ZSk7XG4gICAgICB9KTtcbiAgfSwgdDMgPSBbY29tbGluaywgaGlzdG9yeV0sICRbNF0gPSBjb21saW5rLCAkWzVdID0gaGlzdG9yeSwgJFs2XSA9IHQyLCAkWzddID0gdDMpIDogKHQyID0gJFs2XSwgdDMgPSAkWzddKSwgdXNlRWZmZWN0KHQyLCB0MyksIG51bGw7XG59LCBNZXRhID0gKHByb3BzKSA9PiB7XG4gIGNvbnN0ICQgPSBjKDMpLCB7XG4gICAgY29tbGlua1xuICB9ID0gcHJvcHM7XG4gIGxldCB0MCwgdDE7XG4gIHJldHVybiAkWzBdICE9PSBjb21saW5rID8gKHQwID0gKCkgPT4ge1xuICAgIGNvbnN0IHNlbmRNZXRhID0gKCkgPT4ge1xuICAgICAgY29tbGluay5wb3N0KFwidmlzdWFsLWVkaXRpbmcvbWV0YVwiLCB7XG4gICAgICAgIHRpdGxlOiBkb2N1bWVudC50aXRsZVxuICAgICAgfSk7XG4gICAgfSwgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigodDIpID0+IHtcbiAgICAgIGNvbnN0IFttdXRhdGlvbl0gPSB0MjtcbiAgICAgIG11dGF0aW9uLnRhcmdldC5ub2RlTmFtZSA9PT0gXCJUSVRMRVwiICYmIHNlbmRNZXRhKCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIG9ic2VydmVyLm9ic2VydmUoZG9jdW1lbnQuaGVhZCwge1xuICAgICAgc3VidHJlZTogITAsXG4gICAgICBjaGFyYWN0ZXJEYXRhOiAhMCxcbiAgICAgIGNoaWxkTGlzdDogITBcbiAgICB9KSwgc2VuZE1ldGEoKSwgKCkgPT4gb2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICB9LCB0MSA9IFtjb21saW5rXSwgJFswXSA9IGNvbWxpbmssICRbMV0gPSB0MCwgJFsyXSA9IHQxKSA6ICh0MCA9ICRbMV0sIHQxID0gJFsyXSksIHVzZUVmZmVjdCh0MCwgdDEpLCBudWxsO1xufTtcbmZ1bmN0aW9uIGdldFJlZmVyZW5jZU5vZGVBbmRJbnNlcnRQb3NpdGlvbihwb3NpdGlvbikge1xuICBpZiAocG9zaXRpb24pIHtcbiAgICBjb25zdCB7XG4gICAgICB0b3AsXG4gICAgICByaWdodCxcbiAgICAgIGJvdHRvbSxcbiAgICAgIGxlZnRcbiAgICB9ID0gcG9zaXRpb247XG4gICAgaWYgKGxlZnQgfHwgdG9wKVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbm9kZTogKGxlZnQgPz8gdG9wKS5zYW5pdHksXG4gICAgICAgIHBvc2l0aW9uOiBcImFmdGVyXCJcbiAgICAgIH07XG4gICAgaWYgKHJpZ2h0IHx8IGJvdHRvbSlcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG5vZGU6IChyaWdodCA/PyBib3R0b20pLnNhbml0eSxcbiAgICAgICAgcG9zaXRpb246IFwiYmVmb3JlXCJcbiAgICAgIH07XG4gIH1cbn1cbmZ1bmN0aW9uIHVzZURyYWdFbmRFdmVudHMoKSB7XG4gIGNvbnN0ICQgPSBjKDQpLCB7XG4gICAgZ2V0RG9jdW1lbnRcbiAgfSA9IHVzZURvY3VtZW50cygpO1xuICBsZXQgdDAsIHQxO1xuICAkWzBdICE9PSBnZXREb2N1bWVudCA/ICh0MCA9ICgpID0+IHtcbiAgICBjb25zdCBoYW5kbGVyID0gKGUpID0+IHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgaW5zZXJ0UG9zaXRpb24sXG4gICAgICAgIHRhcmdldCxcbiAgICAgICAgcHJldmVudEluc2VydERlZmF1bHRcbiAgICAgIH0gPSBlLmRldGFpbDtcbiAgICAgIGlmIChwcmV2ZW50SW5zZXJ0RGVmYXVsdClcbiAgICAgICAgcmV0dXJuO1xuICAgICAgY29uc3QgcmVmZXJlbmNlID0gZ2V0UmVmZXJlbmNlTm9kZUFuZEluc2VydFBvc2l0aW9uKGluc2VydFBvc2l0aW9uKTtcbiAgICAgIGlmIChyZWZlcmVuY2UpIHtcbiAgICAgICAgY29uc3QgZG9jID0gZ2V0RG9jdW1lbnQodGFyZ2V0LmlkKSwge1xuICAgICAgICAgIG5vZGUsXG4gICAgICAgICAgcG9zaXRpb25cbiAgICAgICAgfSA9IHJlZmVyZW5jZSwge1xuICAgICAgICAgIGtleTogdGFyZ2V0S2V5LFxuICAgICAgICAgIGhhc0V4cGxpY2l0S2V5XG4gICAgICAgIH0gPSBnZXRBcnJheUl0ZW1LZXlBbmRQYXJlbnRQYXRoKHRhcmdldCksIHtcbiAgICAgICAgICBwYXRoOiBhcnJheVBhdGgsXG4gICAgICAgICAga2V5OiByZWZlcmVuY2VJdGVtS2V5XG4gICAgICAgIH0gPSBnZXRBcnJheUl0ZW1LZXlBbmRQYXJlbnRQYXRoKG5vZGUpO1xuICAgICAgICBhcnJheVBhdGggJiYgcmVmZXJlbmNlSXRlbUtleSAmJiByZWZlcmVuY2VJdGVtS2V5ICE9PSB0YXJnZXRLZXkgJiYgZG9jLnBhdGNoKGFzeW5jICh0MjIpID0+IHtcbiAgICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBnZXRTbmFwc2hvdFxuICAgICAgICAgIH0gPSB0MjIsIHNuYXBzaG90ID0gYXdhaXQgZ2V0U25hcHNob3QoKSwgZWxlbWVudFZhbHVlID0gZ2V0KHNuYXBzaG90LCB0YXJnZXQucGF0aCk7XG4gICAgICAgICAgcmV0dXJuIGhhc0V4cGxpY2l0S2V5ID8gW2F0KGFycmF5UGF0aCwgcmVtb3ZlKHtcbiAgICAgICAgICAgIF9rZXk6IHRhcmdldEtleVxuICAgICAgICAgIH0pKSwgYXQoYXJyYXlQYXRoLCBpbnNlcnQoZWxlbWVudFZhbHVlLCBwb3NpdGlvbiwge1xuICAgICAgICAgICAgX2tleTogcmVmZXJlbmNlSXRlbUtleVxuICAgICAgICAgIH0pKV0gOiBbYXQoYXJyYXlQYXRoLCByZW1vdmUofn50YXJnZXRLZXkpKSwgYXQoYXJyYXlQYXRoLCBpbnNlcnQoZWxlbWVudFZhbHVlLCBwb3NpdGlvbiwgcmVmZXJlbmNlSXRlbUtleSA+IHRhcmdldEtleSA/IH5+cmVmZXJlbmNlSXRlbUtleSAtIDEgOiB+fnJlZmVyZW5jZUl0ZW1LZXkpKV07XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwic2FuaXR5L2RyYWdFbmRcIiwgaGFuZGxlciksICgpID0+IHtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwic2FuaXR5L2RyYWdFbmRcIiwgaGFuZGxlcik7XG4gICAgfTtcbiAgfSwgdDEgPSBbZ2V0RG9jdW1lbnRdLCAkWzBdID0gZ2V0RG9jdW1lbnQsICRbMV0gPSB0MCwgJFsyXSA9IHQxKSA6ICh0MCA9ICRbMV0sIHQxID0gJFsyXSksIHVzZUVmZmVjdCh0MCwgdDEpO1xuICBjb25zdCBkaXNwYXRjaERyYWdFbmRFdmVudCA9IF90ZW1wJDk7XG4gIGxldCB0MjtcbiAgcmV0dXJuICRbM10gPT09IFN5bWJvbC5mb3IoXCJyZWFjdC5tZW1vX2NhY2hlX3NlbnRpbmVsXCIpID8gKHQyID0ge1xuICAgIGRpc3BhdGNoRHJhZ0VuZEV2ZW50XG4gIH0sICRbM10gPSB0MikgOiB0MiA9ICRbM10sIHQyO1xufVxuZnVuY3Rpb24gX3RlbXAkOShldmVudCkge1xuICBjb25zdCBjdXN0b21FdmVudCA9IG5ldyBDdXN0b21FdmVudChcInNhbml0eS9kcmFnRW5kXCIsIHtcbiAgICBkZXRhaWw6IGV2ZW50LFxuICAgIGNhbmNlbGFibGU6ICEwXG4gIH0pO1xuICB3aW5kb3cuZGlzcGF0Y2hFdmVudChjdXN0b21FdmVudCk7XG59XG5jb25zdCBTY2hlbWFDb250ZXh0ID0gY3JlYXRlQ29udGV4dChudWxsKTtcbmZ1bmN0aW9uIHVzZVNjaGVtYSgpIHtcbiAgY29uc3QgY29udGV4dCA9IHVzZUNvbnRleHQoU2NoZW1hQ29udGV4dCk7XG4gIGlmICghY29udGV4dClcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJTY2hlbWEgY29udGV4dCBpcyBtaXNzaW5nXCIpO1xuICByZXR1cm4gY29udGV4dDtcbn1cbmZ1bmN0aW9uIGdldEFycmF5UmVtb3ZlQWN0aW9uKG5vZGUsIGRvYykge1xuICBpZiAoIW5vZGUudHlwZSkgdGhyb3cgbmV3IEVycm9yKFwiTm9kZSB0eXBlIGlzIG1pc3NpbmdcIik7XG4gIHJldHVybiAoKSA9PiBkb2MucGF0Y2goYXN5bmMgKHtcbiAgICBnZXRTbmFwc2hvdFxuICB9KSA9PiBnZXRBcnJheVJlbW92ZVBhdGNoZXMobm9kZSwgYXdhaXQgZ2V0U25hcHNob3QoKSkpO1xufVxuZnVuY3Rpb24gZ2V0QXJyYXlJbnNlcnRBY3Rpb24obm9kZSwgZG9jLCBpbnNlcnRUeXBlLCBwb3NpdGlvbikge1xuICBpZiAoIW5vZGUudHlwZSkgdGhyb3cgbmV3IEVycm9yKFwiTm9kZSB0eXBlIGlzIG1pc3NpbmdcIik7XG4gIHJldHVybiAoKSA9PiBkb2MucGF0Y2goKCkgPT4gZ2V0QXJyYXlJbnNlcnRQYXRjaGVzKG5vZGUsIGluc2VydFR5cGUsIHBvc2l0aW9uKSk7XG59XG5mdW5jdGlvbiBnZXREdXBsaWNhdGVBY3Rpb24obm9kZSwgZG9jKSB7XG4gIGlmICghbm9kZS50eXBlKSB0aHJvdyBuZXcgRXJyb3IoXCJOb2RlIHR5cGUgaXMgbWlzc2luZ1wiKTtcbiAgcmV0dXJuICgpID0+IGRvYy5wYXRjaChhc3luYyAoe1xuICAgIGdldFNuYXBzaG90XG4gIH0pID0+IGdldEFycmF5RHVwbGljYXRlUGF0Y2hlcyhub2RlLCBhd2FpdCBnZXRTbmFwc2hvdCgpKSk7XG59XG5mdW5jdGlvbiBnZXRDb250ZXh0TWVudUl0ZW1zKGNvbnRleHQpIHtcbiAgY29uc3Qge1xuICAgIG5vZGUsXG4gICAgZmllbGQsXG4gICAgcGFyZW50LFxuICAgIGRvY1xuICB9ID0gY29udGV4dDtcbiAgcmV0dXJuIGZpZWxkPy50eXBlID09PSBcImFycmF5SXRlbVwiID8gZ2V0Q29udGV4dE1lbnVBcnJheUl0ZW1zKHtcbiAgICBub2RlLFxuICAgIGZpZWxkLFxuICAgIGRvY1xuICB9KSA6IHBhcmVudD8udHlwZSA9PT0gXCJ1bmlvblwiID8gZ2V0Q29udGV4dE1lbnVVbmlvbkl0ZW1zKHtcbiAgICBub2RlLFxuICAgIHBhcmVudCxcbiAgICBkb2NcbiAgfSkgOiBQcm9taXNlLnJlc29sdmUoW10pO1xufVxuZnVuY3Rpb24gZ2V0RHVwbGljYXRlSXRlbShjb250ZXh0KSB7XG4gIGNvbnN0IHtcbiAgICBub2RlLFxuICAgIGRvY1xuICB9ID0gY29udGV4dDtcbiAgcmV0dXJuIGRvYyA/IFt7XG4gICAgdHlwZTogXCJhY3Rpb25cIixcbiAgICBsYWJlbDogXCJEdXBsaWNhdGVcIixcbiAgICBpY29uOiBDb3B5SWNvbixcbiAgICBhY3Rpb246IGdldER1cGxpY2F0ZUFjdGlvbihub2RlLCBkb2MpLFxuICAgIHRlbGVtZXRyeUV2ZW50OiBcIlZpc3VhbCBFZGl0aW5nIENvbnRleHQgTWVudSBJdGVtIER1cGxpY2F0ZWRcIlxuICB9XSA6IFtdO1xufVxuZnVuY3Rpb24gZ2V0UmVtb3ZlSXRlbXMoY29udGV4dCkge1xuICBjb25zdCB7XG4gICAgbm9kZSxcbiAgICBkb2NcbiAgfSA9IGNvbnRleHQ7XG4gIHJldHVybiBkb2MgPyBbe1xuICAgIHR5cGU6IFwiYWN0aW9uXCIsXG4gICAgbGFiZWw6IFwiUmVtb3ZlXCIsXG4gICAgaWNvbjogUmVtb3ZlSWNvbixcbiAgICBhY3Rpb246IGdldEFycmF5UmVtb3ZlQWN0aW9uKG5vZGUsIGRvYyksXG4gICAgdGVsZW1ldHJ5RXZlbnQ6IFwiVmlzdWFsIEVkaXRpbmcgQ29udGV4dCBNZW51IEl0ZW0gUmVtb3ZlZFwiXG4gIH1dIDogW107XG59XG5hc3luYyBmdW5jdGlvbiBnZXRNb3ZlSXRlbXMoY29udGV4dCwgd2l0aERpdmlkZXIgPSAhMCkge1xuICBjb25zdCB7XG4gICAgbm9kZSxcbiAgICBkb2NcbiAgfSA9IGNvbnRleHQ7XG4gIGlmICghZG9jKSByZXR1cm4gW107XG4gIGNvbnN0IGl0ZW1zID0gW10sIGdyb3VwSXRlbXMgPSBbXSwgW21vdmVVcFBhdGNoZXMsIG1vdmVEb3duUGF0Y2hlcywgbW92ZUZpcnN0UGF0Y2hlcywgbW92ZUxhc3RQYXRjaGVzXSA9IGF3YWl0IFByb21pc2UuYWxsKFtnZXRBcnJheU1vdmVQYXRjaGVzKG5vZGUsIGRvYywgXCJwcmV2aW91c1wiKSwgZ2V0QXJyYXlNb3ZlUGF0Y2hlcyhub2RlLCBkb2MsIFwibmV4dFwiKSwgZ2V0QXJyYXlNb3ZlUGF0Y2hlcyhub2RlLCBkb2MsIFwiZmlyc3RcIiksIGdldEFycmF5TW92ZVBhdGNoZXMobm9kZSwgZG9jLCBcImxhc3RcIildKTtcbiAgcmV0dXJuIG1vdmVGaXJzdFBhdGNoZXMubGVuZ3RoICYmIGdyb3VwSXRlbXMucHVzaCh7XG4gICAgdHlwZTogXCJhY3Rpb25cIixcbiAgICBsYWJlbDogXCJUbyB0b3BcIixcbiAgICBpY29uOiBQdWJsaXNoSWNvbixcbiAgICBhY3Rpb246ICgpID0+IGRvYy5wYXRjaChtb3ZlRmlyc3RQYXRjaGVzKSxcbiAgICB0ZWxlbWV0cnlFdmVudDogXCJWaXN1YWwgRWRpdGluZyBDb250ZXh0IE1lbnUgSXRlbSBNb3ZlZFwiXG4gIH0pLCBtb3ZlVXBQYXRjaGVzLmxlbmd0aCAmJiBncm91cEl0ZW1zLnB1c2goe1xuICAgIHR5cGU6IFwiYWN0aW9uXCIsXG4gICAgbGFiZWw6IFwiVXBcIixcbiAgICBpY29uOiBBcnJvd1VwSWNvbixcbiAgICBhY3Rpb246ICgpID0+IGRvYy5wYXRjaChtb3ZlVXBQYXRjaGVzKSxcbiAgICB0ZWxlbWV0cnlFdmVudDogXCJWaXN1YWwgRWRpdGluZyBDb250ZXh0IE1lbnUgSXRlbSBNb3ZlZFwiXG4gIH0pLCBtb3ZlRG93blBhdGNoZXMubGVuZ3RoICYmIGdyb3VwSXRlbXMucHVzaCh7XG4gICAgdHlwZTogXCJhY3Rpb25cIixcbiAgICBsYWJlbDogXCJEb3duXCIsXG4gICAgaWNvbjogQXJyb3dEb3duSWNvbixcbiAgICBhY3Rpb246ICgpID0+IGRvYy5wYXRjaChtb3ZlRG93blBhdGNoZXMpLFxuICAgIHRlbGVtZXRyeUV2ZW50OiBcIlZpc3VhbCBFZGl0aW5nIENvbnRleHQgTWVudSBJdGVtIE1vdmVkXCJcbiAgfSksIG1vdmVMYXN0UGF0Y2hlcy5sZW5ndGggJiYgZ3JvdXBJdGVtcy5wdXNoKHtcbiAgICB0eXBlOiBcImFjdGlvblwiLFxuICAgIGxhYmVsOiBcIlRvIGJvdHRvbVwiLFxuICAgIGljb246IFVucHVibGlzaEljb24sXG4gICAgYWN0aW9uOiAoKSA9PiBkb2MucGF0Y2gobW92ZUxhc3RQYXRjaGVzKSxcbiAgICB0ZWxlbWV0cnlFdmVudDogXCJWaXN1YWwgRWRpdGluZyBDb250ZXh0IE1lbnUgSXRlbSBNb3ZlZFwiXG4gIH0pLCBncm91cEl0ZW1zLmxlbmd0aCAmJiAoaXRlbXMucHVzaCh7XG4gICAgdHlwZTogXCJncm91cFwiLFxuICAgIGxhYmVsOiBcIk1vdmVcIixcbiAgICBpY29uOiBTb3J0SWNvbixcbiAgICBpdGVtczogZ3JvdXBJdGVtc1xuICB9KSwgd2l0aERpdmlkZXIgJiYgaXRlbXMucHVzaCh7XG4gICAgdHlwZTogXCJkaXZpZGVyXCJcbiAgfSkpLCBpdGVtcztcbn1cbmFzeW5jIGZ1bmN0aW9uIGdldENvbnRleHRNZW51QXJyYXlJdGVtcyhjb250ZXh0KSB7XG4gIGNvbnN0IHtcbiAgICBub2RlLFxuICAgIGZpZWxkLFxuICAgIGRvY1xuICB9ID0gY29udGV4dCwgaXRlbXMgPSBbXTtcbiAgcmV0dXJuIGl0ZW1zLnB1c2goLi4uZ2V0RHVwbGljYXRlSXRlbShjb250ZXh0KSksIGl0ZW1zLnB1c2goLi4uZ2V0UmVtb3ZlSXRlbXMoY29udGV4dCkpLCBpdGVtcy5wdXNoKC4uLmF3YWl0IGdldE1vdmVJdGVtcyhjb250ZXh0KSksIGl0ZW1zLnB1c2goe1xuICAgIHR5cGU6IFwiYWN0aW9uXCIsXG4gICAgbGFiZWw6IFwiSW5zZXJ0IGJlZm9yZVwiLFxuICAgIGljb246IEluc2VydEFib3ZlSWNvbixcbiAgICBhY3Rpb246IGdldEFycmF5SW5zZXJ0QWN0aW9uKG5vZGUsIGRvYywgZmllbGQubmFtZSwgXCJiZWZvcmVcIiksXG4gICAgdGVsZW1ldHJ5RXZlbnQ6IFwiVmlzdWFsIEVkaXRpbmcgQ29udGV4dCBNZW51IEl0ZW0gSW5zZXJ0ZWRcIlxuICB9KSwgaXRlbXMucHVzaCh7XG4gICAgdHlwZTogXCJhY3Rpb25cIixcbiAgICBsYWJlbDogXCJJbnNlcnQgYWZ0ZXJcIixcbiAgICBpY29uOiBJbnNlcnRCZWxvd0ljb24sXG4gICAgYWN0aW9uOiBnZXRBcnJheUluc2VydEFjdGlvbihub2RlLCBkb2MsIGZpZWxkLm5hbWUsIFwiYWZ0ZXJcIiksXG4gICAgdGVsZW1ldHJ5RXZlbnQ6IFwiVmlzdWFsIEVkaXRpbmcgQ29udGV4dCBNZW51IEl0ZW0gSW5zZXJ0ZWRcIlxuICB9KSwgaXRlbXM7XG59XG5jb25zdCBJbnNlcnRNZW51V3JhcHBlciA9IChwcm9wcykgPT4ge1xuICBjb25zdCAkID0gYygxMiksIHtcbiAgICBsYWJlbCxcbiAgICBwYXJlbnQsXG4gICAgd2lkdGgsXG4gICAgb25TZWxlY3QsXG4gICAgYm91bmRhcnlFbGVtZW50XG4gIH0gPSBwcm9wcztcbiAgbGV0IHQwO1xuICAkWzBdID09PSBTeW1ib2wuZm9yKFwicmVhY3QubWVtb19jYWNoZV9zZW50aW5lbFwiKSA/ICh0MCA9IFtcImxlZnQtc3RhcnRcIiwgXCJyaWdodFwiLCBcImxlZnRcIiwgXCJyaWdodC1lbmRcIiwgXCJsZWZ0LWVuZFwiLCBcImJvdHRvbVwiLCBcInRvcFwiXSwgJFswXSA9IHQwKSA6IHQwID0gJFswXTtcbiAgbGV0IHQxO1xuICAkWzFdID09PSBTeW1ib2wuZm9yKFwicmVhY3QubWVtb19jYWNoZV9zZW50aW5lbFwiKSA/ICh0MSA9IFs0LCA0LCA0LCA0XSwgJFsxXSA9IHQxKSA6IHQxID0gJFsxXTtcbiAgbGV0IHQyO1xuICAkWzJdICE9PSBib3VuZGFyeUVsZW1lbnQgfHwgJFszXSAhPT0gd2lkdGggPyAodDIgPSB7XG4gICAgYXJyb3c6ICExLFxuICAgIGNvbnN0cmFpblNpemU6ICEwLFxuICAgIGZsb2F0aW5nQm91bmRhcnk6IGJvdW5kYXJ5RWxlbWVudCxcbiAgICBwYWRkaW5nOiAwLFxuICAgIHBsYWNlbWVudDogXCJyaWdodC1zdGFydFwiLFxuICAgIGZhbGxiYWNrUGxhY2VtZW50czogdDAsXG4gICAgcHJldmVudE92ZXJmbG93OiAhMCxcbiAgICB3aWR0aCxcbiAgICBfX3Vuc3RhYmxlX21hcmdpbnM6IHQxXG4gIH0sICRbMl0gPSBib3VuZGFyeUVsZW1lbnQsICRbM10gPSB3aWR0aCwgJFs0XSA9IHQyKSA6IHQyID0gJFs0XTtcbiAgbGV0IHQzO1xuICAkWzVdICE9PSBvblNlbGVjdCB8fCAkWzZdICE9PSBwYXJlbnQgPyAodDMgPSAvKiBAX19QVVJFX18gKi8ganN4KEluc2VydE1lbnUsIHsgbm9kZTogcGFyZW50LCBvblNlbGVjdCB9KSwgJFs1XSA9IG9uU2VsZWN0LCAkWzZdID0gcGFyZW50LCAkWzddID0gdDMpIDogdDMgPSAkWzddO1xuICBsZXQgdDQ7XG4gIHJldHVybiAkWzhdICE9PSBsYWJlbCB8fCAkWzldICE9PSB0MiB8fCAkWzEwXSAhPT0gdDMgPyAodDQgPSAvKiBAX19QVVJFX18gKi8ganN4KE1lbnVHcm91cCwgeyBmb250U2l6ZTogMSwgaWNvbjogSW5zZXJ0QmVsb3dJY29uLCBwYWRkaW5nOiAyLCBwb3BvdmVyOiB0Miwgc3BhY2U6IDIsIHRleHQ6IGxhYmVsLCBjaGlsZHJlbjogdDMgfSksICRbOF0gPSBsYWJlbCwgJFs5XSA9IHQyLCAkWzEwXSA9IHQzLCAkWzExXSA9IHQ0KSA6IHQ0ID0gJFsxMV0sIHQ0O1xufTtcbmFzeW5jIGZ1bmN0aW9uIGdldENvbnRleHRNZW51VW5pb25JdGVtcyhjb250ZXh0KSB7XG4gIGNvbnN0IHtcbiAgICBkb2MsXG4gICAgbm9kZSxcbiAgICBwYXJlbnRcbiAgfSA9IGNvbnRleHQsIGl0ZW1zID0gW107XG4gIGlmIChpdGVtcy5wdXNoKC4uLmdldER1cGxpY2F0ZUl0ZW0oY29udGV4dCkpLCBpdGVtcy5wdXNoKC4uLmdldFJlbW92ZUl0ZW1zKGNvbnRleHQpKSwgaXRlbXMucHVzaCguLi5hd2FpdCBnZXRNb3ZlSXRlbXMoY29udGV4dCkpLCBwYXJlbnQub3B0aW9ucz8uaW5zZXJ0TWVudSkge1xuICAgIGNvbnN0IHdpZHRoID0gKHBhcmVudC5vcHRpb25zLmluc2VydE1lbnUgfHwge30pLnZpZXdzPy5zb21lKCh2aWV3KSA9PiB2aWV3Lm5hbWUgPT09IFwiZ3JpZFwiKSA/IDAgOiB2b2lkIDA7XG4gICAgaXRlbXMucHVzaCh7XG4gICAgICB0eXBlOiBcImN1c3RvbVwiLFxuICAgICAgY29tcG9uZW50OiAoe1xuICAgICAgICBib3VuZGFyeUVsZW1lbnQsXG4gICAgICAgIHNlbmRUZWxlbWV0cnlcbiAgICAgIH0pID0+IC8qIEBfX1BVUkVfXyAqLyBqc3goSW5zZXJ0TWVudVdyYXBwZXIsIHsgbGFiZWw6IFwiSW5zZXJ0IGJlZm9yZVwiLCBvblNlbGVjdDogKHNjaGVtYVR5cGUpID0+IHtcbiAgICAgICAgZ2V0QXJyYXlJbnNlcnRBY3Rpb24obm9kZSwgZG9jLCBzY2hlbWFUeXBlLm5hbWUsIFwiYmVmb3JlXCIpKCksIHNlbmRUZWxlbWV0cnkoXCJWaXN1YWwgRWRpdGluZyBDb250ZXh0IE1lbnUgSXRlbSBJbnNlcnRlZFwiLCBudWxsKTtcbiAgICAgIH0sIHBhcmVudCwgd2lkdGgsIGJvdW5kYXJ5RWxlbWVudCB9KVxuICAgIH0pLCBpdGVtcy5wdXNoKHtcbiAgICAgIHR5cGU6IFwiY3VzdG9tXCIsXG4gICAgICBjb21wb25lbnQ6ICh7XG4gICAgICAgIGJvdW5kYXJ5RWxlbWVudCxcbiAgICAgICAgc2VuZFRlbGVtZXRyeVxuICAgICAgfSkgPT4gLyogQF9fUFVSRV9fICovIGpzeChJbnNlcnRNZW51V3JhcHBlciwgeyBsYWJlbDogXCJJbnNlcnQgYWZ0ZXJcIiwgb25TZWxlY3Q6IChzY2hlbWFUeXBlKSA9PiB7XG4gICAgICAgIGdldEFycmF5SW5zZXJ0QWN0aW9uKG5vZGUsIGRvYywgc2NoZW1hVHlwZS5uYW1lLCBcImFmdGVyXCIpKCksIHNlbmRUZWxlbWV0cnkoXCJWaXN1YWwgRWRpdGluZyBDb250ZXh0IE1lbnUgSXRlbSBJbnNlcnRlZFwiLCBudWxsKTtcbiAgICAgIH0sIHBhcmVudCwgd2lkdGgsIGJvdW5kYXJ5RWxlbWVudCB9KVxuICAgIH0pO1xuICB9IGVsc2VcbiAgICBpdGVtcy5wdXNoKHtcbiAgICAgIHR5cGU6IFwiZ3JvdXBcIixcbiAgICAgIGxhYmVsOiBcIkluc2VydCBiZWZvcmVcIixcbiAgICAgIGljb246IEluc2VydEFib3ZlSWNvbixcbiAgICAgIGl0ZW1zOiBwYXJlbnQub2YuZmlsdGVyKChpdGVtKSA9PiBpdGVtLnR5cGUgPT09IFwidW5pb25PcHRpb25cIikubWFwKCh0KSA9PiAoe1xuICAgICAgICB0eXBlOiBcImFjdGlvblwiLFxuICAgICAgICBpY29uOiBnZXROb2RlSWNvbih0KSxcbiAgICAgICAgbGFiZWw6IHQubmFtZSA9PT0gXCJibG9ja1wiID8gXCJQYXJhZ3JhcGhcIiA6IHQudGl0bGUgfHwgdC5uYW1lLFxuICAgICAgICBhY3Rpb246IGdldEFycmF5SW5zZXJ0QWN0aW9uKG5vZGUsIGRvYywgdC5uYW1lLCBcImJlZm9yZVwiKSxcbiAgICAgICAgdGVsZW1ldHJ5RXZlbnQ6IFwiVmlzdWFsIEVkaXRpbmcgQ29udGV4dCBNZW51IEl0ZW0gSW5zZXJ0ZWRcIlxuICAgICAgfSkpXG4gICAgfSksIGl0ZW1zLnB1c2goe1xuICAgICAgdHlwZTogXCJncm91cFwiLFxuICAgICAgbGFiZWw6IFwiSW5zZXJ0IGFmdGVyXCIsXG4gICAgICBpY29uOiBJbnNlcnRCZWxvd0ljb24sXG4gICAgICBpdGVtczogcGFyZW50Lm9mLmZpbHRlcigoaXRlbSkgPT4gaXRlbS50eXBlID09PSBcInVuaW9uT3B0aW9uXCIpLm1hcCgodCkgPT4gKHtcbiAgICAgICAgdHlwZTogXCJhY3Rpb25cIixcbiAgICAgICAgbGFiZWw6IHQubmFtZSA9PT0gXCJibG9ja1wiID8gXCJQYXJhZ3JhcGhcIiA6IHQudGl0bGUgfHwgdC5uYW1lLFxuICAgICAgICBpY29uOiBnZXROb2RlSWNvbih0KSxcbiAgICAgICAgYWN0aW9uOiBnZXRBcnJheUluc2VydEFjdGlvbihub2RlLCBkb2MsIHQubmFtZSwgXCJhZnRlclwiKSxcbiAgICAgICAgdGVsZW1ldHJ5RXZlbnQ6IFwiVmlzdWFsIEVkaXRpbmcgQ29udGV4dCBNZW51IEl0ZW0gSW5zZXJ0ZWRcIlxuICAgICAgfSkpXG4gICAgfSk7XG4gIHJldHVybiBpdGVtcztcbn1cbmNvbnN0IFBPUE9WRVJfTUFSR0lOUyA9IFstNCwgNCwgLTQsIDRdO1xuZnVuY3Rpb24gQ29udGV4dE1lbnVJdGVtKHByb3BzKSB7XG4gIGNvbnN0ICQgPSBjKDI3KSwge1xuICAgIG5vZGUsXG4gICAgb25EaXNtaXNzLFxuICAgIGJvdW5kYXJ5RWxlbWVudFxuICB9ID0gcHJvcHMsIHNlbmRUZWxlbWV0cnkgPSB1c2VUZWxlbWV0cnkoKTtcbiAgbGV0IHQwO1xuICAkWzBdICE9PSBub2RlIHx8ICRbMV0gIT09IG9uRGlzbWlzcyB8fCAkWzJdICE9PSBzZW5kVGVsZW1ldHJ5ID8gKHQwID0gKCkgPT4ge1xuICAgIG5vZGUudHlwZSA9PT0gXCJhY3Rpb25cIiAmJiAobm9kZS5hY3Rpb24/LigpLCBvbkRpc21pc3M/LigpLCBub2RlLnRlbGVtZXRyeUV2ZW50ICYmIHNlbmRUZWxlbWV0cnkobm9kZS50ZWxlbWV0cnlFdmVudCwgbnVsbCkpO1xuICB9LCAkWzBdID0gbm9kZSwgJFsxXSA9IG9uRGlzbWlzcywgJFsyXSA9IHNlbmRUZWxlbWV0cnksICRbM10gPSB0MCkgOiB0MCA9ICRbM107XG4gIGNvbnN0IG9uQ2xpY2sgPSB0MDtcbiAgaWYgKG5vZGUudHlwZSA9PT0gXCJkaXZpZGVyXCIpIHtcbiAgICBsZXQgdDE7XG4gICAgcmV0dXJuICRbNF0gPT09IFN5bWJvbC5mb3IoXCJyZWFjdC5tZW1vX2NhY2hlX3NlbnRpbmVsXCIpID8gKHQxID0gLyogQF9fUFVSRV9fICovIGpzeChNZW51RGl2aWRlciwge30pLCAkWzRdID0gdDEpIDogdDEgPSAkWzRdLCB0MTtcbiAgfVxuICBpZiAobm9kZS50eXBlID09PSBcImFjdGlvblwiKSB7XG4gICAgY29uc3QgdDEgPSAhbm9kZS5hY3Rpb247XG4gICAgbGV0IHQyO1xuICAgIHJldHVybiAkWzVdICE9PSBub2RlLmhvdGtleXMgfHwgJFs2XSAhPT0gbm9kZS5pY29uIHx8ICRbN10gIT09IG5vZGUubGFiZWwgfHwgJFs4XSAhPT0gb25DbGljayB8fCAkWzldICE9PSB0MSA/ICh0MiA9IC8qIEBfX1BVUkVfXyAqLyBqc3goTWVudUl0ZW0sIHsgZm9udFNpemU6IDEsIGhvdGtleXM6IG5vZGUuaG90a2V5cywgaWNvbjogbm9kZS5pY29uLCBwYWRkaW5nOiAyLCBzcGFjZTogMiwgdGV4dDogbm9kZS5sYWJlbCwgZGlzYWJsZWQ6IHQxLCBvbkNsaWNrIH0pLCAkWzVdID0gbm9kZS5ob3RrZXlzLCAkWzZdID0gbm9kZS5pY29uLCAkWzddID0gbm9kZS5sYWJlbCwgJFs4XSA9IG9uQ2xpY2ssICRbOV0gPSB0MSwgJFsxMF0gPSB0MikgOiB0MiA9ICRbMTBdLCB0MjtcbiAgfVxuICBpZiAobm9kZS50eXBlID09PSBcImdyb3VwXCIpIHtcbiAgICBjb25zdCB0MSA9IG5vZGUuaWNvbjtcbiAgICBsZXQgdDI7XG4gICAgJFsxMV0gPT09IFN5bWJvbC5mb3IoXCJyZWFjdC5tZW1vX2NhY2hlX3NlbnRpbmVsXCIpID8gKHQyID0ge1xuICAgICAgYXJyb3c6ICExLFxuICAgICAgY29uc3RyYWluU2l6ZTogITAsXG4gICAgICBwbGFjZW1lbnQ6IFwicmlnaHQtc3RhcnRcIixcbiAgICAgIGZhbGxiYWNrUGxhY2VtZW50czogW1wibGVmdC1zdGFydFwiLCBcInJpZ2h0XCIsIFwibGVmdFwiLCBcInJpZ2h0LWVuZFwiLCBcImxlZnQtZW5kXCIsIFwiYm90dG9tXCIsIFwidG9wXCJdLFxuICAgICAgcHJldmVudE92ZXJmbG93OiAhMCxcbiAgICAgIF9fdW5zdGFibGVfbWFyZ2luczogUE9QT1ZFUl9NQVJHSU5TXG4gICAgfSwgJFsxMV0gPSB0MikgOiB0MiA9ICRbMTFdO1xuICAgIGNvbnN0IHQzID0gbm9kZS5sYWJlbDtcbiAgICBsZXQgdDQ7XG4gICAgaWYgKCRbMTJdICE9PSBib3VuZGFyeUVsZW1lbnQgfHwgJFsxM10gIT09IG5vZGUuaXRlbXMgfHwgJFsxNF0gIT09IG9uRGlzbWlzcykge1xuICAgICAgbGV0IHQ1MjtcbiAgICAgICRbMTZdICE9PSBib3VuZGFyeUVsZW1lbnQgfHwgJFsxN10gIT09IG9uRGlzbWlzcyA/ICh0NTIgPSAoaXRlbSwgaXRlbUluZGV4KSA9PiAvKiBAX19QVVJFX18gKi8ganN4KENvbnRleHRNZW51SXRlbSwgeyBub2RlOiBpdGVtLCBvbkRpc21pc3MsIGJvdW5kYXJ5RWxlbWVudCB9LCBpdGVtSW5kZXgpLCAkWzE2XSA9IGJvdW5kYXJ5RWxlbWVudCwgJFsxN10gPSBvbkRpc21pc3MsICRbMThdID0gdDUyKSA6IHQ1MiA9ICRbMThdLCB0NCA9IG5vZGUuaXRlbXMubWFwKHQ1MiksICRbMTJdID0gYm91bmRhcnlFbGVtZW50LCAkWzEzXSA9IG5vZGUuaXRlbXMsICRbMTRdID0gb25EaXNtaXNzLCAkWzE1XSA9IHQ0O1xuICAgIH0gZWxzZVxuICAgICAgdDQgPSAkWzE1XTtcbiAgICBsZXQgdDU7XG4gICAgcmV0dXJuICRbMTldICE9PSBub2RlLmljb24gfHwgJFsyMF0gIT09IG5vZGUubGFiZWwgfHwgJFsyMV0gIT09IHQ0ID8gKHQ1ID0gLyogQF9fUFVSRV9fICovIGpzeChNZW51R3JvdXAsIHsgZm9udFNpemU6IDEsIGljb246IHQxLCBwYWRkaW5nOiAyLCBwb3BvdmVyOiB0Miwgc3BhY2U6IDIsIHRleHQ6IHQzLCBjaGlsZHJlbjogdDQgfSksICRbMTldID0gbm9kZS5pY29uLCAkWzIwXSA9IG5vZGUubGFiZWwsICRbMjFdID0gdDQsICRbMjJdID0gdDUpIDogdDUgPSAkWzIyXSwgdDU7XG4gIH1cbiAgaWYgKG5vZGUudHlwZSA9PT0gXCJjdXN0b21cIikge1xuICAgIGNvbnN0IHtcbiAgICAgIGNvbXBvbmVudDogQ29tcG9uZW50XG4gICAgfSA9IG5vZGU7XG4gICAgbGV0IHQxO1xuICAgIHJldHVybiAkWzIzXSAhPT0gQ29tcG9uZW50IHx8ICRbMjRdICE9PSBib3VuZGFyeUVsZW1lbnQgfHwgJFsyNV0gIT09IHNlbmRUZWxlbWV0cnkgPyAodDEgPSAvKiBAX19QVVJFX18gKi8ganN4KENvbXBvbmVudCwgeyBib3VuZGFyeUVsZW1lbnQsIHNlbmRUZWxlbWV0cnkgfSksICRbMjNdID0gQ29tcG9uZW50LCAkWzI0XSA9IGJvdW5kYXJ5RWxlbWVudCwgJFsyNV0gPSBzZW5kVGVsZW1ldHJ5LCAkWzI2XSA9IHQxKSA6IHQxID0gJFsyNl0sIHQxO1xuICB9XG4gIHJldHVybiBudWxsO1xufVxuY29uc3QgQ29udGV4dE1lbnUgPSAocHJvcHMpID0+IHtcbiAgY29uc3QgJCA9IGMoNDMpLCB7XG4gICAgbm9kZSxcbiAgICBvbkRpc21pc3MsXG4gICAgcG9zaXRpb246IHQwXG4gIH0gPSBwcm9wcywge1xuICAgIHgsXG4gICAgeVxuICB9ID0gdDAsIFtib3VuZGFyeUVsZW1lbnQsIHNldEJvdW5kYXJ5RWxlbWVudF0gPSB1c2VTdGF0ZShudWxsKSwge1xuICAgIGdldEZpZWxkXG4gIH0gPSB1c2VTY2hlbWEoKSwge1xuICAgIGdldERvY3VtZW50XG4gIH0gPSB1c2VEb2N1bWVudHMoKTtcbiAgbGV0IHQxO1xuICAkWzBdICE9PSBnZXRGaWVsZCB8fCAkWzFdICE9PSBub2RlID8gKHQxID0gZ2V0RmllbGQobm9kZSksICRbMF0gPSBnZXRGaWVsZCwgJFsxXSA9IG5vZGUsICRbMl0gPSB0MSkgOiB0MSA9ICRbMl07XG4gIGNvbnN0IHtcbiAgICBmaWVsZCxcbiAgICBwYXJlbnRcbiAgfSA9IHQxO1xuICBsZXQgdDI7XG4gIHQyID0gZmllbGQ/LnRpdGxlIHx8IGZpZWxkPy5uYW1lIHx8IFwiVW5rbm93biB0eXBlXCI7XG4gIGNvbnN0IHRpdGxlID0gdDIsIFtpdGVtcywgc2V0SXRlbXNdID0gdXNlU3RhdGUodm9pZCAwKTtcbiAgbGV0IHQzLCB0NDtcbiAgJFszXSAhPT0gZmllbGQgfHwgJFs0XSAhPT0gZ2V0RG9jdW1lbnQgfHwgJFs1XSAhPT0gbm9kZSB8fCAkWzZdICE9PSBwYXJlbnQgPyAodDMgPSAoKSA9PiB7XG4gICAgKGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGRvYyA9IGdldERvY3VtZW50KG5vZGUuaWQpO1xuICAgICAgaWYgKCFkb2MpXG4gICAgICAgIHJldHVybjtcbiAgICAgIGNvbnN0IGl0ZW1zXzAgPSBhd2FpdCBnZXRDb250ZXh0TWVudUl0ZW1zKHtcbiAgICAgICAgbm9kZSxcbiAgICAgICAgZmllbGQsXG4gICAgICAgIHBhcmVudCxcbiAgICAgICAgZG9jXG4gICAgICB9KTtcbiAgICAgIHNldEl0ZW1zKGl0ZW1zXzApO1xuICAgIH0pKCk7XG4gIH0sIHQ0ID0gW2ZpZWxkLCBub2RlLCBwYXJlbnQsIGdldERvY3VtZW50XSwgJFszXSA9IGZpZWxkLCAkWzRdID0gZ2V0RG9jdW1lbnQsICRbNV0gPSBub2RlLCAkWzZdID0gcGFyZW50LCAkWzddID0gdDMsICRbOF0gPSB0NCkgOiAodDMgPSAkWzddLCB0NCA9ICRbOF0pLCB1c2VFZmZlY3QodDMsIHQ0KTtcbiAgbGV0IHQ1LCB0NjtcbiAgJFs5XSAhPT0geCB8fCAkWzEwXSAhPT0geSA/ICh0NiA9IHtcbiAgICBnZXRCb3VuZGluZ0NsaWVudFJlY3Q6ICgpID0+ICh7XG4gICAgICBib3R0b206IHksXG4gICAgICBsZWZ0OiB4LFxuICAgICAgcmlnaHQ6IHgsXG4gICAgICB0b3A6IHksXG4gICAgICB3aWR0aDogMCxcbiAgICAgIGhlaWdodDogMFxuICAgIH0pXG4gIH0sICRbOV0gPSB4LCAkWzEwXSA9IHksICRbMTFdID0gdDYpIDogdDYgPSAkWzExXSwgdDUgPSB0NjtcbiAgY29uc3QgY29udGV4dE1lbnVSZWZlcmVuY2VFbGVtZW50ID0gdDU7XG4gIGxldCB0NywgdDg7XG4gICRbMTJdICE9PSBmaWVsZCA/ICh0OCA9IGdldE5vZGVJY29uKGZpZWxkKSwgJFsxMl0gPSBmaWVsZCwgJFsxM10gPSB0OCkgOiB0OCA9ICRbMTNdLCB0NyA9IHQ4O1xuICBjb25zdCBpY29uID0gdDc7XG4gIGxldCB0OTtcbiAgJFsxNF0gPT09IFN5bWJvbC5mb3IoXCJyZWFjdC5tZW1vX2NhY2hlX3NlbnRpbmVsXCIpID8gKHQ5ID0ge1xuICAgIG1pbldpZHRoOiAxMjAsXG4gICAgbWF4V2lkdGg6IDE2MFxuICB9LCAkWzE0XSA9IHQ5KSA6IHQ5ID0gJFsxNF07XG4gIGxldCB0MTA7XG4gICRbMTVdICE9PSBpY29uIHx8ICRbMTZdICE9PSBpdGVtcyA/ICh0MTAgPSAvKiBAX19QVVJFX18gKi8ganN4KEJveCwgeyBmbGV4OiBcIm5vbmVcIiwgY2hpbGRyZW46IGl0ZW1zID8gLyogQF9fUFVSRV9fICovIGpzeChUZXh0LCB7IHNpemU6IDEsIGNoaWxkcmVuOiBpY29uIH0pIDogLyogQF9fUFVSRV9fICovIGpzeChTcGlubmVyLCB7IHNpemU6IDEgfSkgfSksICRbMTVdID0gaWNvbiwgJFsxNl0gPSBpdGVtcywgJFsxN10gPSB0MTApIDogdDEwID0gJFsxN107XG4gIGNvbnN0IHQxMSA9IGl0ZW1zID8gdGl0bGUgOiBcIkxvYWRpbmcuLi5cIjtcbiAgbGV0IHQxMjtcbiAgJFsxOF0gIT09IHQxMSA/ICh0MTIgPSAvKiBAX19QVVJFX18gKi8ganN4KFN0YWNrLCB7IGZsZXg6IDEsIHNwYWNlOiAyLCBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeChUZXh0LCB7IHNpemU6IDEsIHdlaWdodDogXCJzZW1pYm9sZFwiLCBjaGlsZHJlbjogdDExIH0pIH0pLCAkWzE4XSA9IHQxMSwgJFsxOV0gPSB0MTIpIDogdDEyID0gJFsxOV07XG4gIGxldCB0MTM7XG4gICRbMjBdICE9PSB0MTAgfHwgJFsyMV0gIT09IHQxMiA/ICh0MTMgPSAvKiBAX19QVVJFX18gKi8ganN4cyhGbGV4LCB7IGdhcDogMiwgcGFkZGluZzogMiwgY2hpbGRyZW46IFtcbiAgICB0MTAsXG4gICAgdDEyXG4gIF0gfSksICRbMjBdID0gdDEwLCAkWzIxXSA9IHQxMiwgJFsyMl0gPSB0MTMpIDogdDEzID0gJFsyMl07XG4gIGxldCB0MTQ7XG4gICRbMjNdICE9PSBib3VuZGFyeUVsZW1lbnQgfHwgJFsyNF0gIT09IGl0ZW1zIHx8ICRbMjVdICE9PSBvbkRpc21pc3MgPyAodDE0ID0gaXRlbXMgJiYgLyogQF9fUFVSRV9fICovIGpzeHMoRnJhZ21lbnQsIHsgY2hpbGRyZW46IFtcbiAgICAvKiBAX19QVVJFX18gKi8ganN4KE1lbnVEaXZpZGVyLCB7fSksXG4gICAgaXRlbXMubWFwKChpdGVtLCBpKSA9PiAvKiBAX19QVVJFX18gKi8ganN4KENvbnRleHRNZW51SXRlbSwgeyBub2RlOiBpdGVtLCBvbkRpc21pc3MsIGJvdW5kYXJ5RWxlbWVudCB9LCBpKSlcbiAgXSB9KSwgJFsyM10gPSBib3VuZGFyeUVsZW1lbnQsICRbMjRdID0gaXRlbXMsICRbMjVdID0gb25EaXNtaXNzLCAkWzI2XSA9IHQxNCkgOiB0MTQgPSAkWzI2XTtcbiAgbGV0IHQxNTtcbiAgJFsyN10gIT09IHQxMyB8fCAkWzI4XSAhPT0gdDE0ID8gKHQxNSA9IC8qIEBfX1BVUkVfXyAqLyBqc3hzKE1lbnUsIHsgc3R5bGU6IHQ5LCBjaGlsZHJlbjogW1xuICAgIHQxMyxcbiAgICB0MTRcbiAgXSB9KSwgJFsyN10gPSB0MTMsICRbMjhdID0gdDE0LCAkWzI5XSA9IHQxNSkgOiB0MTUgPSAkWzI5XTtcbiAgY29uc3QgdDE2ID0gYCR7eH0tJHt5fWA7XG4gIGxldCB0MTc7XG4gICRbMzBdICE9PSB4IHx8ICRbMzFdICE9PSB5ID8gKHQxNyA9IHtcbiAgICBwb3NpdGlvbjogXCJhYnNvbHV0ZVwiLFxuICAgIGxlZnQ6IHgsXG4gICAgdG9wOiB5XG4gIH0sICRbMzBdID0geCwgJFszMV0gPSB5LCAkWzMyXSA9IHQxNykgOiB0MTcgPSAkWzMyXTtcbiAgbGV0IHQxODtcbiAgJFszM10gIT09IHQxNiB8fCAkWzM0XSAhPT0gdDE3ID8gKHQxOCA9IC8qIEBfX1BVUkVfXyAqLyBqc3goXCJkaXZcIiwgeyBzdHlsZTogdDE3IH0sIHQxNiksICRbMzNdID0gdDE2LCAkWzM0XSA9IHQxNywgJFszNV0gPSB0MTgpIDogdDE4ID0gJFszNV07XG4gIGxldCB0MTk7XG4gICRbMzZdICE9PSBjb250ZXh0TWVudVJlZmVyZW5jZUVsZW1lbnQgfHwgJFszN10gIT09IHQxNSB8fCAkWzM4XSAhPT0gdDE4ID8gKHQxOSA9IC8qIEBfX1BVUkVfXyAqLyBqc3goUG9wb3ZlciwgeyBfX3Vuc3RhYmxlX21hcmdpbnM6IFBPUE9WRVJfTUFSR0lOUywgYXJyb3c6ICExLCBvcGVuOiAhMCwgcGxhY2VtZW50OiBcInJpZ2h0LXN0YXJ0XCIsIHJlZmVyZW5jZUVsZW1lbnQ6IGNvbnRleHRNZW51UmVmZXJlbmNlRWxlbWVudCwgY29udGVudDogdDE1LCBjaGlsZHJlbjogdDE4IH0pLCAkWzM2XSA9IGNvbnRleHRNZW51UmVmZXJlbmNlRWxlbWVudCwgJFszN10gPSB0MTUsICRbMzhdID0gdDE4LCAkWzM5XSA9IHQxOSkgOiB0MTkgPSAkWzM5XTtcbiAgbGV0IHQyMDtcbiAgcmV0dXJuICRbNDBdICE9PSBvbkRpc21pc3MgfHwgJFs0MV0gIT09IHQxOSA/ICh0MjAgPSAvKiBAX19QVVJFX18gKi8ganN4KFBvcG92ZXJQb3J0YWwsIHsgc2V0Qm91bmRhcnlFbGVtZW50LCBvbkRpc21pc3MsIGNoaWxkcmVuOiB0MTkgfSksICRbNDBdID0gb25EaXNtaXNzLCAkWzQxXSA9IHQxOSwgJFs0Ml0gPSB0MjApIDogdDIwID0gJFs0Ml0sIHQyMDtcbn07XG5mdW5jdGlvbiBnZXRMaW5rSHJlZihocmVmLCByZWZlcmVyKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgcGFyc2VkID0gbmV3IFVSTChocmVmLCB0eXBlb2YgbG9jYXRpb24gPiBcInVcIiA/IHZvaWQgMCA6IGxvY2F0aW9uLm9yaWdpbik7XG4gICAgaWYgKHBhcnNlZC5oYXNoKSB7XG4gICAgICBjb25zdCBoYXNoID0gbmV3IFVSTChnZXRMaW5rSHJlZihwYXJzZWQuaGFzaC5zbGljZSgxKSwgcmVmZXJlcikpO1xuICAgICAgcmV0dXJuIGAke3BhcnNlZC5vcmlnaW59JHtwYXJzZWQucGF0aG5hbWV9JHtwYXJzZWQuc2VhcmNofSMke2hhc2gucGF0aG5hbWV9JHtoYXNoLnNlYXJjaH1gO1xuICAgIH1cbiAgICByZXR1cm4gcGFyc2VkLnNlYXJjaFBhcmFtcy5zZXQoXCJwcmV2aWV3XCIsIHJlZmVyZXIpLCBwYXJzZWQudG9TdHJpbmcoKTtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIGhyZWY7XG4gIH1cbn1cbmNvbnN0IFByZXZpZXdTbmFwc2hvdHNDb250ZXh0ID0gY3JlYXRlQ29udGV4dChudWxsKTtcbmZ1bmN0aW9uIHVzZVByZXZpZXdTbmFwc2hvdHMoKSB7XG4gIGNvbnN0IGNvbnRleHQgPSB1c2VDb250ZXh0KFByZXZpZXdTbmFwc2hvdHNDb250ZXh0KTtcbiAgaWYgKCFjb250ZXh0KVxuICAgIHRocm93IG5ldyBFcnJvcihcIlByZXZpZXcgU25hcHNob3RzIGNvbnRleHQgaXMgbWlzc2luZ1wiKTtcbiAgcmV0dXJuIGNvbnRleHQ7XG59XG5jb25zdCBpc1JlYWN0RWxlbWVudE92ZXJsYXlDb21wb25lbnQgPSAoY29tcG9uZW50KSA9PiBpc1ZhbGlkRWxlbWVudChjb21wb25lbnQpLCBSb290JDMgPSBzdHlsZWQoQ2FyZClgXG4gIGJhY2tncm91bmQtY29sb3I6IHZhcigtLW92ZXJsYXktYmcpO1xuICBib3JkZXItcmFkaXVzOiAzcHg7XG4gIHBvaW50ZXItZXZlbnRzOiBub25lO1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHdpbGwtY2hhbmdlOiB0cmFuc2Zvcm07XG4gIGJveC1zaGFkb3c6IHZhcigtLW92ZXJsYXktYm94LXNoYWRvdyk7XG4gIHRyYW5zaXRpb246IG5vbmU7XG5cbiAgLS1vdmVybGF5LWJnOiB0cmFuc3BhcmVudDtcbiAgLS1vdmVybGF5LWJveC1zaGFkb3c6IGluc2V0IDAgMCAwIDFweCB0cmFuc3BhcmVudDtcblxuICBbZGF0YS1vdmVybGF5c10gJiB7XG4gICAgLS1vdmVybGF5LWJnOiBjb2xvci1taXgoaW4gc3JnYiwgdHJhbnNwYXJlbnQgOTUlLCB2YXIoLS1jYXJkLWZvY3VzLXJpbmctY29sb3IpKTtcbiAgICAtLW92ZXJsYXktYm94LXNoYWRvdzogaW5zZXQgMCAwIDAgMnB4XG4gICAgICBjb2xvci1taXgoaW4gc3JnYiwgdHJhbnNwYXJlbnQgNTAlLCB2YXIoLS1jYXJkLWZvY3VzLXJpbmctY29sb3IpKTtcbiAgfVxuXG4gIFtkYXRhLWZhZGluZy1vdXRdICYge1xuICAgIHRyYW5zaXRpb246XG4gICAgICBib3gtc2hhZG93IDE1NTBtcyxcbiAgICAgIGJhY2tncm91bmQtY29sb3IgMTU1MG1zO1xuXG4gICAgLS1vdmVybGF5LWJnOiByZ2JhKDAsIDAsIDI1NSwgMCk7XG4gICAgLS1vdmVybGF5LWJveC1zaGFkb3c6IGluc2V0IDAgMCAwIDFweCB0cmFuc3BhcmVudDtcbiAgfVxuXG4gICZbZGF0YS1mb2N1c2VkXSB7XG4gICAgLS1vdmVybGF5LWJveC1zaGFkb3c6IGluc2V0IDAgMCAwIDFweCB2YXIoLS1jYXJkLWZvY3VzLXJpbmctY29sb3IpO1xuICB9XG5cbiAgJltkYXRhLWhvdmVyZWRdOm5vdChbZGF0YS1mb2N1c2VkXSkge1xuICAgIHRyYW5zaXRpb246IG5vbmU7XG4gICAgLS1vdmVybGF5LWJveC1zaGFkb3c6IGluc2V0IDAgMCAwIDJweCB2YXIoLS1jYXJkLWZvY3VzLXJpbmctY29sb3IpO1xuICB9XG5cbiAgLyogW2RhdGEtdW5tb3VudGVkXSAmIHtcbiAgICAtLW92ZXJsYXktYm94LXNoYWRvdzogaW5zZXQgMCAwIDAgMXB4IHZhcigtLWNhcmQtZm9jdXMtcmluZy1jb2xvcik7XG4gIH0gKi9cblxuICA6bGluayB7XG4gICAgdGV4dC1kZWNvcmF0aW9uOiBub25lO1xuICB9XG5gLCBBY3Rpb25zID0gc3R5bGVkKEZsZXgpYFxuICBib3R0b206IDEwMCU7XG4gIGN1cnNvcjogcG9pbnRlcjtcbiAgcG9pbnRlci1ldmVudHM6IG5vbmU7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgcmlnaHQ6IDA7XG5cbiAgW2RhdGEtaG92ZXJlZF0gJiB7XG4gICAgcG9pbnRlci1ldmVudHM6IGFsbDtcbiAgfVxuXG4gIFtkYXRhLWZsaXBwZWRdICYge1xuICAgIGJvdHRvbTogYXV0bztcbiAgICB0b3A6IDEwMCU7XG4gIH1cbmAsIFRhYiA9IHN0eWxlZChGbGV4KWBcbiAgYm90dG9tOiAxMDAlO1xuICBjdXJzb3I6IHBvaW50ZXI7XG4gIHBvaW50ZXItZXZlbnRzOiBub25lO1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIGxlZnQ6IDA7XG5cbiAgW2RhdGEtaG92ZXJlZF0gJiB7XG4gICAgcG9pbnRlci1ldmVudHM6IGFsbDtcbiAgfVxuXG4gIFtkYXRhLWZsaXBwZWRdICYge1xuICAgIGJvdHRvbTogYXV0bztcbiAgICB0b3A6IDEwMCU7XG4gIH1cbmAsIEFjdGlvbk9wZW4gPSBzdHlsZWQoQ2FyZClgXG4gIGN1cnNvcjogcG9pbnRlcjtcbiAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tY2FyZC1mb2N1cy1yaW5nLWNvbG9yKTtcbiAgcmlnaHQ6IDA7XG4gIGJvcmRlci1yYWRpdXM6IDNweDtcblxuICAmIFtkYXRhLXVpPSdUZXh0J10ge1xuICAgIGNvbG9yOiAjZmZmO1xuICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7XG4gIH1cbmAsIExhYmVscyA9IHN0eWxlZChGbGV4KWBcbiAgZGlzcGxheTogZmxleDtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tY2FyZC1mb2N1cy1yaW5nLWNvbG9yKTtcbiAgcmlnaHQ6IDA7XG4gIGJvcmRlci1yYWRpdXM6IDNweDtcbiAgJiBbZGF0YS11aT0nVGV4dCddLFxuICAmIFtkYXRhLXNhbml0eS1pY29uXSB7XG4gICAgY29sb3I6ICNmZmY7XG4gICAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgfVxuYDtcbmZ1bmN0aW9uIGNyZWF0ZUludGVudExpbmsobm9kZSkge1xuICBjb25zdCB7XG4gICAgaWQsXG4gICAgdHlwZSxcbiAgICBwYXRoLFxuICAgIGJhc2VVcmwsXG4gICAgdG9vbCxcbiAgICB3b3Jrc3BhY2VcbiAgfSA9IG5vZGU7XG4gIHJldHVybiBjcmVhdGVFZGl0VXJsKHtcbiAgICBiYXNlVXJsLFxuICAgIHdvcmtzcGFjZSxcbiAgICB0b29sLFxuICAgIHR5cGUsXG4gICAgaWQsXG4gICAgcGF0aDogcGF0aFRvVXJsU3RyaW5nKHN0dWRpb1BhdGguZnJvbVN0cmluZyhwYXRoKSlcbiAgfSk7XG59XG5jb25zdCBFbGVtZW50T3ZlcmxheUlubmVyID0gKHByb3BzKSA9PiB7XG4gIGNvbnN0ICQgPSBjKDM1KSwge1xuICAgIGVsZW1lbnQsXG4gICAgZm9jdXNlZCxcbiAgICBjb21wb25lbnRSZXNvbHZlcixcbiAgICBub2RlLFxuICAgIHNob3dBY3Rpb25zLFxuICAgIGRyYWdnYWJsZVxuICB9ID0gcHJvcHMsIHtcbiAgICBnZXRGaWVsZCxcbiAgICBnZXRUeXBlXG4gIH0gPSB1c2VTY2hlbWEoKTtcbiAgbGV0IHQwO1xuICAkWzBdICE9PSBnZXRUeXBlIHx8ICRbMV0gIT09IG5vZGUgPyAodDAgPSBnZXRUeXBlKG5vZGUpLCAkWzBdID0gZ2V0VHlwZSwgJFsxXSA9IG5vZGUsICRbMl0gPSB0MCkgOiB0MCA9ICRbMl07XG4gIGNvbnN0IHNjaGVtYVR5cGUgPSB0MDtcbiAgbGV0IHQxO1xuICAkWzNdICE9PSBnZXRGaWVsZCB8fCAkWzRdICE9PSBub2RlID8gKHQxID0gZ2V0RmllbGQobm9kZSksICRbM10gPSBnZXRGaWVsZCwgJFs0XSA9IG5vZGUsICRbNV0gPSB0MSkgOiB0MSA9ICRbNV07XG4gIGNvbnN0IHtcbiAgICBmaWVsZCxcbiAgICBwYXJlbnRcbiAgfSA9IHQxO1xuICBsZXQgdDI7XG4gICRbNl0gIT09IG5vZGUgPyAodDIgPSBcInBhdGhcIiBpbiBub2RlID8gY3JlYXRlSW50ZW50TGluayhub2RlKSA6IG5vZGUuaHJlZiwgJFs2XSA9IG5vZGUsICRbN10gPSB0MikgOiB0MiA9ICRbN107XG4gIGNvbnN0IGhyZWYgPSB0MiwgcHJldmlld1NuYXBzaG90cyA9IHVzZVByZXZpZXdTbmFwc2hvdHMoKTtcbiAgbGV0IHQzO1xuICBiYjA6IHtcbiAgICBpZiAoIShcInBhdGhcIiBpbiBub2RlKSkge1xuICAgICAgdDMgPSB2b2lkIDA7XG4gICAgICBicmVhayBiYjA7XG4gICAgfVxuICAgIGxldCB0NDI7XG4gICAgJFs4XSAhPT0gbm9kZSB8fCAkWzldICE9PSBwcmV2aWV3U25hcHNob3RzID8gKHQ0MiA9IHByZXZpZXdTbmFwc2hvdHMuZmluZCgoc25hcHNob3QpID0+IHNuYXBzaG90Ll9pZCA9PT0gbm9kZS5pZCk/LnRpdGxlLCAkWzhdID0gbm9kZSwgJFs5XSA9IHByZXZpZXdTbmFwc2hvdHMsICRbMTBdID0gdDQyKSA6IHQ0MiA9ICRbMTBdLCB0MyA9IHQ0MjtcbiAgfVxuICBjb25zdCB0aXRsZSA9IHQzO1xuICBsZXQgdDQ7XG4gIGJiMToge1xuICAgIGlmICghKFwicGF0aFwiIGluIG5vZGUpKSB7XG4gICAgICB0NCA9IHZvaWQgMDtcbiAgICAgIGJyZWFrIGJiMTtcbiAgICB9XG4gICAgaWYgKCFmaWVsZCB8fCAhc2NoZW1hVHlwZSkge1xuICAgICAgdDQgPSB2b2lkIDA7XG4gICAgICBicmVhayBiYjE7XG4gICAgfVxuICAgIGNvbnN0IHR5cGUgPSBmaWVsZC52YWx1ZS50eXBlLCB0NTIgPSAhIWZvY3VzZWQ7XG4gICAgbGV0IHQ2MjtcbiAgICAkWzExXSAhPT0gZWxlbWVudCB8fCAkWzEyXSAhPT0gZmllbGQgfHwgJFsxM10gIT09IG5vZGUgfHwgJFsxNF0gIT09IHBhcmVudCB8fCAkWzE1XSAhPT0gc2NoZW1hVHlwZSB8fCAkWzE2XSAhPT0gdDUyIHx8ICRbMTddICE9PSB0eXBlID8gKHQ2MiA9IHtcbiAgICAgIGRvY3VtZW50OiBzY2hlbWFUeXBlLFxuICAgICAgZWxlbWVudCxcbiAgICAgIGZpZWxkLFxuICAgICAgZm9jdXNlZDogdDUyLFxuICAgICAgbm9kZSxcbiAgICAgIHBhcmVudCxcbiAgICAgIHR5cGVcbiAgICB9LCAkWzExXSA9IGVsZW1lbnQsICRbMTJdID0gZmllbGQsICRbMTNdID0gbm9kZSwgJFsxNF0gPSBwYXJlbnQsICRbMTVdID0gc2NoZW1hVHlwZSwgJFsxNl0gPSB0NTIsICRbMTddID0gdHlwZSwgJFsxOF0gPSB0NjIpIDogdDYyID0gJFsxOF0sIHQ0ID0gdDYyO1xuICB9XG4gIGNvbnN0IGNvbXBvbmVudENvbnRleHQgPSB0NCwgY3VzdG9tQ29tcG9uZW50cyA9IHVzZUN1c3RvbUNvbXBvbmVudHMoY29tcG9uZW50Q29udGV4dCwgY29tcG9uZW50UmVzb2x2ZXIpO1xuICBsZXQgdDU7XG4gICRbMTldICE9PSBzY2hlbWFUeXBlID8gKHQ1ID0gc2NoZW1hVHlwZT8uaWNvbiA/IC8qIEBfX1BVUkVfXyAqLyBqc3goXCJkaXZcIiwgeyBkYW5nZXJvdXNseVNldElubmVySFRNTDoge1xuICAgIF9faHRtbDogc2NoZW1hVHlwZS5pY29uXG4gIH0gfSkgOiAvKiBAX19QVVJFX18gKi8ganN4KERvY3VtZW50SWNvbiwge30pLCAkWzE5XSA9IHNjaGVtYVR5cGUsICRbMjBdID0gdDUpIDogdDUgPSAkWzIwXTtcbiAgY29uc3QgaWNvbiA9IHQ1O1xuICBsZXQgdDY7XG4gICRbMjFdICE9PSBocmVmIHx8ICRbMjJdICE9PSBzaG93QWN0aW9ucyA/ICh0NiA9IHNob3dBY3Rpb25zID8gLyogQF9fUFVSRV9fICovIGpzeChBY3Rpb25zLCB7IGdhcDogMSwgcGFkZGluZ1k6IDEsIFwiZGF0YS1zYW5pdHktb3ZlcmxheS1lbGVtZW50XCI6ICEwLCBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeChMaW5rLCB7IGhyZWYgfSkgfSkgOiBudWxsLCAkWzIxXSA9IGhyZWYsICRbMjJdID0gc2hvd0FjdGlvbnMsICRbMjNdID0gdDYpIDogdDYgPSAkWzIzXTtcbiAgbGV0IHQ3O1xuICAkWzI0XSAhPT0gZHJhZ2dhYmxlIHx8ICRbMjVdICE9PSBpY29uIHx8ICRbMjZdICE9PSB0aXRsZSA/ICh0NyA9IHRpdGxlICYmIC8qIEBfX1BVUkVfXyAqLyBqc3goVGFiLCB7IGdhcDogMSwgcGFkZGluZ1k6IDEsIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4cyhMYWJlbHMsIHsgZ2FwOiAyLCBwYWRkaW5nOiAyLCBjaGlsZHJlbjogW1xuICAgIGRyYWdnYWJsZSAmJiAvKiBAX19QVVJFX18gKi8ganN4KEJveCwgeyBtYXJnaW5SaWdodDogMSwgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3goVGV4dCwgeyBjbGFzc05hbWU6IFwiZHJhZy1oYW5kbGVcIiwgc2l6ZTogMCwgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3goRHJhZ0hhbmRsZUljb24sIHt9KSB9KSB9KSxcbiAgICAvKiBAX19QVVJFX18gKi8ganN4KFRleHQsIHsgc2l6ZTogMCwgY2hpbGRyZW46IGljb24gfSksXG4gICAgLyogQF9fUFVSRV9fICovIGpzeChUZXh0LCB7IHNpemU6IDEsIHdlaWdodDogXCJtZWRpdW1cIiwgY2hpbGRyZW46IHRpdGxlIH0pXG4gIF0gfSkgfSksICRbMjRdID0gZHJhZ2dhYmxlLCAkWzI1XSA9IGljb24sICRbMjZdID0gdGl0bGUsICRbMjddID0gdDcpIDogdDcgPSAkWzI3XTtcbiAgbGV0IHQ4O1xuICAkWzI4XSAhPT0gY29tcG9uZW50Q29udGV4dCB8fCAkWzI5XSAhPT0gY3VzdG9tQ29tcG9uZW50cyA/ICh0OCA9IEFycmF5LmlzQXJyYXkoY3VzdG9tQ29tcG9uZW50cykgPyBjdXN0b21Db21wb25lbnRzLm1hcCgodDkyLCBpKSA9PiB7XG4gICAgY29uc3Qge1xuICAgICAgY29tcG9uZW50OiBDb21wb25lbnQsXG4gICAgICBwcm9wczogcHJvcHNfMFxuICAgIH0gPSB0OTI7XG4gICAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3goQ29tcG9uZW50LCB7IFBvaW50ZXJFdmVudHMsIC4uLmNvbXBvbmVudENvbnRleHQsIC4uLnByb3BzXzAgfSwgaSk7XG4gIH0pIDogY3VzdG9tQ29tcG9uZW50cywgJFsyOF0gPSBjb21wb25lbnRDb250ZXh0LCAkWzI5XSA9IGN1c3RvbUNvbXBvbmVudHMsICRbMzBdID0gdDgpIDogdDggPSAkWzMwXTtcbiAgbGV0IHQ5O1xuICByZXR1cm4gJFszMV0gIT09IHQ2IHx8ICRbMzJdICE9PSB0NyB8fCAkWzMzXSAhPT0gdDggPyAodDkgPSAvKiBAX19QVVJFX18gKi8ganN4cyhGcmFnbWVudCwgeyBjaGlsZHJlbjogW1xuICAgIHQ2LFxuICAgIHQ3LFxuICAgIHQ4XG4gIF0gfSksICRbMzFdID0gdDYsICRbMzJdID0gdDcsICRbMzNdID0gdDgsICRbMzRdID0gdDkpIDogdDkgPSAkWzM0XSwgdDk7XG59LCBFbGVtZW50T3ZlcmxheSA9IG1lbW8oZnVuY3Rpb24ocHJvcHMpIHtcbiAgY29uc3QgJCA9IGMoMjQpLCB7XG4gICAgZHJhZ2dhYmxlLFxuICAgIGZvY3VzZWQsXG4gICAgaG92ZXJlZCxcbiAgICByZWN0LFxuICAgIHdhc01heWJlQ29sbGFwc2VkLFxuICAgIGVuYWJsZVNjcm9sbEludG9WaWV3XG4gIH0gPSBwcm9wcywgcmVmID0gdXNlUmVmKG51bGwpLCBzY3JvbGxlZEludG9WaWV3UmVmID0gdXNlUmVmKCExKTtcbiAgbGV0IHQwO1xuICBjb25zdCB0MSA9IGAke3JlY3Qud31weGAsIHQyID0gYCR7cmVjdC5ofXB4YCwgdDMgPSBgdHJhbnNsYXRlKCR7cmVjdC54fXB4LCAke3JlY3QueX1weClgO1xuICBsZXQgdDQ7XG4gICRbMF0gIT09IHQxIHx8ICRbMV0gIT09IHQyIHx8ICRbMl0gIT09IHQzID8gKHQ0ID0ge1xuICAgIHdpZHRoOiB0MSxcbiAgICBoZWlnaHQ6IHQyLFxuICAgIHRyYW5zZm9ybTogdDNcbiAgfSwgJFswXSA9IHQxLCAkWzFdID0gdDIsICRbMl0gPSB0MywgJFszXSA9IHQ0KSA6IHQ0ID0gJFszXSwgdDAgPSB0NDtcbiAgY29uc3Qgc3R5bGUgPSB0MDtcbiAgbGV0IHQ1LCB0NjtcbiAgJFs0XSAhPT0gZW5hYmxlU2Nyb2xsSW50b1ZpZXcgfHwgJFs1XSAhPT0gZm9jdXNlZCB8fCAkWzZdICE9PSB3YXNNYXliZUNvbGxhcHNlZCA/ICh0NSA9ICgpID0+IHtcbiAgICBpZiAoIXNjcm9sbGVkSW50b1ZpZXdSZWYuY3VycmVudCAmJiAhd2FzTWF5YmVDb2xsYXBzZWQgJiYgZm9jdXNlZCA9PT0gITAgJiYgcmVmLmN1cnJlbnQgJiYgZW5hYmxlU2Nyb2xsSW50b1ZpZXcpIHtcbiAgICAgIGNvbnN0IHRhcmdldCA9IHJlZi5jdXJyZW50O1xuICAgICAgc2Nyb2xsSW50b1ZpZXcocmVmLmN1cnJlbnQsIHtcbiAgICAgICAgYmVoYXZpb3I6IChhY3Rpb25zKSA9PiB7XG4gICAgICAgICAgYWN0aW9ucy5sZW5ndGggIT09IDAgJiYgdGFyZ2V0LnNjcm9sbEludG9WaWV3KHtcbiAgICAgICAgICAgIGJlaGF2aW9yOiBcInNtb290aFwiLFxuICAgICAgICAgICAgYmxvY2s6IFwiY2VudGVyXCIsXG4gICAgICAgICAgICBpbmxpbmU6IFwibmVhcmVzdFwiXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIHNjcm9sbE1vZGU6IFwiaWYtbmVlZGVkXCIsXG4gICAgICAgIGJsb2NrOiBcImNlbnRlclwiLFxuICAgICAgICBpbmxpbmU6IFwibmVhcmVzdFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgc2Nyb2xsZWRJbnRvVmlld1JlZi5jdXJyZW50ID0gZm9jdXNlZCA9PT0gITA7XG4gIH0sIHQ2ID0gW2ZvY3VzZWQsIHdhc01heWJlQ29sbGFwc2VkLCBlbmFibGVTY3JvbGxJbnRvVmlld10sICRbNF0gPSBlbmFibGVTY3JvbGxJbnRvVmlldywgJFs1XSA9IGZvY3VzZWQsICRbNl0gPSB3YXNNYXliZUNvbGxhcHNlZCwgJFs3XSA9IHQ1LCAkWzhdID0gdDYpIDogKHQ1ID0gJFs3XSwgdDYgPSAkWzhdKSwgdXNlRWZmZWN0KHQ1LCB0Nik7XG4gIGNvbnN0IFtpc05lYXJUb3AsIHNldElzTmVhclRvcF0gPSB1c2VTdGF0ZSghMSk7XG4gIGxldCB0NztcbiAgJFs5XSAhPT0gaG92ZXJlZCA/ICh0NyA9ICgpID0+IHtcbiAgICBpZiAoIXJlZi5jdXJyZW50IHx8ICFob3ZlcmVkKVxuICAgICAgcmV0dXJuO1xuICAgIGNvbnN0IGlvID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKCh0ODIpID0+IHtcbiAgICAgIGNvbnN0IFtpbnRlcnNlY3Rpb25dID0gdDgyO1xuICAgICAgc2V0SXNOZWFyVG9wKGludGVyc2VjdGlvbi5ib3VuZGluZ0NsaWVudFJlY3QudG9wIDwgMCk7XG4gICAgfSwge1xuICAgICAgdGhyZXNob2xkOiAxXG4gICAgfSk7XG4gICAgcmV0dXJuIGlvLm9ic2VydmUocmVmLmN1cnJlbnQpLCAoKSA9PiBpby5kaXNjb25uZWN0KCk7XG4gIH0sICRbOV0gPSBob3ZlcmVkLCAkWzEwXSA9IHQ3KSA6IHQ3ID0gJFsxMF07XG4gIGxldCB0ODtcbiAgJFsxMV0gIT09IGhvdmVyZWQgfHwgJFsxMl0gIT09IGlzTmVhclRvcCA/ICh0OCA9IFtob3ZlcmVkLCBpc05lYXJUb3BdLCAkWzExXSA9IGhvdmVyZWQsICRbMTJdID0gaXNOZWFyVG9wLCAkWzEzXSA9IHQ4KSA6IHQ4ID0gJFsxM10sIHVzZUVmZmVjdCh0NywgdDgpO1xuICBjb25zdCB0OSA9IGZvY3VzZWQgPyBcIlwiIDogdm9pZCAwLCB0MTAgPSBob3ZlcmVkID8gXCJcIiA6IHZvaWQgMCwgdDExID0gaXNOZWFyVG9wID8gXCJcIiA6IHZvaWQgMCwgdDEyID0gZHJhZ2dhYmxlID8gXCJcIiA6IHZvaWQgMDtcbiAgbGV0IHQxMztcbiAgJFsxNF0gIT09IGhvdmVyZWQgfHwgJFsxNV0gIT09IHByb3BzID8gKHQxMyA9IGhvdmVyZWQgJiYgLyogQF9fUFVSRV9fICovIGpzeChFbGVtZW50T3ZlcmxheUlubmVyLCB7IC4uLnByb3BzIH0pLCAkWzE0XSA9IGhvdmVyZWQsICRbMTVdID0gcHJvcHMsICRbMTZdID0gdDEzKSA6IHQxMyA9ICRbMTZdO1xuICBsZXQgdDE0O1xuICByZXR1cm4gJFsxN10gIT09IHN0eWxlIHx8ICRbMThdICE9PSB0MTAgfHwgJFsxOV0gIT09IHQxMSB8fCAkWzIwXSAhPT0gdDEyIHx8ICRbMjFdICE9PSB0MTMgfHwgJFsyMl0gIT09IHQ5ID8gKHQxNCA9IC8qIEBfX1BVUkVfXyAqLyBqc3goUm9vdCQzLCB7IFwiZGF0YS1mb2N1c2VkXCI6IHQ5LCBcImRhdGEtaG92ZXJlZFwiOiB0MTAsIFwiZGF0YS1mbGlwcGVkXCI6IHQxMSwgXCJkYXRhLWRyYWdnYWJsZVwiOiB0MTIsIHJlZiwgc3R5bGUsIGNoaWxkcmVuOiB0MTMgfSksICRbMTddID0gc3R5bGUsICRbMThdID0gdDEwLCAkWzE5XSA9IHQxMSwgJFsyMF0gPSB0MTIsICRbMjFdID0gdDEzLCAkWzIyXSA9IHQ5LCAkWzIzXSA9IHQxNCkgOiB0MTQgPSAkWzIzXSwgdDE0O1xufSk7XG5mdW5jdGlvbiB1c2VDdXN0b21Db21wb25lbnRzKGNvbXBvbmVudENvbnRleHQsIGNvbXBvbmVudFJlc29sdmVyKSB7XG4gIGNvbnN0ICQgPSBjKDQpO1xuICBsZXQgdDA7XG4gIGJiMDoge1xuICAgIGlmICghY29tcG9uZW50Q29udGV4dCkge1xuICAgICAgdDAgPSB2b2lkIDA7XG4gICAgICBicmVhayBiYjA7XG4gICAgfVxuICAgIGxldCB0MTtcbiAgICBpZiAoJFswXSAhPT0gY29tcG9uZW50Q29udGV4dCB8fCAkWzFdICE9PSBjb21wb25lbnRSZXNvbHZlcikge1xuICAgICAgY29uc3QgcmVzb2x2ZWQgPSBjb21wb25lbnRSZXNvbHZlcj8uKGNvbXBvbmVudENvbnRleHQpO1xuICAgICAgaWYgKCFyZXNvbHZlZCkge1xuICAgICAgICB0MCA9IHZvaWQgMDtcbiAgICAgICAgYnJlYWsgYmIwO1xuICAgICAgfVxuICAgICAgaWYgKGlzUmVhY3RFbGVtZW50T3ZlcmxheUNvbXBvbmVudChyZXNvbHZlZCkpIHtcbiAgICAgICAgdDAgPSByZXNvbHZlZDtcbiAgICAgICAgYnJlYWsgYmIwO1xuICAgICAgfVxuICAgICAgdDEgPSAoQXJyYXkuaXNBcnJheShyZXNvbHZlZCkgPyByZXNvbHZlZCA6IFtyZXNvbHZlZF0pLm1hcChfdGVtcCQ4KSwgJFswXSA9IGNvbXBvbmVudENvbnRleHQsICRbMV0gPSBjb21wb25lbnRSZXNvbHZlciwgJFsyXSA9IHQxLCAkWzNdID0gdDA7XG4gICAgfSBlbHNlXG4gICAgICB0MSA9ICRbMl0sIHQwID0gJFszXTtcbiAgICB0MCA9IHQxO1xuICB9XG4gIHJldHVybiB0MDtcbn1cbmZ1bmN0aW9uIF90ZW1wJDgoY29tcG9uZW50KSB7XG4gIHJldHVybiB0eXBlb2YgY29tcG9uZW50ID09IFwib2JqZWN0XCIgJiYgXCJjb21wb25lbnRcIiBpbiBjb21wb25lbnQgPyBjb21wb25lbnQgOiB7XG4gICAgY29tcG9uZW50LFxuICAgIHByb3BzOiB7fVxuICB9O1xufVxuY29uc3QgTGluayA9IG1lbW8oZnVuY3Rpb24ocHJvcHMpIHtcbiAgY29uc3QgJCA9IGMoNiksIHJlZmVyZXIgPSB1c2VTeW5jRXh0ZXJuYWxTdG9yZShfdGVtcDIkNSwgX3RlbXAzJDIpO1xuICBsZXQgdDAsIHQxO1xuICAkWzBdICE9PSBwcm9wcy5ocmVmIHx8ICRbMV0gIT09IHJlZmVyZXIgPyAodDEgPSBnZXRMaW5rSHJlZihwcm9wcy5ocmVmLCByZWZlcmVyKSwgJFswXSA9IHByb3BzLmhyZWYsICRbMV0gPSByZWZlcmVyLCAkWzJdID0gdDEpIDogdDEgPSAkWzJdLCB0MCA9IHQxO1xuICBjb25zdCBocmVmID0gdDA7XG4gIGxldCB0MjtcbiAgJFszXSA9PT0gU3ltYm9sLmZvcihcInJlYWN0Lm1lbW9fY2FjaGVfc2VudGluZWxcIikgPyAodDIgPSAvKiBAX19QVVJFX18gKi8ganN4KEFjdGlvbk9wZW4sIHsgcGFkZGluZzogMiwgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3goVGV4dCwgeyBzaXplOiAxLCB3ZWlnaHQ6IFwibWVkaXVtXCIsIGNoaWxkcmVuOiBcIk9wZW4gaW4gU3R1ZGlvXCIgfSkgfSksICRbM10gPSB0MikgOiB0MiA9ICRbM107XG4gIGxldCB0MztcbiAgcmV0dXJuICRbNF0gIT09IGhyZWYgPyAodDMgPSAvKiBAX19QVVJFX18gKi8ganN4KEJveCwgeyBhczogXCJhXCIsIGhyZWYsIHRhcmdldDogXCJfYmxhbmtcIiwgcmVsOiBcIm5vb3BlbmVyIG5vcmVmZXJyZXJcIiwgY2hpbGRyZW46IHQyIH0pLCAkWzRdID0gaHJlZiwgJFs1XSA9IHQzKSA6IHQzID0gJFs1XSwgdDM7XG59KTtcbmZ1bmN0aW9uIF90ZW1wMiQ1KG9uU3RvcmVDaGFuZ2UpIHtcbiAgY29uc3QgaGFuZGxlUG9wU3RhdGUgPSAoKSA9PiBvblN0b3JlQ2hhbmdlKCk7XG4gIHJldHVybiB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInBvcHN0YXRlXCIsIGhhbmRsZVBvcFN0YXRlKSwgKCkgPT4gd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwb3BzdGF0ZVwiLCBoYW5kbGVQb3BTdGF0ZSk7XG59XG5mdW5jdGlvbiBfdGVtcDMkMigpIHtcbiAgcmV0dXJuIHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xufVxuY29uc3QgT3ZlcmxheURyYWdHcm91cFJlY3QgPSAodDApID0+IHtcbiAgY29uc3QgJCA9IGMoNSksIHtcbiAgICBkcmFnR3JvdXBSZWN0XG4gIH0gPSB0MCwgdDEgPSBgJHtkcmFnR3JvdXBSZWN0Lnl9cHhgLCB0MiA9IGAke2RyYWdHcm91cFJlY3QueH1weGAsIHQzID0gYCR7ZHJhZ0dyb3VwUmVjdC53IC0gMX1weGAsIHQ0ID0gYCR7ZHJhZ0dyb3VwUmVjdC5oIC0gMX1weGA7XG4gIGxldCB0NTtcbiAgcmV0dXJuICRbMF0gIT09IHQxIHx8ICRbMV0gIT09IHQyIHx8ICRbMl0gIT09IHQzIHx8ICRbM10gIT09IHQ0ID8gKHQ1ID0gLyogQF9fUFVSRV9fICovIGpzeChcImRpdlwiLCB7IHN0eWxlOiB7XG4gICAgcG9zaXRpb246IFwiYWJzb2x1dGVcIixcbiAgICB0b3A6IHQxLFxuICAgIGxlZnQ6IHQyLFxuICAgIHdpZHRoOiB0MyxcbiAgICBoZWlnaHQ6IHQ0LFxuICAgIGJvcmRlcjogXCIxcHggZGFzaGVkICNmMDcwOWJcIixcbiAgICBwb2ludGVyRXZlbnRzOiBcIm5vbmVcIlxuICB9IH0pLCAkWzBdID0gdDEsICRbMV0gPSB0MiwgJFsyXSA9IHQzLCAkWzNdID0gdDQsICRbNF0gPSB0NSkgOiB0NSA9ICRbNF0sIHQ1O1xufSwgbWFya2VyVGhpY2tuZXNzID0gNjtcbmZ1bmN0aW9uIGxlcnAodjAsIHYxLCB0KSB7XG4gIHJldHVybiB2MCAqICgxIC0gdCkgKyB2MSAqIHQ7XG59XG5jb25zdCBPdmVybGF5RHJhZ0luc2VydE1hcmtlciA9ICh0MCkgPT4ge1xuICBjb25zdCAkID0gYyg0KSwge1xuICAgIGRyYWdJbnNlcnRQb3NpdGlvblxuICB9ID0gdDA7XG4gIGlmIChkcmFnSW5zZXJ0UG9zaXRpb24gPT09IG51bGwpXG4gICAgcmV0dXJuO1xuICBjb25zdCBmbG93ID0gZHJhZ0luc2VydFBvc2l0aW9uPy5sZWZ0IHx8IGRyYWdJbnNlcnRQb3NpdGlvbj8ucmlnaHQgPyBcImhvcml6b250YWxcIiA6IFwidmVydGljYWxcIjtcbiAgbGV0IHggPSAwLCB5ID0gMCwgd2lkdGggPSAwLCBoZWlnaHQgPSAwO1xuICBpZiAoZmxvdyA9PT0gXCJob3Jpem9udGFsXCIpIHtcbiAgICBjb25zdCB7XG4gICAgICBsZWZ0LFxuICAgICAgcmlnaHRcbiAgICB9ID0gZHJhZ0luc2VydFBvc2l0aW9uO1xuICAgIGlmICh3aWR0aCA9IG1hcmtlclRoaWNrbmVzcywgcmlnaHQgJiYgbGVmdCkge1xuICAgICAgY29uc3Qgc3RhcnRYID0gbGVmdC5yZWN0LnggKyBsZWZ0LnJlY3QudywgZW5kWCA9IHJpZ2h0LnJlY3QueCwgb2Zmc2V0ID0gTWF0aC5taW4ocmlnaHQucmVjdC5oLCBsZWZ0LnJlY3QuaCkgKiAwLjAxMjU7XG4gICAgICB4ID0gbGVycChzdGFydFgsIGVuZFgsIDAuNSkgLSBtYXJrZXJUaGlja25lc3MgLyAyLCB5ID0gbGVmdC5yZWN0LnkgKyBvZmZzZXQsIGhlaWdodCA9IE1hdGgubWluKHJpZ2h0LnJlY3QuaCwgbGVmdC5yZWN0LmgpIC0gb2Zmc2V0ICogMjtcbiAgICB9IGVsc2UgaWYgKHJpZ2h0ICYmICFsZWZ0KSB7XG4gICAgICBjb25zdCBvZmZzZXRfMCA9IHJpZ2h0LnJlY3QuaCAqIDAuMDEyNTtcbiAgICAgIHggPSByaWdodC5yZWN0LnggLSBtYXJrZXJUaGlja25lc3MgLyAyLCB5ID0gcmlnaHQucmVjdC55ICsgb2Zmc2V0XzAsIGhlaWdodCA9IHJpZ2h0LnJlY3QuaCAtIG9mZnNldF8wICogMjtcbiAgICB9IGVsc2UgaWYgKGxlZnQgJiYgIXJpZ2h0KSB7XG4gICAgICBjb25zdCBvZmZzZXRfMSA9IGxlZnQucmVjdC5oICogMC4wMTI1O1xuICAgICAgeCA9IGxlZnQucmVjdC54ICsgbGVmdC5yZWN0LncgLSBtYXJrZXJUaGlja25lc3MgLyAyLCB5ID0gbGVmdC5yZWN0LnkgKyBvZmZzZXRfMSwgaGVpZ2h0ID0gbGVmdC5yZWN0LmggLSBvZmZzZXRfMSAqIDI7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGNvbnN0IHtcbiAgICAgIGJvdHRvbSxcbiAgICAgIHRvcFxuICAgIH0gPSBkcmFnSW5zZXJ0UG9zaXRpb247XG4gICAgaWYgKGJvdHRvbSAmJiB0b3ApIHtcbiAgICAgIGNvbnN0IHN0YXJ0WF8wID0gTWF0aC5taW4odG9wLnJlY3QueCwgYm90dG9tLnJlY3QueCksIHN0YXJ0WSA9IHRvcC5yZWN0LnkgKyB0b3AucmVjdC5oLCBlbmRZID0gYm90dG9tLnJlY3QueSwgb2Zmc2V0XzIgPSBNYXRoLm1pbihib3R0b20ucmVjdC53LCB0b3AucmVjdC53KSAqIDAuMDEyNTtcbiAgICAgIGhlaWdodCA9IG1hcmtlclRoaWNrbmVzcywgeCA9IHN0YXJ0WF8wICsgb2Zmc2V0XzIsIHkgPSBsZXJwKHN0YXJ0WSwgZW5kWSwgMC41KSAtIG1hcmtlclRoaWNrbmVzcyAvIDIsIHdpZHRoID0gTWF0aC5tYXgoYm90dG9tLnJlY3QudywgdG9wLnJlY3QudykgLSBvZmZzZXRfMiAqIDI7XG4gICAgfSBlbHNlIGlmIChib3R0b20gJiYgIXRvcCkge1xuICAgICAgY29uc3Qgb2Zmc2V0XzMgPSBib3R0b20ucmVjdC53ICogMC4wMTI1O1xuICAgICAgeCA9IGJvdHRvbS5yZWN0LnggKyBvZmZzZXRfMywgeSA9IGJvdHRvbS5yZWN0LnkgLSBtYXJrZXJUaGlja25lc3MgLyAyLCB3aWR0aCA9IGJvdHRvbS5yZWN0LncgLSBvZmZzZXRfMyAqIDIsIGhlaWdodCA9IG1hcmtlclRoaWNrbmVzcztcbiAgICB9IGVsc2UgaWYgKHRvcCAmJiAhYm90dG9tKSB7XG4gICAgICBjb25zdCBvZmZzZXRfNCA9IHRvcC5yZWN0LncgKiAwLjAxMjU7XG4gICAgICB4ID0gdG9wLnJlY3QueCArIG9mZnNldF80LCB5ID0gdG9wLnJlY3QueSArIHRvcC5yZWN0LmggLSBtYXJrZXJUaGlja25lc3MgLyAyLCB3aWR0aCA9IHRvcC5yZWN0LncgLSBvZmZzZXRfNCAqIDIsIGhlaWdodCA9IG1hcmtlclRoaWNrbmVzcztcbiAgICB9XG4gIH1cbiAgY29uc3QgdDEgPSBgJHt3aWR0aH1weGAsIHQyID0gYCR7aGVpZ2h0fXB4YCwgdDMgPSBgdHJhbnNsYXRlKCR7eH1weCwgJHt5fXB4KWA7XG4gIGxldCB0NDtcbiAgcmV0dXJuICRbMF0gIT09IHQxIHx8ICRbMV0gIT09IHQyIHx8ICRbMl0gIT09IHQzID8gKHQ0ID0gLyogQF9fUFVSRV9fICovIGpzeChcImRpdlwiLCB7IHN0eWxlOiB7XG4gICAgcG9zaXRpb246IFwiYWJzb2x1dGVcIixcbiAgICB3aWR0aDogdDEsXG4gICAgaGVpZ2h0OiB0MixcbiAgICB0cmFuc2Zvcm06IHQzLFxuICAgIGJhY2tncm91bmQ6IFwiIzU1NmJmY1wiLFxuICAgIGJvcmRlcjogXCIycHggc29saWQgd2hpdGVcIixcbiAgICBib3JkZXJSYWRpdXM6IFwiOTk5cHhcIixcbiAgICB6SW5kZXg6IFwiOTk5OTk5XCJcbiAgfSB9KSwgJFswXSA9IHQxLCAkWzFdID0gdDIsICRbMl0gPSB0MywgJFszXSA9IHQ0KSA6IHQ0ID0gJFszXSwgdDQ7XG59LCBSb290JDIgPSBzdHlsZWQuZGl2YFxuICAtLWRyYWctcHJldmlldy1vcGFjaXR5OiAwLjk4O1xuICAtLWRyYWctcHJldmlldy1za2VsZXRvbi1zdHJva2U6ICNmZmZmZmY7XG5cbiAgQG1lZGlhIChwcmVmZXJzLWNvbG9yLXNjaGVtZTogZGFyaykge1xuICAgIC0tZHJhZy1wcmV2aWV3LXNrZWxldG9uLXN0cm9rZTogIzM4M2Q1MTtcbiAgfVxuXG4gIHBvc2l0aW9uOiBmaXhlZDtcbiAgZGlzcGxheTogZ3JpZDtcbiAgdHJhbnNmb3JtOiAkeyh7XG4gICRzY2FsZUZhY3RvcixcbiAgJHdpZHRoLFxuICAkaGVpZ2h0XG59KSA9PiBgdHJhbnNsYXRlKGNhbGModmFyKC0tZHJhZy1wcmV2aWV3LXgpIC0gJHskd2lkdGggLyAyfXB4KSwgY2FsYyh2YXIoLS1kcmFnLXByZXZpZXcteSkgLSAkeyRoZWlnaHQgLyAyfXB4KSkgc2NhbGUoJHskc2NhbGVGYWN0b3J9KWB9O1xuICB3aWR0aDogJHsoe1xuICAkd2lkdGhcbn0pID0+IGAkeyR3aWR0aH1weGB9O1xuICBoZWlnaHQ6ICR7KHtcbiAgJGhlaWdodFxufSkgPT4gYCR7JGhlaWdodH1weGB9O1xuICB6LWluZGV4OiA5OTk5OTk5O1xuICBvcGFjaXR5OiB2YXIoLS1kcmFnLXByZXZpZXctb3BhY2l0eSk7XG4gIGN1cnNvcjogbW92ZTtcblxuICAuZHJhZy1wcmV2aWV3LWNvbnRlbnQtd3JhcHBlciB7XG4gICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIGhlaWdodDogMTAwJTtcbiAgICBjb250YWluZXItdHlwZTogaW5saW5lLXNpemU7XG4gIH1cblxuICBbZGF0YS11aT0nY2FyZCddIHtcbiAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgaGVpZ2h0OiAxMDAlO1xuICB9XG5cbiAgLmRyYWctcHJldmlldy1za2VsZXRvbiB7XG4gICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgIGluc2V0OiAwO1xuXG4gICAgcmVjdCB7XG4gICAgICBzdHJva2U6IHZhcigtLWRyYWctcHJldmlldy1za2VsZXRvbi1zdHJva2UpO1xuICAgIH1cbiAgfVxuXG4gIC5kcmFnLXByZXZpZXctaGFuZGxlIHtcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgdG9wOiA0Y3FtaW47XG4gICAgbGVmdDogNGNxbWluO1xuICAgIHdpZHRoOiA2Y3FtaW47XG4gICAgZmlsbDogdmFyKC0tZHJhZy1wcmV2aWV3LWhhbmRsZS1maWxsKTtcbiAgfVxuYDtcbmZ1bmN0aW9uIGNsYW1wKG51bWJlciwgbWluLCBtYXgpIHtcbiAgcmV0dXJuIG51bWJlciA8IG1pbiA/IG1pbiA6IG51bWJlciA+IG1heCA/IG1heCA6IG51bWJlcjtcbn1cbmZ1bmN0aW9uIG1hcChudW1iZXIsIGluTWluLCBpbk1heCwgb3V0TWluLCBvdXRNYXgpIHtcbiAgY29uc3QgbWFwcGVkID0gKG51bWJlciAtIGluTWluKSAqIChvdXRNYXggLSBvdXRNaW4pIC8gKGluTWF4IC0gaW5NaW4pICsgb3V0TWluO1xuICByZXR1cm4gY2xhbXAobWFwcGVkLCBvdXRNaW4sIG91dE1heCk7XG59XG5jb25zdCBPdmVybGF5RHJhZ1ByZXZpZXcgPSAodDApID0+IHtcbiAgY29uc3QgJCA9IGMoNTApLCB7XG4gICAgc2tlbGV0b25cbiAgfSA9IHQwLCBtYXhTa2VsZXRvbldpZHRoID0gTWF0aC5taW4oc2tlbGV0b24ubWF4V2lkdGgsIHdpbmRvdy5pbm5lcldpZHRoIC8gMiksIHNjYWxlRmFjdG9yID0gc2tlbGV0b24udyA+IG1heFNrZWxldG9uV2lkdGggPyBtYXhTa2VsZXRvbldpZHRoIC8gc2tlbGV0b24udyA6IDEsIG9mZnNldFggPSBza2VsZXRvbi5vZmZzZXRYICogc2NhbGVGYWN0b3IsIG9mZnNldFkgPSBza2VsZXRvbi5vZmZzZXRZICogc2NhbGVGYWN0b3IsIHByZWZlcnNEYXJrID0gdXNlUHJlZmVyc0RhcmsoKSwgdGhlbWUgPSB1c2VUaGVtZV92MigpLCByYWRpdXMgPSB0aGVtZS5yYWRpdXNbfn5tYXAoc2tlbGV0b24udywgMCwgMTkyMCwgMSwgdGhlbWUucmFkaXVzLmxlbmd0aCAtIDIpXTtcbiAgbGV0IFQwLCBUMSwgdDEsIHQxMCwgdDExLCB0MTIsIHQxMywgdDE0LCB0MiwgdDMsIHQ0LCB0NSwgdDYsIHQ3LCB0OCwgdDk7XG4gIGlmICgkWzBdICE9PSBvZmZzZXRYIHx8ICRbMV0gIT09IG9mZnNldFkgfHwgJFsyXSAhPT0gcHJlZmVyc0RhcmsgfHwgJFszXSAhPT0gcmFkaXVzIHx8ICRbNF0gIT09IHNjYWxlRmFjdG9yIHx8ICRbNV0gIT09IHNrZWxldG9uLmNoaWxkUmVjdHMgfHwgJFs2XSAhPT0gc2tlbGV0b24uaCB8fCAkWzddICE9PSBza2VsZXRvbi53KSB7XG4gICAgY29uc3QgaW1hZ2VSZWN0cyA9IHNrZWxldG9uLmNoaWxkUmVjdHMuZmlsdGVyKF90ZW1wJDcpLCB0ZXh0UmVjdHMgPSBza2VsZXRvbi5jaGlsZFJlY3RzLmZpbHRlcihfdGVtcDIkNCk7XG4gICAgVDEgPSBSb290JDIsIHQxMCA9IHNrZWxldG9uLncsIHQxMSA9IHNrZWxldG9uLmgsIHQxMiA9IG9mZnNldFgsIHQxMyA9IG9mZnNldFksIHQxNCA9IHNjYWxlRmFjdG9yLCBUMCA9IENhcmQsIHQ1ID0gcmFkaXVzLCB0NiA9IDQsIHQ3ID0gXCJoaWRkZW5cIiwgdDggPSBcInRyYW5zcGFyZW50XCIsIHQ5ID0gcHJlZmVyc0RhcmsgPyBcImRhcmtcIiA6IFwibGlnaHRcIiwgdDQgPSBcImRyYWctcHJldmlldy1jb250ZW50LXdyYXBwZXJcIiwgdDIgPSBcImRyYWctcHJldmlldy1za2VsZXRvblwiLCB0MyA9IGAwIDAgJHtza2VsZXRvbi53fSAke3NrZWxldG9uLmh9YCwgdDEgPSBbLi4uaW1hZ2VSZWN0cywgLi4udGV4dFJlY3RzXSwgJFswXSA9IG9mZnNldFgsICRbMV0gPSBvZmZzZXRZLCAkWzJdID0gcHJlZmVyc0RhcmssICRbM10gPSByYWRpdXMsICRbNF0gPSBzY2FsZUZhY3RvciwgJFs1XSA9IHNrZWxldG9uLmNoaWxkUmVjdHMsICRbNl0gPSBza2VsZXRvbi5oLCAkWzddID0gc2tlbGV0b24udywgJFs4XSA9IFQwLCAkWzldID0gVDEsICRbMTBdID0gdDEsICRbMTFdID0gdDEwLCAkWzEyXSA9IHQxMSwgJFsxM10gPSB0MTIsICRbMTRdID0gdDEzLCAkWzE1XSA9IHQxNCwgJFsxNl0gPSB0MiwgJFsxN10gPSB0MywgJFsxOF0gPSB0NCwgJFsxOV0gPSB0NSwgJFsyMF0gPSB0NiwgJFsyMV0gPSB0NywgJFsyMl0gPSB0OCwgJFsyM10gPSB0OTtcbiAgfSBlbHNlXG4gICAgVDAgPSAkWzhdLCBUMSA9ICRbOV0sIHQxID0gJFsxMF0sIHQxMCA9ICRbMTFdLCB0MTEgPSAkWzEyXSwgdDEyID0gJFsxM10sIHQxMyA9ICRbMTRdLCB0MTQgPSAkWzE1XSwgdDIgPSAkWzE2XSwgdDMgPSAkWzE3XSwgdDQgPSAkWzE4XSwgdDUgPSAkWzE5XSwgdDYgPSAkWzIwXSwgdDcgPSAkWzIxXSwgdDggPSAkWzIyXSwgdDkgPSAkWzIzXTtcbiAgbGV0IHQxNTtcbiAgJFsyNF0gIT09IHQxIHx8ICRbMjVdICE9PSB0aGVtZS5jb2xvciA/ICh0MTUgPSB0MS5tYXAoKHJfMSwgaSkgPT4gLyogQF9fUFVSRV9fICovIGpzeChcInJlY3RcIiwgeyB4OiByXzEueCwgeTogcl8xLnksIHdpZHRoOiByXzEudywgaGVpZ2h0OiByXzEuaCwgZmlsbDogdGhlbWUuY29sb3Iuc2tlbGV0b24uZnJvbSB9LCBpKSksICRbMjRdID0gdDEsICRbMjVdID0gdGhlbWUuY29sb3IsICRbMjZdID0gdDE1KSA6IHQxNSA9ICRbMjZdO1xuICBsZXQgdDE2O1xuICAkWzI3XSAhPT0gdDE1IHx8ICRbMjhdICE9PSB0MiB8fCAkWzI5XSAhPT0gdDMgPyAodDE2ID0gLyogQF9fUFVSRV9fICovIGpzeChcInN2Z1wiLCB7IGNsYXNzTmFtZTogdDIsIHZpZXdCb3g6IHQzLCBjaGlsZHJlbjogdDE1IH0pLCAkWzI3XSA9IHQxNSwgJFsyOF0gPSB0MiwgJFsyOV0gPSB0MywgJFszMF0gPSB0MTYpIDogdDE2ID0gJFszMF07XG4gIGxldCB0MTc7XG4gICRbMzFdICE9PSB0MTYgfHwgJFszMl0gIT09IHQ0ID8gKHQxNyA9IC8qIEBfX1BVUkVfXyAqLyBqc3goXCJkaXZcIiwgeyBjbGFzc05hbWU6IHQ0LCBjaGlsZHJlbjogdDE2IH0pLCAkWzMxXSA9IHQxNiwgJFszMl0gPSB0NCwgJFszM10gPSB0MTcpIDogdDE3ID0gJFszM107XG4gIGxldCB0MTg7XG4gICRbMzRdICE9PSBUMCB8fCAkWzM1XSAhPT0gdDE3IHx8ICRbMzZdICE9PSB0NSB8fCAkWzM3XSAhPT0gdDYgfHwgJFszOF0gIT09IHQ3IHx8ICRbMzldICE9PSB0OCB8fCAkWzQwXSAhPT0gdDkgPyAodDE4ID0gLyogQF9fUFVSRV9fICovIGpzeChUMCwgeyByYWRpdXM6IHQ1LCBzaGFkb3c6IHQ2LCBvdmVyZmxvdzogdDcsIHRvbmU6IHQ4LCBzY2hlbWU6IHQ5LCBjaGlsZHJlbjogdDE3IH0pLCAkWzM0XSA9IFQwLCAkWzM1XSA9IHQxNywgJFszNl0gPSB0NSwgJFszN10gPSB0NiwgJFszOF0gPSB0NywgJFszOV0gPSB0OCwgJFs0MF0gPSB0OSwgJFs0MV0gPSB0MTgpIDogdDE4ID0gJFs0MV07XG4gIGxldCB0MTk7XG4gIHJldHVybiAkWzQyXSAhPT0gVDEgfHwgJFs0M10gIT09IHQxMCB8fCAkWzQ0XSAhPT0gdDExIHx8ICRbNDVdICE9PSB0MTIgfHwgJFs0Nl0gIT09IHQxMyB8fCAkWzQ3XSAhPT0gdDE0IHx8ICRbNDhdICE9PSB0MTggPyAodDE5ID0gLyogQF9fUFVSRV9fICovIGpzeChUMSwgeyAkd2lkdGg6IHQxMCwgJGhlaWdodDogdDExLCAkb2Zmc2V0WDogdDEyLCAkb2Zmc2V0WTogdDEzLCAkc2NhbGVGYWN0b3I6IHQxNCwgY2hpbGRyZW46IHQxOCB9KSwgJFs0Ml0gPSBUMSwgJFs0M10gPSB0MTAsICRbNDRdID0gdDExLCAkWzQ1XSA9IHQxMiwgJFs0Nl0gPSB0MTMsICRbNDddID0gdDE0LCAkWzQ4XSA9IHQxOCwgJFs0OV0gPSB0MTkpIDogdDE5ID0gJFs0OV0sIHQxOTtcbn07XG5mdW5jdGlvbiBfdGVtcCQ3KHIpIHtcbiAgcmV0dXJuIHIudGFnTmFtZSA9PT0gXCJJTUdcIjtcbn1cbmZ1bmN0aW9uIF90ZW1wMiQ0KHJfMCkge1xuICByZXR1cm4gcl8wLnRhZ05hbWUgIT09IFwiSU1HXCI7XG59XG5jb25zdCBSb290JDEgPSBzdHlsZWQoQ2FyZClgXG4gIHBvc2l0aW9uOiBmaXhlZDtcbiAgYm90dG9tOiAycmVtO1xuICBsZWZ0OiAycmVtO1xuYCwgT3ZlcmxheU1pbmltYXBQcm9tcHQgPSAoKSA9PiB7XG4gIGNvbnN0ICQgPSBjKDIpO1xuICBsZXQgdDA7XG4gICRbMF0gPT09IFN5bWJvbC5mb3IoXCJyZWFjdC5tZW1vX2NhY2hlX3NlbnRpbmVsXCIpID8gKHQwID0ge1xuICAgIHpJbmRleDogXCI5OTk5OTlcIlxuICB9LCAkWzBdID0gdDApIDogdDAgPSAkWzBdO1xuICBsZXQgdDE7XG4gIHJldHVybiAkWzFdID09PSBTeW1ib2wuZm9yKFwicmVhY3QubWVtb19jYWNoZV9zZW50aW5lbFwiKSA/ICh0MSA9IC8qIEBfX1BVUkVfXyAqLyBqc3goUm9vdCQxLCB7IHBhZGRpbmc6IDIsIHNoYWRvdzogMiwgcmFkaXVzOiAyLCBzdHlsZTogdDAsIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4cyhGbGV4LCB7IGFsaWduOiBcImNlbnRlclwiLCBnYXA6IDIsIGNoaWxkcmVuOiBbXG4gICAgLyogQF9fUFVSRV9fICovIGpzeChIb3RrZXlzLCB7IGtleXM6IFtcIlNoaWZ0XCJdIH0pLFxuICAgIC8qIEBfX1BVUkVfXyAqLyBqc3goVGV4dCwgeyBzaXplOiAxLCBjaGlsZHJlbjogXCJab29tIE91dFwiIH0pLFxuICAgIC8qIEBfX1BVUkVfXyAqLyBqc3goRXhwYW5kSWNvbiwge30pXG4gIF0gfSkgfSksICRbMV0gPSB0MSkgOiB0MSA9ICRbMV0sIHQxO1xufSwgZWxlbWVudHNSZWR1Y2VyID0gKGVsZW1lbnRzLCBtZXNzYWdlKSA9PiB7XG4gIGNvbnN0IHtcbiAgICB0eXBlXG4gIH0gPSBtZXNzYWdlO1xuICBzd2l0Y2ggKHR5cGUpIHtcbiAgICBjYXNlIFwiZWxlbWVudC9yZWdpc3RlclwiOlxuICAgICAgcmV0dXJuIGVsZW1lbnRzLmZpbmQoKGUpID0+IGUuaWQgPT09IG1lc3NhZ2UuaWQpID8gZWxlbWVudHMgOiBbLi4uZWxlbWVudHMsIHtcbiAgICAgICAgaWQ6IG1lc3NhZ2UuaWQsXG4gICAgICAgIGFjdGl2YXRlZDogITEsXG4gICAgICAgIGVsZW1lbnQ6IG1lc3NhZ2UuZWxlbWVudCxcbiAgICAgICAgZm9jdXNlZDogITEsXG4gICAgICAgIGhvdmVyZWQ6ICExLFxuICAgICAgICByZWN0OiBtZXNzYWdlLnJlY3QsXG4gICAgICAgIHNhbml0eTogbWVzc2FnZS5zYW5pdHksXG4gICAgICAgIGRyYWdEaXNhYmxlZDogbWVzc2FnZS5kcmFnRGlzYWJsZWRcbiAgICAgIH1dO1xuICAgIGNhc2UgXCJlbGVtZW50L2FjdGl2YXRlXCI6XG4gICAgICByZXR1cm4gZWxlbWVudHMubWFwKChlKSA9PiBlLmlkID09PSBtZXNzYWdlLmlkID8ge1xuICAgICAgICAuLi5lLFxuICAgICAgICBhY3RpdmF0ZWQ6ICEwXG4gICAgICB9IDogZSk7XG4gICAgY2FzZSBcImVsZW1lbnQvdXBkYXRlXCI6XG4gICAgICByZXR1cm4gZWxlbWVudHMubWFwKChlKSA9PiBlLmlkID09PSBtZXNzYWdlLmlkID8ge1xuICAgICAgICAuLi5lLFxuICAgICAgICBzYW5pdHk6IG1lc3NhZ2Uuc2FuaXR5LFxuICAgICAgICByZWN0OiBtZXNzYWdlLnJlY3RcbiAgICAgIH0gOiBlKTtcbiAgICBjYXNlIFwiZWxlbWVudC91bnJlZ2lzdGVyXCI6XG4gICAgICByZXR1cm4gZWxlbWVudHMuZmlsdGVyKChlKSA9PiBlLmlkICE9PSBtZXNzYWdlLmlkKTtcbiAgICBjYXNlIFwiZWxlbWVudC9kZWFjdGl2YXRlXCI6XG4gICAgICByZXR1cm4gZWxlbWVudHMubWFwKChlKSA9PiBlLmlkID09PSBtZXNzYWdlLmlkID8ge1xuICAgICAgICAuLi5lLFxuICAgICAgICBhY3RpdmF0ZWQ6ICExLFxuICAgICAgICBob3ZlcmVkOiAhMVxuICAgICAgfSA6IGUpO1xuICAgIGNhc2UgXCJlbGVtZW50L21vdXNlZW50ZXJcIjpcbiAgICAgIHJldHVybiBlbGVtZW50cy5tYXAoKGUpID0+IGUuaWQgPT09IG1lc3NhZ2UuaWQgPyB7XG4gICAgICAgIC4uLmUsXG4gICAgICAgIHJlY3Q6IG1lc3NhZ2UucmVjdCxcbiAgICAgICAgaG92ZXJlZDogITBcbiAgICAgIH0gOiB7XG4gICAgICAgIC4uLmUsXG4gICAgICAgIGhvdmVyZWQ6ICExXG4gICAgICB9KTtcbiAgICBjYXNlIFwiZWxlbWVudC9tb3VzZWxlYXZlXCI6XG4gICAgICByZXR1cm4gZWxlbWVudHMubWFwKChlbGVtZW50KSA9PiBlbGVtZW50LmlkID09PSBtZXNzYWdlLmlkID8ge1xuICAgICAgICAuLi5lbGVtZW50LFxuICAgICAgICBob3ZlcmVkOiAhMVxuICAgICAgfSA6IGVsZW1lbnQpO1xuICAgIGNhc2UgXCJlbGVtZW50L3VwZGF0ZVJlY3RcIjpcbiAgICAgIHJldHVybiBlbGVtZW50cy5tYXAoKGVsZW1lbnQpID0+IGVsZW1lbnQuaWQgPT09IG1lc3NhZ2UuaWQgPyB7XG4gICAgICAgIC4uLmVsZW1lbnQsXG4gICAgICAgIHJlY3Q6IG1lc3NhZ2UucmVjdFxuICAgICAgfSA6IGVsZW1lbnQpO1xuICAgIGNhc2UgXCJlbGVtZW50L2NsaWNrXCI6XG4gICAgICByZXR1cm4gZWxlbWVudHMubWFwKChlKSA9PiAoe1xuICAgICAgICAuLi5lLFxuICAgICAgICBmb2N1c2VkOiBlLmlkID09PSBtZXNzYWdlLmlkICYmIFwiY2xpY2tlZFwiXG4gICAgICB9KSk7XG4gICAgY2FzZSBcIm92ZXJsYXkvYmx1clwiOlxuICAgICAgcmV0dXJuIGVsZW1lbnRzLm1hcCgoZSkgPT4gKHtcbiAgICAgICAgLi4uZSxcbiAgICAgICAgZm9jdXNlZDogITFcbiAgICAgIH0pKTtcbiAgICBjYXNlIFwicHJlc2VudGF0aW9uL2JsdXJcIjpcbiAgICAgIHJldHVybiBlbGVtZW50cy5tYXAoKGUpID0+ICh7XG4gICAgICAgIC4uLmUsXG4gICAgICAgIGZvY3VzZWQ6ICExXG4gICAgICB9KSk7XG4gICAgY2FzZSBcInByZXNlbnRhdGlvbi9mb2N1c1wiOiB7XG4gICAgICBjb25zdCBjbGlja2VkRWxlbWVudCA9IGVsZW1lbnRzLmZpbmQoKGUpID0+IGUuZm9jdXNlZCA9PT0gXCJjbGlja2VkXCIpO1xuICAgICAgcmV0dXJuIGVsZW1lbnRzLm1hcCgoZSkgPT4ge1xuICAgICAgICBjb25zdCBmb2N1c2VkID0gXCJwYXRoXCIgaW4gZS5zYW5pdHkgJiYgZS5zYW5pdHkuaWQgPT09IG1lc3NhZ2UuZGF0YS5pZCAmJiBlLnNhbml0eS5wYXRoID09PSBtZXNzYWdlLmRhdGEucGF0aDtcbiAgICAgICAgcmV0dXJuIGNsaWNrZWRFbGVtZW50ICYmIGUgPT09IGNsaWNrZWRFbGVtZW50ICYmIGZvY3VzZWQgPyBlIDoge1xuICAgICAgICAgIC4uLmUsXG4gICAgICAgICAgLy8gTWFyayBhcyBhIGR1cGUgaWYgYW5vdGhlciBtYXRjaGluZyBpdGVtIGhhcyBiZWVuIGNsaWNrZWQgdG8gcHJldmVudFxuICAgICAgICAgIC8vIHNjcm9sbGluZywgb3RoZXJ3aXNlIGp1c3Qgc2V0IGZvY3VzIGFzIGEgYm9vbGVhblxuICAgICAgICAgIGZvY3VzZWQ6IGZvY3VzZWQgJiYgY2xpY2tlZEVsZW1lbnQgPyBcImR1cGxpY2F0ZVwiIDogZm9jdXNlZFxuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgfVxuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gZWxlbWVudHM7XG4gIH1cbn07XG5mdW5jdGlvbiBvdmVybGF5U3RhdGVSZWR1Y2VyKHN0YXRlLCBtZXNzYWdlKSB7XG4gIGNvbnN0IHtcbiAgICB0eXBlXG4gIH0gPSBtZXNzYWdlO1xuICBsZXQge1xuICAgIGNvbnRleHRNZW51LFxuICAgIGZvY3VzUGF0aCxcbiAgICBwZXJzcGVjdGl2ZSxcbiAgICBpc0RyYWdnaW5nLFxuICAgIGRyYWdJbnNlcnRQb3NpdGlvbixcbiAgICBkcmFnU2hvd01pbmltYXAsXG4gICAgZHJhZ1Nob3dNaW5pbWFwUHJvbXB0LFxuICAgIGRyYWdTa2VsZXRvbixcbiAgICBkcmFnTWluaW1hcFRyYW5zaXRpb24sXG4gICAgZHJhZ0dyb3VwUmVjdFxuICB9ID0gc3RhdGUsIHdhc01heWJlQ29sbGFwc2VkID0gITE7XG4gIGlmICh0eXBlID09PSBcInByZXNlbnRhdGlvbi9mb2N1c1wiKSB7XG4gICAgY29uc3QgcHJldkZvY3VzUGF0aCA9IHN0YXRlLmZvY3VzUGF0aDtcbiAgICBmb2N1c1BhdGggPSBtZXNzYWdlLmRhdGEucGF0aCwgcHJldkZvY3VzUGF0aCAhPT0gZm9jdXNQYXRoICYmICh3YXNNYXliZUNvbGxhcHNlZCA9IHByZXZGb2N1c1BhdGguc2xpY2UoZm9jdXNQYXRoLmxlbmd0aCkuc3RhcnRzV2l0aChcIltcIikpO1xuICB9XG4gIHJldHVybiB0eXBlID09PSBcInByZXNlbnRhdGlvbi9wZXJzcGVjdGl2ZVwiICYmIChwZXJzcGVjdGl2ZSA9IG1lc3NhZ2UuZGF0YS5wZXJzcGVjdGl2ZSksIHR5cGUgPT09IFwiZWxlbWVudC9jb250ZXh0bWVudVwiICYmIChcInNhbml0eVwiIGluIG1lc3NhZ2UgPyBjb250ZXh0TWVudSA9IHtcbiAgICBub2RlOiBtZXNzYWdlLnNhbml0eSxcbiAgICBwb3NpdGlvbjogbWVzc2FnZS5wb3NpdGlvblxuICB9IDogY29udGV4dE1lbnUgPSBudWxsKSwgKHR5cGUgPT09IFwiZWxlbWVudC9jbGlja1wiIHx8IHR5cGUgPT09IFwiZWxlbWVudC9tb3VzZWxlYXZlXCIgfHwgdHlwZSA9PT0gXCJvdmVybGF5L2JsdXJcIiB8fCB0eXBlID09PSBcInByZXNlbnRhdGlvbi9ibHVyXCIgfHwgdHlwZSA9PT0gXCJwcmVzZW50YXRpb24vZm9jdXNcIikgJiYgKGNvbnRleHRNZW51ID0gbnVsbCksIHR5cGUgPT09IFwib3ZlcmxheS9kcmFnVXBkYXRlSW5zZXJ0UG9zaXRpb25cIiAmJiAoZHJhZ0luc2VydFBvc2l0aW9uID0gbWVzc2FnZS5pbnNlcnRQb3NpdGlvbiksIHR5cGUgPT09IFwib3ZlcmxheS9kcmFnU3RhcnRcIiAmJiAoaXNEcmFnZ2luZyA9ICEwKSwgbWVzc2FnZS50eXBlID09PSBcIm92ZXJsYXkvZHJhZ1VwZGF0ZVNrZWxldG9uXCIgJiYgKGRyYWdTa2VsZXRvbiA9IG1lc3NhZ2Uuc2tlbGV0b24pLCB0eXBlID09PSBcIm92ZXJsYXkvZHJhZ0VuZFwiICYmIChpc0RyYWdnaW5nID0gITEpLCBtZXNzYWdlLnR5cGUgPT09IFwib3ZlcmxheS9kcmFnVG9nZ2xlTWluaW1hcFByb21wdFwiICYmIChkcmFnU2hvd01pbmltYXBQcm9tcHQgPSBtZXNzYWdlLmRpc3BsYXkpLCB0eXBlID09PSBcIm92ZXJsYXkvZHJhZ1N0YXJ0TWluaW1hcFRyYW5zaXRpb25cIiAmJiAoZHJhZ01pbmltYXBUcmFuc2l0aW9uID0gITApLCB0eXBlID09PSBcIm92ZXJsYXkvZHJhZ0VuZE1pbmltYXBUcmFuc2l0aW9uXCIgJiYgKGRyYWdNaW5pbWFwVHJhbnNpdGlvbiA9ICExKSwgdHlwZSA9PT0gXCJvdmVybGF5L2RyYWdVcGRhdGVHcm91cFJlY3RcIiAmJiAoZHJhZ0dyb3VwUmVjdCA9IG1lc3NhZ2UuZ3JvdXBSZWN0KSwgdHlwZSA9PT0gXCJvdmVybGF5L2RyYWdUb2dnbGVNaW5pbWFwXCIgJiYgKGRyYWdTaG93TWluaW1hcCA9IG1lc3NhZ2UuZGlzcGxheSksIHtcbiAgICAuLi5zdGF0ZSxcbiAgICBjb250ZXh0TWVudSxcbiAgICBlbGVtZW50czogZWxlbWVudHNSZWR1Y2VyKHN0YXRlLmVsZW1lbnRzLCBtZXNzYWdlKSxcbiAgICBkcmFnSW5zZXJ0UG9zaXRpb24sXG4gICAgZHJhZ1NrZWxldG9uLFxuICAgIGRyYWdHcm91cFJlY3QsXG4gICAgaXNEcmFnZ2luZyxcbiAgICBmb2N1c1BhdGgsXG4gICAgcGVyc3BlY3RpdmUsXG4gICAgd2FzTWF5YmVDb2xsYXBzZWQsXG4gICAgZHJhZ1Nob3dNaW5pbWFwLFxuICAgIGRyYWdTaG93TWluaW1hcFByb21wdCxcbiAgICBkcmFnTWluaW1hcFRyYW5zaXRpb25cbiAgfTtcbn1cbmNvbnN0IFByZXZpZXdTbmFwc2hvdHNQcm92aWRlciA9IGZ1bmN0aW9uKHByb3BzKSB7XG4gIGNvbnN0ICQgPSBjKDEzKSwge1xuICAgIGNvbWxpbmssXG4gICAgY2hpbGRyZW5cbiAgfSA9IHByb3BzO1xuICBsZXQgdDA7XG4gICRbMF0gPT09IFN5bWJvbC5mb3IoXCJyZWFjdC5tZW1vX2NhY2hlX3NlbnRpbmVsXCIpID8gKHQwID0gW10sICRbMF0gPSB0MCkgOiB0MCA9ICRbMF07XG4gIGNvbnN0IFtwcmV2aWV3U25hcHNob3RzLCBzZXRQcmV2aWV3U25hcHNob3RzXSA9IHVzZVN0YXRlKHQwKTtcbiAgbGV0IHQxO1xuICAkWzFdICE9PSBjb21saW5rID8gKHQxID0gYXN5bmMgKHNpZ25hbCkgPT4ge1xuICAgIGlmIChjb21saW5rKVxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjb21saW5rLmZldGNoKFwidmlzdWFsLWVkaXRpbmcvcHJldmlldy1zbmFwc2hvdHNcIiwgdm9pZCAwLCB7XG4gICAgICAgICAgc2lnbmFsLFxuICAgICAgICAgIHN1cHByZXNzV2FybmluZ3M6ICEwXG4gICAgICAgIH0pO1xuICAgICAgICBzZXRQcmV2aWV3U25hcHNob3RzKHJlc3BvbnNlLnNuYXBzaG90cyk7XG4gICAgICB9IGNhdGNoIHtcbiAgICAgIH1cbiAgfSwgJFsxXSA9IGNvbWxpbmssICRbMl0gPSB0MSkgOiB0MSA9ICRbMl07XG4gIGNvbnN0IGZldGNoUHJldmlld1NuYXBzaG90cyA9IHQxO1xuICBsZXQgdDIsIHQzO1xuICAkWzNdICE9PSBjb21saW5rIHx8ICRbNF0gIT09IGZldGNoUHJldmlld1NuYXBzaG90cyA/ICh0MiA9ICgpID0+IHtcbiAgICBpZiAoIWNvbWxpbmspXG4gICAgICByZXR1cm47XG4gICAgY29uc3QgcHJldmlld1NhcHNob3RzRmV0Y2ggPSBuZXcgQWJvcnRDb250cm9sbGVyKCksIHVuc3ViID0gY29tbGluay5vblN0YXR1cygoKSA9PiB7XG4gICAgICBmZXRjaFByZXZpZXdTbmFwc2hvdHMocHJldmlld1NhcHNob3RzRmV0Y2guc2lnbmFsKTtcbiAgICB9LCBcImNvbm5lY3RlZFwiKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgcHJldmlld1NhcHNob3RzRmV0Y2guYWJvcnQoKSwgdW5zdWIoKTtcbiAgICB9O1xuICB9LCB0MyA9IFtjb21saW5rLCBmZXRjaFByZXZpZXdTbmFwc2hvdHNdLCAkWzNdID0gY29tbGluaywgJFs0XSA9IGZldGNoUHJldmlld1NuYXBzaG90cywgJFs1XSA9IHQyLCAkWzZdID0gdDMpIDogKHQyID0gJFs1XSwgdDMgPSAkWzZdKSwgdXNlRWZmZWN0KHQyLCB0Myk7XG4gIGxldCB0NCwgdDU7XG4gICRbN10gIT09IGNvbWxpbmsgPyAodDQgPSAoKSA9PiBjb21saW5rPy5vbihcInByZXNlbnRhdGlvbi9wcmV2aWV3LXNuYXBzaG90c1wiLCAoZGF0YSkgPT4ge1xuICAgIHNldFByZXZpZXdTbmFwc2hvdHMoZGF0YS5zbmFwc2hvdHMpO1xuICB9KSwgdDUgPSBbY29tbGlua10sICRbN10gPSBjb21saW5rLCAkWzhdID0gdDQsICRbOV0gPSB0NSkgOiAodDQgPSAkWzhdLCB0NSA9ICRbOV0pLCB1c2VFZmZlY3QodDQsIHQ1KTtcbiAgbGV0IHQ2O1xuICB0NiA9IHByZXZpZXdTbmFwc2hvdHM7XG4gIGNvbnN0IGNvbnRleHQgPSB0NjtcbiAgbGV0IHQ3O1xuICByZXR1cm4gJFsxMF0gIT09IGNoaWxkcmVuIHx8ICRbMTFdICE9PSBjb250ZXh0ID8gKHQ3ID0gLyogQF9fUFVSRV9fICovIGpzeChQcmV2aWV3U25hcHNob3RzQ29udGV4dC5Qcm92aWRlciwgeyB2YWx1ZTogY29udGV4dCwgY2hpbGRyZW4gfSksICRbMTBdID0gY2hpbGRyZW4sICRbMTFdID0gY29udGV4dCwgJFsxMl0gPSB0NykgOiB0NyA9ICRbMTJdLCB0Nztcbn07XG5mdW5jdGlvbiBpc1Nhbml0eU5vZGUobm9kZSkge1xuICByZXR1cm4gXCJwYXRoXCIgaW4gbm9kZTtcbn1cbmZ1bmN0aW9uIGlzRG9jdW1lbnRTY2hlbWFUeXBlKHR5cGUpIHtcbiAgcmV0dXJuIHR5cGUudHlwZSA9PT0gXCJkb2N1bWVudFwiO1xufVxuZnVuY3Rpb24gaXNUeXBlU2NoZW1hVHlwZSh0eXBlKSB7XG4gIHJldHVybiB0eXBlLnR5cGUgPT09IFwidHlwZVwiO1xufVxuZnVuY3Rpb24gcG9wVW5rZXllZFBhdGhTZWdtZW50cyhwYXRoKSB7XG4gIHJldHVybiBwYXRoLnNwbGl0KFwiLlwiKS50b1JldmVyc2VkKCkucmVkdWNlKChhY2MsIHBhcnQpID0+IGFjYy5sZW5ndGggPyBbcGFydCwgLi4uYWNjXSA6IHBhcnQuaW5jbHVkZXMoXCJbX2tleT09XCIpID8gW3BhcnRdIDogW10sIFtdKS5qb2luKFwiLlwiKTtcbn1cbmZ1bmN0aW9uIGdldFBhdGhzV2l0aFVucmVzb2x2ZWRUeXBlcyhlbGVtZW50cykge1xuICByZXR1cm4gZWxlbWVudHMucmVkdWNlKChhY2MsIGVsZW1lbnQpID0+IHtcbiAgICBjb25zdCB7XG4gICAgICBzYW5pdHlcbiAgICB9ID0gZWxlbWVudDtcbiAgICBpZiAoIShcImlkXCIgaW4gc2FuaXR5KSB8fCAhc2FuaXR5LnBhdGguaW5jbHVkZXMoXCJbX2tleT09XCIpKSByZXR1cm4gYWNjO1xuICAgIGNvbnN0IHBhdGggPSBwb3BVbmtleWVkUGF0aFNlZ21lbnRzKHNhbml0eS5wYXRoKTtcbiAgICByZXR1cm4gYWNjLmZpbmQoKGl0ZW0pID0+IGl0ZW0uaWQgPT09IHNhbml0eS5pZCAmJiBpdGVtLnBhdGggPT09IHBhdGgpIHx8IGFjYy5wdXNoKHtcbiAgICAgIGlkOiBzYW5pdHkuaWQsXG4gICAgICBwYXRoXG4gICAgfSksIGFjYztcbiAgfSwgW10pO1xufVxuY29uc3QgU2NoZW1hUHJvdmlkZXIgPSBmdW5jdGlvbihwcm9wcykge1xuICBjb25zdCAkID0gYygyMiksIHtcbiAgICBjb21saW5rLFxuICAgIGNoaWxkcmVuLFxuICAgIGVsZW1lbnRzXG4gIH0gPSBwcm9wcztcbiAgbGV0IHQwO1xuICAkWzBdID09PSBTeW1ib2wuZm9yKFwicmVhY3QubWVtb19jYWNoZV9zZW50aW5lbFwiKSA/ICh0MCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCksICRbMF0gPSB0MCkgOiB0MCA9ICRbMF07XG4gIGNvbnN0IFtyZXNvbHZlZFR5cGVzLCBzZXRSZXNvbHZlZFR5cGVzXSA9IHVzZVN0YXRlKHQwKSwgW3NjaGVtYSwgc2V0U2NoZW1hXSA9IHVzZVN0YXRlKG51bGwpO1xuICBsZXQgdDEsIHQyO1xuICAkWzFdICE9PSBjb21saW5rID8gKHQxID0gKCkgPT4ge1xuICAgIGlmICghY29tbGluaylcbiAgICAgIHJldHVybjtcbiAgICBjb25zdCBmZXRjaFNjaGVtYSA9IGFzeW5jIGZ1bmN0aW9uKHNpZ25hbCkge1xuICAgICAgaWYgKGNvbWxpbmspXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjb21saW5rLmZldGNoKFwidmlzdWFsLWVkaXRpbmcvc2NoZW1hXCIsIHZvaWQgMCwge1xuICAgICAgICAgICAgc2lnbmFsLFxuICAgICAgICAgICAgc3VwcHJlc3NXYXJuaW5nczogITBcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBzZXRTY2hlbWEocmVzcG9uc2Uuc2NoZW1hKTtcbiAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgIH1cbiAgICB9LCBzY2hlbWFGZXRjaCA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKSwgdW5zdWIgPSBjb21saW5rLm9uU3RhdHVzKCgpID0+IHtcbiAgICAgIGZldGNoU2NoZW1hKHNjaGVtYUZldGNoLnNpZ25hbCk7XG4gICAgfSwgXCJjb25uZWN0ZWRcIik7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIHNjaGVtYUZldGNoLmFib3J0KCksIHVuc3ViKCk7XG4gICAgfTtcbiAgfSwgdDIgPSBbY29tbGlua10sICRbMV0gPSBjb21saW5rLCAkWzJdID0gdDEsICRbM10gPSB0MikgOiAodDEgPSAkWzJdLCB0MiA9ICRbM10pLCB1c2VFZmZlY3QodDEsIHQyKTtcbiAgbGV0IHQzO1xuICAkWzRdID09PSBTeW1ib2wuZm9yKFwicmVhY3QubWVtb19jYWNoZV9zZW50aW5lbFwiKSA/ICh0MyA9IFtdLCAkWzRdID0gdDMpIDogdDMgPSAkWzRdO1xuICBjb25zdCByZXBvcnRlZFBhdGhzUmVmID0gdXNlUmVmKHQzKSwgdDQgPSB1c2VEZWZlcnJlZFZhbHVlKGVsZW1lbnRzKTtcbiAgbGV0IHQ1O1xuICAkWzVdICE9PSB0NCA/ICh0NSA9IGdldFBhdGhzV2l0aFVucmVzb2x2ZWRUeXBlcyh0NCksICRbNV0gPSB0NCwgJFs2XSA9IHQ1KSA6IHQ1ID0gJFs2XTtcbiAgY29uc3QgcGF0aHMgPSB0NSwgY29udHJvbGxlclJlZiA9IHVzZVJlZihudWxsKTtcbiAgbGV0IHQ2LCB0NztcbiAgJFs3XSAhPT0gY29tbGluayB8fCAkWzhdICE9PSBwYXRocyA/ICh0NiA9ICgpID0+IHtcbiAgICBpZiAoIXBhdGhzLmxlbmd0aCB8fCAhY29tbGluaylcbiAgICAgIHJldHVybjtcbiAgICBjb25zdCByZXBvcnRQYXRocyA9IGFzeW5jIChwYXRoc18wLCBzaWduYWxfMCkgPT4ge1xuICAgICAgY29uc3QgaW5pdGlhbFJlcG9ydGVkUGF0aHMgPSByZXBvcnRlZFBhdGhzUmVmLmN1cnJlbnQ7XG4gICAgICB0cnkge1xuICAgICAgICByZXBvcnRlZFBhdGhzUmVmLmN1cnJlbnQgPSBwYXRoc18wO1xuICAgICAgICBjb25zdCByZXNwb25zZV8wID0gYXdhaXQgY29tbGluay5mZXRjaChcInZpc3VhbC1lZGl0aW5nL3NjaGVtYS11bmlvbi10eXBlc1wiLCB7XG4gICAgICAgICAgcGF0aHM6IHBhdGhzXzBcbiAgICAgICAgfSwge1xuICAgICAgICAgIHNpZ25hbDogc2lnbmFsXzAsXG4gICAgICAgICAgc3VwcHJlc3NXYXJuaW5nczogITBcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChzaWduYWxfMC5hYm9ydGVkKVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgc2V0UmVzb2x2ZWRUeXBlcyhyZXNwb25zZV8wLnR5cGVzKSwgY29udHJvbGxlclJlZi5jdXJyZW50ID0gbnVsbDtcbiAgICAgIH0gY2F0Y2gge1xuICAgICAgfVxuICAgICAgc2lnbmFsXzAuYWJvcnRlZCAmJiAocmVwb3J0ZWRQYXRoc1JlZi5jdXJyZW50ID0gaW5pdGlhbFJlcG9ydGVkUGF0aHMpO1xuICAgIH07XG4gICAgcGF0aHMuc29tZSgocCkgPT4gIXJlcG9ydGVkUGF0aHNSZWYuY3VycmVudC5maW5kKCh0ODIpID0+IHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgaWQsXG4gICAgICAgIHBhdGhcbiAgICAgIH0gPSB0ODI7XG4gICAgICByZXR1cm4gaWQgPT09IHAuaWQgJiYgcGF0aCA9PT0gcC5wYXRoO1xuICAgIH0pKSAmJiAoY29udHJvbGxlclJlZi5jdXJyZW50Py5hYm9ydCgpLCBjb250cm9sbGVyUmVmLmN1cnJlbnQgPSBuZXcgQWJvcnRDb250cm9sbGVyKCksIHJlcG9ydFBhdGhzKHBhdGhzLCBjb250cm9sbGVyUmVmLmN1cnJlbnQuc2lnbmFsKSk7XG4gIH0sIHQ3ID0gW2NvbWxpbmssIHBhdGhzXSwgJFs3XSA9IGNvbWxpbmssICRbOF0gPSBwYXRocywgJFs5XSA9IHQ2LCAkWzEwXSA9IHQ3KSA6ICh0NiA9ICRbOV0sIHQ3ID0gJFsxMF0pLCB1c2VFZmZlY3QodDYsIHQ3KTtcbiAgbGV0IHQ4O1xuICAkWzExXSAhPT0gc2NoZW1hID8gKHQ4ID0gKG5vZGUsIF90eXBlKSA9PiB7XG4gICAgY29uc3QgdHlwZSA9IF90eXBlIHx8IFwiZG9jdW1lbnRcIjtcbiAgICBpZiAoIXNjaGVtYSB8fCB0eXBlb2Ygbm9kZSAhPSBcInN0cmluZ1wiICYmICghaXNTYW5pdHlOb2RlKG5vZGUpIHx8ICFBcnJheS5pc0FycmF5KHNjaGVtYSkpKVxuICAgICAgcmV0dXJuO1xuICAgIGNvbnN0IG5hbWUgPSB0eXBlb2Ygbm9kZSA9PSBcInN0cmluZ1wiID8gbm9kZSA6IG5vZGUudHlwZSwgZmlsdGVyID0gdHlwZSA9PT0gXCJkb2N1bWVudFwiID8gaXNEb2N1bWVudFNjaGVtYVR5cGUgOiBpc1R5cGVTY2hlbWFUeXBlO1xuICAgIHJldHVybiBzY2hlbWEuZmlsdGVyKGZpbHRlcikuZmluZCgoc2NoZW1hVHlwZSkgPT4gc2NoZW1hVHlwZS5uYW1lID09PSBuYW1lKTtcbiAgfSwgJFsxMV0gPSBzY2hlbWEsICRbMTJdID0gdDgpIDogdDggPSAkWzEyXTtcbiAgY29uc3QgZ2V0VHlwZSA9IHQ4O1xuICBsZXQgdDk7XG4gICRbMTNdICE9PSBnZXRUeXBlIHx8ICRbMTRdICE9PSByZXNvbHZlZFR5cGVzID8gKHQ5ID0gKG5vZGVfMCkgPT4ge1xuICAgIGlmICghaXNTYW5pdHlOb2RlKG5vZGVfMCkpXG4gICAgICByZXR1cm4ge1xuICAgICAgICBmaWVsZDogdm9pZCAwLFxuICAgICAgICBwYXJlbnQ6IHZvaWQgMFxuICAgICAgfTtcbiAgICBjb25zdCBzY2hlbWFUeXBlXzAgPSBnZXRUeXBlKG5vZGVfMCk7XG4gICAgaWYgKCFzY2hlbWFUeXBlXzApXG4gICAgICByZXR1cm4ge1xuICAgICAgICBmaWVsZDogdm9pZCAwLFxuICAgICAgICBwYXJlbnQ6IHZvaWQgMFxuICAgICAgfTtcbiAgICBmdW5jdGlvbiBmaWVsZEZyb21QYXRoKHNjaGVtYVR5cGVfMSwgcGF0aF8wLCBwYXJlbnQsIHQxMDIpIHtcbiAgICAgIGNvbnN0IHByZXZQYXRoID0gdDEwMiA9PT0gdm9pZCAwID8gW10gOiB0MTAyO1xuICAgICAgaWYgKCFzY2hlbWFUeXBlXzEpXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZmllbGQ6IHZvaWQgMCxcbiAgICAgICAgICBwYXJlbnQ6IHZvaWQgMFxuICAgICAgICB9O1xuICAgICAgY29uc3QgW25leHQsIC4uLnJlc3RdID0gcGF0aF8wO1xuICAgICAgaWYgKFwiZmllbGRzXCIgaW4gc2NoZW1hVHlwZV8xKSB7XG4gICAgICAgIGNvbnN0IG9iamVjdEZpZWxkID0gc2NoZW1hVHlwZV8xLmZpZWxkc1tuZXh0XTtcbiAgICAgICAgaWYgKCFvYmplY3RGaWVsZCAmJiBcInJlc3RcIiBpbiBzY2hlbWFUeXBlXzEpXG4gICAgICAgICAgcmV0dXJuIGZpZWxkRnJvbVBhdGgoc2NoZW1hVHlwZV8xLnJlc3QsIHBhdGhfMCwgc2NoZW1hVHlwZV8xLCBwcmV2UGF0aCk7XG4gICAgICAgIGlmICghcmVzdC5sZW5ndGgpXG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGZpZWxkOiBvYmplY3RGaWVsZCxcbiAgICAgICAgICAgIHBhcmVudFxuICAgICAgICAgIH07XG4gICAgICAgIGlmICghb2JqZWN0RmllbGQpXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBbQHNhbml0eS92aXN1YWwtZWRpdGluZ10gTm8gZmllbGQgY291bGQgYmUgcmVzb2x2ZWQgYXQgcGF0aDogXCIke1suLi5wcmV2UGF0aCwgLi4ucGF0aF8wXS5qb2luKFwiLlwiKX1cImApO1xuICAgICAgICByZXR1cm4gZmllbGRGcm9tUGF0aChvYmplY3RGaWVsZC52YWx1ZSwgcmVzdCwgc2NoZW1hVHlwZV8xLCBbLi4ucHJldlBhdGgsIG5leHRdKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChzY2hlbWFUeXBlXzEudHlwZSA9PT0gXCJhcnJheVwiKVxuICAgICAgICAgIHJldHVybiBmaWVsZEZyb21QYXRoKHNjaGVtYVR5cGVfMS5vZiwgcGF0aF8wLCBzY2hlbWFUeXBlXzEsIHByZXZQYXRoKTtcbiAgICAgICAgaWYgKHNjaGVtYVR5cGVfMS50eXBlID09PSBcImFycmF5SXRlbVwiKVxuICAgICAgICAgIHJldHVybiByZXN0Lmxlbmd0aCA/IGZpZWxkRnJvbVBhdGgoc2NoZW1hVHlwZV8xLnZhbHVlLCByZXN0LCBzY2hlbWFUeXBlXzEsIFsuLi5wcmV2UGF0aCwgbmV4dF0pIDoge1xuICAgICAgICAgICAgZmllbGQ6IHNjaGVtYVR5cGVfMSxcbiAgICAgICAgICAgIHBhcmVudFxuICAgICAgICAgIH07XG4gICAgICAgIGlmIChzY2hlbWFUeXBlXzEudHlwZSA9PT0gXCJ1bmlvblwiKSB7XG4gICAgICAgICAgY29uc3QgbmFtZV8wID0gbmV4dC5zdGFydHNXaXRoKFwiW19rZXk9PVwiKSA/IHJlc29sdmVkVHlwZXM/LmdldChub2RlXzAuaWQpPy5nZXQoW3ByZXZQYXRoLmpvaW4oXCIuXCIpLCBuZXh0XS5maWx0ZXIoQm9vbGVhbikuam9pbihcIlwiKSkgOiBuZXh0O1xuICAgICAgICAgIHJldHVybiBmaWVsZEZyb21QYXRoKHNjaGVtYVR5cGVfMS5vZi5maW5kKChpdGVtKSA9PiBpdGVtLnR5cGUgPT09IFwidW5pb25PcHRpb25cIiA/IGl0ZW0ubmFtZSA9PT0gbmFtZV8wIDogaXRlbSksIHJlc3QsIHNjaGVtYVR5cGVfMSwgWy4uLnByZXZQYXRoLCBuZXh0XSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKHNjaGVtYVR5cGVfMS50eXBlID09PSBcInVuaW9uT3B0aW9uXCIpXG4gICAgICAgICAgICByZXR1cm4gbmV4dCA/IGZpZWxkRnJvbVBhdGgoc2NoZW1hVHlwZV8xLnZhbHVlLCBwYXRoXzAsIHNjaGVtYVR5cGVfMSwgcHJldlBhdGgpIDoge1xuICAgICAgICAgICAgICBmaWVsZDogc2NoZW1hVHlwZV8xLFxuICAgICAgICAgICAgICBwYXJlbnRcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgaWYgKHNjaGVtYVR5cGVfMS50eXBlID09PSBcImlubGluZVwiKSB7XG4gICAgICAgICAgICBjb25zdCB0eXBlXzAgPSBnZXRUeXBlKHNjaGVtYVR5cGVfMS5uYW1lLCBcInR5cGVcIik7XG4gICAgICAgICAgICByZXR1cm4gZmllbGRGcm9tUGF0aCh0eXBlXzAudmFsdWUsIHBhdGhfMCwgc2NoZW1hVHlwZV8xLCBwcmV2UGF0aCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFtAc2FuaXR5L3Zpc3VhbC1lZGl0aW5nXSBObyBmaWVsZCBjb3VsZCBiZSByZXNvbHZlZCBhdCBwYXRoOiBcIiR7Wy4uLnByZXZQYXRoLCAuLi5wYXRoXzBdLmpvaW4oXCIuXCIpfVwiYCk7XG4gICAgfVxuICAgIGNvbnN0IG5vZGVQYXRoID0gbm9kZV8wLnBhdGguc3BsaXQoXCIuXCIpLmZsYXRNYXAoX3RlbXAkNik7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBmaWVsZEZyb21QYXRoKHNjaGVtYVR5cGVfMCwgbm9kZVBhdGgsIHZvaWQgMCk7XG4gICAgfSBjYXRjaCAodDExMikge1xuICAgICAgY29uc3QgZV8wID0gdDExMjtcbiAgICAgIHJldHVybiBlXzAgaW5zdGFuY2VvZiBFcnJvciAmJiBjb25zb2xlLndhcm4oZV8wLm1lc3NhZ2UpLCB7XG4gICAgICAgIGZpZWxkOiB2b2lkIDAsXG4gICAgICAgIHBhcmVudDogdm9pZCAwXG4gICAgICB9O1xuICAgIH1cbiAgfSwgJFsxM10gPSBnZXRUeXBlLCAkWzE0XSA9IHJlc29sdmVkVHlwZXMsICRbMTVdID0gdDkpIDogdDkgPSAkWzE1XTtcbiAgY29uc3QgZ2V0RmllbGQgPSB0OTtcbiAgbGV0IHQxMCwgdDExO1xuICAkWzE2XSAhPT0gZ2V0RmllbGQgfHwgJFsxN10gIT09IGdldFR5cGUgPyAodDExID0ge1xuICAgIGdldEZpZWxkLFxuICAgIGdldFR5cGVcbiAgfSwgJFsxNl0gPSBnZXRGaWVsZCwgJFsxN10gPSBnZXRUeXBlLCAkWzE4XSA9IHQxMSkgOiB0MTEgPSAkWzE4XSwgdDEwID0gdDExO1xuICBjb25zdCBjb250ZXh0ID0gdDEwO1xuICBsZXQgdDEyO1xuICByZXR1cm4gJFsxOV0gIT09IGNoaWxkcmVuIHx8ICRbMjBdICE9PSBjb250ZXh0ID8gKHQxMiA9IC8qIEBfX1BVUkVfXyAqLyBqc3goU2NoZW1hQ29udGV4dC5Qcm92aWRlciwgeyB2YWx1ZTogY29udGV4dCwgY2hpbGRyZW4gfSksICRbMTldID0gY2hpbGRyZW4sICRbMjBdID0gY29udGV4dCwgJFsyMV0gPSB0MTIpIDogdDEyID0gJFsyMV0sIHQxMjtcbn07XG5mdW5jdGlvbiBfdGVtcCQ2KHBhcnQpIHtcbiAgcmV0dXJuIHBhcnQuaW5jbHVkZXMoXCJbXCIpID8gcGFydC5zcGxpdCgvKFxcWy4rXFxdKS8sIDIpIDogW3BhcnRdO1xufVxuY29uc3QgY3JlYXRlU3RvcmUgPSAoaW5pdGlhbFN0YXRlKSA9PiB7XG4gIGxldCBzdGF0ZSA9IGluaXRpYWxTdGF0ZTtcbiAgY29uc3QgZ2V0U3RhdGUgPSAoKSA9PiBzdGF0ZSwgbGlzdGVuZXJzID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKTtcbiAgcmV0dXJuIHtcbiAgICBnZXRTdGF0ZSxcbiAgICBzZXRTdGF0ZTogKGZuKSA9PiB7XG4gICAgICBzdGF0ZSA9IGZuKHN0YXRlKSwgbGlzdGVuZXJzLmZvckVhY2goKGwpID0+IGwoKSk7XG4gICAgfSxcbiAgICBzdWJzY3JpYmU6IChsaXN0ZW5lcikgPT4gKGxpc3RlbmVycy5hZGQobGlzdGVuZXIpLCAoKSA9PiBsaXN0ZW5lcnMuZGVsZXRlKGxpc3RlbmVyKSlcbiAgfTtcbn0sIHN0b3JlID0gY3JlYXRlU3RvcmUoe30pLCBTaGFyZWRTdGF0ZVByb3ZpZGVyID0gKHByb3BzKSA9PiB7XG4gIGNvbnN0ICQgPSBjKDExKSwge1xuICAgIGNvbWxpbmssXG4gICAgY2hpbGRyZW5cbiAgfSA9IHByb3BzO1xuICBsZXQgdDAsIHQxO1xuICAkWzBdICE9PSBjb21saW5rID8gKHQwID0gKCkgPT4gY29tbGluaz8ub24oXCJwcmVzZW50YXRpb24vc2hhcmVkLXN0YXRlXCIsIF90ZW1wJDUpLCB0MSA9IFtjb21saW5rXSwgJFswXSA9IGNvbWxpbmssICRbMV0gPSB0MCwgJFsyXSA9IHQxKSA6ICh0MCA9ICRbMV0sIHQxID0gJFsyXSksIHVzZUVmZmVjdCh0MCwgdDEpO1xuICBsZXQgdDIsIHQzO1xuICAkWzNdICE9PSBjb21saW5rID8gKHQyID0gKCkgPT4ge1xuICAgIChhc3luYyBmdW5jdGlvbigpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gYXdhaXQgY29tbGluaz8uZmV0Y2goXCJ2aXN1YWwtZWRpdGluZy9zaGFyZWQtc3RhdGVcIiwgdm9pZCAwLCB7XG4gICAgICAgIHN1cHByZXNzV2FybmluZ3M6ICEwXG4gICAgICB9KTtcbiAgICAgIHZhbHVlICYmIHN0b3JlLnNldFN0YXRlKCgpID0+IHZhbHVlLnN0YXRlKTtcbiAgICB9KSgpLmNhdGNoKF90ZW1wMiQzKTtcbiAgfSwgdDMgPSBbY29tbGlua10sICRbM10gPSBjb21saW5rLCAkWzRdID0gdDIsICRbNV0gPSB0MykgOiAodDIgPSAkWzRdLCB0MyA9ICRbNV0pLCB1c2VFZmZlY3QodDIsIHQzKTtcbiAgbGV0IHQ0LCB0NTtcbiAgJFs2XSAhPT0gY29tbGluayA/ICh0NSA9IHtcbiAgICBjb21saW5rLFxuICAgIHN0b3JlXG4gIH0sICRbNl0gPSBjb21saW5rLCAkWzddID0gdDUpIDogdDUgPSAkWzddLCB0NCA9IHQ1O1xuICBjb25zdCB2YWx1ZV8wID0gdDQ7XG4gIGxldCB0NjtcbiAgcmV0dXJuICRbOF0gIT09IGNoaWxkcmVuIHx8ICRbOV0gIT09IHZhbHVlXzAgPyAodDYgPSAvKiBAX19QVVJFX18gKi8ganN4KFNoYXJlZFN0YXRlQ29udGV4dC5Qcm92aWRlciwgeyB2YWx1ZTogdmFsdWVfMCwgY2hpbGRyZW4gfSksICRbOF0gPSBjaGlsZHJlbiwgJFs5XSA9IHZhbHVlXzAsICRbMTBdID0gdDYpIDogdDYgPSAkWzEwXSwgdDY7XG59O1xuZnVuY3Rpb24gX3RlbXAkNShkYXRhKSB7XG4gIFwidmFsdWVcIiBpbiBkYXRhID8gc3RvcmUuc2V0U3RhdGUoKHByZXYpID0+ICh7XG4gICAgLi4ucHJldixcbiAgICBbZGF0YS5rZXldOiBkYXRhLnZhbHVlXG4gIH0pKSA6IHN0b3JlLnNldFN0YXRlKChwcmV2XzApID0+IE9iamVjdC5mcm9tRW50cmllcyhPYmplY3QuZW50cmllcyhwcmV2XzApLmZpbHRlcigodDApID0+IHtcbiAgICBjb25zdCBba2V5XSA9IHQwO1xuICAgIHJldHVybiBrZXkgIT09IGRhdGEua2V5O1xuICB9KSkpO1xufVxuZnVuY3Rpb24gX3RlbXAyJDMocmVhc29uKSB7XG4gIGNvbnNvbGUuZGVidWcocmVhc29uKSwgY29uc29sZS53YXJuKFwiW0BzYW5pdHkvdmlzdWFsLWVkaXRpbmddOiBGYWlsZWQgdG8gZmV0Y2ggc2hhcmVkIHN0YXRlLiBDaGVjayB5b3VyIHZlcnNpb24gb2YgYHNhbml0eWAgaXMgdXAtdG8tZGF0ZVwiKTtcbn1cbmNvbnN0IFRlbGVtZXRyeVByb3ZpZGVyID0gKHQwKSA9PiB7XG4gIGNvbnN0ICQgPSBjKDUpLCB7XG4gICAgY2hpbGRyZW4sXG4gICAgY29tbGlua1xuICB9ID0gdDA7XG4gIGxldCB0MTtcbiAgJFswXSAhPT0gY29tbGluayA/ICh0MSA9IChuYW1lLCBkYXRhKSA9PiB7XG4gICAgaWYgKCFjb21saW5rKVxuICAgICAgcmV0dXJuO1xuICAgIGNvbnN0IGV2ZW50ID0gZXZlbnRzW25hbWVdO1xuICAgIGlmIChldmVudClcbiAgICAgIGNvbWxpbmsucG9zdChcInZpc3VhbC1lZGl0aW5nL3RlbGVtZXRyeS1sb2dcIiwge1xuICAgICAgICBldmVudCxcbiAgICAgICAgZGF0YVxuICAgICAgfSk7XG4gICAgZWxzZVxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBUZWxlbWV0cnkgZXZlbnQ6ICR7bmFtZX0gZG9lcyBub3QgZXhpc3RgKTtcbiAgfSwgJFswXSA9IGNvbWxpbmssICRbMV0gPSB0MSkgOiB0MSA9ICRbMV07XG4gIGNvbnN0IGxvZyA9IHQxO1xuICBsZXQgdDI7XG4gIHJldHVybiAkWzJdICE9PSBjaGlsZHJlbiB8fCAkWzNdICE9PSBsb2cgPyAodDIgPSAvKiBAX19QVVJFX18gKi8ganN4KFRlbGVtZXRyeUNvbnRleHQuUHJvdmlkZXIsIHsgdmFsdWU6IGxvZywgY2hpbGRyZW4gfSksICRbMl0gPSBjaGlsZHJlbiwgJFszXSA9IGxvZywgJFs0XSA9IHQyKSA6IHQyID0gJFs0XSwgdDI7XG59O1xuZnVuY3Rpb24gdXNlQ29udHJvbGxlcihlbGVtZW50LCBoYW5kbGVyLCBpbkZyYW1lLCBpblBvcFVwKSB7XG4gIGNvbnN0ICQgPSBjKDcpLCBvdmVybGF5Q29udHJvbGxlciA9IHVzZVJlZih2b2lkIDApLCBvcHRpbWlzdGljQWN0b3JSZWFkeSA9IHVzZU9wdGltaXN0aWNBY3RvclJlYWR5KCk7XG4gIGxldCB0MCwgdDE7XG4gIHJldHVybiAkWzBdICE9PSBlbGVtZW50IHx8ICRbMV0gIT09IGhhbmRsZXIgfHwgJFsyXSAhPT0gaW5GcmFtZSB8fCAkWzNdICE9PSBpblBvcFVwIHx8ICRbNF0gIT09IG9wdGltaXN0aWNBY3RvclJlYWR5ID8gKHQwID0gKCkgPT4ge1xuICAgIGlmIChlbGVtZW50KVxuICAgICAgcmV0dXJuIG92ZXJsYXlDb250cm9sbGVyLmN1cnJlbnQgPSBjcmVhdGVPdmVybGF5Q29udHJvbGxlcih7XG4gICAgICAgIGhhbmRsZXIsXG4gICAgICAgIG92ZXJsYXlFbGVtZW50OiBlbGVtZW50LFxuICAgICAgICBpbkZyYW1lLFxuICAgICAgICBpblBvcFVwLFxuICAgICAgICBvcHRpbWlzdGljQWN0b3JSZWFkeVxuICAgICAgfSksICgpID0+IHtcbiAgICAgICAgb3ZlcmxheUNvbnRyb2xsZXIuY3VycmVudD8uZGVzdHJveSgpLCBvdmVybGF5Q29udHJvbGxlci5jdXJyZW50ID0gdm9pZCAwO1xuICAgICAgfTtcbiAgfSwgdDEgPSBbZWxlbWVudCwgaGFuZGxlciwgaW5GcmFtZSwgaW5Qb3BVcCwgb3B0aW1pc3RpY0FjdG9yUmVhZHldLCAkWzBdID0gZWxlbWVudCwgJFsxXSA9IGhhbmRsZXIsICRbMl0gPSBpbkZyYW1lLCAkWzNdID0gaW5Qb3BVcCwgJFs0XSA9IG9wdGltaXN0aWNBY3RvclJlYWR5LCAkWzVdID0gdDAsICRbNl0gPSB0MSkgOiAodDAgPSAkWzVdLCB0MSA9ICRbNl0pLCB1c2VFZmZlY3QodDAsIHQxKSwgb3ZlcmxheUNvbnRyb2xsZXI7XG59XG5mdW5jdGlvbiB1c2VQZXJzcGVjdGl2ZVN5bmMoY29tbGluaywgZGlzcGF0Y2gpIHtcbiAgY29uc3QgJCA9IGMoNCk7XG4gIGxldCB0MCwgdDE7XG4gICRbMF0gIT09IGNvbWxpbmsgfHwgJFsxXSAhPT0gZGlzcGF0Y2ggPyAodDAgPSAoKSA9PiB7XG4gICAgY29uc3QgY29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcbiAgICBjb21saW5rPy5mZXRjaChcInZpc3VhbC1lZGl0aW5nL2ZldGNoLXBlcnNwZWN0aXZlXCIsIHZvaWQgMCwge1xuICAgICAgc2lnbmFsOiBjb250cm9sbGVyLnNpZ25hbCxcbiAgICAgIHN1cHByZXNzV2FybmluZ3M6ICEwXG4gICAgfSkudGhlbigoZGF0YSkgPT4ge1xuICAgICAgZGlzcGF0Y2goe1xuICAgICAgICB0eXBlOiBcInByZXNlbnRhdGlvbi9wZXJzcGVjdGl2ZVwiLFxuICAgICAgICBkYXRhXG4gICAgICB9KTtcbiAgICB9KS5jYXRjaChfdGVtcCQ0KTtcbiAgICBjb25zdCB1bnN1YiA9IGNvbWxpbms/Lm9uKFwicHJlc2VudGF0aW9uL3BlcnNwZWN0aXZlXCIsIChkYXRhXzApID0+IHtcbiAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgdHlwZTogXCJwcmVzZW50YXRpb24vcGVyc3BlY3RpdmVcIixcbiAgICAgICAgZGF0YTogZGF0YV8wXG4gICAgICB9KTtcbiAgICB9KTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgdW5zdWI/LigpLCBjb250cm9sbGVyLmFib3J0KCk7XG4gICAgfTtcbiAgfSwgdDEgPSBbY29tbGluaywgZGlzcGF0Y2hdLCAkWzBdID0gY29tbGluaywgJFsxXSA9IGRpc3BhdGNoLCAkWzJdID0gdDAsICRbM10gPSB0MSkgOiAodDAgPSAkWzJdLCB0MSA9ICRbM10pLCB1c2VFZmZlY3QodDAsIHQxKTtcbn1cbmZ1bmN0aW9uIF90ZW1wJDQoKSB7XG59XG5mdW5jdGlvbiBpc0VxdWFsU2V0cyhhLCBiKSB7XG4gIGlmIChhID09PSBiKSByZXR1cm4gITA7XG4gIGlmIChhLnNpemUgIT09IGIuc2l6ZSkgcmV0dXJuICExO1xuICBmb3IgKGNvbnN0IHZhbHVlIG9mIGEpIGlmICghYi5oYXModmFsdWUpKSByZXR1cm4gITE7XG4gIHJldHVybiAhMDtcbn1cbmZ1bmN0aW9uIHVzZVJlcG9ydERvY3VtZW50cyhjb21saW5rLCBlbGVtZW50cywgcGVyc3BlY3RpdmUpIHtcbiAgY29uc3QgJCA9IGMoNyksIGxhc3RSZXBvcnRlZCA9IHVzZVJlZih2b2lkIDApO1xuICBsZXQgdDA7XG4gICRbMF0gIT09IGNvbWxpbmsgPyAodDAgPSAoZG9jdW1lbnRzLCBwZXJzcGVjdGl2ZV8wKSA9PiB7XG4gICAgY29tbGluaz8ucG9zdChcInZpc3VhbC1lZGl0aW5nL2RvY3VtZW50c1wiLCB7XG4gICAgICBkb2N1bWVudHMsXG4gICAgICBwZXJzcGVjdGl2ZTogcGVyc3BlY3RpdmVfMFxuICAgIH0pO1xuICB9LCAkWzBdID0gY29tbGluaywgJFsxXSA9IHQwKSA6IHQwID0gJFsxXTtcbiAgY29uc3QgcmVwb3J0RG9jdW1lbnRzID0gdDA7XG4gIGxldCB0MSwgdDI7XG4gICRbMl0gIT09IGVsZW1lbnRzIHx8ICRbM10gIT09IHBlcnNwZWN0aXZlIHx8ICRbNF0gIT09IHJlcG9ydERvY3VtZW50cyA/ICh0MSA9ICgpID0+IHtcbiAgICBjb25zdCBub2RlcyA9IGVsZW1lbnRzLm1hcChfdGVtcCQzKS5maWx0ZXIoX3RlbXAyJDIpLCBub2RlSWRzID0gbmV3IFNldChub2Rlcy5tYXAoX3RlbXAzJDEpKTtcbiAgICBpZiAoIWxhc3RSZXBvcnRlZC5jdXJyZW50IHx8ICFpc0VxdWFsU2V0cyhub2RlSWRzLCBsYXN0UmVwb3J0ZWQuY3VycmVudC5ub2RlSWRzKSB8fCBwZXJzcGVjdGl2ZSAhPT0gbGFzdFJlcG9ydGVkLmN1cnJlbnQucGVyc3BlY3RpdmUpIHtcbiAgICAgIGNvbnN0IGRvY3VtZW50c09uUGFnZSA9IEFycmF5LmZyb20obm9kZUlkcykubWFwKChfaWQpID0+IHtcbiAgICAgICAgY29uc3Qgbm9kZV8wID0gbm9kZXMuZmluZCgobm9kZSkgPT4gbm9kZS5pZCA9PT0gX2lkKSwge1xuICAgICAgICAgIHR5cGUsXG4gICAgICAgICAgcHJvamVjdElkOiBfcHJvamVjdElkLFxuICAgICAgICAgIGRhdGFzZXQ6IF9kYXRhc2V0XG4gICAgICAgIH0gPSBub2RlXzA7XG4gICAgICAgIHJldHVybiBfcHJvamVjdElkICYmIF9kYXRhc2V0ID8ge1xuICAgICAgICAgIF9pZCxcbiAgICAgICAgICBfdHlwZTogdHlwZSxcbiAgICAgICAgICBfcHJvamVjdElkLFxuICAgICAgICAgIF9kYXRhc2V0XG4gICAgICAgIH0gOiB7XG4gICAgICAgICAgX2lkLFxuICAgICAgICAgIF90eXBlOiB0eXBlXG4gICAgICAgIH07XG4gICAgICB9KTtcbiAgICAgIGxhc3RSZXBvcnRlZC5jdXJyZW50ID0ge1xuICAgICAgICBub2RlSWRzLFxuICAgICAgICBwZXJzcGVjdGl2ZVxuICAgICAgfSwgcmVwb3J0RG9jdW1lbnRzKGRvY3VtZW50c09uUGFnZSwgcGVyc3BlY3RpdmUpO1xuICAgIH1cbiAgfSwgdDIgPSBbZWxlbWVudHMsIHBlcnNwZWN0aXZlLCByZXBvcnREb2N1bWVudHNdLCAkWzJdID0gZWxlbWVudHMsICRbM10gPSBwZXJzcGVjdGl2ZSwgJFs0XSA9IHJlcG9ydERvY3VtZW50cywgJFs1XSA9IHQxLCAkWzZdID0gdDIpIDogKHQxID0gJFs1XSwgdDIgPSAkWzZdKSwgdXNlRWZmZWN0KHQxLCB0Mik7XG59XG5mdW5jdGlvbiBfdGVtcDMkMShlXzApIHtcbiAgcmV0dXJuIGVfMC5pZDtcbn1cbmZ1bmN0aW9uIF90ZW1wMiQyKHMpIHtcbiAgcmV0dXJuICEhcztcbn1cbmZ1bmN0aW9uIF90ZW1wJDMoZSkge1xuICBjb25zdCB7XG4gICAgc2FuaXR5XG4gIH0gPSBlO1xuICByZXR1cm4gXCJpZFwiIGluIHNhbml0eSA/IHNhbml0eSA6IG51bGw7XG59XG5jb25zdCBSb290ID0gc3R5bGVkLmRpdmBcbiAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7XG4gIGRpcmVjdGlvbjogbHRyO1xuICBpbnNldDogMDtcbiAgcG9pbnRlci1ldmVudHM6IG5vbmU7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgd2lkdGg6IDEwMCU7XG4gIGhlaWdodDogMTAwJTtcbiAgei1pbmRleDogJHsoe1xuICAkekluZGV4XG59KSA9PiAkekluZGV4ID8/IFwiOTk5OTk5OVwifTtcbmA7XG5mdW5jdGlvbiByYWYyKGZuKSB7XG4gIGxldCByMCwgcjE7XG4gIHJldHVybiByMCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgcjEgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZm4pO1xuICB9KSwgKCkgPT4ge1xuICAgIHIwICE9PSB2b2lkIDAgJiYgY2FuY2VsQW5pbWF0aW9uRnJhbWUocjApLCByMSAhPT0gdm9pZCAwICYmIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHIxKTtcbiAgfTtcbn1cbmNvbnN0IERvY3VtZW50UmVwb3J0ZXIgPSAocHJvcHMpID0+IHtcbiAgY29uc3QgJCA9IGMoOCksIHtcbiAgICBkb2N1bWVudElkc1xuICB9ID0gcHJvcHM7XG4gIGxldCB0MDtcbiAgJFswXSA9PT0gU3ltYm9sLmZvcihcInJlYWN0Lm1lbW9fY2FjaGVfc2VudGluZWxcIikgPyAodDAgPSBbXSwgJFswXSA9IHQwKSA6IHQwID0gJFswXTtcbiAgY29uc3QgW3VuaXF1ZUlkcywgc2V0VW5pcXVlSWRzXSA9IHVzZVN0YXRlKHQwKTtcbiAgbGV0IHQxLCB0MjtcbiAgJFsxXSAhPT0gZG9jdW1lbnRJZHMgPyAodDEgPSAoKSA9PiB7XG4gICAgc2V0VW5pcXVlSWRzKChwcmV2KSA9PiB7XG4gICAgICBjb25zdCBuZXh0ID0gQXJyYXkuZnJvbShuZXcgU2V0KGRvY3VtZW50SWRzKSk7XG4gICAgICByZXR1cm4gcHJldi5sZW5ndGggPT09IG5leHQubGVuZ3RoICYmIHByZXYucmVkdWNlKF90ZW1wJDIsIG5leHQpPy5sZW5ndGggPT09IDAgPyBwcmV2IDogbmV4dDtcbiAgICB9KTtcbiAgfSwgdDIgPSBbZG9jdW1lbnRJZHNdLCAkWzFdID0gZG9jdW1lbnRJZHMsICRbMl0gPSB0MSwgJFszXSA9IHQyKSA6ICh0MSA9ICRbMl0sIHQyID0gJFszXSksIHVzZUVmZmVjdCh0MSwgdDIpO1xuICBjb25zdCBhY3RvciA9IHVzZU9wdGltaXN0aWNBY3RvcigpO1xuICBsZXQgdDMsIHQ0O1xuICByZXR1cm4gJFs0XSAhPT0gYWN0b3IgfHwgJFs1XSAhPT0gdW5pcXVlSWRzID8gKHQzID0gKCkgPT4ge1xuICAgIGZvciAoY29uc3QgaWRfMCBvZiB1bmlxdWVJZHMpXG4gICAgICBhY3Rvci5zZW5kKHtcbiAgICAgICAgdHlwZTogXCJvYnNlcnZlXCIsXG4gICAgICAgIGRvY3VtZW50SWQ6IGdldERyYWZ0SWQoaWRfMClcbiAgICAgIH0pLCBhY3Rvci5zZW5kKHtcbiAgICAgICAgdHlwZTogXCJvYnNlcnZlXCIsXG4gICAgICAgIGRvY3VtZW50SWQ6IGdldFB1Ymxpc2hlZElkKGlkXzApXG4gICAgICB9KTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgZm9yIChjb25zdCBpZF8xIG9mIHVuaXF1ZUlkcylcbiAgICAgICAgYWN0b3Iuc2VuZCh7XG4gICAgICAgICAgdHlwZTogXCJ1bm9ic2VydmVcIixcbiAgICAgICAgICBkb2N1bWVudElkOiBnZXREcmFmdElkKGlkXzEpXG4gICAgICAgIH0pLCBhY3Rvci5zZW5kKHtcbiAgICAgICAgICB0eXBlOiBcInVub2JzZXJ2ZVwiLFxuICAgICAgICAgIGRvY3VtZW50SWQ6IGdldFB1Ymxpc2hlZElkKGlkXzEpXG4gICAgICAgIH0pO1xuICAgIH07XG4gIH0sIHQ0ID0gW2FjdG9yLCB1bmlxdWVJZHNdLCAkWzRdID0gYWN0b3IsICRbNV0gPSB1bmlxdWVJZHMsICRbNl0gPSB0MywgJFs3XSA9IHQ0KSA6ICh0MyA9ICRbNl0sIHQ0ID0gJFs3XSksIHVzZUVmZmVjdCh0MywgdDQpLCBudWxsO1xufSwgT3ZlcmxheXNDb250cm9sbGVyID0gKHByb3BzKSA9PiB7XG4gIGNvbnN0ICQgPSBjKDEyKSwge1xuICAgIGNvbWxpbmssXG4gICAgZGlzcGF0Y2gsXG4gICAgaW5GcmFtZSxcbiAgICBpblBvcFVwLFxuICAgIG9uRHJhZyxcbiAgICBvdmVybGF5RW5hYmxlZCxcbiAgICByb290RWxlbWVudFxuICB9ID0gcHJvcHMsIHtcbiAgICBkaXNwYXRjaERyYWdFbmRFdmVudFxuICB9ID0gdXNlRHJhZ0VuZEV2ZW50cygpLCBzZW5kVGVsZW1ldHJ5ID0gdXNlVGVsZW1ldHJ5KCk7XG4gIGxldCB0MDtcbiAgJFswXSAhPT0gY29tbGluayB8fCAkWzFdICE9PSBkaXNwYXRjaCB8fCAkWzJdICE9PSBkaXNwYXRjaERyYWdFbmRFdmVudCB8fCAkWzNdICE9PSBvbkRyYWcgfHwgJFs0XSAhPT0gc2VuZFRlbGVtZXRyeSA/ICh0MCA9IChtZXNzYWdlKSA9PiB7XG4gICAgaWYgKG1lc3NhZ2UudHlwZSA9PT0gXCJlbGVtZW50L2NsaWNrXCIpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgc2FuaXR5XG4gICAgICB9ID0gbWVzc2FnZTtcbiAgICAgIGNvbWxpbms/LnBvc3QoXCJ2aXN1YWwtZWRpdGluZy9mb2N1c1wiLCBzYW5pdHkpLCBzZW5kVGVsZW1ldHJ5KFwiVmlzdWFsIEVkaXRpbmcgT3ZlcmxheSBDbGlja2VkXCIsIG51bGwpO1xuICAgIH0gZWxzZSBpZiAobWVzc2FnZS50eXBlID09PSBcIm92ZXJsYXkvYWN0aXZhdGVcIilcbiAgICAgIGNvbWxpbms/LnBvc3QoXCJ2aXN1YWwtZWRpdGluZy90b2dnbGVcIiwge1xuICAgICAgICBlbmFibGVkOiAhMFxuICAgICAgfSk7XG4gICAgZWxzZSBpZiAobWVzc2FnZS50eXBlID09PSBcIm92ZXJsYXkvZGVhY3RpdmF0ZVwiKVxuICAgICAgY29tbGluaz8ucG9zdChcInZpc3VhbC1lZGl0aW5nL3RvZ2dsZVwiLCB7XG4gICAgICAgIGVuYWJsZWQ6ICExXG4gICAgICB9KTtcbiAgICBlbHNlIGlmIChtZXNzYWdlLnR5cGUgPT09IFwib3ZlcmxheS9kcmFnRW5kXCIpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgaW5zZXJ0UG9zaXRpb24sXG4gICAgICAgIHRhcmdldCxcbiAgICAgICAgZHJhZ0dyb3VwLFxuICAgICAgICBmbG93LFxuICAgICAgICBwcmV2ZW50SW5zZXJ0RGVmYXVsdFxuICAgICAgfSA9IG1lc3NhZ2U7XG4gICAgICBkaXNwYXRjaERyYWdFbmRFdmVudCh7XG4gICAgICAgIGluc2VydFBvc2l0aW9uLFxuICAgICAgICB0YXJnZXQsXG4gICAgICAgIGRyYWdHcm91cCxcbiAgICAgICAgZmxvdyxcbiAgICAgICAgcHJldmVudEluc2VydERlZmF1bHRcbiAgICAgIH0pLCBpbnNlcnRQb3NpdGlvbiAmJiBzZW5kVGVsZW1ldHJ5KFwiVmlzdWFsIEVkaXRpbmcgRHJhZyBTZXF1ZW5jZSBDb21wbGV0ZWRcIiwgbnVsbCk7XG4gICAgfSBlbHNlIGlmIChtZXNzYWdlLnR5cGUgPT09IFwib3ZlcmxheS9kcmFnVXBkYXRlQ3Vyc29yUG9zaXRpb25cIikge1xuICAgICAgb25EcmFnKG1lc3NhZ2UueCwgbWVzc2FnZS55KTtcbiAgICAgIHJldHVybjtcbiAgICB9IGVsc2UgaWYgKG1lc3NhZ2UudHlwZSA9PT0gXCJvdmVybGF5L2RyYWdUb2dnbGVNaW5pbWFwXCIgJiYgbWVzc2FnZS5kaXNwbGF5ID09PSAhMClcbiAgICAgIHNlbmRUZWxlbWV0cnkoXCJWaXN1YWwgRWRpdGluZyBEcmFnIE1pbmltYXAgRW5hYmxlZFwiLCBudWxsKTtcbiAgICBlbHNlIGlmIChtZXNzYWdlLnR5cGUgPT09IFwib3ZlcmxheS9zZXRDdXJzb3JcIikge1xuICAgICAgY29uc3Qge1xuICAgICAgICBlbGVtZW50LFxuICAgICAgICBjdXJzb3JcbiAgICAgIH0gPSBtZXNzYWdlO1xuICAgICAgY3Vyc29yID8gZWxlbWVudC5zdHlsZS5jdXJzb3IgPSBjdXJzb3IgOiBlbGVtZW50LnN0eWxlLnJlbW92ZVByb3BlcnR5KFwiY3Vyc29yXCIpO1xuICAgIH1cbiAgICBkaXNwYXRjaChtZXNzYWdlKTtcbiAgfSwgJFswXSA9IGNvbWxpbmssICRbMV0gPSBkaXNwYXRjaCwgJFsyXSA9IGRpc3BhdGNoRHJhZ0VuZEV2ZW50LCAkWzNdID0gb25EcmFnLCAkWzRdID0gc2VuZFRlbGVtZXRyeSwgJFs1XSA9IHQwKSA6IHQwID0gJFs1XTtcbiAgY29uc3QgY29udHJvbGxlciA9IHVzZUNvbnRyb2xsZXIocm9vdEVsZW1lbnQsIHQwLCBpbkZyYW1lLCBpblBvcFVwKTtcbiAgbGV0IHQxO1xuICAkWzZdICE9PSBjb250cm9sbGVyLmN1cnJlbnQgfHwgJFs3XSAhPT0gb3ZlcmxheUVuYWJsZWQgPyAodDEgPSAoKSA9PiB7XG4gICAgb3ZlcmxheUVuYWJsZWQgPyBjb250cm9sbGVyLmN1cnJlbnQ/LmFjdGl2YXRlKCkgOiBjb250cm9sbGVyLmN1cnJlbnQ/LmRlYWN0aXZhdGUoKTtcbiAgfSwgJFs2XSA9IGNvbnRyb2xsZXIuY3VycmVudCwgJFs3XSA9IG92ZXJsYXlFbmFibGVkLCAkWzhdID0gdDEpIDogdDEgPSAkWzhdO1xuICBsZXQgdDI7XG4gIHJldHVybiAkWzldICE9PSBjb250cm9sbGVyIHx8ICRbMTBdICE9PSBvdmVybGF5RW5hYmxlZCA/ICh0MiA9IFtjb250cm9sbGVyLCBvdmVybGF5RW5hYmxlZF0sICRbOV0gPSBjb250cm9sbGVyLCAkWzEwXSA9IG92ZXJsYXlFbmFibGVkLCAkWzExXSA9IHQyKSA6IHQyID0gJFsxMV0sIHVzZUVmZmVjdCh0MSwgdDIpLCBudWxsO1xufSwgT3ZlcmxheXMgPSAocHJvcHMpID0+IHtcbiAgY29uc3QgJCA9IGMoNzQpLCB7XG4gICAgY29tbGluayxcbiAgICBjb21saW5rU3RhdHVzLFxuICAgIGNvbXBvbmVudFJlc29sdmVyOiBfY29tcG9uZW50UmVzb2x2ZXIsXG4gICAgaW5GcmFtZSxcbiAgICBpblBvcFVwLFxuICAgIHpJbmRleFxuICB9ID0gcHJvcHMsIHByZWZlcnNEYXJrID0gdXNlUHJlZmVyc0RhcmsoKTtcbiAgbGV0IHQwO1xuICAkWzBdID09PSBTeW1ib2wuZm9yKFwicmVhY3QubWVtb19jYWNoZV9zZW50aW5lbFwiKSA/ICh0MCA9IHtcbiAgICBjb250ZXh0TWVudTogbnVsbCxcbiAgICBkcmFnSW5zZXJ0UG9zaXRpb246IG51bGwsXG4gICAgZHJhZ1Nob3dNaW5pbWFwOiAhMSxcbiAgICBkcmFnU2hvd01pbmltYXBQcm9tcHQ6ICExLFxuICAgIGRyYWdTa2VsZXRvbjogbnVsbCxcbiAgICBlbGVtZW50czogW10sXG4gICAgZm9jdXNQYXRoOiBcIlwiLFxuICAgIGlzRHJhZ2dpbmc6ICExLFxuICAgIHBlcnNwZWN0aXZlOiBcInB1Ymxpc2hlZFwiLFxuICAgIHdhc01heWJlQ29sbGFwc2VkOiAhMSxcbiAgICBkcmFnTWluaW1hcFRyYW5zaXRpb246ICExLFxuICAgIGRyYWdHcm91cFJlY3Q6IG51bGxcbiAgfSwgJFswXSA9IHQwKSA6IHQwID0gJFswXTtcbiAgY29uc3QgW3QxLCBkaXNwYXRjaF0gPSB1c2VSZWR1Y2VyKG92ZXJsYXlTdGF0ZVJlZHVjZXIsIHQwKSwge1xuICAgIGNvbnRleHRNZW51LFxuICAgIGRyYWdJbnNlcnRQb3NpdGlvbixcbiAgICBkcmFnU2hvd01pbmltYXAsXG4gICAgZHJhZ1Nob3dNaW5pbWFwUHJvbXB0LFxuICAgIGRyYWdTa2VsZXRvbixcbiAgICBlbGVtZW50cyxcbiAgICBpc0RyYWdnaW5nLFxuICAgIHBlcnNwZWN0aXZlLFxuICAgIHdhc01heWJlQ29sbGFwc2VkLFxuICAgIGRyYWdNaW5pbWFwVHJhbnNpdGlvbixcbiAgICBkcmFnR3JvdXBSZWN0XG4gIH0gPSB0MSwgW3Jvb3RFbGVtZW50LCBzZXRSb290RWxlbWVudF0gPSB1c2VTdGF0ZShudWxsKSwgW292ZXJsYXlFbmFibGVkLCBzZXRPdmVybGF5RW5hYmxlZF0gPSB1c2VTdGF0ZSghMCk7XG4gIGxldCB0MiwgdDM7XG4gICRbMV0gIT09IGNvbWxpbmsgPyAodDIgPSAoKSA9PiB7XG4gICAgY29uc3QgdW5zdWJzID0gW2NvbWxpbms/Lm9uKFwicHJlc2VudGF0aW9uL2ZvY3VzXCIsIChkYXRhKSA9PiB7XG4gICAgICBkaXNwYXRjaCh7XG4gICAgICAgIHR5cGU6IFwicHJlc2VudGF0aW9uL2ZvY3VzXCIsXG4gICAgICAgIGRhdGFcbiAgICAgIH0pO1xuICAgIH0pLCBjb21saW5rPy5vbihcInByZXNlbnRhdGlvbi9ibHVyXCIsIChkYXRhXzApID0+IHtcbiAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgdHlwZTogXCJwcmVzZW50YXRpb24vYmx1clwiLFxuICAgICAgICBkYXRhOiBkYXRhXzBcbiAgICAgIH0pO1xuICAgIH0pLCBjb21saW5rPy5vbihcInByZXNlbnRhdGlvbi90b2dnbGUtb3ZlcmxheVwiLCAoKSA9PiB7XG4gICAgICBzZXRPdmVybGF5RW5hYmxlZChfdGVtcDIkMSk7XG4gICAgfSldLmZpbHRlcihCb29sZWFuKTtcbiAgICByZXR1cm4gKCkgPT4gdW5zdWJzLmZvckVhY2goX3RlbXAzKTtcbiAgfSwgdDMgPSBbY29tbGlua10sICRbMV0gPSBjb21saW5rLCAkWzJdID0gdDIsICRbM10gPSB0MykgOiAodDIgPSAkWzJdLCB0MyA9ICRbM10pLCB1c2VFZmZlY3QodDIsIHQzKSwgdXNlUGVyc3BlY3RpdmVTeW5jKGNvbWxpbmssIGRpc3BhdGNoKSwgdXNlUmVwb3J0RG9jdW1lbnRzKGNvbWxpbmssIGVsZW1lbnRzLCBwZXJzcGVjdGl2ZSk7XG4gIGxldCB0NDtcbiAgJFs0XSAhPT0gcm9vdEVsZW1lbnQgPyAodDQgPSAoeCwgeSkgPT4ge1xuICAgIHJvb3RFbGVtZW50ICYmIChyb290RWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eShcIi0tZHJhZy1wcmV2aWV3LXhcIiwgYCR7eH1weGApLCByb290RWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eShcIi0tZHJhZy1wcmV2aWV3LXlcIiwgYCR7eSAtIHdpbmRvdy5zY3JvbGxZfXB4YCkpO1xuICB9LCAkWzRdID0gcm9vdEVsZW1lbnQsICRbNV0gPSB0NCkgOiB0NCA9ICRbNV07XG4gIGNvbnN0IHVwZGF0ZURyYWdQcmV2aWV3Q3VzdG9tUHJvcHMgPSB0NDtcbiAgbGV0IHQ1LCB0NjtcbiAgJFs2XSA9PT0gU3ltYm9sLmZvcihcInJlYWN0Lm1lbW9fY2FjaGVfc2VudGluZWxcIikgPyAodDUgPSAoKSA9PiB7XG4gICAgY29uc3QgaGFuZGxlQ2xpY2sgPSBfdGVtcDQsIGhhbmRsZUtleVVwID0gKGUpID0+IHtcbiAgICAgIGlzQWx0S2V5KGUpICYmIHNldE92ZXJsYXlFbmFibGVkKF90ZW1wNSk7XG4gICAgfSwgaGFuZGxlS2V5ZG93biA9IChlXzApID0+IHtcbiAgICAgIGlzQWx0S2V5KGVfMCkgJiYgc2V0T3ZlcmxheUVuYWJsZWQoX3RlbXA2KSwgaXNIb3RrZXkoW1wibW9kXCIsIFwiXFxcXFwiXSwgZV8wKSAmJiBzZXRPdmVybGF5RW5hYmxlZChfdGVtcDcpO1xuICAgIH07XG4gICAgcmV0dXJuIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlQ2xpY2spLCB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlS2V5ZG93biksIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgaGFuZGxlS2V5VXApLCAoKSA9PiB7XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUNsaWNrKSwgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUtleWRvd24pLCB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIGhhbmRsZUtleVVwKTtcbiAgICB9O1xuICB9LCB0NiA9IFtzZXRPdmVybGF5RW5hYmxlZF0sICRbNl0gPSB0NSwgJFs3XSA9IHQ2KSA6ICh0NSA9ICRbNl0sIHQ2ID0gJFs3XSksIHVzZUVmZmVjdCh0NSwgdDYpO1xuICBjb25zdCBbb3ZlcmxheXNGbGFzaCwgc2V0T3ZlcmxheXNGbGFzaF0gPSB1c2VTdGF0ZSghMSksIFtmYWRpbmdPdXQsIHNldEZhZGluZ091dF0gPSB1c2VTdGF0ZSghMSksIGZhZGVPdXRUaW1lb3V0UmVmID0gdXNlUmVmKHZvaWQgMCk7XG4gIGxldCB0NywgdDg7XG4gICRbOF0gIT09IG92ZXJsYXlFbmFibGVkID8gKHQ3ID0gKCkgPT4ge1xuICAgIGlmIChvdmVybGF5RW5hYmxlZClcbiAgICAgIHJldHVybiByYWYyKCgpID0+IHtcbiAgICAgICAgc2V0T3ZlcmxheXNGbGFzaCghMCksIHJhZjIoKCkgPT4ge1xuICAgICAgICAgIHNldEZhZGluZ091dCghMCksIGZhZGVPdXRUaW1lb3V0UmVmLmN1cnJlbnQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHNldEZhZGluZ091dCghMSksIHNldE92ZXJsYXlzRmxhc2goITEpO1xuICAgICAgICAgIH0sIDE1MDApO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIGZhZGVPdXRUaW1lb3V0UmVmLmN1cnJlbnQgJiYgKGNsZWFyVGltZW91dChmYWRlT3V0VGltZW91dFJlZi5jdXJyZW50KSwgc2V0T3ZlcmxheXNGbGFzaCghMSksIHNldEZhZGluZ091dCghMSkpO1xuICB9LCB0OCA9IFtvdmVybGF5RW5hYmxlZF0sICRbOF0gPSBvdmVybGF5RW5hYmxlZCwgJFs5XSA9IHQ3LCAkWzEwXSA9IHQ4KSA6ICh0NyA9ICRbOV0sIHQ4ID0gJFsxMF0pLCB1c2VFZmZlY3QodDcsIHQ4KTtcbiAgbGV0IHQ5LCB0MTA7XG4gICRbMTFdICE9PSBlbGVtZW50cyA/ICh0MTAgPSBlbGVtZW50cy5mbGF0TWFwKF90ZW1wOCksICRbMTFdID0gZWxlbWVudHMsICRbMTJdID0gdDEwKSA6IHQxMCA9ICRbMTJdLCB0OSA9IHQxMDtcbiAgY29uc3QgZG9jdW1lbnRJZHMgPSB0OTtcbiAgbGV0IHQxMTtcbiAgJFsxM10gPT09IFN5bWJvbC5mb3IoXCJyZWFjdC5tZW1vX2NhY2hlX3NlbnRpbmVsXCIpID8gKHQxMSA9ICgpID0+IHtcbiAgICBkaXNwYXRjaCh7XG4gICAgICB0eXBlOiBcIm92ZXJsYXkvYmx1clwiXG4gICAgfSk7XG4gIH0sICRbMTNdID0gdDExKSA6IHQxMSA9ICRbMTNdO1xuICBjb25zdCBjbG9zZUNvbnRleHRNZW51ID0gdDExLCBvcHRpbWlzdGljQWN0b3JSZWFkeSA9IHVzZU9wdGltaXN0aWNBY3RvclJlYWR5KCk7XG4gIGxldCB0MTI7XG4gIHQxMiA9IG9wdGltaXN0aWNBY3RvclJlYWR5ID8gX2NvbXBvbmVudFJlc29sdmVyIDogdm9pZCAwO1xuICBjb25zdCBjb21wb25lbnRSZXNvbHZlciA9IHQxMjtcbiAgbGV0IHQxMztcbiAgYmIwOiB7XG4gICAgaWYgKChpbkZyYW1lIHx8IGluUG9wVXApICYmIGNvbWxpbmtTdGF0dXMgIT09IFwiY29ubmVjdGVkXCIgfHwgaXNEcmFnZ2luZykge1xuICAgICAgbGV0IHQxNDM7XG4gICAgICAkWzE0XSA9PT0gU3ltYm9sLmZvcihcInJlYWN0Lm1lbW9fY2FjaGVfc2VudGluZWxcIikgPyAodDE0MyA9IFtdLCAkWzE0XSA9IHQxNDMpIDogdDE0MyA9ICRbMTRdLCB0MTMgPSB0MTQzO1xuICAgICAgYnJlYWsgYmIwO1xuICAgIH1cbiAgICBsZXQgdDE0MjtcbiAgICAkWzE1XSAhPT0gY29tcG9uZW50UmVzb2x2ZXIgfHwgJFsxNl0gIT09IGRyYWdNaW5pbWFwVHJhbnNpdGlvbiB8fCAkWzE3XSAhPT0gZHJhZ1Nob3dNaW5pbWFwIHx8ICRbMThdICE9PSBlbGVtZW50cyB8fCAkWzE5XSAhPT0gaW5GcmFtZSB8fCAkWzIwXSAhPT0gaXNEcmFnZ2luZyB8fCAkWzIxXSAhPT0gb3B0aW1pc3RpY0FjdG9yUmVhZHkgfHwgJFsyMl0gIT09IHdhc01heWJlQ29sbGFwc2VkID8gKHQxNDIgPSBlbGVtZW50cy5maWx0ZXIoX3RlbXA5KS5tYXAoKHQxNTIpID0+IHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgaWQsXG4gICAgICAgIGVsZW1lbnQ6IGVsZW1lbnRfMCxcbiAgICAgICAgZm9jdXNlZCxcbiAgICAgICAgaG92ZXJlZCxcbiAgICAgICAgcmVjdCxcbiAgICAgICAgc2FuaXR5LFxuICAgICAgICBkcmFnRGlzYWJsZWRcbiAgICAgIH0gPSB0MTUyLCBkcmFnZ2FibGUgPSAhZHJhZ0Rpc2FibGVkICYmICEhZWxlbWVudF8wLmdldEF0dHJpYnV0ZShcImRhdGEtc2FuaXR5XCIpICYmIG9wdGltaXN0aWNBY3RvclJlYWR5ICYmIGVsZW1lbnRzLnNvbWUoKGVfMikgPT4gXCJpZFwiIGluIGVfMi5zYW5pdHkgJiYgXCJpZFwiIGluIHNhbml0eSA/IHNhbml0eU5vZGVzRXhpc3RJblNhbWVBcnJheShlXzIuc2FuaXR5LCBzYW5pdHkpICYmIGVfMi5zYW5pdHkucGF0aCAhPT0gc2FuaXR5LnBhdGggOiAhMSk7XG4gICAgICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeChFbGVtZW50T3ZlcmxheSwgeyBjb21wb25lbnRSZXNvbHZlciwgZWxlbWVudDogZWxlbWVudF8wLCBlbmFibGVTY3JvbGxJbnRvVmlldzogIWlzRHJhZ2dpbmcgJiYgIWRyYWdNaW5pbWFwVHJhbnNpdGlvbiAmJiAhZHJhZ1Nob3dNaW5pbWFwLCBmb2N1c2VkLCBob3ZlcmVkLCBub2RlOiBzYW5pdHksIHJlY3QsIHNob3dBY3Rpb25zOiAhaW5GcmFtZSwgZHJhZ2dhYmxlLCBpc0RyYWdnaW5nOiBpc0RyYWdnaW5nIHx8IGRyYWdNaW5pbWFwVHJhbnNpdGlvbiwgd2FzTWF5YmVDb2xsYXBzZWQ6IGZvY3VzZWQgJiYgd2FzTWF5YmVDb2xsYXBzZWQgfSwgaWQpO1xuICAgIH0pLCAkWzE1XSA9IGNvbXBvbmVudFJlc29sdmVyLCAkWzE2XSA9IGRyYWdNaW5pbWFwVHJhbnNpdGlvbiwgJFsxN10gPSBkcmFnU2hvd01pbmltYXAsICRbMThdID0gZWxlbWVudHMsICRbMTldID0gaW5GcmFtZSwgJFsyMF0gPSBpc0RyYWdnaW5nLCAkWzIxXSA9IG9wdGltaXN0aWNBY3RvclJlYWR5LCAkWzIyXSA9IHdhc01heWJlQ29sbGFwc2VkLCAkWzIzXSA9IHQxNDIpIDogdDE0MiA9ICRbMjNdLCB0MTMgPSB0MTQyO1xuICB9XG4gIGNvbnN0IGVsZW1lbnRzVG9SZW5kZXIgPSB0MTMsIHQxNCA9IHByZWZlcnNEYXJrID8gXCJkYXJrXCIgOiBcImxpZ2h0XCIsIHQxNSA9IGZhZGluZ091dCA/IFwiXCIgOiB2b2lkIDAsIHQxNiA9IG92ZXJsYXlzRmxhc2ggPyBcIlwiIDogdm9pZCAwO1xuICBsZXQgdDE3O1xuICAkWzI0XSAhPT0gZG9jdW1lbnRJZHMgfHwgJFsyNV0gIT09IHBlcnNwZWN0aXZlID8gKHQxNyA9IC8qIEBfX1BVUkVfXyAqLyBqc3goRG9jdW1lbnRSZXBvcnRlciwgeyBkb2N1bWVudElkcywgcGVyc3BlY3RpdmUgfSksICRbMjRdID0gZG9jdW1lbnRJZHMsICRbMjVdID0gcGVyc3BlY3RpdmUsICRbMjZdID0gdDE3KSA6IHQxNyA9ICRbMjZdO1xuICBsZXQgdDE4O1xuICAkWzI3XSAhPT0gY29tbGluayB8fCAkWzI4XSAhPT0gaW5GcmFtZSB8fCAkWzI5XSAhPT0gaW5Qb3BVcCB8fCAkWzMwXSAhPT0gb3ZlcmxheUVuYWJsZWQgfHwgJFszMV0gIT09IHJvb3RFbGVtZW50IHx8ICRbMzJdICE9PSB1cGRhdGVEcmFnUHJldmlld0N1c3RvbVByb3BzID8gKHQxOCA9IC8qIEBfX1BVUkVfXyAqLyBqc3goT3ZlcmxheXNDb250cm9sbGVyLCB7IGNvbWxpbmssIGRpc3BhdGNoLCBpbkZyYW1lLCBpblBvcFVwLCBvbkRyYWc6IHVwZGF0ZURyYWdQcmV2aWV3Q3VzdG9tUHJvcHMsIG92ZXJsYXlFbmFibGVkLCByb290RWxlbWVudCB9KSwgJFsyN10gPSBjb21saW5rLCAkWzI4XSA9IGluRnJhbWUsICRbMjldID0gaW5Qb3BVcCwgJFszMF0gPSBvdmVybGF5RW5hYmxlZCwgJFszMV0gPSByb290RWxlbWVudCwgJFszMl0gPSB1cGRhdGVEcmFnUHJldmlld0N1c3RvbVByb3BzLCAkWzMzXSA9IHQxOCkgOiB0MTggPSAkWzMzXTtcbiAgbGV0IHQxOTtcbiAgJFszNF0gIT09IGNvbnRleHRNZW51ID8gKHQxOSA9IGNvbnRleHRNZW51ICYmIC8qIEBfX1BVUkVfXyAqLyBqc3goQ29udGV4dE1lbnUsIHsgLi4uY29udGV4dE1lbnUsIG9uRGlzbWlzczogY2xvc2VDb250ZXh0TWVudSB9KSwgJFszNF0gPSBjb250ZXh0TWVudSwgJFszNV0gPSB0MTkpIDogdDE5ID0gJFszNV07XG4gIGxldCB0MjA7XG4gICRbMzZdICE9PSBkcmFnR3JvdXBSZWN0IHx8ICRbMzddICE9PSBkcmFnSW5zZXJ0UG9zaXRpb24gfHwgJFszOF0gIT09IGRyYWdNaW5pbWFwVHJhbnNpdGlvbiB8fCAkWzM5XSAhPT0gZHJhZ1Nob3dNaW5pbWFwUHJvbXB0IHx8ICRbNDBdICE9PSBpc0RyYWdnaW5nID8gKHQyMCA9IGlzRHJhZ2dpbmcgJiYgIWRyYWdNaW5pbWFwVHJhbnNpdGlvbiAmJiAvKiBAX19QVVJFX18gKi8ganN4cyhGcmFnbWVudCwgeyBjaGlsZHJlbjogW1xuICAgIGRyYWdJbnNlcnRQb3NpdGlvbiAmJiAvKiBAX19QVVJFX18gKi8ganN4KE92ZXJsYXlEcmFnSW5zZXJ0TWFya2VyLCB7IGRyYWdJbnNlcnRQb3NpdGlvbiB9KSxcbiAgICBkcmFnU2hvd01pbmltYXBQcm9tcHQgJiYgLyogQF9fUFVSRV9fICovIGpzeChPdmVybGF5TWluaW1hcFByb21wdCwge30pLFxuICAgIGRyYWdHcm91cFJlY3QgJiYgLyogQF9fUFVSRV9fICovIGpzeChPdmVybGF5RHJhZ0dyb3VwUmVjdCwgeyBkcmFnR3JvdXBSZWN0IH0pXG4gIF0gfSksICRbMzZdID0gZHJhZ0dyb3VwUmVjdCwgJFszN10gPSBkcmFnSW5zZXJ0UG9zaXRpb24sICRbMzhdID0gZHJhZ01pbmltYXBUcmFuc2l0aW9uLCAkWzM5XSA9IGRyYWdTaG93TWluaW1hcFByb21wdCwgJFs0MF0gPSBpc0RyYWdnaW5nLCAkWzQxXSA9IHQyMCkgOiB0MjAgPSAkWzQxXTtcbiAgbGV0IHQyMTtcbiAgJFs0Ml0gIT09IGRyYWdTa2VsZXRvbiB8fCAkWzQzXSAhPT0gaXNEcmFnZ2luZyA/ICh0MjEgPSBpc0RyYWdnaW5nICYmIGRyYWdTa2VsZXRvbiAmJiAvKiBAX19QVVJFX18gKi8ganN4KE92ZXJsYXlEcmFnUHJldmlldywgeyBza2VsZXRvbjogZHJhZ1NrZWxldG9uIH0pLCAkWzQyXSA9IGRyYWdTa2VsZXRvbiwgJFs0M10gPSBpc0RyYWdnaW5nLCAkWzQ0XSA9IHQyMSkgOiB0MjEgPSAkWzQ0XTtcbiAgbGV0IHQyMjtcbiAgJFs0NV0gIT09IGVsZW1lbnRzVG9SZW5kZXIgfHwgJFs0Nl0gIT09IHQxNSB8fCAkWzQ3XSAhPT0gdDE2IHx8ICRbNDhdICE9PSB0MTcgfHwgJFs0OV0gIT09IHQxOCB8fCAkWzUwXSAhPT0gdDE5IHx8ICRbNTFdICE9PSB0MjAgfHwgJFs1Ml0gIT09IHQyMSB8fCAkWzUzXSAhPT0gekluZGV4ID8gKHQyMiA9IC8qIEBfX1BVUkVfXyAqLyBqc3hzKFJvb3QsIHsgXCJkYXRhLWZhZGluZy1vdXRcIjogdDE1LCBcImRhdGEtb3ZlcmxheXNcIjogdDE2LCByZWY6IHNldFJvb3RFbGVtZW50LCAkekluZGV4OiB6SW5kZXgsIGNoaWxkcmVuOiBbXG4gICAgdDE3LFxuICAgIHQxOCxcbiAgICB0MTksXG4gICAgZWxlbWVudHNUb1JlbmRlcixcbiAgICB0MjAsXG4gICAgdDIxXG4gIF0gfSksICRbNDVdID0gZWxlbWVudHNUb1JlbmRlciwgJFs0Nl0gPSB0MTUsICRbNDddID0gdDE2LCAkWzQ4XSA9IHQxNywgJFs0OV0gPSB0MTgsICRbNTBdID0gdDE5LCAkWzUxXSA9IHQyMCwgJFs1Ml0gPSB0MjEsICRbNTNdID0gekluZGV4LCAkWzU0XSA9IHQyMikgOiB0MjIgPSAkWzU0XTtcbiAgbGV0IHQyMztcbiAgJFs1NV0gIT09IGNvbWxpbmsgfHwgJFs1Nl0gIT09IHQyMiA/ICh0MjMgPSAvKiBAX19QVVJFX18gKi8ganN4KFNoYXJlZFN0YXRlUHJvdmlkZXIsIHsgY29tbGluaywgY2hpbGRyZW46IHQyMiB9KSwgJFs1NV0gPSBjb21saW5rLCAkWzU2XSA9IHQyMiwgJFs1N10gPSB0MjMpIDogdDIzID0gJFs1N107XG4gIGxldCB0MjQ7XG4gICRbNThdICE9PSBjb21saW5rIHx8ICRbNTldICE9PSB0MjMgPyAodDI0ID0gLyogQF9fUFVSRV9fICovIGpzeChQcmV2aWV3U25hcHNob3RzUHJvdmlkZXIsIHsgY29tbGluaywgY2hpbGRyZW46IHQyMyB9KSwgJFs1OF0gPSBjb21saW5rLCAkWzU5XSA9IHQyMywgJFs2MF0gPSB0MjQpIDogdDI0ID0gJFs2MF07XG4gIGxldCB0MjU7XG4gICRbNjFdICE9PSBjb21saW5rIHx8ICRbNjJdICE9PSBlbGVtZW50cyB8fCAkWzYzXSAhPT0gdDI0ID8gKHQyNSA9IC8qIEBfX1BVUkVfXyAqLyBqc3goU2NoZW1hUHJvdmlkZXIsIHsgY29tbGluaywgZWxlbWVudHMsIGNoaWxkcmVuOiB0MjQgfSksICRbNjFdID0gY29tbGluaywgJFs2Ml0gPSBlbGVtZW50cywgJFs2M10gPSB0MjQsICRbNjRdID0gdDI1KSA6IHQyNSA9ICRbNjRdO1xuICBsZXQgdDI2O1xuICAkWzY1XSAhPT0gcm9vdEVsZW1lbnQgfHwgJFs2Nl0gIT09IHQyNSA/ICh0MjYgPSAvKiBAX19QVVJFX18gKi8ganN4KExheWVyUHJvdmlkZXIsIHsgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3goUG9ydGFsUHJvdmlkZXIsIHsgZWxlbWVudDogcm9vdEVsZW1lbnQsIGNoaWxkcmVuOiB0MjUgfSkgfSksICRbNjVdID0gcm9vdEVsZW1lbnQsICRbNjZdID0gdDI1LCAkWzY3XSA9IHQyNikgOiB0MjYgPSAkWzY3XTtcbiAgbGV0IHQyNztcbiAgJFs2OF0gIT09IHQxNCB8fCAkWzY5XSAhPT0gdDI2ID8gKHQyNyA9IC8qIEBfX1BVUkVfXyAqLyBqc3goVGhlbWVQcm92aWRlciwgeyBzY2hlbWU6IHQxNCwgdGhlbWU6IHN0dWRpb1RoZW1lLCB0b25lOiBcInRyYW5zcGFyZW50XCIsIGNoaWxkcmVuOiB0MjYgfSksICRbNjhdID0gdDE0LCAkWzY5XSA9IHQyNiwgJFs3MF0gPSB0MjcpIDogdDI3ID0gJFs3MF07XG4gIGxldCB0Mjg7XG4gIHJldHVybiAkWzcxXSAhPT0gY29tbGluayB8fCAkWzcyXSAhPT0gdDI3ID8gKHQyOCA9IC8qIEBfX1BVUkVfXyAqLyBqc3goVGVsZW1ldHJ5UHJvdmlkZXIsIHsgY29tbGluaywgY2hpbGRyZW46IHQyNyB9KSwgJFs3MV0gPSBjb21saW5rLCAkWzcyXSA9IHQyNywgJFs3M10gPSB0MjgpIDogdDI4ID0gJFs3M10sIHQyODtcbn0sIElTX01BQyA9IHR5cGVvZiB3aW5kb3cgPCBcInVcIiAmJiAvTWFjfGlQb2R8aVBob25lfGlQYWQvLnRlc3Qod2luZG93Lm5hdmlnYXRvci5wbGF0Zm9ybSksIE1PRElGSUVSUyA9IHtcbiAgYWx0OiBcImFsdEtleVwiLFxuICBjdHJsOiBcImN0cmxLZXlcIixcbiAgbW9kOiBJU19NQUMgPyBcIm1ldGFLZXlcIiA6IFwiY3RybEtleVwiLFxuICBzaGlmdDogXCJzaGlmdEtleVwiXG59O1xuZnVuY3Rpb24gaXNIb3RrZXkoa2V5cywgZXZlbnQpIHtcbiAgcmV0dXJuIGtleXMuZXZlcnkoKGtleSkgPT4gTU9ESUZJRVJTW2tleV0gPyBldmVudFtNT0RJRklFUlNba2V5XV0gOiBldmVudC5rZXkgPT09IGtleS50b1VwcGVyQ2FzZSgpKTtcbn1cbmZ1bmN0aW9uIGlzQWx0S2V5KGV2ZW50KSB7XG4gIHJldHVybiBldmVudC5rZXkgPT09IFwiQWx0XCI7XG59XG5mdW5jdGlvbiBfdGVtcCQyKGFjYywgcHJldklkKSB7XG4gIHJldHVybiBhY2MuZmlsdGVyKChpZCkgPT4gaWQgIT09IHByZXZJZCk7XG59XG5mdW5jdGlvbiBfdGVtcDIkMShlbmFibGVkKSB7XG4gIHJldHVybiAhZW5hYmxlZDtcbn1cbmZ1bmN0aW9uIF90ZW1wMyh1bnN1Yikge1xuICByZXR1cm4gdW5zdWIoKTtcbn1cbmZ1bmN0aW9uIF90ZW1wNChldmVudCkge1xuICBjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQ7XG4gIGlmICgoaXNIVE1MQW5jaG9yRWxlbWVudCh0YXJnZXQpIHx8IGlzSFRNTEVsZW1lbnQodGFyZ2V0KSAmJiB0YXJnZXQuY2xvc2VzdChcImFcIikpICYmIGV2ZW50LmFsdEtleSkge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCksIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIGNvbnN0IG5ld0V2ZW50ID0gbmV3IE1vdXNlRXZlbnQoZXZlbnQudHlwZSwge1xuICAgICAgLi4uZXZlbnQsXG4gICAgICBhbHRLZXk6ICExLFxuICAgICAgYnViYmxlczogITAsXG4gICAgICBjYW5jZWxhYmxlOiAhMFxuICAgIH0pO1xuICAgIGV2ZW50LnRhcmdldD8uZGlzcGF0Y2hFdmVudChuZXdFdmVudCk7XG4gIH1cbn1cbmZ1bmN0aW9uIF90ZW1wNShlbmFibGVkXzApIHtcbiAgcmV0dXJuICFlbmFibGVkXzA7XG59XG5mdW5jdGlvbiBfdGVtcDYoZW5hYmxlZF8xKSB7XG4gIHJldHVybiAhZW5hYmxlZF8xO1xufVxuZnVuY3Rpb24gX3RlbXA3KGVuYWJsZWRfMikge1xuICByZXR1cm4gIWVuYWJsZWRfMjtcbn1cbmZ1bmN0aW9uIF90ZW1wOChlbGVtZW50KSB7XG4gIHJldHVybiBcImlkXCIgaW4gZWxlbWVudC5zYW5pdHkgPyBbZWxlbWVudC5zYW5pdHkuaWRdIDogW107XG59XG5mdW5jdGlvbiBfdGVtcDkoZV8xKSB7XG4gIHJldHVybiBlXzEuYWN0aXZhdGVkIHx8IGVfMS5mb2N1c2VkO1xufVxuY29uc3QgUmVmcmVzaCA9IChwcm9wcykgPT4ge1xuICBjb25zdCAkID0gYyg0KSwge1xuICAgIGNvbWxpbmssXG4gICAgcmVmcmVzaFxuICB9ID0gcHJvcHMsIG1hbnVhbFJlZnJlc2hSZWYgPSB1c2VSZWYoMCksIG11dGF0aW9uUmVmcmVzaFJlZiA9IHVzZVJlZigwKTtcbiAgbGV0IHQwLCB0MTtcbiAgcmV0dXJuICRbMF0gIT09IGNvbWxpbmsgfHwgJFsxXSAhPT0gcmVmcmVzaCA/ICh0MCA9ICgpID0+IGNvbWxpbmsub24oXCJwcmVzZW50YXRpb24vcmVmcmVzaFwiLCAoZGF0YSkgPT4ge1xuICAgIGlmIChkYXRhLnNvdXJjZSA9PT0gXCJtYW51YWxcIikge1xuICAgICAgY2xlYXJUaW1lb3V0KG1hbnVhbFJlZnJlc2hSZWYuY3VycmVudCk7XG4gICAgICBjb25zdCBwcm9taXNlID0gcmVmcmVzaChkYXRhKTtcbiAgICAgIGlmIChwcm9taXNlID09PSAhMSlcbiAgICAgICAgcmV0dXJuO1xuICAgICAgY29tbGluay5wb3N0KFwidmlzdWFsLWVkaXRpbmcvcmVmcmVzaGluZ1wiLCBkYXRhKTtcbiAgICAgIGxldCB0aW1lZE91dDtcbiAgICAgIHRpbWVkT3V0ID0gITEsIG1hbnVhbFJlZnJlc2hSZWYuY3VycmVudCA9IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgY29tbGluay5wb3N0KFwidmlzdWFsLWVkaXRpbmcvcmVmcmVzaGVkXCIsIGRhdGEpLCB0aW1lZE91dCA9ICEwO1xuICAgICAgfSwgM2UzKSwgcHJvbWlzZT8uZmluYWxseT8uKCgpID0+IHtcbiAgICAgICAgdGltZWRPdXQgfHwgKGNsZWFyVGltZW91dChtYW51YWxSZWZyZXNoUmVmLmN1cnJlbnQpLCBjb21saW5rLnBvc3QoXCJ2aXN1YWwtZWRpdGluZy9yZWZyZXNoZWRcIiwgZGF0YSkpO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmIChkYXRhLnNvdXJjZSA9PT0gXCJtdXRhdGlvblwiKSB7XG4gICAgICBjbGVhclRpbWVvdXQobXV0YXRpb25SZWZyZXNoUmVmLmN1cnJlbnQpO1xuICAgICAgY29uc3QgcHJvbWlzZV8wID0gcmVmcmVzaChkYXRhKTtcbiAgICAgIGlmIChwcm9taXNlXzAgPT09ICExKVxuICAgICAgICByZXR1cm47XG4gICAgICBjb21saW5rLnBvc3QoXCJ2aXN1YWwtZWRpdGluZy9yZWZyZXNoaW5nXCIsIGRhdGEpLCBtdXRhdGlvblJlZnJlc2hSZWYuY3VycmVudCA9IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgY29uc3QgcHJvbWlzZV8xID0gcmVmcmVzaChkYXRhKTtcbiAgICAgICAgcHJvbWlzZV8xICE9PSAhMSAmJiAoY29tbGluay5wb3N0KFwidmlzdWFsLWVkaXRpbmcvcmVmcmVzaGluZ1wiLCBkYXRhKSwgcHJvbWlzZV8xPy5maW5hbGx5Py4oKCkgPT4ge1xuICAgICAgICAgIGNvbWxpbmsucG9zdChcInZpc3VhbC1lZGl0aW5nL3JlZnJlc2hlZFwiLCBkYXRhKTtcbiAgICAgICAgfSkgfHwgY29tbGluay5wb3N0KFwidmlzdWFsLWVkaXRpbmcvcmVmcmVzaGVkXCIsIGRhdGEpKTtcbiAgICAgIH0sIDFlMyksIHByb21pc2VfMD8uZmluYWxseT8uKCgpID0+IHtcbiAgICAgICAgY29tbGluay5wb3N0KFwidmlzdWFsLWVkaXRpbmcvcmVmcmVzaGVkXCIsIGRhdGEpO1xuICAgICAgfSkgfHwgY29tbGluay5wb3N0KFwidmlzdWFsLWVkaXRpbmcvcmVmcmVzaGVkXCIsIGRhdGEpO1xuICAgIH1cbiAgfSksIHQxID0gW2NvbWxpbmssIHJlZnJlc2hdLCAkWzBdID0gY29tbGluaywgJFsxXSA9IHJlZnJlc2gsICRbMl0gPSB0MCwgJFszXSA9IHQxKSA6ICh0MCA9ICRbMl0sIHQxID0gJFszXSksIHVzZUVmZmVjdCh0MCwgdDEpLCBudWxsO1xufTtcbmZ1bmN0aW9uIHVzZUNvbWxpbmsodDApIHtcbiAgY29uc3QgJCA9IGMoOSksIGFjdGl2ZSA9IHQwID09PSB2b2lkIDAgPyAhMCA6IHQwLCBbbm9kZSwgc2V0Tm9kZV0gPSB1c2VTdGF0ZSgpLCBbc3RhdHVzLCBzZXRTdGF0dXNdID0gdXNlU3RhdGUoXCJpZGxlXCIpO1xuICBsZXQgdDEsIHQyO1xuICAkWzBdICE9PSBhY3RpdmUgPyAodDEgPSAoKSA9PiB7XG4gICAgaWYgKCFhY3RpdmUpXG4gICAgICByZXR1cm47XG4gICAgY29uc3QgaW5zdGFuY2UgPSBjcmVhdGVOb2RlKHtcbiAgICAgIG5hbWU6IFwidmlzdWFsLWVkaXRpbmdcIixcbiAgICAgIGNvbm5lY3RUbzogXCJwcmVzZW50YXRpb25cIlxuICAgIH0sIGNyZWF0ZU5vZGVNYWNoaW5lKCkucHJvdmlkZSh7XG4gICAgICBhY3RvcnM6IGNyZWF0ZUNvbXBhdGliaWxpdHlBY3RvcnMoKVxuICAgIH0pKSwgdW5zdWIgPSBpbnN0YW5jZS5vblN0YXR1cygoKSA9PiBzZXRTdGF0dXMoXCJjb25uZWN0ZWRcIiksIFwiY29ubmVjdGVkXCIpO1xuICAgIHNldE5vZGUoaW5zdGFuY2UpO1xuICAgIGNvbnN0IHN0b3AgPSBpbnN0YW5jZS5zdGFydCgpO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICB1bnN1YigpLCBzdG9wKCksIHNldE5vZGUodm9pZCAwKTtcbiAgICB9O1xuICB9LCB0MiA9IFthY3RpdmVdLCAkWzBdID0gYWN0aXZlLCAkWzFdID0gdDEsICRbMl0gPSB0MikgOiAodDEgPSAkWzFdLCB0MiA9ICRbMl0pLCB1c2VFZmZlY3QodDEsIHQyKTtcbiAgbGV0IHQzLCB0NDtcbiAgJFszXSAhPT0gc3RhdHVzID8gKHQzID0gKCkgPT4ge1xuICAgIGlmIChzdGF0dXMgPT09IFwiY29ubmVjdGVkXCIpXG4gICAgICByZXR1cm47XG4gICAgY29uc3QgY29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcbiAgICByZXR1cm4gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIF90ZW1wJDEsIHtcbiAgICAgIHNpZ25hbDogY29udHJvbGxlci5zaWduYWxcbiAgICB9KSwgKCkgPT4ge1xuICAgICAgY29udHJvbGxlci5hYm9ydCgpO1xuICAgIH07XG4gIH0sIHQ0ID0gW3N0YXR1c10sICRbM10gPSBzdGF0dXMsICRbNF0gPSB0MywgJFs1XSA9IHQ0KSA6ICh0MyA9ICRbNF0sIHQ0ID0gJFs1XSksIHVzZUVmZmVjdCh0MywgdDQpO1xuICBsZXQgdDU7XG4gIHJldHVybiAkWzZdICE9PSBub2RlIHx8ICRbN10gIT09IHN0YXR1cyA/ICh0NSA9IFtub2RlLCBzdGF0dXNdLCAkWzZdID0gbm9kZSwgJFs3XSA9IHN0YXR1cywgJFs4XSA9IHQ1KSA6IHQ1ID0gJFs4XSwgdDU7XG59XG5mdW5jdGlvbiBfdGVtcCQxKHQwKSB7XG4gIGNvbnN0IHtcbiAgICBkYXRhLFxuICAgIG9yaWdpblxuICB9ID0gdDA7XG4gIGRhdGEgJiYgdHlwZW9mIGRhdGEgPT0gXCJvYmplY3RcIiAmJiBcImRvbWFpblwiIGluIGRhdGEgJiYgZGF0YS5kb21haW4gPT09IFwic2FuaXR5L2NoYW5uZWxzXCIgJiYgXCJmcm9tXCIgaW4gZGF0YSAmJiBkYXRhLmZyb20gPT09IFwicHJlc2VudGF0aW9uXCIgJiYgXCJ0eXBlXCIgaW4gZGF0YSAmJiBkYXRhLnR5cGUgPT09IFwicHJlc2VudGF0aW9uL3N0YXR1c1wiICYmIHdpbmRvdy5wYXJlbnQucG9zdE1lc3NhZ2Uoe1xuICAgIGRvbWFpbjogXCJzYW5pdHkvY2hhbm5lbHNcIixcbiAgICB0eXBlOiBcInZpc3VhbC1lZGl0aW5nL3N0YXR1c1wiLFxuICAgIGRhdGE6IHtcbiAgICAgIG9yaWdpbjogbG9jYXRpb24ub3JpZ2luXG4gICAgfVxuICB9LCBvcmlnaW4pO1xufVxuZnVuY3Rpb24gY3JlYXRlU2hhcmVkTGlzdGVuZXIoY29tbGluaykge1xuICBjb25zdCBpbmNvbWluZ0Nvbm5lY3Rpb24kID0gbmV3IFJlcGxheVN1YmplY3QoMSksIGluY29taW5nTXV0YXRpb25zJCA9IG5ldyBTdWJqZWN0KCk7XG4gIHJldHVybiBjb21saW5rLmZldGNoKFwidmlzdWFsLWVkaXRpbmcvc25hcHNob3Qtd2VsY29tZVwiLCB2b2lkIDAsIHtcbiAgICBzdXBwcmVzc1dhcm5pbmdzOiAhMFxuICB9KS50aGVuKChkYXRhKSA9PiB7XG4gICAgaW5jb21pbmdDb25uZWN0aW9uJC5uZXh0KGRhdGEuZXZlbnQpO1xuICB9KS5jYXRjaCgoKSA9PiB7XG4gIH0pLCBjb21saW5rLm9uKFwicHJlc2VudGF0aW9uL3NuYXBzaG90LWV2ZW50XCIsIChkYXRhKSA9PiB7XG4gICAgZGF0YS5ldmVudC50eXBlID09PSBcInJlY29ubmVjdFwiICYmIGluY29taW5nQ29ubmVjdGlvbiQubmV4dChkYXRhLmV2ZW50KSwgZGF0YS5ldmVudC50eXBlID09PSBcIm11dGF0aW9uXCIgJiYgaW5jb21pbmdNdXRhdGlvbnMkLm5leHQoZGF0YS5ldmVudCk7XG4gIH0pLCBtZXJnZShpbmNvbWluZ0Nvbm5lY3Rpb24kLCBpbmNvbWluZ011dGF0aW9ucyQpO1xufVxuZnVuY3Rpb24gdXNlRGF0YXNldE11dGF0b3IoY29tbGluaykge1xuICBjb25zdCAkID0gYygzKTtcbiAgbGV0IHQwLCB0MTtcbiAgJFswXSAhPT0gY29tbGluayA/ICh0MCA9ICgpID0+IHtcbiAgICBpZiAoIWNvbWxpbmspXG4gICAgICByZXR1cm47XG4gICAgY29uc3QgbGlzdGVuZXIgPSBjcmVhdGVTaGFyZWRMaXN0ZW5lcihjb21saW5rKSwgZGF0YXNldE11dGF0b3IgPSBjcmVhdGVEYXRhc2V0TXV0YXRvcihjb21saW5rKSwgbXV0YXRvciA9IGNyZWF0ZUFjdG9yKGRhdGFzZXRNdXRhdG9yLCB7XG4gICAgICBpbnB1dDoge1xuICAgICAgICBjbGllbnQ6IHtcbiAgICAgICAgICB3aXRoQ29uZmlnOiBfdGVtcFxuICAgICAgICB9LFxuICAgICAgICBzaGFyZWRMaXN0ZW5lcjogbGlzdGVuZXJcbiAgICAgIH1cbiAgICB9KTtcbiAgICBtdXRhdG9yLnN0YXJ0KCk7XG4gICAgY29uc3QgZmVhdHVyZXNGZXRjaCA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcbiAgICByZXR1cm4gY29tbGluay5mZXRjaChcInZpc3VhbC1lZGl0aW5nL2ZlYXR1cmVzXCIsIHZvaWQgMCwge1xuICAgICAgc2lnbmFsOiBmZWF0dXJlc0ZldGNoLnNpZ25hbCxcbiAgICAgIHN1cHByZXNzV2FybmluZ3M6ICEwXG4gICAgfSkudGhlbigoZGF0YSkgPT4ge1xuICAgICAgZGF0YS5mZWF0dXJlcy5vcHRpbWlzdGljICYmIHNldEFjdG9yKG11dGF0b3IpO1xuICAgIH0pLmNhdGNoKF90ZW1wMiksICgpID0+IHtcbiAgICAgIG11dGF0b3Iuc3RvcCgpLCBmZWF0dXJlc0ZldGNoLmFib3J0KCk7XG4gICAgfTtcbiAgfSwgdDEgPSBbY29tbGlua10sICRbMF0gPSBjb21saW5rLCAkWzFdID0gdDAsICRbMl0gPSB0MSkgOiAodDAgPSAkWzFdLCB0MSA9ICRbMl0pLCB1c2VFZmZlY3QodDAsIHQxKTtcbn1cbmZ1bmN0aW9uIF90ZW1wMigpIHtcbiAgY29uc29sZS53YXJuKFwiW0BzYW5pdHkvdmlzdWFsLWVkaXRpbmddIFBhY2thZ2UgdmVyc2lvbiBtaXNtYXRjaCBkZXRlY3RlZDogUGxlYXNlIHVwZGF0ZSB5b3VyIFNhbml0eSBzdHVkaW8gdG8gcHJldmVudCBwb3RlbnRpYWwgY29tcGF0aWJpbGl0eSBpc3N1ZXMuXCIpO1xufVxuZnVuY3Rpb24gX3RlbXAoKSB7XG59XG5jb25zdCBWaXN1YWxFZGl0aW5nID0gKHByb3BzKSA9PiB7XG4gIGNvbnN0ICQgPSBjKDIyKSwge1xuICAgIGNvbXBvbmVudHMsXG4gICAgaGlzdG9yeSxcbiAgICBwb3J0YWw6IHQwLFxuICAgIHJlZnJlc2gsXG4gICAgekluZGV4XG4gIH0gPSBwcm9wcywgcG9ydGFsID0gdDAgPT09IHZvaWQgMCA/ICEwIDogdDAsIFtpbkZyYW1lLCBzZXRJbkZyYW1lXSA9IHVzZVN0YXRlKG51bGwpLCBbaW5Qb3BVcCwgc2V0SW5Qb3BVcF0gPSB1c2VTdGF0ZShudWxsKTtcbiAgbGV0IHQxLCB0MjtcbiAgJFswXSA9PT0gU3ltYm9sLmZvcihcInJlYWN0Lm1lbW9fY2FjaGVfc2VudGluZWxcIikgPyAodDEgPSAoKSA9PiB7XG4gICAgc2V0SW5GcmFtZShpc01heWJlUHJldmlld0lmcmFtZSgpKSwgc2V0SW5Qb3BVcChpc01heWJlUHJldmlld1dpbmRvdygpKTtcbiAgfSwgdDIgPSBbXSwgJFswXSA9IHQxLCAkWzFdID0gdDIpIDogKHQxID0gJFswXSwgdDIgPSAkWzFdKSwgdXNlRWZmZWN0KHQxLCB0Mik7XG4gIGNvbnN0IFtwb3J0YWxFbGVtZW50LCBzZXRQb3J0YWxFbGVtZW50XSA9IHVzZVN0YXRlKG51bGwpO1xuICBsZXQgdDMsIHQ0O1xuICAkWzJdICE9PSBwb3J0YWwgPyAodDMgPSAoKSA9PiB7XG4gICAgaWYgKHBvcnRhbCA9PT0gITEpXG4gICAgICByZXR1cm47XG4gICAgY29uc3Qgbm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzYW5pdHktdmlzdWFsLWVkaXRpbmdcIik7XG4gICAgcmV0dXJuIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5hcHBlbmRDaGlsZChub2RlKSwgc2V0UG9ydGFsRWxlbWVudChub2RlKSwgKCkgPT4ge1xuICAgICAgc2V0UG9ydGFsRWxlbWVudChudWxsKSwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNvbnRhaW5zKG5vZGUpICYmIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5yZW1vdmVDaGlsZChub2RlKTtcbiAgICB9O1xuICB9LCB0NCA9IFtwb3J0YWxdLCAkWzJdID0gcG9ydGFsLCAkWzNdID0gdDMsICRbNF0gPSB0NCkgOiAodDMgPSAkWzNdLCB0NCA9ICRbNF0pLCB1c2VFZmZlY3QodDMsIHQ0KTtcbiAgY29uc3QgW2NvbWxpbmssIGNvbWxpbmtTdGF0dXNdID0gdXNlQ29tbGluayhpbkZyYW1lID09PSAhMCB8fCBpblBvcFVwID09PSAhMCk7XG4gIHVzZURhdGFzZXRNdXRhdG9yKGNvbWxpbmtTdGF0dXMgPT09IFwiY29ubmVjdGVkXCIgPyBjb21saW5rIDogdm9pZCAwKTtcbiAgbGV0IHQ1O1xuICAkWzVdICE9PSBjb21saW5rIHx8ICRbNl0gIT09IGNvbWxpbmtTdGF0dXMgfHwgJFs3XSAhPT0gY29tcG9uZW50cyB8fCAkWzhdICE9PSBpbkZyYW1lIHx8ICRbOV0gIT09IGluUG9wVXAgfHwgJFsxMF0gIT09IHpJbmRleCA/ICh0NSA9IGluRnJhbWUgIT09IG51bGwgJiYgaW5Qb3BVcCAhPT0gbnVsbCAmJiAvKiBAX19QVVJFX18gKi8ganN4KE92ZXJsYXlzLCB7IGNvbWxpbmssIGNvbWxpbmtTdGF0dXMsIGNvbXBvbmVudFJlc29sdmVyOiBjb21wb25lbnRzLCBpbkZyYW1lLCBpblBvcFVwLCB6SW5kZXggfSksICRbNV0gPSBjb21saW5rLCAkWzZdID0gY29tbGlua1N0YXR1cywgJFs3XSA9IGNvbXBvbmVudHMsICRbOF0gPSBpbkZyYW1lLCAkWzldID0gaW5Qb3BVcCwgJFsxMF0gPSB6SW5kZXgsICRbMTFdID0gdDUpIDogdDUgPSAkWzExXTtcbiAgbGV0IHQ2O1xuICAkWzEyXSAhPT0gY29tbGluayB8fCAkWzEzXSAhPT0gaGlzdG9yeSB8fCAkWzE0XSAhPT0gcmVmcmVzaCA/ICh0NiA9IGNvbWxpbmsgJiYgLyogQF9fUFVSRV9fICovIGpzeHMoRnJhZ21lbnQsIHsgY2hpbGRyZW46IFtcbiAgICAvKiBAX19QVVJFX18gKi8ganN4KEhpc3RvcnksIHsgY29tbGluaywgaGlzdG9yeSB9KSxcbiAgICAvKiBAX19QVVJFX18gKi8ganN4KE1ldGEsIHsgY29tbGluayB9KSxcbiAgICByZWZyZXNoICYmIC8qIEBfX1BVUkVfXyAqLyBqc3goUmVmcmVzaCwgeyBjb21saW5rLCByZWZyZXNoIH0pXG4gIF0gfSksICRbMTJdID0gY29tbGluaywgJFsxM10gPSBoaXN0b3J5LCAkWzE0XSA9IHJlZnJlc2gsICRbMTVdID0gdDYpIDogdDYgPSAkWzE1XTtcbiAgbGV0IHQ3O1xuICAkWzE2XSAhPT0gdDUgfHwgJFsxN10gIT09IHQ2ID8gKHQ3ID0gLyogQF9fUFVSRV9fICovIGpzeHMoRnJhZ21lbnQsIHsgY2hpbGRyZW46IFtcbiAgICB0NSxcbiAgICB0NlxuICBdIH0pLCAkWzE2XSA9IHQ1LCAkWzE3XSA9IHQ2LCAkWzE4XSA9IHQ3KSA6IHQ3ID0gJFsxOF07XG4gIGNvbnN0IGNoaWxkcmVuID0gdDc7XG4gIGlmIChwb3J0YWwgPT09ICExIHx8ICFwb3J0YWxFbGVtZW50KVxuICAgIHJldHVybiBjaGlsZHJlbjtcbiAgbGV0IHQ4O1xuICByZXR1cm4gJFsxOV0gIT09IGNoaWxkcmVuIHx8ICRbMjBdICE9PSBwb3J0YWxFbGVtZW50ID8gKHQ4ID0gY3JlYXRlUG9ydGFsKGNoaWxkcmVuLCBwb3J0YWxFbGVtZW50KSwgJFsxOV0gPSBjaGlsZHJlbiwgJFsyMF0gPSBwb3J0YWxFbGVtZW50LCAkWzIxXSA9IHQ4KSA6IHQ4ID0gJFsyMV0sIHQ4O1xufTtcblZpc3VhbEVkaXRpbmcuZGlzcGxheU5hbWUgPSBcIlZpc3VhbEVkaXRpbmdcIjtcbmV4cG9ydCB7XG4gIFZpc3VhbEVkaXRpbmcsXG4gIGNyZWF0ZURhdGFBdHRyaWJ1dGUsXG4gIGNyZWF0ZURhdGFzZXRNdXRhdG9yLFxuICBjcmVhdGVEb2N1bWVudE11dGF0b3IsXG4gIGVtcHR5QWN0b3IsXG4gIHVzZURvY3VtZW50cyxcbiAgdXNlT3B0aW1pc3RpYyxcbiAgdXNlT3B0aW1pc3RpY0FjdG9yXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwXG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@sanity+visual-editing@2.13.15_@emotion+is-prop-valid@1.2.2_@sanity+client@6.28.4_@sani_8c2033feabd5f584af4469bfce14153f/node_modules/@sanity/visual-editing/dist/react/index.js\n");

/***/ })

};
;